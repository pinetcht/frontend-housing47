(function(){const E=document.createElement("link").relList;if(E&&E.supports&&E.supports("modulepreload"))return;for(const L of document.querySelectorAll('link[rel="modulepreload"]'))R(L);new MutationObserver(L=>{for(const H of L)if(H.type==="childList")for(const A of H.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&R(A)}).observe(document,{childList:!0,subtree:!0});function I(L){const H={};return L.integrity&&(H.integrity=L.integrity),L.referrerPolicy&&(H.referrerPolicy=L.referrerPolicy),L.crossOrigin==="use-credentials"?H.credentials="include":L.crossOrigin==="anonymous"?H.credentials="omit":H.credentials="same-origin",H}function R(L){if(L.ep)return;L.ep=!0;const H=I(L);fetch(L.href,H)}})();function Fg(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var Am={exports:{}},Jf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var og;function B_(){if(og)return Jf;og=1;var x=Symbol.for("react.transitional.element"),E=Symbol.for("react.fragment");function I(R,L,H){var A=null;if(H!==void 0&&(A=""+H),L.key!==void 0&&(A=""+L.key),"key"in L){H={};for(var u in L)u!=="key"&&(H[u]=L[u])}else H=L;return L=H.ref,{$$typeof:x,type:R,key:A,ref:L!==void 0?L:null,props:H}}return Jf.Fragment=E,Jf.jsx=I,Jf.jsxs=I,Jf}var sg;function O_(){return sg||(sg=1,Am.exports=B_()),Am.exports}var F=O_(),zm={exports:{}},vi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lg;function j_(){if(lg)return vi;lg=1;var x=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),A=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),Q=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),ze=Symbol.iterator;function _e(Te){return Te===null||typeof Te!="object"?null:(Te=ze&&Te[ze]||Te["@@iterator"],typeof Te=="function"?Te:null)}var ie={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},he=Object.assign,je={};function Me(Te,ct,Et){this.props=Te,this.context=ct,this.refs=je,this.updater=Et||ie}Me.prototype.isReactComponent={},Me.prototype.setState=function(Te,ct){if(typeof Te!="object"&&typeof Te!="function"&&Te!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Te,ct,"setState")},Me.prototype.forceUpdate=function(Te){this.updater.enqueueForceUpdate(this,Te,"forceUpdate")};function Oe(){}Oe.prototype=Me.prototype;function Fe(Te,ct,Et){this.props=Te,this.context=ct,this.refs=je,this.updater=Et||ie}var qe=Fe.prototype=new Oe;qe.constructor=Fe,he(qe,Me.prototype),qe.isPureReactComponent=!0;var dt=Array.isArray,mt={H:null,A:null,T:null,S:null,V:null},zt=Object.prototype.hasOwnProperty;function yt(Te,ct,Et,wt,Ot,$t){return Et=$t.ref,{$$typeof:x,type:Te,key:ct,ref:Et!==void 0?Et:null,props:$t}}function St(Te,ct){return yt(Te.type,ct,void 0,void 0,void 0,Te.props)}function Qt(Te){return typeof Te=="object"&&Te!==null&&Te.$$typeof===x}function Bi(Te){var ct={"=":"=0",":":"=2"};return"$"+Te.replace(/[=:]/g,function(Et){return ct[Et]})}var Si=/\/+/g;function Mi(Te,ct){return typeof Te=="object"&&Te!==null&&Te.key!=null?Bi(""+Te.key):ct.toString(36)}function Ui(){}function Ki(Te){switch(Te.status){case"fulfilled":return Te.value;case"rejected":throw Te.reason;default:switch(typeof Te.status=="string"?Te.then(Ui,Ui):(Te.status="pending",Te.then(function(ct){Te.status==="pending"&&(Te.status="fulfilled",Te.value=ct)},function(ct){Te.status==="pending"&&(Te.status="rejected",Te.reason=ct)})),Te.status){case"fulfilled":return Te.value;case"rejected":throw Te.reason}}throw Te}function Vi(Te,ct,Et,wt,Ot){var $t=typeof Te;($t==="undefined"||$t==="boolean")&&(Te=null);var qt=!1;if(Te===null)qt=!0;else switch($t){case"bigint":case"string":case"number":qt=!0;break;case"object":switch(Te.$$typeof){case x:case E:qt=!0;break;case ce:return qt=Te._init,Vi(qt(Te._payload),ct,Et,wt,Ot)}}if(qt)return Ot=Ot(Te),qt=wt===""?"."+Mi(Te,0):wt,dt(Ot)?(Et="",qt!=null&&(Et=qt.replace(Si,"$&/")+"/"),Vi(Ot,ct,Et,"",function(Ln){return Ln})):Ot!=null&&(Qt(Ot)&&(Ot=St(Ot,Et+(Ot.key==null||Te&&Te.key===Ot.key?"":(""+Ot.key).replace(Si,"$&/")+"/")+qt)),ct.push(Ot)),1;qt=0;var kn=wt===""?".":wt+":";if(dt(Te))for(var Ai=0;Ai<Te.length;Ai++)wt=Te[Ai],$t=kn+Mi(wt,Ai),qt+=Vi(wt,ct,Et,$t,Ot);else if(Ai=_e(Te),typeof Ai=="function")for(Te=Ai.call(Te),Ai=0;!(wt=Te.next()).done;)wt=wt.value,$t=kn+Mi(wt,Ai++),qt+=Vi(wt,ct,Et,$t,Ot);else if($t==="object"){if(typeof Te.then=="function")return Vi(Ki(Te),ct,Et,wt,Ot);throw ct=String(Te),Error("Objects are not valid as a React child (found: "+(ct==="[object Object]"?"object with keys {"+Object.keys(Te).join(", ")+"}":ct)+"). If you meant to render a collection of children, use an array instead.")}return qt}function Ve(Te,ct,Et){if(Te==null)return Te;var wt=[],Ot=0;return Vi(Te,wt,"","",function($t){return ct.call(Et,$t,Ot++)}),wt}function xt(Te){if(Te._status===-1){var ct=Te._result;ct=ct(),ct.then(function(Et){(Te._status===0||Te._status===-1)&&(Te._status=1,Te._result=Et)},function(Et){(Te._status===0||Te._status===-1)&&(Te._status=2,Te._result=Et)}),Te._status===-1&&(Te._status=0,Te._result=ct)}if(Te._status===1)return Te._result.default;throw Te._result}var jt=typeof reportError=="function"?reportError:function(Te){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ct=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Te=="object"&&Te!==null&&typeof Te.message=="string"?String(Te.message):String(Te),error:Te});if(!window.dispatchEvent(ct))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Te);return}console.error(Te)};function ui(){}return vi.Children={map:Ve,forEach:function(Te,ct,Et){Ve(Te,function(){ct.apply(this,arguments)},Et)},count:function(Te){var ct=0;return Ve(Te,function(){ct++}),ct},toArray:function(Te){return Ve(Te,function(ct){return ct})||[]},only:function(Te){if(!Qt(Te))throw Error("React.Children.only expected to receive a single React element child.");return Te}},vi.Component=Me,vi.Fragment=I,vi.Profiler=L,vi.PureComponent=Fe,vi.StrictMode=R,vi.Suspense=re,vi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=mt,vi.__COMPILER_RUNTIME={__proto__:null,c:function(Te){return mt.H.useMemoCache(Te)}},vi.cache=function(Te){return function(){return Te.apply(null,arguments)}},vi.cloneElement=function(Te,ct,Et){if(Te==null)throw Error("The argument must be a React element, but you passed "+Te+".");var wt=he({},Te.props),Ot=Te.key,$t=void 0;if(ct!=null)for(qt in ct.ref!==void 0&&($t=void 0),ct.key!==void 0&&(Ot=""+ct.key),ct)!zt.call(ct,qt)||qt==="key"||qt==="__self"||qt==="__source"||qt==="ref"&&ct.ref===void 0||(wt[qt]=ct[qt]);var qt=arguments.length-2;if(qt===1)wt.children=Et;else if(1<qt){for(var kn=Array(qt),Ai=0;Ai<qt;Ai++)kn[Ai]=arguments[Ai+2];wt.children=kn}return yt(Te.type,Ot,void 0,void 0,$t,wt)},vi.createContext=function(Te){return Te={$$typeof:A,_currentValue:Te,_currentValue2:Te,_threadCount:0,Provider:null,Consumer:null},Te.Provider=Te,Te.Consumer={$$typeof:H,_context:Te},Te},vi.createElement=function(Te,ct,Et){var wt,Ot={},$t=null;if(ct!=null)for(wt in ct.key!==void 0&&($t=""+ct.key),ct)zt.call(ct,wt)&&wt!=="key"&&wt!=="__self"&&wt!=="__source"&&(Ot[wt]=ct[wt]);var qt=arguments.length-2;if(qt===1)Ot.children=Et;else if(1<qt){for(var kn=Array(qt),Ai=0;Ai<qt;Ai++)kn[Ai]=arguments[Ai+2];Ot.children=kn}if(Te&&Te.defaultProps)for(wt in qt=Te.defaultProps,qt)Ot[wt]===void 0&&(Ot[wt]=qt[wt]);return yt(Te,$t,void 0,void 0,null,Ot)},vi.createRef=function(){return{current:null}},vi.forwardRef=function(Te){return{$$typeof:u,render:Te}},vi.isValidElement=Qt,vi.lazy=function(Te){return{$$typeof:ce,_payload:{_status:-1,_result:Te},_init:xt}},vi.memo=function(Te,ct){return{$$typeof:Q,type:Te,compare:ct===void 0?null:ct}},vi.startTransition=function(Te){var ct=mt.T,Et={};mt.T=Et;try{var wt=Te(),Ot=mt.S;Ot!==null&&Ot(Et,wt),typeof wt=="object"&&wt!==null&&typeof wt.then=="function"&&wt.then(ui,jt)}catch($t){jt($t)}finally{mt.T=ct}},vi.unstable_useCacheRefresh=function(){return mt.H.useCacheRefresh()},vi.use=function(Te){return mt.H.use(Te)},vi.useActionState=function(Te,ct,Et){return mt.H.useActionState(Te,ct,Et)},vi.useCallback=function(Te,ct){return mt.H.useCallback(Te,ct)},vi.useContext=function(Te){return mt.H.useContext(Te)},vi.useDebugValue=function(){},vi.useDeferredValue=function(Te,ct){return mt.H.useDeferredValue(Te,ct)},vi.useEffect=function(Te,ct,Et){var wt=mt.H;if(typeof Et=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return wt.useEffect(Te,ct)},vi.useId=function(){return mt.H.useId()},vi.useImperativeHandle=function(Te,ct,Et){return mt.H.useImperativeHandle(Te,ct,Et)},vi.useInsertionEffect=function(Te,ct){return mt.H.useInsertionEffect(Te,ct)},vi.useLayoutEffect=function(Te,ct){return mt.H.useLayoutEffect(Te,ct)},vi.useMemo=function(Te,ct){return mt.H.useMemo(Te,ct)},vi.useOptimistic=function(Te,ct){return mt.H.useOptimistic(Te,ct)},vi.useReducer=function(Te,ct,Et){return mt.H.useReducer(Te,ct,Et)},vi.useRef=function(Te){return mt.H.useRef(Te)},vi.useState=function(Te){return mt.H.useState(Te)},vi.useSyncExternalStore=function(Te,ct,Et){return mt.H.useSyncExternalStore(Te,ct,Et)},vi.useTransition=function(){return mt.H.useTransition()},vi.version="19.1.0",vi}var cg;function Wm(){return cg||(cg=1,zm.exports=j_()),zm.exports}var Pe=Wm();const $n=Fg(Pe);var Rm={exports:{}},ep={},Pm={exports:{}},Im={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ug;function F_(){return ug||(ug=1,function(x){function E(Ve,xt){var jt=Ve.length;Ve.push(xt);e:for(;0<jt;){var ui=jt-1>>>1,Te=Ve[ui];if(0<L(Te,xt))Ve[ui]=xt,Ve[jt]=Te,jt=ui;else break e}}function I(Ve){return Ve.length===0?null:Ve[0]}function R(Ve){if(Ve.length===0)return null;var xt=Ve[0],jt=Ve.pop();if(jt!==xt){Ve[0]=jt;e:for(var ui=0,Te=Ve.length,ct=Te>>>1;ui<ct;){var Et=2*(ui+1)-1,wt=Ve[Et],Ot=Et+1,$t=Ve[Ot];if(0>L(wt,jt))Ot<Te&&0>L($t,wt)?(Ve[ui]=$t,Ve[Ot]=jt,ui=Ot):(Ve[ui]=wt,Ve[Et]=jt,ui=Et);else if(Ot<Te&&0>L($t,jt))Ve[ui]=$t,Ve[Ot]=jt,ui=Ot;else break e}}return xt}function L(Ve,xt){var jt=Ve.sortIndex-xt.sortIndex;return jt!==0?jt:Ve.id-xt.id}if(x.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var H=performance;x.unstable_now=function(){return H.now()}}else{var A=Date,u=A.now();x.unstable_now=function(){return A.now()-u}}var re=[],Q=[],ce=1,ze=null,_e=3,ie=!1,he=!1,je=!1,Me=!1,Oe=typeof setTimeout=="function"?setTimeout:null,Fe=typeof clearTimeout=="function"?clearTimeout:null,qe=typeof setImmediate<"u"?setImmediate:null;function dt(Ve){for(var xt=I(Q);xt!==null;){if(xt.callback===null)R(Q);else if(xt.startTime<=Ve)R(Q),xt.sortIndex=xt.expirationTime,E(re,xt);else break;xt=I(Q)}}function mt(Ve){if(je=!1,dt(Ve),!he)if(I(re)!==null)he=!0,zt||(zt=!0,Mi());else{var xt=I(Q);xt!==null&&Vi(mt,xt.startTime-Ve)}}var zt=!1,yt=-1,St=5,Qt=-1;function Bi(){return Me?!0:!(x.unstable_now()-Qt<St)}function Si(){if(Me=!1,zt){var Ve=x.unstable_now();Qt=Ve;var xt=!0;try{e:{he=!1,je&&(je=!1,Fe(yt),yt=-1),ie=!0;var jt=_e;try{t:{for(dt(Ve),ze=I(re);ze!==null&&!(ze.expirationTime>Ve&&Bi());){var ui=ze.callback;if(typeof ui=="function"){ze.callback=null,_e=ze.priorityLevel;var Te=ui(ze.expirationTime<=Ve);if(Ve=x.unstable_now(),typeof Te=="function"){ze.callback=Te,dt(Ve),xt=!0;break t}ze===I(re)&&R(re),dt(Ve)}else R(re);ze=I(re)}if(ze!==null)xt=!0;else{var ct=I(Q);ct!==null&&Vi(mt,ct.startTime-Ve),xt=!1}}break e}finally{ze=null,_e=jt,ie=!1}xt=void 0}}finally{xt?Mi():zt=!1}}}var Mi;if(typeof qe=="function")Mi=function(){qe(Si)};else if(typeof MessageChannel<"u"){var Ui=new MessageChannel,Ki=Ui.port2;Ui.port1.onmessage=Si,Mi=function(){Ki.postMessage(null)}}else Mi=function(){Oe(Si,0)};function Vi(Ve,xt){yt=Oe(function(){Ve(x.unstable_now())},xt)}x.unstable_IdlePriority=5,x.unstable_ImmediatePriority=1,x.unstable_LowPriority=4,x.unstable_NormalPriority=3,x.unstable_Profiling=null,x.unstable_UserBlockingPriority=2,x.unstable_cancelCallback=function(Ve){Ve.callback=null},x.unstable_forceFrameRate=function(Ve){0>Ve||125<Ve?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):St=0<Ve?Math.floor(1e3/Ve):5},x.unstable_getCurrentPriorityLevel=function(){return _e},x.unstable_next=function(Ve){switch(_e){case 1:case 2:case 3:var xt=3;break;default:xt=_e}var jt=_e;_e=xt;try{return Ve()}finally{_e=jt}},x.unstable_requestPaint=function(){Me=!0},x.unstable_runWithPriority=function(Ve,xt){switch(Ve){case 1:case 2:case 3:case 4:case 5:break;default:Ve=3}var jt=_e;_e=Ve;try{return xt()}finally{_e=jt}},x.unstable_scheduleCallback=function(Ve,xt,jt){var ui=x.unstable_now();switch(typeof jt=="object"&&jt!==null?(jt=jt.delay,jt=typeof jt=="number"&&0<jt?ui+jt:ui):jt=ui,Ve){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=jt+Te,Ve={id:ce++,callback:xt,priorityLevel:Ve,startTime:jt,expirationTime:Te,sortIndex:-1},jt>ui?(Ve.sortIndex=jt,E(Q,Ve),I(re)===null&&Ve===I(Q)&&(je?(Fe(yt),yt=-1):je=!0,Vi(mt,jt-ui))):(Ve.sortIndex=Te,E(re,Ve),he||ie||(he=!0,zt||(zt=!0,Mi()))),Ve},x.unstable_shouldYield=Bi,x.unstable_wrapCallback=function(Ve){var xt=_e;return function(){var jt=_e;_e=xt;try{return Ve.apply(this,arguments)}finally{_e=jt}}}}(Im)),Im}var hg;function N_(){return hg||(hg=1,Pm.exports=F_()),Pm.exports}var Dm={exports:{}},Ma={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dg;function U_(){if(dg)return Ma;dg=1;var x=Wm();function E(re){var Q="https://react.dev/errors/"+re;if(1<arguments.length){Q+="?args[]="+encodeURIComponent(arguments[1]);for(var ce=2;ce<arguments.length;ce++)Q+="&args[]="+encodeURIComponent(arguments[ce])}return"Minified React error #"+re+"; visit "+Q+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function I(){}var R={d:{f:I,r:function(){throw Error(E(522))},D:I,C:I,L:I,m:I,X:I,S:I,M:I},p:0,findDOMNode:null},L=Symbol.for("react.portal");function H(re,Q,ce){var ze=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:ze==null?null:""+ze,children:re,containerInfo:Q,implementation:ce}}var A=x.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(re,Q){if(re==="font")return"";if(typeof Q=="string")return Q==="use-credentials"?Q:""}return Ma.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ma.createPortal=function(re,Q){var ce=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q||Q.nodeType!==1&&Q.nodeType!==9&&Q.nodeType!==11)throw Error(E(299));return H(re,Q,null,ce)},Ma.flushSync=function(re){var Q=A.T,ce=R.p;try{if(A.T=null,R.p=2,re)return re()}finally{A.T=Q,R.p=ce,R.d.f()}},Ma.preconnect=function(re,Q){typeof re=="string"&&(Q?(Q=Q.crossOrigin,Q=typeof Q=="string"?Q==="use-credentials"?Q:"":void 0):Q=null,R.d.C(re,Q))},Ma.prefetchDNS=function(re){typeof re=="string"&&R.d.D(re)},Ma.preinit=function(re,Q){if(typeof re=="string"&&Q&&typeof Q.as=="string"){var ce=Q.as,ze=u(ce,Q.crossOrigin),_e=typeof Q.integrity=="string"?Q.integrity:void 0,ie=typeof Q.fetchPriority=="string"?Q.fetchPriority:void 0;ce==="style"?R.d.S(re,typeof Q.precedence=="string"?Q.precedence:void 0,{crossOrigin:ze,integrity:_e,fetchPriority:ie}):ce==="script"&&R.d.X(re,{crossOrigin:ze,integrity:_e,fetchPriority:ie,nonce:typeof Q.nonce=="string"?Q.nonce:void 0})}},Ma.preinitModule=function(re,Q){if(typeof re=="string")if(typeof Q=="object"&&Q!==null){if(Q.as==null||Q.as==="script"){var ce=u(Q.as,Q.crossOrigin);R.d.M(re,{crossOrigin:ce,integrity:typeof Q.integrity=="string"?Q.integrity:void 0,nonce:typeof Q.nonce=="string"?Q.nonce:void 0})}}else Q==null&&R.d.M(re)},Ma.preload=function(re,Q){if(typeof re=="string"&&typeof Q=="object"&&Q!==null&&typeof Q.as=="string"){var ce=Q.as,ze=u(ce,Q.crossOrigin);R.d.L(re,ce,{crossOrigin:ze,integrity:typeof Q.integrity=="string"?Q.integrity:void 0,nonce:typeof Q.nonce=="string"?Q.nonce:void 0,type:typeof Q.type=="string"?Q.type:void 0,fetchPriority:typeof Q.fetchPriority=="string"?Q.fetchPriority:void 0,referrerPolicy:typeof Q.referrerPolicy=="string"?Q.referrerPolicy:void 0,imageSrcSet:typeof Q.imageSrcSet=="string"?Q.imageSrcSet:void 0,imageSizes:typeof Q.imageSizes=="string"?Q.imageSizes:void 0,media:typeof Q.media=="string"?Q.media:void 0})}},Ma.preloadModule=function(re,Q){if(typeof re=="string")if(Q){var ce=u(Q.as,Q.crossOrigin);R.d.m(re,{as:typeof Q.as=="string"&&Q.as!=="script"?Q.as:void 0,crossOrigin:ce,integrity:typeof Q.integrity=="string"?Q.integrity:void 0})}else R.d.m(re)},Ma.requestFormReset=function(re){R.d.r(re)},Ma.unstable_batchedUpdates=function(re,Q){return re(Q)},Ma.useFormState=function(re,Q,ce){return A.H.useFormState(re,Q,ce)},Ma.useFormStatus=function(){return A.H.useHostTransitionStatus()},Ma.version="19.1.0",Ma}var fg;function V_(){if(fg)return Dm.exports;fg=1;function x(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x)}catch(E){console.error(E)}}return x(),Dm.exports=U_(),Dm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pg;function Z_(){if(pg)return ep;pg=1;var x=N_(),E=Wm(),I=V_();function R(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function L(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function H(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function A(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function u(i){if(H(i)!==i)throw Error(R(188))}function re(i){var o=i.alternate;if(!o){if(o=H(i),o===null)throw Error(R(188));return o!==i?null:i}for(var c=i,p=o;;){var b=c.return;if(b===null)break;var C=b.alternate;if(C===null){if(p=b.return,p!==null){c=p;continue}break}if(b.child===C.child){for(C=b.child;C;){if(C===c)return u(b),i;if(C===p)return u(b),o;C=C.sibling}throw Error(R(188))}if(c.return!==p.return)c=b,p=C;else{for(var V=!1,W=b.child;W;){if(W===c){V=!0,c=b,p=C;break}if(W===p){V=!0,p=b,c=C;break}W=W.sibling}if(!V){for(W=C.child;W;){if(W===c){V=!0,c=C,p=b;break}if(W===p){V=!0,p=C,c=b;break}W=W.sibling}if(!V)throw Error(R(189))}}if(c.alternate!==p)throw Error(R(190))}if(c.tag!==3)throw Error(R(188));return c.stateNode.current===c?i:o}function Q(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=Q(i),o!==null)return o;i=i.sibling}return null}var ce=Object.assign,ze=Symbol.for("react.element"),_e=Symbol.for("react.transitional.element"),ie=Symbol.for("react.portal"),he=Symbol.for("react.fragment"),je=Symbol.for("react.strict_mode"),Me=Symbol.for("react.profiler"),Oe=Symbol.for("react.provider"),Fe=Symbol.for("react.consumer"),qe=Symbol.for("react.context"),dt=Symbol.for("react.forward_ref"),mt=Symbol.for("react.suspense"),zt=Symbol.for("react.suspense_list"),yt=Symbol.for("react.memo"),St=Symbol.for("react.lazy"),Qt=Symbol.for("react.activity"),Bi=Symbol.for("react.memo_cache_sentinel"),Si=Symbol.iterator;function Mi(i){return i===null||typeof i!="object"?null:(i=Si&&i[Si]||i["@@iterator"],typeof i=="function"?i:null)}var Ui=Symbol.for("react.client.reference");function Ki(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Ui?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case he:return"Fragment";case Me:return"Profiler";case je:return"StrictMode";case mt:return"Suspense";case zt:return"SuspenseList";case Qt:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case ie:return"Portal";case qe:return(i.displayName||"Context")+".Provider";case Fe:return(i._context.displayName||"Context")+".Consumer";case dt:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case yt:return o=i.displayName||null,o!==null?o:Ki(i.type)||"Memo";case St:o=i._payload,i=i._init;try{return Ki(i(o))}catch{}}return null}var Vi=Array.isArray,Ve=E.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xt=I.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,jt={pending:!1,data:null,method:null,action:null},ui=[],Te=-1;function ct(i){return{current:i}}function Et(i){0>Te||(i.current=ui[Te],ui[Te]=null,Te--)}function wt(i,o){Te++,ui[Te]=i.current,i.current=o}var Ot=ct(null),$t=ct(null),qt=ct(null),kn=ct(null);function Ai(i,o){switch(wt(qt,o),wt($t,i),wt(Ot,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?Nh(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=Nh(o),i=Uh(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Et(Ot),wt(Ot,i)}function Ln(){Et(Ot),Et($t),Et(qt)}function vo(i){i.memoizedState!==null&&wt(kn,i);var o=Ot.current,c=Uh(o,i.type);o!==c&&(wt($t,i),wt(Ot,c))}function Vn(i){$t.current===i&&(Et(Ot),Et($t)),kn.current===i&&(Et(kn),Ct._currentValue=jt)}var Cn=Object.prototype.hasOwnProperty,Fr=x.unstable_scheduleCallback,Wi=x.unstable_cancelCallback,xo=x.unstable_shouldYield,bo=x.unstable_requestPaint,Mn=x.unstable_now,$a=x.unstable_getCurrentPriorityLevel,za=x.unstable_ImmediatePriority,Jr=x.unstable_UserBlockingPriority,lr=x.unstable_NormalPriority,pt=x.unstable_LowPriority,Mt=x.unstable_IdlePriority,hi=x.log,Ri=x.unstable_setDisableYieldValue,xn=null,un=null;function hn(i){if(typeof hi=="function"&&Ri(i),un&&typeof un.setStrictMode=="function")try{un.setStrictMode(xn,i)}catch{}}var zi=Math.clz32?Math.clz32:ea,dn=Math.log,An=Math.LN2;function ea(i){return i>>>=0,i===0?32:31-(dn(i)/An|0)|0}var ta=256,Nr=4194304;function Ce(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function $(i,o,c){var p=i.pendingLanes;if(p===0)return 0;var b=0,C=i.suspendedLanes,V=i.pingedLanes;i=i.warmLanes;var W=p&134217727;return W!==0?(p=W&~C,p!==0?b=Ce(p):(V&=W,V!==0?b=Ce(V):c||(c=W&~i,c!==0&&(b=Ce(c))))):(W=p&~C,W!==0?b=Ce(W):V!==0?b=Ce(V):c||(c=p&~i,c!==0&&(b=Ce(c)))),b===0?0:o!==0&&o!==b&&(o&C)===0&&(C=b&-b,c=o&-o,C>=c||C===32&&(c&4194048)!==0)?o:b}function K(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function Z(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ue(){var i=ta;return ta<<=1,(ta&4194048)===0&&(ta=256),i}function be(){var i=Nr;return Nr<<=1,(Nr&62914560)===0&&(Nr=4194304),i}function ve(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function Ie(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Ee(i,o,c,p,b,C){var V=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var W=i.entanglements,me=i.expirationTimes,Ne=i.hiddenUpdates;for(c=V&~c;0<c;){var et=31-zi(c),lt=1<<et;W[et]=0,me[et]=-1;var Ge=Ne[et];if(Ge!==null)for(Ne[et]=null,et=0;et<Ge.length;et++){var $e=Ge[et];$e!==null&&($e.lane&=-536870913)}c&=~lt}p!==0&&Ke(i,p,0),C!==0&&b===0&&i.tag!==0&&(i.suspendedLanes|=C&~(V&~o))}function Ke(i,o,c){i.pendingLanes|=o,i.suspendedLanes&=~o;var p=31-zi(o);i.entangledLanes|=o,i.entanglements[p]=i.entanglements[p]|1073741824|c&4194090}function He(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var p=31-zi(c),b=1<<p;b&o|i[p]&o&&(i[p]|=o),c&=~b}}function Re(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function nt(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function vt(){var i=xt.p;return i!==0?i:(i=window.event,i===void 0?32:jr(i.type))}function bt(i,o){var c=xt.p;try{return xt.p=i,o()}finally{xt.p=c}}var Ze=Math.random().toString(36).slice(2),Bt="__reactFiber$"+Ze,At="__reactProps$"+Ze,Gt="__reactContainer$"+Ze,pi="__reactEvents$"+Ze,st="__reactListeners$"+Ze,Rt="__reactHandles$"+Ze,_t="__reactResources$"+Ze,Xt="__reactMarker$"+Ze;function fn(i){delete i[Bt],delete i[At],delete i[pi],delete i[st],delete i[Rt]}function Ur(i){var o=i[Bt];if(o)return o;for(var c=i.parentNode;c;){if(o=c[Gt]||c[Bt]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=Xf(i);i!==null;){if(c=i[Bt])return c;i=Xf(i)}return o}i=c,c=i.parentNode}return null}function Ft(i){if(i=i[Bt]||i[Gt]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function zn(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(R(33))}function Pi(i){var o=i[_t];return o||(o=i[_t]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Zn(i){i[Xt]=!0}var Ts=new Set,wo={};function Xn(i,o){Fi(i,o),Fi(i+"Capture",o)}function Fi(i,o){for(wo[i]=o,i=0;i<o.length;i++)Ts.add(o[i])}var ef=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ss={},Xc={};function Ho(i){return Cn.call(Xc,i)?!0:Cn.call(Ss,i)?!1:ef.test(i)?Xc[i]=!0:(Ss[i]=!0,!1)}function To(i,o,c){if(Ho(o))if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+c)}}function $l(i,o,c){if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+c)}}function Xa(i,o,c,p){if(p===null)i.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(o,c,""+p)}}var Yc,Es;function Cs(i){if(Yc===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Yc=o&&o[1]||"",Es=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Yc+i+Es}var $u=!1;function Kc(i,o){if(!i||$u)return"";$u=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var lt=function(){throw Error()};if(Object.defineProperty(lt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(lt,[])}catch($e){var Ge=$e}Reflect.construct(i,[],lt)}else{try{lt.call()}catch($e){Ge=$e}i.call(lt.prototype)}}else{try{throw Error()}catch($e){Ge=$e}(lt=i())&&typeof lt.catch=="function"&&lt.catch(function(){})}}catch($e){if($e&&Ge&&typeof $e.stack=="string")return[$e.stack,Ge.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=p.DetermineComponentFrameRoot(),V=C[0],W=C[1];if(V&&W){var me=V.split(`
`),Ne=W.split(`
`);for(b=p=0;p<me.length&&!me[p].includes("DetermineComponentFrameRoot");)p++;for(;b<Ne.length&&!Ne[b].includes("DetermineComponentFrameRoot");)b++;if(p===me.length||b===Ne.length)for(p=me.length-1,b=Ne.length-1;1<=p&&0<=b&&me[p]!==Ne[b];)b--;for(;1<=p&&0<=b;p--,b--)if(me[p]!==Ne[b]){if(p!==1||b!==1)do if(p--,b--,0>b||me[p]!==Ne[b]){var et=`
`+me[p].replace(" at new "," at ");return i.displayName&&et.includes("<anonymous>")&&(et=et.replace("<anonymous>",i.displayName)),et}while(1<=p&&0<=b);break}}}finally{$u=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?Cs(c):""}function Xl(i){switch(i.tag){case 26:case 27:case 5:return Cs(i.type);case 16:return Cs("Lazy");case 13:return Cs("Suspense");case 19:return Cs("SuspenseList");case 0:case 15:return Kc(i.type,!1);case 11:return Kc(i.type.render,!1);case 1:return Kc(i.type,!0);case 31:return Cs("Activity");default:return""}}function Xu(i){try{var o="";do o+=Xl(i),i=i.return;while(i);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function ia(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function $o(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Yu(i){var o=$o(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),p=""+i[o];if(!i.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var b=c.get,C=c.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return b.call(this)},set:function(V){p=""+V,C.call(this,V)}}),Object.defineProperty(i,o,{enumerable:c.enumerable}),{getValue:function(){return p},setValue:function(V){p=""+V},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Yl(i){i._valueTracker||(i._valueTracker=Yu(i))}function Wc(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),p="";return i&&(p=$o(i)?i.checked?"true":"false":i.value),i=p,i!==c?(o.setValue(i),!0):!1}function Ms(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Kl=/[\n"\\]/g;function Bn(i){return i.replace(Kl,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ri(i,o,c,p,b,C,V,W){i.name="",V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?i.type=V:i.removeAttribute("type"),o!=null?V==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+ia(o)):i.value!==""+ia(o)&&(i.value=""+ia(o)):V!=="submit"&&V!=="reset"||i.removeAttribute("value"),o!=null?Ya(i,V,ia(o)):c!=null?Ya(i,V,ia(c)):p!=null&&i.removeAttribute("value"),b==null&&C!=null&&(i.defaultChecked=!!C),b!=null&&(i.checked=b&&typeof b!="function"&&typeof b!="symbol"),W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?i.name=""+ia(W):i.removeAttribute("name")}function Xo(i,o,c,p,b,C,V,W){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.type=C),o!=null||c!=null){if(!(C!=="submit"&&C!=="reset"||o!=null))return;c=c!=null?""+ia(c):"",o=o!=null?""+ia(o):c,W||o===i.value||(i.value=o),i.defaultValue=o}p=p??b,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=W?i.checked:!!p,i.defaultChecked=!!p,V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&(i.name=V)}function Ya(i,o,c){o==="number"&&Ms(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Vr(i,o,c,p){if(i=i.options,o){o={};for(var b=0;b<c.length;b++)o["$"+c[b]]=!0;for(c=0;c<i.length;c++)b=o.hasOwnProperty("$"+i[c].value),i[c].selected!==b&&(i[c].selected=b),b&&p&&(i[c].defaultSelected=!0)}else{for(c=""+ia(c),o=null,b=0;b<i.length;b++){if(i[b].value===c){i[b].selected=!0,p&&(i[b].defaultSelected=!0);return}o!==null||i[b].disabled||(o=i[b])}o!==null&&(o.selected=!0)}}function As(i,o,c){if(o!=null&&(o=""+ia(o),o!==i.value&&(i.value=o),c==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=c!=null?""+ia(c):""}function _i(i,o,c,p){if(o==null){if(p!=null){if(c!=null)throw Error(R(92));if(Vi(p)){if(1<p.length)throw Error(R(93));p=p[0]}c=p}c==null&&(c=""),o=c}c=ia(o),i.defaultValue=c,p=i.textContent,p===c&&p!==""&&p!==null&&(i.value=p)}function fr(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var Wl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zs(i,o,c){var p=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?p?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":p?i.setProperty(o,c):typeof c!="number"||c===0||Wl.has(o)?o==="float"?i.cssFloat=c:i[o]=(""+c).trim():i[o]=c+"px"}function Tr(i,o,c){if(o!=null&&typeof o!="object")throw Error(R(62));if(i=i.style,c!=null){for(var p in c)!c.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var b in o)p=o[b],o.hasOwnProperty(b)&&c[b]!==p&&zs(i,b,p)}else for(var C in o)o.hasOwnProperty(C)&&zs(i,C,o[C])}function ir(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cr(i){return Qc.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Sr=null;function Gn(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Rs=null,na=null;function rn(i){var o=Ft(i);if(o&&(i=o.stateNode)){var c=i[At]||null;e:switch(i=o.stateNode,o.type){case"input":if(ri(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Bn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var p=c[o];if(p!==i&&p.form===i.form){var b=p[At]||null;if(!b)throw Error(R(90));ri(p,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(o=0;o<c.length;o++)p=c[o],p.form===i.form&&Wc(p)}break e;case"textarea":As(i,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Vr(i,!!c.multiple,o,!1)}}}var Yo=!1;function So(i,o,c){if(Yo)return i(o,c);Yo=!0;try{var p=i(o);return p}finally{if(Yo=!1,(Rs!==null||na!==null)&&(Ph(),Rs&&(o=Rs,i=na,na=Rs=null,rn(o),i)))for(o=0;o<i.length;o++)rn(i[o])}}function Eo(i,o){var c=i.stateNode;if(c===null)return null;var p=c[At]||null;if(p===null)return null;c=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(R(231,o,typeof c));return c}var On=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zi=!1;if(On)try{var Zr={};Object.defineProperty(Zr,"passive",{get:function(){Zi=!0}}),window.addEventListener("test",Zr,Zr),window.removeEventListener("test",Zr,Zr)}catch{Zi=!1}var oi=null,ii=null,Co=null;function mi(){if(Co)return Co;var i,o=ii,c=o.length,p,b="value"in oi?oi.value:oi.textContent,C=b.length;for(i=0;i<c&&o[i]===b[i];i++);var V=c-i;for(p=1;p<=V&&o[c-p]===b[C-p];p++);return Co=b.slice(i,1<p?1-p:void 0)}function Mo(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Gr(){return!0}function pl(){return!1}function ur(i){function o(c,p,b,C,V){this._reactName=c,this._targetInst=b,this.type=p,this.nativeEvent=C,this.target=V,this.currentTarget=null;for(var W in i)i.hasOwnProperty(W)&&(c=i[W],this[W]=c?c(C):C[W]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Gr:pl,this.isPropagationStopped=pl,this}return ce(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Gr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Gr)},persist:function(){},isPersistent:Gr}),o}var Ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ko=ur(Ka),Ao=ce({},Ka,{view:0,detail:0}),Jc=ur(Ao),Wo,eu,Ra,Yn=ce({},Ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ro,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ra&&(Ra&&i.type==="mousemove"?(Wo=i.screenX-Ra.screenX,eu=i.screenY-Ra.screenY):eu=Wo=0,Ra=i),Wo)},movementY:function(i){return"movementY"in i?i.movementY:eu}}),Ql=ur(Yn),Kh=ce({},Yn,{dataTransfer:0}),Er=ur(Kh),Kn=ce({},Ao,{relatedTarget:0}),ra=ur(Kn),ml=ce({},Ka,{animationName:0,elapsedTime:0,pseudoElement:0}),Ku=ur(ml),Wh=ce({},Ka,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),zo=ur(Wh),Wu=ce({},Ka,{data:0}),Qh=ur(Wu),tu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jh(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Pa[i])?!!o[i]:!1}function Ro(){return Jh}var Qu=ce({},Ao,{key:function(i){if(i.key){var o=tu[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Mo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?iu[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ro,charCode:function(i){return i.type==="keypress"?Mo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Mo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),gl=ur(Qu),Ju=ce({},Yn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nu=ur(Ju),Wa=ce({},Ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ro}),tf=ur(Wa),_l=ce({},Ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jl=ur(_l),yl=ce({},Yn,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ed=ur(yl),ru=ce({},Ka,{newState:0,oldState:0}),td=ur(ru),vl=[9,13,27,32],eh=On&&"CompositionEvent"in window,xl=null;On&&"documentMode"in document&&(xl=document.documentMode);var nf=On&&"TextEvent"in window&&!xl,th=On&&(!eh||xl&&8<xl&&11>=xl),ec=" ",au=!1;function ou(i,o){switch(i){case"keyup":return vl.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ih(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ps=!1;function Is(i,o){switch(i){case"compositionend":return ih(o);case"keypress":return o.which!==32?null:(au=!0,ec);case"textInput":return i=o.data,i===ec&&au?null:i;default:return null}}function su(i,o){if(Ps)return i==="compositionend"||!eh&&ou(i,o)?(i=mi(),Co=ii=oi=null,Ps=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return th&&o.locale!=="ko"?null:o.data;default:return null}}var id={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bl(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!id[i.type]:o==="textarea"}function nd(i,o,c,p){Rs?na?na.push(p):na=[p]:Rs=p,o=Vd(o,"onChange"),0<o.length&&(c=new Ko("onChange","change",null,c,p),i.push({event:c,listeners:o}))}var Po=null,wl=null;function rf(i){Ca(i,0)}function tc(i){var o=zn(i);if(Wc(o))return i}function lu(i,o){if(i==="change")return o}var cu=!1;if(On){var ic;if(On){var uu="oninput"in document;if(!uu){var nc=document.createElement("div");nc.setAttribute("oninput","return;"),uu=typeof nc.oninput=="function"}ic=uu}else ic=!1;cu=ic&&(!document.documentMode||9<document.documentMode)}function Ia(){Po&&(Po.detachEvent("onpropertychange",hu),wl=Po=null)}function hu(i){if(i.propertyName==="value"&&tc(wl)){var o=[];nd(o,wl,i,Gn(i)),So(rf,o)}}function nh(i,o,c){i==="focusin"?(Ia(),Po=o,wl=c,Po.attachEvent("onpropertychange",hu)):i==="focusout"&&Ia()}function rh(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return tc(wl)}function rd(i,o){if(i==="click")return tc(o)}function Ei(i,o){if(i==="input"||i==="change")return tc(o)}function Ds(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Rr=typeof Object.is=="function"?Object.is:Ds;function rc(i,o){if(Rr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),p=Object.keys(o);if(c.length!==p.length)return!1;for(p=0;p<c.length;p++){var b=c[p];if(!Cn.call(o,b)||!Rr(i[b],o[b]))return!1}return!0}function ad(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function od(i,o){var c=ad(i);i=0;for(var p;c;){if(c.nodeType===3){if(p=i+c.textContent.length,i<=o&&p>=o)return{node:c,offset:o-i};i=p}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=ad(c)}}function sd(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?sd(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function ah(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Ms(i.document);o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=Ms(i.document)}return o}function oh(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var ld=On&&"documentMode"in document&&11>=document.documentMode,Io=null,Tl=null,Qo=null,ac=!1;function Jo(i,o,c){var p=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;ac||Io==null||Io!==Ms(p)||(p=Io,"selectionStart"in p&&oh(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Qo&&rc(Qo,p)||(Qo=p,p=Vd(Tl,"onSelect"),0<p.length&&(o=new Ko("onSelect","select",null,o,c),i.push({event:o,listeners:p}),o.target=Io)))}function fa(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var pr={animationend:fa("Animation","AnimationEnd"),animationiteration:fa("Animation","AnimationIteration"),animationstart:fa("Animation","AnimationStart"),transitionrun:fa("Transition","TransitionRun"),transitionstart:fa("Transition","TransitionStart"),transitioncancel:fa("Transition","TransitionCancel"),transitionend:fa("Transition","TransitionEnd")},du={},sh={};On&&(sh=document.createElement("div").style,"AnimationEvent"in window||(delete pr.animationend.animation,delete pr.animationiteration.animation,delete pr.animationstart.animation),"TransitionEvent"in window||delete pr.transitionend.transition);function Do(i){if(du[i])return du[i];if(!pr[i])return i;var o=pr[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in sh)return du[i]=o[c];return i}var es=Do("animationend"),oc=Do("animationiteration"),sc=Do("animationstart"),lc=Do("transitionrun"),fu=Do("transitionstart"),cd=Do("transitioncancel"),ks=Do("transitionend"),Ls=new Map,pu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pu.push("scrollEnd");function aa(i,o){Ls.set(i,o),Xn(o,[i])}var xi=new WeakMap;function Pr(i,o){if(typeof i=="object"&&i!==null){var c=xi.get(i);return c!==void 0?c:(o={value:i,source:o,stack:Xu(o)},xi.set(i,o),o)}return{value:i,source:o,stack:Xu(o)}}var qr=[],Bs=0,Os=0;function mu(){for(var i=Bs,o=Os=Bs=0;o<i;){var c=qr[o];qr[o++]=null;var p=qr[o];qr[o++]=null;var b=qr[o];qr[o++]=null;var C=qr[o];if(qr[o++]=null,p!==null&&b!==null){var V=p.pending;V===null?b.next=b:(b.next=V.next,V.next=b),p.pending=b}C!==0&&js(c,b,C)}}function cc(i,o,c,p){qr[Bs++]=i,qr[Bs++]=o,qr[Bs++]=c,qr[Bs++]=p,Os|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function gu(i,o,c,p){return cc(i,o,c,p),ts(i)}function Sl(i,o){return cc(i,null,null,o),ts(i)}function js(i,o,c){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c);for(var b=!1,C=i.return;C!==null;)C.childLanes|=c,p=C.alternate,p!==null&&(p.childLanes|=c),C.tag===22&&(i=C.stateNode,i===null||i._visibility&1||(b=!0)),i=C,C=C.return;return i.tag===3?(C=i.stateNode,b&&o!==null&&(b=31-zi(c),i=C.hiddenUpdates,p=i[b],p===null?i[b]=[o]:p.push(o),o.lane=c|536870912),C):null}function ts(i){if(50<mo)throw mo=0,Fu=null,Error(R(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var ko={};function lh(i,o,c,p){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(i,o,c,p){return new lh(i,o,c,p)}function _u(i){return i=i.prototype,!(!i||!i.isReactComponent)}function pa(i,o){var c=i.alternate;return c===null?(c=Ir(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function El(i,o){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,o=c.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Fs(i,o,c,p,b,C){var V=0;if(p=i,typeof i=="function")_u(i)&&(V=1);else if(typeof i=="string")V=J(i,c,Ot.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case Qt:return i=Ir(31,c,o,b),i.elementType=Qt,i.lanes=C,i;case he:return Ns(c.children,b,C,o);case je:V=8,b|=24;break;case Me:return i=Ir(12,c,o,b|2),i.elementType=Me,i.lanes=C,i;case mt:return i=Ir(13,c,o,b),i.elementType=mt,i.lanes=C,i;case zt:return i=Ir(19,c,o,b),i.elementType=zt,i.lanes=C,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Oe:case qe:V=10;break e;case Fe:V=9;break e;case dt:V=11;break e;case yt:V=14;break e;case St:V=16,p=null;break e}V=29,c=Error(R(130,i===null?"null":typeof i,"")),p=null}return o=Ir(V,c,o,b),o.elementType=i,o.type=p,o.lanes=C,o}function Ns(i,o,c,p){return i=Ir(7,i,p,o),i.lanes=c,i}function uc(i,o,c){return i=Ir(6,i,null,o),i.lanes=c,i}function yu(i,o,c){return o=Ir(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var is=[],Qa=0,Us=null,Vs=0,Dr=[],mr=0,ma=null,Lo=1,Ja="";function Gi(i,o){is[Qa++]=Vs,is[Qa++]=Us,Us=i,Vs=o}function ns(i,o,c){Dr[mr++]=Lo,Dr[mr++]=Ja,Dr[mr++]=ma,ma=i;var p=Lo;i=Ja;var b=32-zi(p)-1;p&=~(1<<b),c+=1;var C=32-zi(o)+b;if(30<C){var V=b-b%5;C=(p&(1<<V)-1).toString(32),p>>=V,b-=V,Lo=1<<32-zi(o)+b|c<<b|p,Ja=C+i}else Lo=1<<C|c<<b|p,Ja=i}function Hr(i){i.return!==null&&(Gi(i,1),ns(i,1,0))}function hc(i){for(;i===Us;)Us=is[--Qa],is[Qa]=null,Vs=is[--Qa],is[Qa]=null;for(;i===ma;)ma=Dr[--mr],Dr[mr]=null,Ja=Dr[--mr],Dr[mr]=null,Lo=Dr[--mr],Dr[mr]=null}var hr=null,bn=null,di=!1,Da=null,oa=!1,dc=Error(R(519));function rs(i){var o=Error(R(418,""));throw Cl(Pr(o,i)),dc}function vu(i){var o=i.stateNode,c=i.type,p=i.memoizedProps;switch(o[Bt]=i,o[At]=p,c){case"dialog":li("cancel",o),li("close",o);break;case"iframe":case"object":case"embed":li("load",o);break;case"video":case"audio":for(c=0;c<Oc.length;c++)li(Oc[c],o);break;case"source":li("error",o);break;case"img":case"image":case"link":li("error",o),li("load",o);break;case"details":li("toggle",o);break;case"input":li("invalid",o),Xo(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Yl(o);break;case"select":li("invalid",o);break;case"textarea":li("invalid",o),_i(o,p.value,p.defaultValue,p.children),Yl(o)}c=p.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||p.suppressHydrationWarning===!0||Vf(o.textContent,c)?(p.popover!=null&&(li("beforetoggle",o),li("toggle",o)),p.onScroll!=null&&li("scroll",o),p.onScrollEnd!=null&&li("scrollend",o),p.onClick!=null&&(o.onclick=Zd),o=!0):o=!1,o||rs(i)}function xu(i){for(hr=i.return;hr;)switch(hr.tag){case 5:case 13:oa=!1;return;case 27:case 3:oa=!0;return;default:hr=hr.return}}function eo(i){if(i!==hr)return!1;if(!di)return xu(i),di=!0,!1;var o=i.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Zf(i.type,i.memoizedProps)),c=!c),c&&bn&&rs(i),xu(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(R(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(o===0){bn=Za(i.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++;i=i.nextSibling}bn=null}}else o===27?(o=bn,cl(i.type)?(i=Vh,Vh=null,bn=i):bn=o):bn=hr?Za(i.stateNode.nextSibling):null;return!0}function ka(){bn=hr=null,di=!1}function ch(){var i=Da;return i!==null&&(Yr===null?Yr=i:Yr.push.apply(Yr,i),Da=null),i}function Cl(i){Da===null?Da=[i]:Da.push(i)}var bu=ct(null),as=null,to=null;function sa(i,o,c){wt(bu,o._currentValue),o._currentValue=c}function $r(i){i._currentValue=bu.current,Et(bu)}function dr(i,o,c){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===c)break;i=i.return}}function os(i,o,c,p){var b=i.child;for(b!==null&&(b.return=i);b!==null;){var C=b.dependencies;if(C!==null){var V=b.child;C=C.firstContext;e:for(;C!==null;){var W=C;C=b;for(var me=0;me<o.length;me++)if(W.context===o[me]){C.lanes|=c,W=C.alternate,W!==null&&(W.lanes|=c),dr(C.return,c,i),p||(V=null);break e}C=W.next}}else if(b.tag===18){if(V=b.return,V===null)throw Error(R(341));V.lanes|=c,C=V.alternate,C!==null&&(C.lanes|=c),dr(V,c,i),V=null}else V=b.child;if(V!==null)V.return=b;else for(V=b;V!==null;){if(V===i){V=null;break}if(b=V.sibling,b!==null){b.return=V.return,V=b;break}V=V.return}b=V}}function Cr(i,o,c,p){i=null;for(var b=o,C=!1;b!==null;){if(!C){if((b.flags&524288)!==0)C=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var V=b.alternate;if(V===null)throw Error(R(387));if(V=V.memoizedProps,V!==null){var W=b.type;Rr(b.pendingProps.value,V.value)||(i!==null?i.push(W):i=[W])}}else if(b===kn.current){if(V=b.alternate,V===null)throw Error(R(387));V.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(i!==null?i.push(Ct):i=[Ct])}b=b.return}i!==null&&os(o,i,c,p),o.flags|=262144}function la(i){for(i=i.firstContext;i!==null;){if(!Rr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ss(i){as=i,to=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ni(i){return wu(as,i)}function io(i,o){return as===null&&ss(i),wu(i,o)}function wu(i,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},to===null){if(i===null)throw Error(R(308));to=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else to=to.next=o;return c}var af=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(c,p){i.push(p)}};this.abort=function(){o.aborted=!0,i.forEach(function(c){return c()})}},uh=x.unstable_scheduleCallback,of=x.unstable_NormalPriority,wn={$$typeof:qe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zs(){return{controller:new af,data:new Map,refCount:0}}function gr(i){i.refCount--,i.refCount===0&&uh(of,function(){i.controller.abort()})}var Tt=null,Tu=0,La=0,Gs=null;function qs(i,o){if(Tt===null){var c=Tt=[];Tu=0,La=Od(),Gs={status:"pending",value:void 0,then:function(p){c.push(p)}}}return Tu++,o.then(Bo,Bo),o}function Bo(){if(--Tu===0&&Tt!==null){Gs!==null&&(Gs.status="fulfilled");var i=Tt;Tt=null,La=0,Gs=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function hh(i,o){var c=[],p={status:"pending",value:null,reason:null,then:function(b){c.push(b)}};return i.then(function(){p.status="fulfilled",p.value=o;for(var b=0;b<c.length;b++)(0,c[b])(o)},function(b){for(p.status="rejected",p.reason=b,b=0;b<c.length;b++)(0,c[b])(void 0)}),p}var si=Ve.S;Ve.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&qs(i,o),si!==null&&si(i,o)};var no=ct(null);function Su(){var i=no.current;return i!==null?i:gn.pooledCache}function ls(i,o){o===null?wt(no,no.current):wt(no,o.pool)}function dh(){var i=Su();return i===null?null:{parent:wn._currentValue,pool:i}}var fc=Error(R(460)),Eu=Error(R(474)),Ml=Error(R(542)),pc={then:function(){}};function fh(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Al(){}function ud(i,o,c){switch(c=i[c],c===void 0?i.push(o):c!==o&&(o.then(Al,Al),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Qi(i),i;default:if(typeof o.status=="string")o.then(Al,Al);else{if(i=gn,i!==null&&100<i.shellSuspendCounter)throw Error(R(482));i=o,i.status="pending",i.then(function(p){if(o.status==="pending"){var b=o;b.status="fulfilled",b.value=p}},function(p){if(o.status==="pending"){var b=o;b.status="rejected",b.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Qi(i),i}throw mc=o,fc}}var mc=null;function ro(){if(mc===null)throw Error(R(459));var i=mc;return mc=null,i}function Qi(i){if(i===fc||i===Ml)throw Error(R(483))}var ga=!1;function zl(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hs(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Oo(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ba(i,o,c){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Hi&2)!==0){var b=p.pending;return b===null?o.next=o:(o.next=b.next,b.next=o),p.pending=o,o=ts(i),js(i,null,c),o}return cc(i,p,o,c),ts(i)}function gc(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var p=o.lanes;p&=i.pendingLanes,c|=p,o.lanes=c,He(i,c)}}function _a(i,o){var c=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,c===p)){var b=null,C=null;if(c=c.firstBaseUpdate,c!==null){do{var V={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};C===null?b=C=V:C=C.next=V,c=c.next}while(c!==null);C===null?b=C=o:C=C.next=o}else b=C=o;c={baseState:p.baseState,firstBaseUpdate:b,lastBaseUpdate:C,shared:p.shared,callbacks:p.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}var $s=!1;function Dt(){if($s){var i=Gs;if(i!==null)throw i}}function Nt(i,o,c,p){$s=!1;var b=i.updateQueue;ga=!1;var C=b.firstBaseUpdate,V=b.lastBaseUpdate,W=b.shared.pending;if(W!==null){b.shared.pending=null;var me=W,Ne=me.next;me.next=null,V===null?C=Ne:V.next=Ne,V=me;var et=i.alternate;et!==null&&(et=et.updateQueue,W=et.lastBaseUpdate,W!==V&&(W===null?et.firstBaseUpdate=Ne:W.next=Ne,et.lastBaseUpdate=me))}if(C!==null){var lt=b.baseState;V=0,et=Ne=me=null,W=C;do{var Ge=W.lane&-536870913,$e=Ge!==W.lane;if($e?(wi&Ge)===Ge:(p&Ge)===Ge){Ge!==0&&Ge===La&&($s=!0),et!==null&&(et=et.next={lane:0,tag:W.tag,payload:W.payload,callback:null,next:null});e:{var ei=i,Wt=W;Ge=o;var ai=c;switch(Wt.tag){case 1:if(ei=Wt.payload,typeof ei=="function"){lt=ei.call(ai,lt,Ge);break e}lt=ei;break e;case 3:ei.flags=ei.flags&-65537|128;case 0:if(ei=Wt.payload,Ge=typeof ei=="function"?ei.call(ai,lt,Ge):ei,Ge==null)break e;lt=ce({},lt,Ge);break e;case 2:ga=!0}}Ge=W.callback,Ge!==null&&(i.flags|=64,$e&&(i.flags|=8192),$e=b.callbacks,$e===null?b.callbacks=[Ge]:$e.push(Ge))}else $e={lane:Ge,tag:W.tag,payload:W.payload,callback:W.callback,next:null},et===null?(Ne=et=$e,me=lt):et=et.next=$e,V|=Ge;if(W=W.next,W===null){if(W=b.shared.pending,W===null)break;$e=W,W=$e.next,$e.next=null,b.lastBaseUpdate=$e,b.shared.pending=null}}while(!0);et===null&&(me=lt),b.baseState=me,b.firstBaseUpdate=Ne,b.lastBaseUpdate=et,C===null&&(b.shared.lanes=0),Ol|=V,i.lanes=V,i.memoizedState=lt}}function _c(i,o){if(typeof i!="function")throw Error(R(191,i));i.call(o)}function Cu(i,o){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)_c(c[i],o)}var cs=ct(null),_r=ct(0);function ph(i,o){i=xs,wt(_r,i),wt(cs,o),xs=i|o.baseLanes}function yr(){wt(_r,xs),wt(cs,cs.current)}function mh(){xs=_r.current,Et(cs),Et(_r)}var ya=0,Vt=null,Kt=null,qn=null,us=!1,kr=!1,ao=!1,hs=0,ds=0,va=null,gh=0;function an(){throw Error(R(321))}function jo(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!Rr(i[c],o[c]))return!1;return!0}function yc(i,o,c,p,b,C){return ya=C,Vt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ve.H=i===null||i.memoizedState===null?hd:vh,ao=!1,C=c(p,b),ao=!1,kr&&(C=fs(o,c,p,b)),vc(i),C}function vc(i){Ve.H=co;var o=Kt!==null&&Kt.next!==null;if(ya=0,qn=Kt=Vt=null,us=!1,ds=0,va=null,o)throw Error(R(300));i===null||vr||(i=i.dependencies,i!==null&&la(i)&&(vr=!0))}function fs(i,o,c,p){Vt=i;var b=0;do{if(kr&&(va=null),ds=0,kr=!1,25<=b)throw Error(R(301));if(b+=1,qn=Kt=null,i.updateQueue!=null){var C=i.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}Ve.H=xh,C=o(c,p)}while(kr);return C}function _h(){var i=Ve.H,o=i.useState()[0];return o=typeof o.then=="function"?l(o):o,i=i.useState()[0],(Kt!==null?Kt.memoizedState:null)!==i&&(Vt.flags|=1024),o}function xc(){var i=hs!==0;return hs=0,i}function Xs(i,o,c){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~c}function bc(i){if(us){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}us=!1}ya=0,qn=Kt=Vt=null,kr=!1,ds=hs=0,va=null}function f(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?Vt.memoizedState=qn=i:qn=qn.next=i,qn}function e(){if(Kt===null){var i=Vt.alternate;i=i!==null?i.memoizedState:null}else i=Kt.next;var o=qn===null?Vt.memoizedState:qn.next;if(o!==null)qn=o,Kt=i;else{if(i===null)throw Vt.alternate===null?Error(R(467)):Error(R(310));Kt=i,i={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},qn===null?Vt.memoizedState=qn=i:qn=qn.next=i}return qn}function n(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function l(i){var o=ds;return ds+=1,va===null&&(va=[]),i=ud(va,i,o),o=Vt,(qn===null?o.memoizedState:qn.next)===null&&(o=o.alternate,Ve.H=o===null||o.memoizedState===null?hd:vh),i}function h(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return l(i);if(i.$$typeof===qe)return Ni(i)}throw Error(R(438,String(i)))}function m(i){var o=null,c=Vt.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var p=Vt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(b){return b.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=n(),Vt.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(i),p=0;p<i;p++)c[p]=Bi;return o.index++,c}function y(i,o){return typeof o=="function"?o(i):o}function w(i){var o=e();return S(o,Kt,i)}function S(i,o,c){var p=i.queue;if(p===null)throw Error(R(311));p.lastRenderedReducer=c;var b=i.baseQueue,C=p.pending;if(C!==null){if(b!==null){var V=b.next;b.next=C.next,C.next=V}o.baseQueue=b=C,p.pending=null}if(C=i.baseState,b===null)i.memoizedState=C;else{o=b.next;var W=V=null,me=null,Ne=o,et=!1;do{var lt=Ne.lane&-536870913;if(lt!==Ne.lane?(wi&lt)===lt:(ya&lt)===lt){var Ge=Ne.revertLane;if(Ge===0)me!==null&&(me=me.next={lane:0,revertLane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),lt===La&&(et=!0);else if((ya&Ge)===Ge){Ne=Ne.next,Ge===La&&(et=!0);continue}else lt={lane:0,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},me===null?(W=me=lt,V=C):me=me.next=lt,Vt.lanes|=Ge,Ol|=Ge;lt=Ne.action,ao&&c(C,lt),C=Ne.hasEagerState?Ne.eagerState:c(C,lt)}else Ge={lane:lt,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},me===null?(W=me=Ge,V=C):me=me.next=Ge,Vt.lanes|=lt,Ol|=lt;Ne=Ne.next}while(Ne!==null&&Ne!==o);if(me===null?V=C:me.next=W,!Rr(C,i.memoizedState)&&(vr=!0,et&&(c=Gs,c!==null)))throw c;i.memoizedState=C,i.baseState=V,i.baseQueue=me,p.lastRenderedState=C}return b===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function z(i){var o=e(),c=o.queue;if(c===null)throw Error(R(311));c.lastRenderedReducer=i;var p=c.dispatch,b=c.pending,C=o.memoizedState;if(b!==null){c.pending=null;var V=b=b.next;do C=i(C,V.action),V=V.next;while(V!==b);Rr(C,o.memoizedState)||(vr=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),c.lastRenderedState=C}return[C,p]}function k(i,o,c){var p=Vt,b=e(),C=di;if(C){if(c===void 0)throw Error(R(407));c=c()}else c=o();var V=!Rr((Kt||b).memoizedState,c);V&&(b.memoizedState=c,vr=!0),b=b.queue;var W=q.bind(null,p,b,i);if(yi(2048,8,W,[i]),b.getSnapshot!==o||V||qn!==null&&qn.memoizedState.tag&1){if(p.flags|=2048,ft(9,it(),B.bind(null,p,b,c,o),null),gn===null)throw Error(R(349));C||(ya&124)!==0||O(p,o,c)}return c}function O(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=Vt.updateQueue,o===null?(o=n(),Vt.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function B(i,o,c,p){o.value=c,o.getSnapshot=p,Y(o)&&ne(i)}function q(i,o,c){return c(function(){Y(o)&&ne(i)})}function Y(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!Rr(i,c)}catch{return!0}}function ne(i){var o=Sl(i,2);o!==null&&Kr(o,i,2)}function te(i){var o=f();if(typeof i=="function"){var c=i;if(i=c(),ao){hn(!0);try{c()}finally{hn(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:i},o}function ae(i,o,c,p){return i.baseState=c,S(i,Kt,typeof p=="function"?p:y)}function se(i,o,c,p,b){if(Di(i))throw Error(R(485));if(i=o.action,i!==null){var C={payload:b,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(V){C.listeners.push(V)}};Ve.T!==null?c(!0):C.isTransition=!1,p(C),c=o.pending,c===null?(C.next=o.pending=C,fe(o,C)):(C.next=c.next,o.pending=c.next=C)}}function fe(i,o){var c=o.action,p=o.payload,b=i.state;if(o.isTransition){var C=Ve.T,V={};Ve.T=V;try{var W=c(b,p),me=Ve.S;me!==null&&me(V,W),pe(i,o,W)}catch(Ne){we(i,o,Ne)}finally{Ve.T=C}}else try{C=c(b,p),pe(i,o,C)}catch(Ne){we(i,o,Ne)}}function pe(i,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(p){ge(i,o,p)},function(p){return we(i,o,p)}):ge(i,o,c)}function ge(i,o,c){o.status="fulfilled",o.value=c,xe(o),i.state=c,o=i.pending,o!==null&&(c=o.next,c===o?i.pending=null:(c=c.next,o.next=c,fe(i,c)))}function we(i,o,c){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=c,xe(o),o=o.next;while(o!==p)}i.action=null}function xe(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function Be(i,o){return o}function ke(i,o){if(di){var c=gn.formState;if(c!==null){e:{var p=Vt;if(di){if(bn){t:{for(var b=bn,C=oa;b.nodeType!==8;){if(!C){b=null;break t}if(b=Za(b.nextSibling),b===null){b=null;break t}}C=b.data,b=C==="F!"||C==="F"?b:null}if(b){bn=Za(b.nextSibling),p=b.data==="F!";break e}}rs(p)}p=!1}p&&(o=c[0])}}return c=f(),c.memoizedState=c.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Be,lastRenderedState:o},c.queue=p,c=Tn.bind(null,Vt,p),p.dispatch=c,p=te(!1),C=jn.bind(null,Vt,!1,p.queue),p=f(),b={state:o,dispatch:null,action:i,pending:null},p.queue=b,c=se.bind(null,Vt,b,C,c),b.dispatch=c,p.memoizedState=i,[o,c,!1]}function We(i){var o=e();return Qe(o,Kt,i)}function Qe(i,o,c){if(o=S(i,o,Be)[0],i=w(y)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=l(o)}catch(V){throw V===fc?Ml:V}else p=o;o=e();var b=o.queue,C=b.dispatch;return c!==o.memoizedState&&(Vt.flags|=2048,ft(9,it(),Ye.bind(null,b,c),null)),[p,C,i]}function Ye(i,o){i.action=o}function gt(i){var o=e(),c=Kt;if(c!==null)return Qe(o,c,i);e(),o=o.memoizedState,c=e();var p=c.queue.dispatch;return c.memoizedState=i,[o,p,!1]}function ft(i,o,c,p){return i={tag:i,create:c,deps:p,inst:o,next:null},o=Vt.updateQueue,o===null&&(o=n(),Vt.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=i.next=i:(p=c.next,c.next=i,i.next=p,o.lastEffect=i),i}function it(){return{destroy:void 0,resource:void 0}}function Pt(){return e().memoizedState}function Jt(i,o,c,p){var b=f();p=p===void 0?null:p,Vt.flags|=i,b.memoizedState=ft(1|o,it(),c,p)}function yi(i,o,c,p){var b=e();p=p===void 0?null:p;var C=b.memoizedState.inst;Kt!==null&&p!==null&&jo(p,Kt.memoizedState.deps)?b.memoizedState=ft(o,C,c,p):(Vt.flags|=i,b.memoizedState=ft(1|o,C,c,p))}function ni(i,o){Jt(8390656,8,i,o)}function Oi(i,o){yi(2048,8,i,o)}function qi(i,o){return yi(4,2,i,o)}function Ji(i,o){return yi(4,4,i,o)}function Ii(i,o){if(typeof o=="function"){i=i();var c=o(i);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function ji(i,o,c){c=c!=null?c.concat([i]):null,yi(4,4,Ii.bind(null,o,i),c)}function Rn(){}function Wn(i,o){var c=e();o=o===void 0?null:o;var p=c.memoizedState;return o!==null&&jo(o,p[1])?p[0]:(c.memoizedState=[i,o],i)}function nr(i,o){var c=e();o=o===void 0?null:o;var p=c.memoizedState;if(o!==null&&jo(o,p[1]))return p[0];if(p=i(),ao){hn(!0);try{i()}finally{hn(!1)}}return c.memoizedState=[p,o],p}function Mr(i,o,c){return c===void 0||(ya&1073741824)!==0?i.memoizedState=o:(i.memoizedState=c,i=Dc(),Vt.lanes|=i,Ol|=i,c)}function oo(i,o,c,p){return Rr(c,o)?c:cs.current!==null?(i=Mr(i,c,p),Rr(i,o)||(vr=!0),i):(ya&42)===0?(vr=!0,i.memoizedState=c):(i=Dc(),Vt.lanes|=i,Ol|=i,o)}function Oa(i,o,c,p,b){var C=xt.p;xt.p=C!==0&&8>C?C:8;var V=Ve.T,W={};Ve.T=W,jn(i,!1,o,c);try{var me=b(),Ne=Ve.S;if(Ne!==null&&Ne(W,me),me!==null&&typeof me=="object"&&typeof me.then=="function"){var et=hh(me,p);en(i,o,et,Or(i))}else en(i,o,p,Or(i))}catch(lt){en(i,o,{then:function(){},status:"rejected",reason:lt},Or())}finally{xt.p=C,Ve.T=V}}function ps(){}function so(i,o,c,p){if(i.tag!==5)throw Error(R(476));var b=ms(i).queue;Oa(i,b,o,jt,c===null?ps:function(){return ja(i),c(p)})}function ms(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:jt,baseState:jt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:jt},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:c},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function ja(i){var o=ms(i).next.queue;en(i,o,{},Or())}function Fa(){return Ni(Ct)}function Xr(){return e().memoizedState}function lo(){return e().memoizedState}function Ys(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var c=Or();i=Oo(c);var p=Ba(o,i,c);p!==null&&(Kr(p,o,c),gc(p,o,c)),o={cache:Zs()},i.payload=o;return}o=o.return}}function Ks(i,o,c){var p=Or();c={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Di(i)?Fo(o,c):(c=gu(i,o,c,p),c!==null&&(Kr(c,i,p),yh(c,o,p)))}function Tn(i,o,c){var p=Or();en(i,o,c,p)}function en(i,o,c,p){var b={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Di(i))Fo(o,b);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var V=o.lastRenderedState,W=C(V,c);if(b.hasEagerState=!0,b.eagerState=W,Rr(W,V))return cc(i,o,b,0),gn===null&&mu(),!1}catch{}finally{}if(c=gu(i,o,b,p),c!==null)return Kr(c,i,p),yh(c,o,p),!0}return!1}function jn(i,o,c,p){if(p={lane:2,revertLane:Od(),action:p,hasEagerState:!1,eagerState:null,next:null},Di(i)){if(o)throw Error(R(479))}else o=gu(i,c,p,2),o!==null&&Kr(o,i,2)}function Di(i){var o=i.alternate;return i===Vt||o!==null&&o===Vt}function Fo(i,o){kr=us=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function yh(i,o,c){if((c&4194048)!==0){var p=o.lanes;p&=i.pendingLanes,c|=p,o.lanes=c,He(i,c)}}var co={readContext:Ni,use:h,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useLayoutEffect:an,useInsertionEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useSyncExternalStore:an,useId:an,useHostTransitionStatus:an,useFormState:an,useActionState:an,useOptimistic:an,useMemoCache:an,useCacheRefresh:an},hd={readContext:Ni,use:h,useCallback:function(i,o){return f().memoizedState=[i,o===void 0?null:o],i},useContext:Ni,useEffect:ni,useImperativeHandle:function(i,o,c){c=c!=null?c.concat([i]):null,Jt(4194308,4,Ii.bind(null,o,i),c)},useLayoutEffect:function(i,o){return Jt(4194308,4,i,o)},useInsertionEffect:function(i,o){Jt(4,2,i,o)},useMemo:function(i,o){var c=f();o=o===void 0?null:o;var p=i();if(ao){hn(!0);try{i()}finally{hn(!1)}}return c.memoizedState=[p,o],p},useReducer:function(i,o,c){var p=f();if(c!==void 0){var b=c(o);if(ao){hn(!0);try{c(o)}finally{hn(!1)}}}else b=o;return p.memoizedState=p.baseState=b,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:b},p.queue=i,i=i.dispatch=Ks.bind(null,Vt,i),[p.memoizedState,i]},useRef:function(i){var o=f();return i={current:i},o.memoizedState=i},useState:function(i){i=te(i);var o=i.queue,c=Tn.bind(null,Vt,o);return o.dispatch=c,[i.memoizedState,c]},useDebugValue:Rn,useDeferredValue:function(i,o){var c=f();return Mr(c,i,o)},useTransition:function(){var i=te(!1);return i=Oa.bind(null,Vt,i.queue,!0,!1),f().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,c){var p=Vt,b=f();if(di){if(c===void 0)throw Error(R(407));c=c()}else{if(c=o(),gn===null)throw Error(R(349));(wi&124)!==0||O(p,o,c)}b.memoizedState=c;var C={value:c,getSnapshot:o};return b.queue=C,ni(q.bind(null,p,C,i),[i]),p.flags|=2048,ft(9,it(),B.bind(null,p,C,c,o),null),c},useId:function(){var i=f(),o=gn.identifierPrefix;if(di){var c=Ja,p=Lo;c=(p&~(1<<32-zi(p)-1)).toString(32)+c,o="«"+o+"R"+c,c=hs++,0<c&&(o+="H"+c.toString(32)),o+="»"}else c=gh++,o="«"+o+"r"+c.toString(32)+"»";return i.memoizedState=o},useHostTransitionStatus:Fa,useFormState:ke,useActionState:ke,useOptimistic:function(i){var o=f();o.memoizedState=o.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=jn.bind(null,Vt,!0,c),c.dispatch=o,[i,o]},useMemoCache:m,useCacheRefresh:function(){return f().memoizedState=Ys.bind(null,Vt)}},vh={readContext:Ni,use:h,useCallback:Wn,useContext:Ni,useEffect:Oi,useImperativeHandle:ji,useInsertionEffect:qi,useLayoutEffect:Ji,useMemo:nr,useReducer:w,useRef:Pt,useState:function(){return w(y)},useDebugValue:Rn,useDeferredValue:function(i,o){var c=e();return oo(c,Kt.memoizedState,i,o)},useTransition:function(){var i=w(y)[0],o=e().memoizedState;return[typeof i=="boolean"?i:l(i),o]},useSyncExternalStore:k,useId:Xr,useHostTransitionStatus:Fa,useFormState:We,useActionState:We,useOptimistic:function(i,o){var c=e();return ae(c,Kt,i,o)},useMemoCache:m,useCacheRefresh:lo},xh={readContext:Ni,use:h,useCallback:Wn,useContext:Ni,useEffect:Oi,useImperativeHandle:ji,useInsertionEffect:qi,useLayoutEffect:Ji,useMemo:nr,useReducer:z,useRef:Pt,useState:function(){return z(y)},useDebugValue:Rn,useDeferredValue:function(i,o){var c=e();return Kt===null?Mr(c,i,o):oo(c,Kt.memoizedState,i,o)},useTransition:function(){var i=z(y)[0],o=e().memoizedState;return[typeof i=="boolean"?i:l(i),o]},useSyncExternalStore:k,useId:Xr,useHostTransitionStatus:Fa,useFormState:gt,useActionState:gt,useOptimistic:function(i,o){var c=e();return Kt!==null?ae(c,Kt,i,o):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:m,useCacheRefresh:lo},ca=null,xa=0;function Na(i){var o=xa;return xa+=1,ca===null&&(ca=[]),ud(ca,i,o)}function Ws(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Rl(i,o){throw o.$$typeof===ze?Error(R(525)):(i=Object.prototype.toString.call(o),Error(R(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function wc(i){var o=i._init;return o(i._payload)}function Tc(i){function o(Ae,Se){if(i){var De=Ae.deletions;De===null?(Ae.deletions=[Se],Ae.flags|=16):De.push(Se)}}function c(Ae,Se){if(!i)return null;for(;Se!==null;)o(Ae,Se),Se=Se.sibling;return null}function p(Ae){for(var Se=new Map;Ae!==null;)Ae.key!==null?Se.set(Ae.key,Ae):Se.set(Ae.index,Ae),Ae=Ae.sibling;return Se}function b(Ae,Se){return Ae=pa(Ae,Se),Ae.index=0,Ae.sibling=null,Ae}function C(Ae,Se,De){return Ae.index=De,i?(De=Ae.alternate,De!==null?(De=De.index,De<Se?(Ae.flags|=67108866,Se):De):(Ae.flags|=67108866,Se)):(Ae.flags|=1048576,Se)}function V(Ae){return i&&Ae.alternate===null&&(Ae.flags|=67108866),Ae}function W(Ae,Se,De,rt){return Se===null||Se.tag!==6?(Se=uc(De,Ae.mode,rt),Se.return=Ae,Se):(Se=b(Se,De),Se.return=Ae,Se)}function me(Ae,Se,De,rt){var It=De.type;return It===he?et(Ae,Se,De.props.children,rt,De.key):Se!==null&&(Se.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===St&&wc(It)===Se.type)?(Se=b(Se,De.props),Ws(Se,De),Se.return=Ae,Se):(Se=Fs(De.type,De.key,De.props,null,Ae.mode,rt),Ws(Se,De),Se.return=Ae,Se)}function Ne(Ae,Se,De,rt){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==De.containerInfo||Se.stateNode.implementation!==De.implementation?(Se=yu(De,Ae.mode,rt),Se.return=Ae,Se):(Se=b(Se,De.children||[]),Se.return=Ae,Se)}function et(Ae,Se,De,rt,It){return Se===null||Se.tag!==7?(Se=Ns(De,Ae.mode,rt,It),Se.return=Ae,Se):(Se=b(Se,De),Se.return=Ae,Se)}function lt(Ae,Se,De){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return Se=uc(""+Se,Ae.mode,De),Se.return=Ae,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case _e:return De=Fs(Se.type,Se.key,Se.props,null,Ae.mode,De),Ws(De,Se),De.return=Ae,De;case ie:return Se=yu(Se,Ae.mode,De),Se.return=Ae,Se;case St:var rt=Se._init;return Se=rt(Se._payload),lt(Ae,Se,De)}if(Vi(Se)||Mi(Se))return Se=Ns(Se,Ae.mode,De,null),Se.return=Ae,Se;if(typeof Se.then=="function")return lt(Ae,Na(Se),De);if(Se.$$typeof===qe)return lt(Ae,io(Ae,Se),De);Rl(Ae,Se)}return null}function Ge(Ae,Se,De,rt){var It=Se!==null?Se.key:null;if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return It!==null?null:W(Ae,Se,""+De,rt);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case _e:return De.key===It?me(Ae,Se,De,rt):null;case ie:return De.key===It?Ne(Ae,Se,De,rt):null;case St:return It=De._init,De=It(De._payload),Ge(Ae,Se,De,rt)}if(Vi(De)||Mi(De))return It!==null?null:et(Ae,Se,De,rt,null);if(typeof De.then=="function")return Ge(Ae,Se,Na(De),rt);if(De.$$typeof===qe)return Ge(Ae,Se,io(Ae,De),rt);Rl(Ae,De)}return null}function $e(Ae,Se,De,rt,It){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return Ae=Ae.get(De)||null,W(Se,Ae,""+rt,It);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case _e:return Ae=Ae.get(rt.key===null?De:rt.key)||null,me(Se,Ae,rt,It);case ie:return Ae=Ae.get(rt.key===null?De:rt.key)||null,Ne(Se,Ae,rt,It);case St:var Ci=rt._init;return rt=Ci(rt._payload),$e(Ae,Se,De,rt,It)}if(Vi(rt)||Mi(rt))return Ae=Ae.get(De)||null,et(Se,Ae,rt,It,null);if(typeof rt.then=="function")return $e(Ae,Se,De,Na(rt),It);if(rt.$$typeof===qe)return $e(Ae,Se,De,io(Se,rt),It);Rl(Se,rt)}return null}function ei(Ae,Se,De,rt){for(var It=null,Ci=null,Ht=Se,ti=Se=0,Qr=null;Ht!==null&&ti<De.length;ti++){Ht.index>ti?(Qr=Ht,Ht=null):Qr=Ht.sibling;var $i=Ge(Ae,Ht,De[ti],rt);if($i===null){Ht===null&&(Ht=Qr);break}i&&Ht&&$i.alternate===null&&o(Ae,Ht),Se=C($i,Se,ti),Ci===null?It=$i:Ci.sibling=$i,Ci=$i,Ht=Qr}if(ti===De.length)return c(Ae,Ht),di&&Gi(Ae,ti),It;if(Ht===null){for(;ti<De.length;ti++)Ht=lt(Ae,De[ti],rt),Ht!==null&&(Se=C(Ht,Se,ti),Ci===null?It=Ht:Ci.sibling=Ht,Ci=Ht);return di&&Gi(Ae,ti),It}for(Ht=p(Ht);ti<De.length;ti++)Qr=$e(Ht,Ae,ti,De[ti],rt),Qr!==null&&(i&&Qr.alternate!==null&&Ht.delete(Qr.key===null?ti:Qr.key),Se=C(Qr,Se,ti),Ci===null?It=Qr:Ci.sibling=Qr,Ci=Qr);return i&&Ht.forEach(function(Hu){return o(Ae,Hu)}),di&&Gi(Ae,ti),It}function Wt(Ae,Se,De,rt){if(De==null)throw Error(R(151));for(var It=null,Ci=null,Ht=Se,ti=Se=0,Qr=null,$i=De.next();Ht!==null&&!$i.done;ti++,$i=De.next()){Ht.index>ti?(Qr=Ht,Ht=null):Qr=Ht.sibling;var Hu=Ge(Ae,Ht,$i.value,rt);if(Hu===null){Ht===null&&(Ht=Qr);break}i&&Ht&&Hu.alternate===null&&o(Ae,Ht),Se=C(Hu,Se,ti),Ci===null?It=Hu:Ci.sibling=Hu,Ci=Hu,Ht=Qr}if($i.done)return c(Ae,Ht),di&&Gi(Ae,ti),It;if(Ht===null){for(;!$i.done;ti++,$i=De.next())$i=lt(Ae,$i.value,rt),$i!==null&&(Se=C($i,Se,ti),Ci===null?It=$i:Ci.sibling=$i,Ci=$i);return di&&Gi(Ae,ti),It}for(Ht=p(Ht);!$i.done;ti++,$i=De.next())$i=$e(Ht,Ae,ti,$i.value,rt),$i!==null&&(i&&$i.alternate!==null&&Ht.delete($i.key===null?ti:$i.key),Se=C($i,Se,ti),Ci===null?It=$i:Ci.sibling=$i,Ci=$i);return i&&Ht.forEach(function(L_){return o(Ae,L_)}),di&&Gi(Ae,ti),It}function ai(Ae,Se,De,rt){if(typeof De=="object"&&De!==null&&De.type===he&&De.key===null&&(De=De.props.children),typeof De=="object"&&De!==null){switch(De.$$typeof){case _e:e:{for(var It=De.key;Se!==null;){if(Se.key===It){if(It=De.type,It===he){if(Se.tag===7){c(Ae,Se.sibling),rt=b(Se,De.props.children),rt.return=Ae,Ae=rt;break e}}else if(Se.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===St&&wc(It)===Se.type){c(Ae,Se.sibling),rt=b(Se,De.props),Ws(rt,De),rt.return=Ae,Ae=rt;break e}c(Ae,Se);break}else o(Ae,Se);Se=Se.sibling}De.type===he?(rt=Ns(De.props.children,Ae.mode,rt,De.key),rt.return=Ae,Ae=rt):(rt=Fs(De.type,De.key,De.props,null,Ae.mode,rt),Ws(rt,De),rt.return=Ae,Ae=rt)}return V(Ae);case ie:e:{for(It=De.key;Se!==null;){if(Se.key===It)if(Se.tag===4&&Se.stateNode.containerInfo===De.containerInfo&&Se.stateNode.implementation===De.implementation){c(Ae,Se.sibling),rt=b(Se,De.children||[]),rt.return=Ae,Ae=rt;break e}else{c(Ae,Se);break}else o(Ae,Se);Se=Se.sibling}rt=yu(De,Ae.mode,rt),rt.return=Ae,Ae=rt}return V(Ae);case St:return It=De._init,De=It(De._payload),ai(Ae,Se,De,rt)}if(Vi(De))return ei(Ae,Se,De,rt);if(Mi(De)){if(It=Mi(De),typeof It!="function")throw Error(R(150));return De=It.call(De),Wt(Ae,Se,De,rt)}if(typeof De.then=="function")return ai(Ae,Se,Na(De),rt);if(De.$$typeof===qe)return ai(Ae,Se,io(Ae,De),rt);Rl(Ae,De)}return typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint"?(De=""+De,Se!==null&&Se.tag===6?(c(Ae,Se.sibling),rt=b(Se,De),rt.return=Ae,Ae=rt):(c(Ae,Se),rt=uc(De,Ae.mode,rt),rt.return=Ae,Ae=rt),V(Ae)):c(Ae,Se)}return function(Ae,Se,De,rt){try{xa=0;var It=ai(Ae,Se,De,rt);return ca=null,It}catch(Ht){if(Ht===fc||Ht===Ml)throw Ht;var Ci=Ir(29,Ht,null,Ae.mode);return Ci.lanes=rt,Ci.return=Ae,Ci}finally{}}}var Mu=Tc(!0),sf=Tc(!1),uo=ct(null),ho=null;function Pl(i){var o=i.alternate;wt(Pn,Pn.current&1),wt(uo,i),ho===null&&(o===null||cs.current!==null||o.memoizedState!==null)&&(ho=i)}function dd(i){if(i.tag===22){if(wt(Pn,Pn.current),wt(uo,i),ho===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(ho=i)}}else Qs()}function Qs(){wt(Pn,Pn.current),wt(uo,uo.current)}function gs(i){Et(uo),ho===i&&(ho=null),Et(Pn)}var Pn=ct(0);function fd(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||$f(c)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Sc(i,o,c,p){o=i.memoizedState,c=c(p,o),c=c==null?o:ce({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Au={enqueueSetState:function(i,o,c){i=i._reactInternals;var p=Or(),b=Oo(p);b.payload=o,c!=null&&(b.callback=c),o=Ba(i,b,p),o!==null&&(Kr(o,i,p),gc(o,i,p))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var p=Or(),b=Oo(p);b.tag=1,b.payload=o,c!=null&&(b.callback=c),o=Ba(i,b,p),o!==null&&(Kr(o,i,p),gc(o,i,p))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=Or(),p=Oo(c);p.tag=2,o!=null&&(p.callback=o),o=Ba(i,p,c),o!==null&&(Kr(o,i,c),gc(o,i,c))}};function bh(i,o,c,p,b,C,V){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,C,V):o.prototype&&o.prototype.isPureReactComponent?!rc(c,p)||!rc(b,C):!0}function lf(i,o,c,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,p),o.state!==i&&Au.enqueueReplaceState(o,o.state,null)}function Il(i,o){var c=o;if("ref"in o){c={};for(var p in o)p!=="ref"&&(c[p]=o[p])}if(i=i.defaultProps){c===o&&(c=ce({},c));for(var b in i)c[b]===void 0&&(c[b]=i[b])}return c}var pd=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function pp(i){pd(i)}function cf(i){console.error(i)}function uf(i){pd(i)}function wh(i,o){try{var c=i.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function mp(i,o,c){try{var p=i.onCaughtError;p(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function Th(i,o,c){return c=Oo(c),c.tag=3,c.payload={element:null},c.callback=function(){wh(i,o)},c}function hf(i){return i=Oo(i),i.tag=3,i}function md(i,o,c,p){var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var C=p.value;i.payload=function(){return b(C)},i.callback=function(){mp(o,c,p)}}var V=c.stateNode;V!==null&&typeof V.componentDidCatch=="function"&&(i.callback=function(){mp(o,c,p),typeof b!="function"&&(jl===null?jl=new Set([this]):jl.add(this));var W=p.stack;this.componentDidCatch(p.value,{componentStack:W!==null?W:""})})}function Sh(i,o,c,p,b){if(c.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=c.alternate,o!==null&&Cr(o,c,b,!0),c=uo.current,c!==null){switch(c.tag){case 13:return ho===null?Df():c.alternate===null&&Qn===0&&(Qn=3),c.flags&=-257,c.flags|=65536,c.lanes=b,p===pc?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([p]):o.add(p),kh(i,p,b)),!1;case 22:return c.flags|=65536,p===pc?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([p]):c.add(p)),kh(i,p,b)),!1}throw Error(R(435,c.tag))}return kh(i,p,b),Df(),!1}if(di)return o=uo.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=b,p!==dc&&(i=Error(R(422),{cause:p}),Cl(Pr(i,c)))):(p!==dc&&(o=Error(R(423),{cause:p}),Cl(Pr(o,c))),i=i.current.alternate,i.flags|=65536,b&=-b,i.lanes|=b,p=Pr(p,c),b=Th(i.stateNode,p,b),_a(i,b),Qn!==4&&(Qn=2)),!1;var C=Error(R(520),{cause:p});if(C=Pr(C,c),In===null?In=[C]:In.push(C),Qn!==4&&(Qn=2),o===null)return!0;p=Pr(p,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,i=b&-b,c.lanes|=i,i=Th(c.stateNode,p,i),_a(c,i),!1;case 1:if(o=c.type,C=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(jl===null||!jl.has(C))))return c.flags|=65536,b&=-b,c.lanes|=b,b=hf(b),md(b,i,c,p),_a(c,b),!1}c=c.return}while(c!==null);return!1}var ba=Error(R(461)),vr=!1;function xr(i,o,c,p){o.child=i===null?sf(o,null,c,p):Mu(o,i.child,c,p)}function gp(i,o,c,p,b){c=c.render;var C=o.ref;if("ref"in p){var V={};for(var W in p)W!=="ref"&&(V[W]=p[W])}else V=p;return ss(o),p=yc(i,o,c,V,C,b),W=xc(),i!==null&&!vr?(Xs(i,o,b),_s(i,o,b)):(di&&W&&Hr(o),o.flags|=1,xr(i,o,p,b),o.child)}function df(i,o,c,p,b){if(i===null){var C=c.type;return typeof C=="function"&&!_u(C)&&C.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=C,_p(i,o,C,p,b)):(i=Fs(c.type,null,p,o,o.mode,b),i.ref=o.ref,i.return=o,o.child=i)}if(C=i.child,!Cc(i,b)){var V=C.memoizedProps;if(c=c.compare,c=c!==null?c:rc,c(V,p)&&i.ref===o.ref)return _s(i,o,b)}return o.flags|=1,i=pa(C,p),i.ref=o.ref,i.return=o,o.child=i}function _p(i,o,c,p,b){if(i!==null){var C=i.memoizedProps;if(rc(C,p)&&i.ref===o.ref)if(vr=!1,o.pendingProps=p=C,Cc(i,b))(i.flags&131072)!==0&&(vr=!0);else return o.lanes=i.lanes,_s(i,o,b)}return Eh(i,o,c,p,b)}function yp(i,o,c){var p=o.pendingProps,b=p.children,C=i!==null?i.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=C!==null?C.baseLanes|c:c,i!==null){for(b=o.child=i.child,C=0;b!==null;)C=C|b.lanes|b.childLanes,b=b.sibling;o.childLanes=C&~p}else o.childLanes=0,o.child=null;return vp(i,o,p,c)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&ls(o,C!==null?C.cachePool:null),C!==null?ph(o,C):yr(),dd(o);else return o.lanes=o.childLanes=536870912,vp(i,o,C!==null?C.baseLanes|c:c,c)}else C!==null?(ls(o,C.cachePool),ph(o,C),Qs(),o.memoizedState=null):(i!==null&&ls(o,null),yr(),Qs());return xr(i,o,b,c),o.child}function vp(i,o,c,p){var b=Su();return b=b===null?null:{parent:wn._currentValue,pool:b},o.memoizedState={baseLanes:c,cachePool:b},i!==null&&ls(o,null),yr(),dd(o),i!==null&&Cr(i,o,p,!0),null}function gd(i,o){var c=o.ref;if(c===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(R(284));(i===null||i.ref!==c)&&(o.flags|=4194816)}}function Eh(i,o,c,p,b){return ss(o),c=yc(i,o,c,p,void 0,b),p=xc(),i!==null&&!vr?(Xs(i,o,b),_s(i,o,b)):(di&&p&&Hr(o),o.flags|=1,xr(i,o,c,b),o.child)}function _d(i,o,c,p,b,C){return ss(o),o.updateQueue=null,c=fs(o,p,c,b),vc(i),p=xc(),i!==null&&!vr?(Xs(i,o,C),_s(i,o,C)):(di&&p&&Hr(o),o.flags|=1,xr(i,o,c,C),o.child)}function ff(i,o,c,p,b){if(ss(o),o.stateNode===null){var C=ko,V=c.contextType;typeof V=="object"&&V!==null&&(C=Ni(V)),C=new c(p,C),o.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=Au,o.stateNode=C,C._reactInternals=o,C=o.stateNode,C.props=p,C.state=o.memoizedState,C.refs={},zl(o),V=c.contextType,C.context=typeof V=="object"&&V!==null?Ni(V):ko,C.state=o.memoizedState,V=c.getDerivedStateFromProps,typeof V=="function"&&(Sc(o,c,V,p),C.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(V=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),V!==C.state&&Au.enqueueReplaceState(C,C.state,null),Nt(o,p,C,b),Dt(),C.state=o.memoizedState),typeof C.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(i===null){C=o.stateNode;var W=o.memoizedProps,me=Il(c,W);C.props=me;var Ne=C.context,et=c.contextType;V=ko,typeof et=="object"&&et!==null&&(V=Ni(et));var lt=c.getDerivedStateFromProps;et=typeof lt=="function"||typeof C.getSnapshotBeforeUpdate=="function",W=o.pendingProps!==W,et||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(W||Ne!==V)&&lf(o,C,p,V),ga=!1;var Ge=o.memoizedState;C.state=Ge,Nt(o,p,C,b),Dt(),Ne=o.memoizedState,W||Ge!==Ne||ga?(typeof lt=="function"&&(Sc(o,c,lt,p),Ne=o.memoizedState),(me=ga||bh(o,c,me,p,Ge,Ne,V))?(et||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(o.flags|=4194308)):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=Ne),C.props=p,C.state=Ne,C.context=V,p=me):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{C=o.stateNode,Hs(i,o),V=o.memoizedProps,et=Il(c,V),C.props=et,lt=o.pendingProps,Ge=C.context,Ne=c.contextType,me=ko,typeof Ne=="object"&&Ne!==null&&(me=Ni(Ne)),W=c.getDerivedStateFromProps,(Ne=typeof W=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(V!==lt||Ge!==me)&&lf(o,C,p,me),ga=!1,Ge=o.memoizedState,C.state=Ge,Nt(o,p,C,b),Dt();var $e=o.memoizedState;V!==lt||Ge!==$e||ga||i!==null&&i.dependencies!==null&&la(i.dependencies)?(typeof W=="function"&&(Sc(o,c,W,p),$e=o.memoizedState),(et=ga||bh(o,c,et,p,Ge,$e,me)||i!==null&&i.dependencies!==null&&la(i.dependencies))?(Ne||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,$e,me),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,$e,me)),typeof C.componentDidUpdate=="function"&&(o.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof C.componentDidUpdate!="function"||V===i.memoizedProps&&Ge===i.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===i.memoizedProps&&Ge===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=$e),C.props=p,C.state=$e,C.context=me,p=et):(typeof C.componentDidUpdate!="function"||V===i.memoizedProps&&Ge===i.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===i.memoizedProps&&Ge===i.memoizedState||(o.flags|=1024),p=!1)}return C=p,gd(i,o),p=(o.flags&128)!==0,C||p?(C=o.stateNode,c=p&&typeof c.getDerivedStateFromError!="function"?null:C.render(),o.flags|=1,i!==null&&p?(o.child=Mu(o,i.child,null,b),o.child=Mu(o,null,c,b)):xr(i,o,c,b),o.memoizedState=C.state,i=o.child):i=_s(i,o,b),i}function Dl(i,o,c,p){return ka(),o.flags|=256,xr(i,o,c,p),o.child}var Ec={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pf(i){return{baseLanes:i,cachePool:dh()}}function mf(i,o,c){return i=i!==null?i.childLanes&~c:0,o&&(i|=Ea),i}function xp(i,o,c){var p=o.pendingProps,b=!1,C=(o.flags&128)!==0,V;if((V=C)||(V=i!==null&&i.memoizedState===null?!1:(Pn.current&2)!==0),V&&(b=!0,o.flags&=-129),V=(o.flags&32)!==0,o.flags&=-33,i===null){if(di){if(b?Pl(o):Qs(),di){var W=bn,me;if(me=W){e:{for(me=W,W=oa;me.nodeType!==8;){if(!W){W=null;break e}if(me=Za(me.nextSibling),me===null){W=null;break e}}W=me}W!==null?(o.memoizedState={dehydrated:W,treeContext:ma!==null?{id:Lo,overflow:Ja}:null,retryLane:536870912,hydrationErrors:null},me=Ir(18,null,null,0),me.stateNode=W,me.return=o,o.child=me,hr=o,bn=null,me=!0):me=!1}me||rs(o)}if(W=o.memoizedState,W!==null&&(W=W.dehydrated,W!==null))return $f(W)?o.lanes=32:o.lanes=536870912,null;gs(o)}return W=p.children,p=p.fallback,b?(Qs(),b=o.mode,W=yd({mode:"hidden",children:W},b),p=Ns(p,b,c,null),W.return=o,p.return=o,W.sibling=p,o.child=W,b=o.child,b.memoizedState=pf(c),b.childLanes=mf(i,V,c),o.memoizedState=Ec,p):(Pl(o),gf(o,W))}if(me=i.memoizedState,me!==null&&(W=me.dehydrated,W!==null)){if(C)o.flags&256?(Pl(o),o.flags&=-257,o=_f(i,o,c)):o.memoizedState!==null?(Qs(),o.child=i.child,o.flags|=128,o=null):(Qs(),b=p.fallback,W=o.mode,p=yd({mode:"visible",children:p.children},W),b=Ns(b,W,c,null),b.flags|=2,p.return=o,b.return=o,p.sibling=b,o.child=p,Mu(o,i.child,null,c),p=o.child,p.memoizedState=pf(c),p.childLanes=mf(i,V,c),o.memoizedState=Ec,o=b);else if(Pl(o),$f(W)){if(V=W.nextSibling&&W.nextSibling.dataset,V)var Ne=V.dgst;V=Ne,p=Error(R(419)),p.stack="",p.digest=V,Cl({value:p,source:null,stack:null}),o=_f(i,o,c)}else if(vr||Cr(i,o,c,!1),V=(c&i.childLanes)!==0,vr||V){if(V=gn,V!==null&&(p=c&-c,p=(p&42)!==0?1:Re(p),p=(p&(V.suspendedLanes|c))!==0?0:p,p!==0&&p!==me.retryLane))throw me.retryLane=p,Sl(i,p),Kr(V,i,p),ba;W.data==="$?"||Df(),o=_f(i,o,c)}else W.data==="$?"?(o.flags|=192,o.child=i.child,o=null):(i=me.treeContext,bn=Za(W.nextSibling),hr=o,di=!0,Da=null,oa=!1,i!==null&&(Dr[mr++]=Lo,Dr[mr++]=Ja,Dr[mr++]=ma,Lo=i.id,Ja=i.overflow,ma=o),o=gf(o,p.children),o.flags|=4096);return o}return b?(Qs(),b=p.fallback,W=o.mode,me=i.child,Ne=me.sibling,p=pa(me,{mode:"hidden",children:p.children}),p.subtreeFlags=me.subtreeFlags&65011712,Ne!==null?b=pa(Ne,b):(b=Ns(b,W,c,null),b.flags|=2),b.return=o,p.return=o,p.sibling=b,o.child=p,p=b,b=o.child,W=i.child.memoizedState,W===null?W=pf(c):(me=W.cachePool,me!==null?(Ne=wn._currentValue,me=me.parent!==Ne?{parent:Ne,pool:Ne}:me):me=dh(),W={baseLanes:W.baseLanes|c,cachePool:me}),b.memoizedState=W,b.childLanes=mf(i,V,c),o.memoizedState=Ec,p):(Pl(o),c=i.child,i=c.sibling,c=pa(c,{mode:"visible",children:p.children}),c.return=o,c.sibling=null,i!==null&&(V=o.deletions,V===null?(o.deletions=[i],o.flags|=16):V.push(i)),o.child=c,o.memoizedState=null,c)}function gf(i,o){return o=yd({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function yd(i,o){return i=Ir(22,i,null,o),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function _f(i,o,c){return Mu(o,i.child,null,c),i=gf(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function bp(i,o,c){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),dr(i.return,o,c)}function Ch(i,o,c,p,b){var C=i.memoizedState;C===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:c,tailMode:b}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=p,C.tail=c,C.tailMode=b)}function wp(i,o,c){var p=o.pendingProps,b=p.revealOrder,C=p.tail;if(xr(i,o,p.children,c),p=Pn.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&bp(i,c,o);else if(i.tag===19)bp(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}switch(wt(Pn,p),b){case"forwards":for(c=o.child,b=null;c!==null;)i=c.alternate,i!==null&&fd(i)===null&&(b=c),c=c.sibling;c=b,c===null?(b=o.child,o.child=null):(b=c.sibling,c.sibling=null),Ch(o,!1,b,c,C);break;case"backwards":for(c=null,b=o.child,o.child=null;b!==null;){if(i=b.alternate,i!==null&&fd(i)===null){o.child=b;break}i=b.sibling,b.sibling=c,c=b,b=i}Ch(o,!0,c,null,C);break;case"together":Ch(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function _s(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),Ol|=o.lanes,(c&o.childLanes)===0)if(i!==null){if(Cr(i,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(R(153));if(o.child!==null){for(i=o.child,c=pa(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=pa(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function Cc(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&la(i)))}function xm(i,o,c){switch(o.tag){case 3:Ai(o,o.stateNode.containerInfo),sa(o,wn,i.memoizedState.cache),ka();break;case 27:case 5:vo(o);break;case 4:Ai(o,o.stateNode.containerInfo);break;case 10:sa(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(Pl(o),o.flags|=128,null):(c&o.child.childLanes)!==0?xp(i,o,c):(Pl(o),i=_s(i,o,c),i!==null?i.sibling:null);Pl(o);break;case 19:var b=(i.flags&128)!==0;if(p=(c&o.childLanes)!==0,p||(Cr(i,o,c,!1),p=(c&o.childLanes)!==0),b){if(p)return wp(i,o,c);o.flags|=128}if(b=o.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),wt(Pn,Pn.current),p)break;return null;case 22:case 23:return o.lanes=0,yp(i,o,c);case 24:sa(o,wn,i.memoizedState.cache)}return _s(i,o,c)}function Fn(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps)vr=!0;else{if(!Cc(i,c)&&(o.flags&128)===0)return vr=!1,xm(i,o,c);vr=(i.flags&131072)!==0}else vr=!1,di&&(o.flags&1048576)!==0&&ns(o,Vs,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var p=o.elementType,b=p._init;if(p=b(p._payload),o.type=p,typeof p=="function")_u(p)?(i=Il(p,i),o.tag=1,o=ff(null,o,p,i,c)):(o.tag=0,o=Eh(null,o,p,i,c));else{if(p!=null){if(b=p.$$typeof,b===dt){o.tag=11,o=gp(null,o,p,i,c);break e}else if(b===yt){o.tag=14,o=df(null,o,p,i,c);break e}}throw o=Ki(p)||p,Error(R(306,o,""))}}return o;case 0:return Eh(i,o,o.type,o.pendingProps,c);case 1:return p=o.type,b=Il(p,o.pendingProps),ff(i,o,p,b,c);case 3:e:{if(Ai(o,o.stateNode.containerInfo),i===null)throw Error(R(387));p=o.pendingProps;var C=o.memoizedState;b=C.element,Hs(i,o),Nt(o,p,null,c);var V=o.memoizedState;if(p=V.cache,sa(o,wn,p),p!==C.cache&&os(o,[wn],c,!0),Dt(),p=V.element,C.isDehydrated)if(C={element:p,isDehydrated:!1,cache:V.cache},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){o=Dl(i,o,p,c);break e}else if(p!==b){b=Pr(Error(R(424)),o),Cl(b),o=Dl(i,o,p,c);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(bn=Za(i.firstChild),hr=o,di=!0,Da=null,oa=!0,c=sf(o,null,p,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(ka(),p===b){o=_s(i,o,c);break e}xr(i,o,p,c)}o=o.child}return o;case 26:return gd(i,o),i===null?(c=v(o.type,null,o.pendingProps,null))?o.memoizedState=c:di||(c=o.type,i=o.pendingProps,p=Fc(qt.current).createElement(c),p[Bt]=o,p[At]=i,ar(p,c,i),Zn(p),o.stateNode=p):o.memoizedState=v(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return vo(o),i===null&&di&&(p=o.stateNode=Zu(o.type,o.pendingProps,qt.current),hr=o,oa=!0,b=bn,cl(o.type)?(Vh=b,bn=Za(p.firstChild)):bn=b),xr(i,o,o.pendingProps.children,c),gd(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&di&&((b=p=bn)&&(p=Xp(p,o.type,o.pendingProps,oa),p!==null?(o.stateNode=p,hr=o,bn=Za(p.firstChild),oa=!1,b=!0):b=!1),b||rs(o)),vo(o),b=o.type,C=o.pendingProps,V=i!==null?i.memoizedProps:null,p=C.children,Zf(b,C)?p=null:V!==null&&Zf(b,V)&&(o.flags|=32),o.memoizedState!==null&&(b=yc(i,o,_h,null,null,c),Ct._currentValue=b),gd(i,o),xr(i,o,p,c),o.child;case 6:return i===null&&di&&((i=c=bn)&&(c=Yp(c,o.pendingProps,oa),c!==null?(o.stateNode=c,hr=o,bn=null,i=!0):i=!1),i||rs(o)),null;case 13:return xp(i,o,c);case 4:return Ai(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=Mu(o,null,p,c):xr(i,o,p,c),o.child;case 11:return gp(i,o,o.type,o.pendingProps,c);case 7:return xr(i,o,o.pendingProps,c),o.child;case 8:return xr(i,o,o.pendingProps.children,c),o.child;case 12:return xr(i,o,o.pendingProps.children,c),o.child;case 10:return p=o.pendingProps,sa(o,o.type,p.value),xr(i,o,p.children,c),o.child;case 9:return b=o.type._context,p=o.pendingProps.children,ss(o),b=Ni(b),p=p(b),o.flags|=1,xr(i,o,p,c),o.child;case 14:return df(i,o,o.type,o.pendingProps,c);case 15:return _p(i,o,o.type,o.pendingProps,c);case 19:return wp(i,o,c);case 31:return p=o.pendingProps,c=o.mode,p={mode:p.mode,children:p.children},i===null?(c=yd(p,c),c.ref=o.ref,o.child=c,c.return=o,o=c):(c=pa(i.child,p),c.ref=o.ref,o.child=c,c.return=o,o=c),o;case 22:return yp(i,o,c);case 24:return ss(o),p=Ni(wn),i===null?(b=Su(),b===null&&(b=gn,C=Zs(),b.pooledCache=C,C.refCount++,C!==null&&(b.pooledCacheLanes|=c),b=C),o.memoizedState={parent:p,cache:b},zl(o),sa(o,wn,b)):((i.lanes&c)!==0&&(Hs(i,o),Nt(o,null,null,c),Dt()),b=i.memoizedState,C=o.memoizedState,b.parent!==p?(b={parent:p,cache:p},o.memoizedState=b,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=b),sa(o,wn,p)):(p=C.cache,sa(o,wn,p),p!==b.cache&&os(o,[wn],c,!0))),xr(i,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(R(156,o.tag))}function wa(i){i.flags|=4}function yf(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!de(o)){if(o=uo.current,o!==null&&((wi&4194048)===wi?ho!==null:(wi&62914560)!==wi&&(wi&536870912)===0||o!==ho))throw mc=pc,Eu;i.flags|=8192}}function Mc(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?be():536870912,i.lanes|=o,Pc|=o)}function kl(i,o){if(!di)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function mn(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,p=0;if(o)for(var b=i.child;b!==null;)c|=b.lanes|b.childLanes,p|=b.subtreeFlags&65011712,p|=b.flags&65011712,b.return=i,b=b.sibling;else for(b=i.child;b!==null;)c|=b.lanes|b.childLanes,p|=b.subtreeFlags,p|=b.flags,b.return=i,b=b.sibling;return i.subtreeFlags|=p,i.childLanes=c,o}function Tp(i,o,c){var p=o.pendingProps;switch(hc(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mn(o),null;case 1:return mn(o),null;case 3:return c=o.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),$r(wn),Ln(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(eo(o)?wa(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,ch())),mn(o),null;case 26:return c=o.memoizedState,i===null?(wa(o),c!==null?(mn(o),yf(o,c)):(mn(o),o.flags&=-16777217)):c?c!==i.memoizedState?(wa(o),mn(o),yf(o,c)):(mn(o),o.flags&=-16777217):(i.memoizedProps!==p&&wa(o),mn(o),o.flags&=-16777217),null;case 27:Vn(o),c=qt.current;var b=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==p&&wa(o);else{if(!p){if(o.stateNode===null)throw Error(R(166));return mn(o),null}i=Ot.current,eo(o)?vu(o):(i=Zu(b,p,c),o.stateNode=i,wa(o))}return mn(o),null;case 5:if(Vn(o),c=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==p&&wa(o);else{if(!p){if(o.stateNode===null)throw Error(R(166));return mn(o),null}if(i=Ot.current,eo(o))vu(o);else{switch(b=Fc(qt.current),i){case 1:i=b.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=b.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=b.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=b.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=b.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof p.is=="string"?b.createElement("select",{is:p.is}):b.createElement("select"),p.multiple?i.multiple=!0:p.size&&(i.size=p.size);break;default:i=typeof p.is=="string"?b.createElement(c,{is:p.is}):b.createElement(c)}}i[Bt]=o,i[At]=p;e:for(b=o.child;b!==null;){if(b.tag===5||b.tag===6)i.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===o)break e;for(;b.sibling===null;){if(b.return===null||b.return===o)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}o.stateNode=i;e:switch(ar(i,c,p),c){case"button":case"input":case"select":case"textarea":i=!!p.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&wa(o)}}return mn(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==p&&wa(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(R(166));if(i=qt.current,eo(o)){if(i=o.stateNode,c=o.memoizedProps,p=null,b=hr,b!==null)switch(b.tag){case 27:case 5:p=b.memoizedProps}i[Bt]=o,i=!!(i.nodeValue===c||p!==null&&p.suppressHydrationWarning===!0||Vf(i.nodeValue,c)),i||rs(o)}else i=Fc(i).createTextNode(p),i[Bt]=o,o.stateNode=i}return mn(o),null;case 13:if(p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(b=eo(o),p!==null&&p.dehydrated!==null){if(i===null){if(!b)throw Error(R(318));if(b=o.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(R(317));b[Bt]=o}else ka(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;mn(o),b=!1}else b=ch(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=b),b=!0;if(!b)return o.flags&256?(gs(o),o):(gs(o),null)}if(gs(o),(o.flags&128)!==0)return o.lanes=c,o;if(c=p!==null,i=i!==null&&i.memoizedState!==null,c){p=o.child,b=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(b=p.alternate.memoizedState.cachePool.pool);var C=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(C=p.memoizedState.cachePool.pool),C!==b&&(p.flags|=2048)}return c!==i&&c&&(o.child.flags|=8192),Mc(o,o.updateQueue),mn(o),null;case 4:return Ln(),i===null&&Nd(o.stateNode.containerInfo),mn(o),null;case 10:return $r(o.type),mn(o),null;case 19:if(Et(Pn),b=o.memoizedState,b===null)return mn(o),null;if(p=(o.flags&128)!==0,C=b.rendering,C===null)if(p)kl(b,!1);else{if(Qn!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(C=fd(i),C!==null){for(o.flags|=128,kl(b,!1),i=C.updateQueue,o.updateQueue=i,Mc(o,i),o.subtreeFlags=0,i=c,c=o.child;c!==null;)El(c,i),c=c.sibling;return wt(Pn,Pn.current&1|2),o.child}i=i.sibling}b.tail!==null&&Mn()>Bu&&(o.flags|=128,p=!0,kl(b,!1),o.lanes=4194304)}else{if(!p)if(i=fd(C),i!==null){if(o.flags|=128,p=!0,i=i.updateQueue,o.updateQueue=i,Mc(o,i),kl(b,!0),b.tail===null&&b.tailMode==="hidden"&&!C.alternate&&!di)return mn(o),null}else 2*Mn()-b.renderingStartTime>Bu&&c!==536870912&&(o.flags|=128,p=!0,kl(b,!1),o.lanes=4194304);b.isBackwards?(C.sibling=o.child,o.child=C):(i=b.last,i!==null?i.sibling=C:o.child=C,b.last=C)}return b.tail!==null?(o=b.tail,b.rendering=o,b.tail=o.sibling,b.renderingStartTime=Mn(),o.sibling=null,i=Pn.current,wt(Pn,p?i&1|2:i&1),o):(mn(o),null);case 22:case 23:return gs(o),mh(),p=o.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(c&536870912)!==0&&(o.flags&128)===0&&(mn(o),o.subtreeFlags&6&&(o.flags|=8192)):mn(o),c=o.updateQueue,c!==null&&Mc(o,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==c&&(o.flags|=2048),i!==null&&Et(no),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),$r(wn),mn(o),null;case 25:return null;case 30:return null}throw Error(R(156,o.tag))}function Sp(i,o){switch(hc(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return $r(wn),Ln(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Vn(o),null;case 13:if(gs(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(R(340));ka()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Et(Pn),null;case 4:return Ln(),null;case 10:return $r(o.type),null;case 22:case 23:return gs(o),mh(),i!==null&&Et(no),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return $r(wn),null;case 25:return null;default:return null}}function zu(i,o){switch(hc(o),o.tag){case 3:$r(wn),Ln();break;case 26:case 27:case 5:Vn(o);break;case 4:Ln();break;case 13:gs(o);break;case 19:Et(Pn);break;case 10:$r(o.type);break;case 22:case 23:gs(o),mh(),i!==null&&Et(no);break;case 24:$r(wn)}}function Ac(i,o){try{var c=o.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var b=p.next;c=b;do{if((c.tag&i)===i){p=void 0;var C=c.create,V=c.inst;p=C(),V.destroy=p}c=c.next}while(c!==b)}}catch(W){_n(o,o.return,W)}}function Ua(i,o,c){try{var p=o.updateQueue,b=p!==null?p.lastEffect:null;if(b!==null){var C=b.next;p=C;do{if((p.tag&i)===i){var V=p.inst,W=V.destroy;if(W!==void 0){V.destroy=void 0,b=o;var me=c,Ne=W;try{Ne()}catch(et){_n(b,me,et)}}}p=p.next}while(p!==C)}}catch(et){_n(o,o.return,et)}}function Mh(i){var o=i.updateQueue;if(o!==null){var c=i.stateNode;try{Cu(o,c)}catch(p){_n(i,i.return,p)}}}function zc(i,o,c){c.props=Il(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(p){_n(i,o,p)}}function Js(i,o){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof c=="function"?i.refCleanup=c(p):c.current=p}}catch(b){_n(i,o,b)}}function ys(i,o){var c=i.ref,p=i.refCleanup;if(c!==null)if(typeof p=="function")try{p()}catch(b){_n(i,o,b)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(b){_n(i,o,b)}else c.current=null}function vf(i){var o=i.type,c=i.memoizedProps,p=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&p.focus();break e;case"img":c.src?p.src=c.src:c.srcSet&&(p.srcset=c.srcSet)}}catch(b){_n(i,i.return,b)}}function el(i,o,c){try{var p=i.stateNode;Hp(p,i.type,c,o),p[At]=o}catch(b){_n(i,i.return,b)}}function Ep(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&cl(i.type)||i.tag===4}function vd(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Ep(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&cl(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Rc(i,o,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(i),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Zd));else if(p!==4&&(p===27&&cl(i.type)&&(c=i.stateNode,o=null),i=i.child,i!==null))for(Rc(i,o,c),i=i.sibling;i!==null;)Rc(i,o,c),i=i.sibling}function Ru(i,o,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(p!==4&&(p===27&&cl(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(Ru(i,o,c),i=i.sibling;i!==null;)Ru(i,o,c),i=i.sibling}function xf(i){var o=i.stateNode,c=i.memoizedProps;try{for(var p=i.type,b=o.attributes;b.length;)o.removeAttributeNode(b[0]);ar(o,p,c),o[Bt]=i,o[At]=c}catch(C){_n(i,i.return,C)}}var vs=!1,rr=!1,bf=!1,Cp=typeof WeakSet=="function"?WeakSet:Set,Ar=null;function bm(i,o){if(i=i.containerInfo,Vu=Wr,i=ah(i),oh(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var p=c.getSelection&&c.getSelection();if(p&&p.rangeCount!==0){c=p.anchorNode;var b=p.anchorOffset,C=p.focusNode;p=p.focusOffset;try{c.nodeType,C.nodeType}catch{c=null;break e}var V=0,W=-1,me=-1,Ne=0,et=0,lt=i,Ge=null;t:for(;;){for(var $e;lt!==c||b!==0&&lt.nodeType!==3||(W=V+b),lt!==C||p!==0&&lt.nodeType!==3||(me=V+p),lt.nodeType===3&&(V+=lt.nodeValue.length),($e=lt.firstChild)!==null;)Ge=lt,lt=$e;for(;;){if(lt===i)break t;if(Ge===c&&++Ne===b&&(W=V),Ge===C&&++et===p&&(me=V),($e=lt.nextSibling)!==null)break;lt=Ge,Ge=lt.parentNode}lt=$e}c=W===-1||me===-1?null:{start:W,end:me}}else c=null}c=c||{start:0,end:0}}else c=null;for(qd={focusedElem:i,selectionRange:c},Wr=!1,Ar=o;Ar!==null;)if(o=Ar,i=o.child,(o.subtreeFlags&1024)!==0&&i!==null)i.return=o,Ar=i;else for(;Ar!==null;){switch(o=Ar,C=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&C!==null){i=void 0,c=o,b=C.memoizedProps,C=C.memoizedState,p=c.stateNode;try{var ei=Il(c.type,b,c.elementType===c.type);i=p.getSnapshotBeforeUpdate(ei,C),p.__reactInternalSnapshotBeforeUpdate=i}catch(Wt){_n(c,c.return,Wt)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,c=i.nodeType,c===9)Hf(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Hf(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(R(163))}if(i=o.sibling,i!==null){i.return=o.return,Ar=i;break}Ar=o.return}}function xd(i,o,c){var p=c.flags;switch(c.tag){case 0:case 11:case 15:po(i,c),p&4&&Ac(5,c);break;case 1:if(po(i,c),p&4)if(i=c.stateNode,o===null)try{i.componentDidMount()}catch(V){_n(c,c.return,V)}else{var b=Il(c.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(b,o,i.__reactInternalSnapshotBeforeUpdate)}catch(V){_n(c,c.return,V)}}p&64&&Mh(c),p&512&&Js(c,c.return);break;case 3:if(po(i,c),p&64&&(i=c.updateQueue,i!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{Cu(i,o)}catch(V){_n(c,c.return,V)}}break;case 27:o===null&&p&4&&xf(c);case 26:case 5:po(i,c),o===null&&p&4&&vf(c),p&512&&Js(c,c.return);break;case 12:po(i,c);break;case 13:po(i,c),p&4&&Sf(i,c),p&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=Bp.bind(null,c),Kp(i,c))));break;case 22:if(p=c.memoizedState!==null||vs,!p){o=o!==null&&o.memoizedState!==null||rr,b=vs;var C=rr;vs=p,(rr=o)&&!C?Ll(i,c,(c.subtreeFlags&8772)!==0):po(i,c),vs=b,rr=C}break;case 30:break;default:po(i,c)}}function wf(i){var o=i.alternate;o!==null&&(i.alternate=null,wf(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&fn(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Sn=null,ua=!1;function No(i,o,c){for(c=c.child;c!==null;)Tf(i,o,c),c=c.sibling}function Tf(i,o,c){if(un&&typeof un.onCommitFiberUnmount=="function")try{un.onCommitFiberUnmount(xn,c)}catch{}switch(c.tag){case 26:rr||ys(c,o),No(i,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:rr||ys(c,o);var p=Sn,b=ua;cl(c.type)&&(Sn=c.stateNode,ua=!1),No(i,o,c),Uc(c.stateNode),Sn=p,ua=b;break;case 5:rr||ys(c,o);case 6:if(p=Sn,b=ua,Sn=null,No(i,o,c),Sn=p,ua=b,Sn!==null)if(ua)try{(Sn.nodeType===9?Sn.body:Sn.nodeName==="HTML"?Sn.ownerDocument.body:Sn).removeChild(c.stateNode)}catch(C){_n(c,o,C)}else try{Sn.removeChild(c.stateNode)}catch(C){_n(c,o,C)}break;case 18:Sn!==null&&(ua?(i=Sn,Hd(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),qu(i)):Hd(Sn,c.stateNode));break;case 4:p=Sn,b=ua,Sn=c.stateNode.containerInfo,ua=!0,No(i,o,c),Sn=p,ua=b;break;case 0:case 11:case 14:case 15:rr||Ua(2,c,o),rr||Ua(4,c,o),No(i,o,c);break;case 1:rr||(ys(c,o),p=c.stateNode,typeof p.componentWillUnmount=="function"&&zc(c,o,p)),No(i,o,c);break;case 21:No(i,o,c);break;case 22:rr=(p=rr)||c.memoizedState!==null,No(i,o,c),rr=p;break;default:No(i,o,c)}}function Sf(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{qu(i)}catch(c){_n(o,o.return,c)}}function bd(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new Cp),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new Cp),o;default:throw Error(R(435,i.tag))}}function wd(i,o){var c=bd(i);o.forEach(function(p){var b=Op.bind(null,i,p);c.has(p)||(c.add(p),p.then(b,b))})}function Ta(i,o){var c=o.deletions;if(c!==null)for(var p=0;p<c.length;p++){var b=c[p],C=i,V=o,W=V;e:for(;W!==null;){switch(W.tag){case 27:if(cl(W.type)){Sn=W.stateNode,ua=!1;break e}break;case 5:Sn=W.stateNode,ua=!1;break e;case 3:case 4:Sn=W.stateNode.containerInfo,ua=!0;break e}W=W.return}if(Sn===null)throw Error(R(160));Tf(C,V,b),Sn=null,ua=!1,C=b.alternate,C!==null&&(C.return=null),b.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Pu(o,i),o=o.sibling}var fo=null;function Pu(i,o){var c=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Ta(o,i),Va(i),p&4&&(Ua(3,i,i.return),Ac(3,i),Ua(5,i,i.return));break;case 1:Ta(o,i),Va(i),p&512&&(rr||c===null||ys(c,c.return)),p&64&&vs&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?p:c.concat(p))));break;case 26:var b=fo;if(Ta(o,i),Va(i),p&512&&(rr||c===null||ys(c,c.return)),p&4){var C=c!==null?c.memoizedState:null;if(p=i.memoizedState,c===null)if(p===null)if(i.stateNode===null){e:{p=i.type,c=i.memoizedProps,b=b.ownerDocument||b;t:switch(p){case"title":C=b.getElementsByTagName("title")[0],(!C||C[Xt]||C[Bt]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=b.createElement(p),b.head.insertBefore(C,b.querySelector("head > title"))),ar(C,p,c),C[Bt]=i,Zn(C),p=C;break e;case"link":var V=le("link","href",b).get(p+(c.href||""));if(V){for(var W=0;W<V.length;W++)if(C=V[W],C.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&C.getAttribute("rel")===(c.rel==null?null:c.rel)&&C.getAttribute("title")===(c.title==null?null:c.title)&&C.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){V.splice(W,1);break t}}C=b.createElement(p),ar(C,p,c),b.head.appendChild(C);break;case"meta":if(V=le("meta","content",b).get(p+(c.content||""))){for(W=0;W<V.length;W++)if(C=V[W],C.getAttribute("content")===(c.content==null?null:""+c.content)&&C.getAttribute("name")===(c.name==null?null:c.name)&&C.getAttribute("property")===(c.property==null?null:c.property)&&C.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&C.getAttribute("charset")===(c.charSet==null?null:c.charSet)){V.splice(W,1);break t}}C=b.createElement(p),ar(C,p,c),b.head.appendChild(C);break;default:throw Error(R(468,p))}C[Bt]=i,Zn(C),p=C}i.stateNode=p}else N(b,i.type,i.stateNode);else i.stateNode=G(b,p,i.memoizedProps);else C!==p?(C===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):C.count--,p===null?N(b,i.type,i.stateNode):G(b,p,i.memoizedProps)):p===null&&i.stateNode!==null&&el(i,i.memoizedProps,c.memoizedProps)}break;case 27:Ta(o,i),Va(i),p&512&&(rr||c===null||ys(c,c.return)),c!==null&&p&4&&el(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Ta(o,i),Va(i),p&512&&(rr||c===null||ys(c,c.return)),i.flags&32){b=i.stateNode;try{fr(b,"")}catch($e){_n(i,i.return,$e)}}p&4&&i.stateNode!=null&&(b=i.memoizedProps,el(i,b,c!==null?c.memoizedProps:b)),p&1024&&(bf=!0);break;case 6:if(Ta(o,i),Va(i),p&4){if(i.stateNode===null)throw Error(R(162));p=i.memoizedProps,c=i.stateNode;try{c.nodeValue=p}catch($e){_n(i,i.return,$e)}}break;case 3:if(ye=null,b=fo,fo=Vc(o.containerInfo),Ta(o,i),fo=b,Va(i),p&4&&c!==null&&c.memoizedState.isDehydrated)try{qu(o.containerInfo)}catch($e){_n(i,i.return,$e)}bf&&(bf=!1,Td(i));break;case 4:p=fo,fo=Vc(i.stateNode.containerInfo),Ta(o,i),Va(i),fo=p;break;case 12:Ta(o,i),Va(i);break;case 13:Ta(o,i),Va(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Md=Mn()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,wd(i,p)));break;case 22:b=i.memoizedState!==null;var me=c!==null&&c.memoizedState!==null,Ne=vs,et=rr;if(vs=Ne||b,rr=et||me,Ta(o,i),rr=et,vs=Ne,Va(i),p&8192)e:for(o=i.stateNode,o._visibility=b?o._visibility&-2:o._visibility|1,b&&(c===null||me||vs||rr||tl(i)),c=null,o=i;;){if(o.tag===5||o.tag===26){if(c===null){me=c=o;try{if(C=me.stateNode,b)V=C.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none";else{W=me.stateNode;var lt=me.memoizedProps.style,Ge=lt!=null&&lt.hasOwnProperty("display")?lt.display:null;W.style.display=Ge==null||typeof Ge=="boolean"?"":(""+Ge).trim()}}catch($e){_n(me,me.return,$e)}}}else if(o.tag===6){if(c===null){me=o;try{me.stateNode.nodeValue=b?"":me.memoizedProps}catch($e){_n(me,me.return,$e)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=i.updateQueue,p!==null&&(c=p.retryQueue,c!==null&&(p.retryQueue=null,wd(i,c))));break;case 19:Ta(o,i),Va(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,wd(i,p)));break;case 30:break;case 21:break;default:Ta(o,i),Va(i)}}function Va(i){var o=i.flags;if(o&2){try{for(var c,p=i.return;p!==null;){if(Ep(p)){c=p;break}p=p.return}if(c==null)throw Error(R(160));switch(c.tag){case 27:var b=c.stateNode,C=vd(i);Ru(i,C,b);break;case 5:var V=c.stateNode;c.flags&32&&(fr(V,""),c.flags&=-33);var W=vd(i);Ru(i,W,V);break;case 3:case 4:var me=c.stateNode.containerInfo,Ne=vd(i);Rc(i,Ne,me);break;default:throw Error(R(161))}}catch(et){_n(i,i.return,et)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function Td(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;Td(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function po(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)xd(i,o.alternate,o),o=o.sibling}function tl(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:Ua(4,o,o.return),tl(o);break;case 1:ys(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&zc(o,o.return,c),tl(o);break;case 27:Uc(o.stateNode);case 26:case 5:ys(o,o.return),tl(o);break;case 22:o.memoizedState===null&&tl(o);break;case 30:tl(o);break;default:tl(o)}i=i.sibling}}function Ll(i,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,b=i,C=o,V=C.flags;switch(C.tag){case 0:case 11:case 15:Ll(b,C,c),Ac(4,C);break;case 1:if(Ll(b,C,c),p=C,b=p.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Ne){_n(p,p.return,Ne)}if(p=C,b=p.updateQueue,b!==null){var W=p.stateNode;try{var me=b.shared.hiddenCallbacks;if(me!==null)for(b.shared.hiddenCallbacks=null,b=0;b<me.length;b++)_c(me[b],W)}catch(Ne){_n(p,p.return,Ne)}}c&&V&64&&Mh(C),Js(C,C.return);break;case 27:xf(C);case 26:case 5:Ll(b,C,c),c&&p===null&&V&4&&vf(C),Js(C,C.return);break;case 12:Ll(b,C,c);break;case 13:Ll(b,C,c),c&&V&4&&Sf(b,C);break;case 22:C.memoizedState===null&&Ll(b,C,c),Js(C,C.return);break;case 30:break;default:Ll(b,C,c)}o=o.sibling}}function Ef(i,o){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&gr(c))}function Sd(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&gr(i))}function Uo(i,o,c,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Mp(i,o,c,p),o=o.sibling}function Mp(i,o,c,p){var b=o.flags;switch(o.tag){case 0:case 11:case 15:Uo(i,o,c,p),b&2048&&Ac(9,o);break;case 1:Uo(i,o,c,p);break;case 3:Uo(i,o,c,p),b&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&gr(i)));break;case 12:if(b&2048){Uo(i,o,c,p),i=o.stateNode;try{var C=o.memoizedProps,V=C.id,W=C.onPostCommit;typeof W=="function"&&W(V,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(me){_n(o,o.return,me)}}else Uo(i,o,c,p);break;case 13:Uo(i,o,c,p);break;case 23:break;case 22:C=o.stateNode,V=o.alternate,o.memoizedState!==null?C._visibility&2?Uo(i,o,c,p):il(i,o):C._visibility&2?Uo(i,o,c,p):(C._visibility|=2,Iu(i,o,c,p,(o.subtreeFlags&10256)!==0)),b&2048&&Ef(V,o);break;case 24:Uo(i,o,c,p),b&2048&&Sd(o.alternate,o);break;default:Uo(i,o,c,p)}}function Iu(i,o,c,p,b){for(b=b&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var C=i,V=o,W=c,me=p,Ne=V.flags;switch(V.tag){case 0:case 11:case 15:Iu(C,V,W,me,b),Ac(8,V);break;case 23:break;case 22:var et=V.stateNode;V.memoizedState!==null?et._visibility&2?Iu(C,V,W,me,b):il(C,V):(et._visibility|=2,Iu(C,V,W,me,b)),b&&Ne&2048&&Ef(V.alternate,V);break;case 24:Iu(C,V,W,me,b),b&&Ne&2048&&Sd(V.alternate,V);break;default:Iu(C,V,W,me,b)}o=o.sibling}}function il(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=i,p=o,b=p.flags;switch(p.tag){case 22:il(c,p),b&2048&&Ef(p.alternate,p);break;case 24:il(c,p),b&2048&&Sd(p.alternate,p);break;default:il(c,p)}o=o.sibling}}var Du=8192;function ku(i){if(i.subtreeFlags&Du)for(i=i.child;i!==null;)Ap(i),i=i.sibling}function Ap(i){switch(i.tag){case 26:ku(i),i.flags&Du&&i.memoizedState!==null&&Ue(fo,i.memoizedState,i.memoizedProps);break;case 5:ku(i);break;case 3:case 4:var o=fo;fo=Vc(i.stateNode.containerInfo),ku(i),fo=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=Du,Du=16777216,ku(i),Du=o):ku(i));break;default:ku(i)}}function zp(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Ah(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var p=o[c];Ar=p,Cf(p,i)}zp(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Rp(i),i=i.sibling}function Rp(i){switch(i.tag){case 0:case 11:case 15:Ah(i),i.flags&2048&&Ua(9,i,i.return);break;case 3:Ah(i);break;case 12:Ah(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Ed(i)):Ah(i);break;default:Ah(i)}}function Ed(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var p=o[c];Ar=p,Cf(p,i)}zp(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:Ua(8,o,o.return),Ed(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,Ed(o));break;default:Ed(o)}i=i.sibling}}function Cf(i,o){for(;Ar!==null;){var c=Ar;switch(c.tag){case 0:case 11:case 15:Ua(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var p=c.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:gr(c.memoizedState.cache)}if(p=c.child,p!==null)p.return=c,Ar=p;else e:for(c=i;Ar!==null;){p=Ar;var b=p.sibling,C=p.return;if(wf(p),p===c){Ar=null;break e}if(b!==null){b.return=C,Ar=b;break e}Ar=C}}}var Mf={getCacheForType:function(i){var o=Ni(wn),c=o.data.get(i);return c===void 0&&(c=i(),o.data.set(i,c)),c}},Pp=typeof WeakMap=="function"?WeakMap:Map,Hi=0,gn=null,bi=null,wi=0,tn=0,Sa=null,Bl=!1,Lu=!1,Af=!1,xs=0,Qn=0,Ol=0,Vo=0,Cd=0,Ea=0,Pc=0,In=null,Yr=null,zf=!1,Md=0,Bu=1/0,Ou=null,jl=null,Lr=0,Fl=null,ju=null,Ic=0,Br=0,zh=null,Rf=null,mo=0,Fu=null;function Or(){if((Hi&2)!==0&&wi!==0)return wi&-wi;if(Ve.T!==null){var i=La;return i!==0?i:Od()}return vt()}function Dc(){Ea===0&&(Ea=(wi&536870912)===0||di?ue():536870912);var i=uo.current;return i!==null&&(i.flags|=32),Ea}function Kr(i,o,c){(i===gn&&(tn===2||tn===9)||i.cancelPendingCommit!==null)&&(kc(i,0),nl(i,wi,Ea,!1)),Ie(i,c),((Hi&2)===0||i!==gn)&&(i===gn&&((Hi&2)===0&&(Vo|=c),Qn===4&&nl(i,wi,Ea,!1)),bs(i))}function Rh(i,o,c){if((Hi&6)!==0)throw Error(R(327));var p=!c&&(o&124)===0&&(o&i.expiredLanes)===0||K(i,o),b=p?Sm(i,o):Rd(i,o,!0),C=p;do{if(b===0){Lu&&!p&&nl(i,o,0,!1);break}else{if(c=i.current.alternate,C&&!wm(c)){b=Rd(i,o,!1),C=!1;continue}if(b===2){if(C=o,i.errorRecoveryDisabledLanes&C)var V=0;else V=i.pendingLanes&-536870913,V=V!==0?V:V&536870912?536870912:0;if(V!==0){o=V;e:{var W=i;b=In;var me=W.current.memoizedState.isDehydrated;if(me&&(kc(W,V).flags|=256),V=Rd(W,V,!1),V!==2){if(Af&&!me){W.errorRecoveryDisabledLanes|=C,Vo|=C,b=4;break e}C=Yr,Yr=b,C!==null&&(Yr===null?Yr=C:Yr.push.apply(Yr,C))}b=V}if(C=!1,b!==2)continue}}if(b===1){kc(i,0),nl(i,o,0,!0);break}e:{switch(p=i,C=b,C){case 0:case 1:throw Error(R(345));case 4:if((o&4194048)!==o)break;case 6:nl(p,o,Ea,!Bl);break e;case 2:Yr=null;break;case 3:case 5:break;default:throw Error(R(329))}if((o&62914560)===o&&(b=Md+300-Mn(),10<b)){if(nl(p,o,Ea,!Bl),$(p,0,!0)!==0)break e;p.timeoutHandle=Nc(Ip.bind(null,p,c,Yr,Ou,zf,o,Ea,Vo,Pc,Bl,C,2,-0,0),b);break e}Ip(p,c,Yr,Ou,zf,o,Ea,Vo,Pc,Bl,C,0,-0,0)}}break}while(!0);bs(i)}function Ip(i,o,c,p,b,C,V,W,me,Ne,et,lt,Ge,$e){if(i.timeoutHandle=-1,lt=o.subtreeFlags,(lt&8192||(lt&16785408)===16785408)&&(Le={stylesheets:null,count:0,unsuspend:ot},Ap(o),lt=Xe(),lt!==null)){i.cancelPendingCommit=lt(Zo.bind(null,i,o,C,c,p,b,V,W,me,et,1,Ge,$e)),nl(i,C,V,!Ne);return}Zo(i,o,C,c,p,b,V,W,me)}function wm(i){for(var o=i;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var p=0;p<c.length;p++){var b=c[p],C=b.getSnapshot;b=b.value;try{if(!Rr(C(),b))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function nl(i,o,c,p){o&=~Cd,o&=~Vo,i.suspendedLanes|=o,i.pingedLanes&=~o,p&&(i.warmLanes|=o),p=i.expirationTimes;for(var b=o;0<b;){var C=31-zi(b),V=1<<C;p[C]=-1,b&=~V}c!==0&&Ke(i,c,o)}function Ph(){return(Hi&6)===0?(Bh(0),!1):!0}function Pf(){if(bi!==null){if(tn===0)var i=bi.return;else i=bi,to=as=null,bc(i),ca=null,xa=0,i=bi;for(;i!==null;)zu(i.alternate,i),i=i.return;bi=null}}function kc(i,o){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,zr(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),Pf(),gn=i,bi=c=pa(i.current,null),wi=o,tn=0,Sa=null,Bl=!1,Lu=K(i,o),Af=!1,Pc=Ea=Cd=Vo=Ol=Qn=0,Yr=In=null,zf=!1,(o&8)!==0&&(o|=o&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=o;0<p;){var b=31-zi(p),C=1<<b;o|=i[b],p&=~C}return xs=o,mu(),c}function If(i,o){Vt=null,Ve.H=co,o===fc||o===Ml?(o=ro(),tn=3):o===Eu?(o=ro(),tn=4):tn=o===ba?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Sa=o,bi===null&&(Qn=1,wh(i,Pr(o,i.current)))}function Ad(){var i=Ve.H;return Ve.H=co,i===null?co:i}function zd(){var i=Ve.A;return Ve.A=Mf,i}function Df(){Qn=4,Bl||(wi&4194048)!==wi&&uo.current!==null||(Lu=!0),(Ol&134217727)===0&&(Vo&134217727)===0||gn===null||nl(gn,wi,Ea,!1)}function Rd(i,o,c){var p=Hi;Hi|=2;var b=Ad(),C=zd();(gn!==i||wi!==o)&&(Ou=null,kc(i,o)),o=!1;var V=Qn;e:do try{if(tn!==0&&bi!==null){var W=bi,me=Sa;switch(tn){case 8:Pf(),V=6;break e;case 3:case 2:case 9:case 6:uo.current===null&&(o=!0);var Ne=tn;if(tn=0,Sa=null,Lc(i,W,me,Ne),c&&Lu){V=0;break e}break;default:Ne=tn,tn=0,Sa=null,Lc(i,W,me,Ne)}}Tm(),V=Qn;break}catch(et){If(i,et)}while(!0);return o&&i.shellSuspendCounter++,to=as=null,Hi=p,Ve.H=b,Ve.A=C,bi===null&&(gn=null,wi=0,mu()),V}function Tm(){for(;bi!==null;)Dp(bi)}function Sm(i,o){var c=Hi;Hi|=2;var p=Ad(),b=zd();gn!==i||wi!==o?(Ou=null,Bu=Mn()+500,kc(i,o)):Lu=K(i,o);e:do try{if(tn!==0&&bi!==null){o=bi;var C=Sa;t:switch(tn){case 1:tn=0,Sa=null,Lc(i,o,C,1);break;case 2:case 9:if(fh(C)){tn=0,Sa=null,kp(o);break}o=function(){tn!==2&&tn!==9||gn!==i||(tn=7),bs(i)},C.then(o,o);break e;case 3:tn=7;break e;case 4:tn=5;break e;case 7:fh(C)?(tn=0,Sa=null,kp(o)):(tn=0,Sa=null,Lc(i,o,C,7));break;case 5:var V=null;switch(bi.tag){case 26:V=bi.memoizedState;case 5:case 27:var W=bi;if(!V||de(V)){tn=0,Sa=null;var me=W.sibling;if(me!==null)bi=me;else{var Ne=W.return;Ne!==null?(bi=Ne,Ih(Ne)):bi=null}break t}}tn=0,Sa=null,Lc(i,o,C,5);break;case 6:tn=0,Sa=null,Lc(i,o,C,6);break;case 8:Pf(),Qn=6;break e;default:throw Error(R(462))}}Em();break}catch(et){If(i,et)}while(!0);return to=as=null,Ve.H=p,Ve.A=b,Hi=c,bi!==null?0:(gn=null,wi=0,mu(),Qn)}function Em(){for(;bi!==null&&!xo();)Dp(bi)}function Dp(i){var o=Fn(i.alternate,i,xs);i.memoizedProps=i.pendingProps,o===null?Ih(i):bi=o}function kp(i){var o=i,c=o.alternate;switch(o.tag){case 15:case 0:o=_d(c,o,o.pendingProps,o.type,void 0,wi);break;case 11:o=_d(c,o,o.pendingProps,o.type.render,o.ref,wi);break;case 5:bc(o);default:zu(c,o),o=bi=El(o,xs),o=Fn(c,o,xs)}i.memoizedProps=i.pendingProps,o===null?Ih(i):bi=o}function Lc(i,o,c,p){to=as=null,bc(o),ca=null,xa=0;var b=o.return;try{if(Sh(i,b,o,c,wi)){Qn=1,wh(i,Pr(c,i.current)),bi=null;return}}catch(C){if(b!==null)throw bi=b,C;Qn=1,wh(i,Pr(c,i.current)),bi=null;return}o.flags&32768?(di||p===1?i=!0:Lu||(wi&536870912)!==0?i=!1:(Bl=i=!0,(p===2||p===9||p===3||p===6)&&(p=uo.current,p!==null&&p.tag===13&&(p.flags|=16384))),Nu(o,i)):Ih(o)}function Ih(i){var o=i;do{if((o.flags&32768)!==0){Nu(o,Bl);return}i=o.return;var c=Tp(o.alternate,o,xs);if(c!==null){bi=c;return}if(o=o.sibling,o!==null){bi=o;return}bi=o=i}while(o!==null);Qn===0&&(Qn=5)}function Nu(i,o){do{var c=Sp(i.alternate,i);if(c!==null){c.flags&=32767,bi=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(i=i.sibling,i!==null)){bi=i;return}bi=i=c}while(i!==null);Qn=6,bi=null}function Zo(i,o,c,p,b,C,V,W,me){i.cancelPendingCommit=null;do Id();while(Lr!==0);if((Hi&6)!==0)throw Error(R(327));if(o!==null){if(o===i.current)throw Error(R(177));if(C=o.lanes|o.childLanes,C|=Os,Ee(i,c,C,V,W,me),i===gn&&(bi=gn=null,wi=0),ju=o,Fl=i,Ic=c,Br=C,zh=b,Rf=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Bf(lr,function(){return Dh(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=Ve.T,Ve.T=null,b=xt.p,xt.p=2,V=Hi,Hi|=4;try{bm(i,o,c)}finally{Hi=V,xt.p=b,Ve.T=p}}Lr=1,rl(),kf(),Pd()}}function rl(){if(Lr===1){Lr=0;var i=Fl,o=ju,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=Ve.T,Ve.T=null;var p=xt.p;xt.p=2;var b=Hi;Hi|=4;try{Pu(o,i);var C=qd,V=ah(i.containerInfo),W=C.focusedElem,me=C.selectionRange;if(V!==W&&W&&W.ownerDocument&&sd(W.ownerDocument.documentElement,W)){if(me!==null&&oh(W)){var Ne=me.start,et=me.end;if(et===void 0&&(et=Ne),"selectionStart"in W)W.selectionStart=Ne,W.selectionEnd=Math.min(et,W.value.length);else{var lt=W.ownerDocument||document,Ge=lt&&lt.defaultView||window;if(Ge.getSelection){var $e=Ge.getSelection(),ei=W.textContent.length,Wt=Math.min(me.start,ei),ai=me.end===void 0?Wt:Math.min(me.end,ei);!$e.extend&&Wt>ai&&(V=ai,ai=Wt,Wt=V);var Ae=od(W,Wt),Se=od(W,ai);if(Ae&&Se&&($e.rangeCount!==1||$e.anchorNode!==Ae.node||$e.anchorOffset!==Ae.offset||$e.focusNode!==Se.node||$e.focusOffset!==Se.offset)){var De=lt.createRange();De.setStart(Ae.node,Ae.offset),$e.removeAllRanges(),Wt>ai?($e.addRange(De),$e.extend(Se.node,Se.offset)):(De.setEnd(Se.node,Se.offset),$e.addRange(De))}}}}for(lt=[],$e=W;$e=$e.parentNode;)$e.nodeType===1&&lt.push({element:$e,left:$e.scrollLeft,top:$e.scrollTop});for(typeof W.focus=="function"&&W.focus(),W=0;W<lt.length;W++){var rt=lt[W];rt.element.scrollLeft=rt.left,rt.element.scrollTop=rt.top}}Wr=!!Vu,qd=Vu=null}finally{Hi=b,xt.p=p,Ve.T=c}}i.current=o,Lr=2}}function kf(){if(Lr===2){Lr=0;var i=Fl,o=ju,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=Ve.T,Ve.T=null;var p=xt.p;xt.p=2;var b=Hi;Hi|=4;try{xd(i,o.alternate,o)}finally{Hi=b,xt.p=p,Ve.T=c}}Lr=3}}function Pd(){if(Lr===4||Lr===3){Lr=0,bo();var i=Fl,o=ju,c=Ic,p=Rf;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Lr=5:(Lr=0,ju=Fl=null,Lp(i,i.pendingLanes));var b=i.pendingLanes;if(b===0&&(jl=null),nt(c),o=o.stateNode,un&&typeof un.onCommitFiberRoot=="function")try{un.onCommitFiberRoot(xn,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=Ve.T,b=xt.p,xt.p=2,Ve.T=null;try{for(var C=i.onRecoverableError,V=0;V<p.length;V++){var W=p[V];C(W.value,{componentStack:W.stack})}}finally{Ve.T=o,xt.p=b}}(Ic&3)!==0&&Id(),bs(i),b=i.pendingLanes,(c&4194090)!==0&&(b&42)!==0?i===Fu?mo++:(mo=0,Fu=i):mo=0,Bh(0)}}function Lp(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,gr(o)))}function Id(i){return rl(),kf(),Pd(),Dh()}function Dh(){if(Lr!==5)return!1;var i=Fl,o=Br;Br=0;var c=nt(Ic),p=Ve.T,b=xt.p;try{xt.p=32>c?32:c,Ve.T=null,c=zh,zh=null;var C=Fl,V=Ic;if(Lr=0,ju=Fl=null,Ic=0,(Hi&6)!==0)throw Error(R(331));var W=Hi;if(Hi|=4,Rp(C.current),Mp(C,C.current,V,c),Hi=W,Bh(0,!1),un&&typeof un.onPostCommitFiberRoot=="function")try{un.onPostCommitFiberRoot(xn,C)}catch{}return!0}finally{xt.p=b,Ve.T=p,Lp(i,o)}}function Dd(i,o,c){o=Pr(c,o),o=Th(i.stateNode,o,2),i=Ba(i,o,2),i!==null&&(Ie(i,2),bs(i))}function _n(i,o,c){if(i.tag===3)Dd(i,i,c);else for(;o!==null;){if(o.tag===3){Dd(o,i,c);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(jl===null||!jl.has(p))){i=Pr(c,i),c=hf(2),p=Ba(o,c,2),p!==null&&(md(c,p,o,i),Ie(p,2),bs(p));break}}o=o.return}}function kh(i,o,c){var p=i.pingCache;if(p===null){p=i.pingCache=new Pp;var b=new Set;p.set(o,b)}else b=p.get(o),b===void 0&&(b=new Set,p.set(o,b));b.has(c)||(Af=!0,b.add(c),i=Lf.bind(null,i,o,c),o.then(i,i))}function Lf(i,o,c){var p=i.pingCache;p!==null&&p.delete(o),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,gn===i&&(wi&c)===c&&(Qn===4||Qn===3&&(wi&62914560)===wi&&300>Mn()-Md?(Hi&2)===0&&kc(i,0):Cd|=c,Pc===wi&&(Pc=0)),bs(i)}function Bc(i,o){o===0&&(o=be()),i=Sl(i,o),i!==null&&(Ie(i,o),bs(i))}function Bp(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),Bc(i,c)}function Op(i,o){var c=0;switch(i.tag){case 13:var p=i.stateNode,b=i.memoizedState;b!==null&&(c=b.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(R(314))}p!==null&&p.delete(o),Bc(i,c)}function Bf(i,o){return Fr(i,o)}var Lh=null,al=null,kd=!1,Ld=!1,Of=!1,Nl=0;function bs(i){i!==al&&i.next===null&&(al===null?Lh=al=i:al=al.next=i),Ld=!0,kd||(kd=!0,Np())}function Bh(i,o){if(!Of&&Ld){Of=!0;do for(var c=!1,p=Lh;p!==null;){if(i!==0){var b=p.pendingLanes;if(b===0)var C=0;else{var V=p.suspendedLanes,W=p.pingedLanes;C=(1<<31-zi(42|i)+1)-1,C&=b&~(V&~W),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(c=!0,ol(p,C))}else C=wi,C=$(p,p===gn?C:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(C&3)===0||K(p,C)||(c=!0,ol(p,C));p=p.next}while(c);Of=!1}}function Cm(){jp()}function jp(){Ld=kd=!1;var i=0;Nl!==0&&(Mm()&&(i=Nl),Nl=0);for(var o=Mn(),c=null,p=Lh;p!==null;){var b=p.next,C=Fp(p,o);C===0?(p.next=null,c===null?Lh=b:c.next=b,b===null&&(al=c)):(c=p,(i!==0||(C&3)!==0)&&(Ld=!0)),p=b}Bh(i)}function Fp(i,o){for(var c=i.suspendedLanes,p=i.pingedLanes,b=i.expirationTimes,C=i.pendingLanes&-62914561;0<C;){var V=31-zi(C),W=1<<V,me=b[V];me===-1?((W&c)===0||(W&p)!==0)&&(b[V]=Z(W,o)):me<=o&&(i.expiredLanes|=W),C&=~W}if(o=gn,c=wi,c=$(i,i===o?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,c===0||i===o&&(tn===2||tn===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Wi(p),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||K(i,c)){if(o=c&-c,o===i.callbackPriority)return o;switch(p!==null&&Wi(p),nt(c)){case 2:case 8:c=Jr;break;case 32:c=lr;break;case 268435456:c=Mt;break;default:c=lr}return p=Bd.bind(null,i),c=Fr(c,p),i.callbackPriority=o,i.callbackNode=c,o}return p!==null&&p!==null&&Wi(p),i.callbackPriority=2,i.callbackNode=null,2}function Bd(i,o){if(Lr!==0&&Lr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Id()&&i.callbackNode!==c)return null;var p=wi;return p=$(i,i===gn?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(Rh(i,p,o),Fp(i,Mn()),i.callbackNode!=null&&i.callbackNode===c?Bd.bind(null,i):null)}function ol(i,o){if(Id())return null;Rh(i,o,!0)}function Np(){qf(function(){(Hi&6)!==0?Fr(za,Cm):jp()})}function Od(){return Nl===0&&(Nl=ue()),Nl}function jf(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:cr(""+i)}function Ff(i,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,i.id&&c.setAttribute("form",i.id),o.parentNode.insertBefore(c,o),i=new FormData(i),c.parentNode.removeChild(c),i}function Up(i,o,c,p,b){if(o==="submit"&&c&&c.stateNode===b){var C=jf((b[At]||null).action),V=p.submitter;V&&(o=(o=V[At]||null)?jf(o.formAction):V.getAttribute("formAction"),o!==null&&(C=o,V=null));var W=new Ko("action","action",null,p,b);i.push({event:W,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Nl!==0){var me=V?Ff(b,V):new FormData(b);so(c,{pending:!0,data:me,method:b.method,action:C},null,me)}}else typeof C=="function"&&(W.preventDefault(),me=V?Ff(b,V):new FormData(b),so(c,{pending:!0,data:me,method:b.method,action:C},C,me))},currentTarget:b}]})}}for(var Oh=0;Oh<pu.length;Oh++){var jd=pu[Oh],jh=jd.toLowerCase(),Vp=jd[0].toUpperCase()+jd.slice(1);aa(jh,"on"+Vp)}aa(es,"onAnimationEnd"),aa(oc,"onAnimationIteration"),aa(sc,"onAnimationStart"),aa("dblclick","onDoubleClick"),aa("focusin","onFocus"),aa("focusout","onBlur"),aa(lc,"onTransitionRun"),aa(fu,"onTransitionStart"),aa(cd,"onTransitionCancel"),aa(ks,"onTransitionEnd"),Fi("onMouseEnter",["mouseout","mouseover"]),Fi("onMouseLeave",["mouseout","mouseover"]),Fi("onPointerEnter",["pointerout","pointerover"]),Fi("onPointerLeave",["pointerout","pointerover"]),Xn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oc));function Ca(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var p=i[c],b=p.event;p=p.listeners;e:{var C=void 0;if(o)for(var V=p.length-1;0<=V;V--){var W=p[V],me=W.instance,Ne=W.currentTarget;if(W=W.listener,me!==C&&b.isPropagationStopped())break e;C=W,b.currentTarget=Ne;try{C(b)}catch(et){pd(et)}b.currentTarget=null,C=me}else for(V=0;V<p.length;V++){if(W=p[V],me=W.instance,Ne=W.currentTarget,W=W.listener,me!==C&&b.isPropagationStopped())break e;C=W,b.currentTarget=Ne;try{C(b)}catch(et){pd(et)}b.currentTarget=null,C=me}}}}function li(i,o){var c=o[pi];c===void 0&&(c=o[pi]=new Set);var p=i+"__bubble";c.has(p)||(Nf(o,i,2,!1),c.add(p))}function Fd(i,o,c){var p=0;o&&(p|=4),Nf(c,i,p,o)}var Fh="_reactListening"+Math.random().toString(36).slice(2);function Nd(i){if(!i[Fh]){i[Fh]=!0,Ts.forEach(function(c){c!=="selectionchange"&&(Zp.has(c)||Fd(c,!1,i),Fd(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Fh]||(o[Fh]=!0,Fd("selectionchange",!1,o))}}function Nf(i,o,c,p){switch(jr(o)){case 2:var b=ha;break;case 8:b=wr;break;default:b=sn}c=b.bind(null,o,c,i),b=void 0,!Zi||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(b=!0),p?b!==void 0?i.addEventListener(o,c,{capture:!0,passive:b}):i.addEventListener(o,c,!0):b!==void 0?i.addEventListener(o,c,{passive:b}):i.addEventListener(o,c,!1)}function Ud(i,o,c,p,b){var C=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var V=p.tag;if(V===3||V===4){var W=p.stateNode.containerInfo;if(W===b)break;if(V===4)for(V=p.return;V!==null;){var me=V.tag;if((me===3||me===4)&&V.stateNode.containerInfo===b)return;V=V.return}for(;W!==null;){if(V=Ur(W),V===null)return;if(me=V.tag,me===5||me===6||me===26||me===27){p=C=V;continue e}W=W.parentNode}}p=p.return}So(function(){var Ne=C,et=Gn(c),lt=[];e:{var Ge=Ls.get(i);if(Ge!==void 0){var $e=Ko,ei=i;switch(i){case"keypress":if(Mo(c)===0)break e;case"keydown":case"keyup":$e=gl;break;case"focusin":ei="focus",$e=ra;break;case"focusout":ei="blur",$e=ra;break;case"beforeblur":case"afterblur":$e=ra;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=Ql;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=Er;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=tf;break;case es:case oc:case sc:$e=Ku;break;case ks:$e=Jl;break;case"scroll":case"scrollend":$e=Jc;break;case"wheel":$e=ed;break;case"copy":case"cut":case"paste":$e=zo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=nu;break;case"toggle":case"beforetoggle":$e=td}var Wt=(o&4)!==0,ai=!Wt&&(i==="scroll"||i==="scrollend"),Ae=Wt?Ge!==null?Ge+"Capture":null:Ge;Wt=[];for(var Se=Ne,De;Se!==null;){var rt=Se;if(De=rt.stateNode,rt=rt.tag,rt!==5&&rt!==26&&rt!==27||De===null||Ae===null||(rt=Eo(Se,Ae),rt!=null&&Wt.push(Uu(Se,rt,De))),ai)break;Se=Se.return}0<Wt.length&&(Ge=new $e(Ge,ei,null,c,et),lt.push({event:Ge,listeners:Wt}))}}if((o&7)===0){e:{if(Ge=i==="mouseover"||i==="pointerover",$e=i==="mouseout"||i==="pointerout",Ge&&c!==Sr&&(ei=c.relatedTarget||c.fromElement)&&(Ur(ei)||ei[Gt]))break e;if(($e||Ge)&&(Ge=et.window===et?et:(Ge=et.ownerDocument)?Ge.defaultView||Ge.parentWindow:window,$e?(ei=c.relatedTarget||c.toElement,$e=Ne,ei=ei?Ur(ei):null,ei!==null&&(ai=H(ei),Wt=ei.tag,ei!==ai||Wt!==5&&Wt!==27&&Wt!==6)&&(ei=null)):($e=null,ei=Ne),$e!==ei)){if(Wt=Ql,rt="onMouseLeave",Ae="onMouseEnter",Se="mouse",(i==="pointerout"||i==="pointerover")&&(Wt=nu,rt="onPointerLeave",Ae="onPointerEnter",Se="pointer"),ai=$e==null?Ge:zn($e),De=ei==null?Ge:zn(ei),Ge=new Wt(rt,Se+"leave",$e,c,et),Ge.target=ai,Ge.relatedTarget=De,rt=null,Ur(et)===Ne&&(Wt=new Wt(Ae,Se+"enter",ei,c,et),Wt.target=De,Wt.relatedTarget=ai,rt=Wt),ai=rt,$e&&ei)t:{for(Wt=$e,Ae=ei,Se=0,De=Wt;De;De=jc(De))Se++;for(De=0,rt=Ae;rt;rt=jc(rt))De++;for(;0<Se-De;)Wt=jc(Wt),Se--;for(;0<De-Se;)Ae=jc(Ae),De--;for(;Se--;){if(Wt===Ae||Ae!==null&&Wt===Ae.alternate)break t;Wt=jc(Wt),Ae=jc(Ae)}Wt=null}else Wt=null;$e!==null&&sl(lt,Ge,$e,Wt,!1),ei!==null&&ai!==null&&sl(lt,ai,ei,Wt,!0)}}e:{if(Ge=Ne?zn(Ne):window,$e=Ge.nodeName&&Ge.nodeName.toLowerCase(),$e==="select"||$e==="input"&&Ge.type==="file")var It=lu;else if(bl(Ge))if(cu)It=Ei;else{It=rh;var Ci=nh}else $e=Ge.nodeName,!$e||$e.toLowerCase()!=="input"||Ge.type!=="checkbox"&&Ge.type!=="radio"?Ne&&ir(Ne.elementType)&&(It=lu):It=rd;if(It&&(It=It(i,Ne))){nd(lt,It,c,et);break e}Ci&&Ci(i,Ge,Ne),i==="focusout"&&Ne&&Ge.type==="number"&&Ne.memoizedProps.value!=null&&Ya(Ge,"number",Ge.value)}switch(Ci=Ne?zn(Ne):window,i){case"focusin":(bl(Ci)||Ci.contentEditable==="true")&&(Io=Ci,Tl=Ne,Qo=null);break;case"focusout":Qo=Tl=Io=null;break;case"mousedown":ac=!0;break;case"contextmenu":case"mouseup":case"dragend":ac=!1,Jo(lt,c,et);break;case"selectionchange":if(ld)break;case"keydown":case"keyup":Jo(lt,c,et)}var Ht;if(eh)e:{switch(i){case"compositionstart":var ti="onCompositionStart";break e;case"compositionend":ti="onCompositionEnd";break e;case"compositionupdate":ti="onCompositionUpdate";break e}ti=void 0}else Ps?ou(i,c)&&(ti="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(ti="onCompositionStart");ti&&(th&&c.locale!=="ko"&&(Ps||ti!=="onCompositionStart"?ti==="onCompositionEnd"&&Ps&&(Ht=mi()):(oi=et,ii="value"in oi?oi.value:oi.textContent,Ps=!0)),Ci=Vd(Ne,ti),0<Ci.length&&(ti=new Qh(ti,i,null,c,et),lt.push({event:ti,listeners:Ci}),Ht?ti.data=Ht:(Ht=ih(c),Ht!==null&&(ti.data=Ht)))),(Ht=nf?Is(i,c):su(i,c))&&(ti=Vd(Ne,"onBeforeInput"),0<ti.length&&(Ci=new Qh("onBeforeInput","beforeinput",null,c,et),lt.push({event:Ci,listeners:ti}),Ci.data=Ht)),Up(lt,i,Ne,c,et)}Ca(lt,o)})}function Uu(i,o,c){return{instance:i,listener:o,currentTarget:c}}function Vd(i,o){for(var c=o+"Capture",p=[];i!==null;){var b=i,C=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||C===null||(b=Eo(i,c),b!=null&&p.unshift(Uu(i,b,C)),b=Eo(i,o),b!=null&&p.push(Uu(i,b,C))),i.tag===3)return p;i=i.return}return[]}function jc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function sl(i,o,c,p,b){for(var C=o._reactName,V=[];c!==null&&c!==p;){var W=c,me=W.alternate,Ne=W.stateNode;if(W=W.tag,me!==null&&me===p)break;W!==5&&W!==26&&W!==27||Ne===null||(me=Ne,b?(Ne=Eo(c,C),Ne!=null&&V.unshift(Uu(c,Ne,me))):b||(Ne=Eo(c,C),Ne!=null&&V.push(Uu(c,Ne,me)))),c=c.return}V.length!==0&&i.push({event:o,listeners:V})}var Gp=/\r\n?/g,qp=/\u0000|\uFFFD/g;function Uf(i){return(typeof i=="string"?i:""+i).replace(Gp,`
`).replace(qp,"")}function Vf(i,o){return o=Uf(o),Uf(i)===o}function Zd(){}function on(i,o,c,p,b,C){switch(c){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||fr(i,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&fr(i,""+p);break;case"className":$l(i,"class",p);break;case"tabIndex":$l(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":$l(i,c,p);break;case"style":Tr(i,p,C);break;case"data":if(o!=="object"){$l(i,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||c!=="href")){i.removeAttribute(c);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=cr(""+p),i.setAttribute(c,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(c==="formAction"?(o!=="input"&&on(i,o,"name",b.name,b,null),on(i,o,"formEncType",b.formEncType,b,null),on(i,o,"formMethod",b.formMethod,b,null),on(i,o,"formTarget",b.formTarget,b,null)):(on(i,o,"encType",b.encType,b,null),on(i,o,"method",b.method,b,null),on(i,o,"target",b.target,b,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=cr(""+p),i.setAttribute(c,p);break;case"onClick":p!=null&&(i.onclick=Zd);break;case"onScroll":p!=null&&li("scroll",i);break;case"onScrollEnd":p!=null&&li("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(R(61));if(c=p.__html,c!=null){if(b.children!=null)throw Error(R(60));i.innerHTML=c}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}c=cr(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""+p):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":p===!0?i.setAttribute(c,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,p):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(c,p):i.removeAttribute(c);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(c):i.setAttribute(c,p);break;case"popover":li("beforetoggle",i),li("toggle",i),To(i,"popover",p);break;case"xlinkActuate":Xa(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Xa(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Xa(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Xa(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Xa(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Xa(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Xa(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Xa(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Xa(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":To(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=pn.get(c)||c,To(i,c,p))}}function Gd(i,o,c,p,b,C){switch(c){case"style":Tr(i,p,C);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(R(61));if(c=p.__html,c!=null){if(b.children!=null)throw Error(R(60));i.innerHTML=c}}break;case"children":typeof p=="string"?fr(i,p):(typeof p=="number"||typeof p=="bigint")&&fr(i,""+p);break;case"onScroll":p!=null&&li("scroll",i);break;case"onScrollEnd":p!=null&&li("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Zd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!wo.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(b=c.endsWith("Capture"),o=c.slice(2,b?c.length-7:void 0),C=i[At]||null,C=C!=null?C[c]:null,typeof C=="function"&&i.removeEventListener(o,C,b),typeof p=="function")){typeof C!="function"&&C!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(o,p,b);break e}c in i?i[c]=p:p===!0?i.setAttribute(c,""):To(i,c,p)}}}function ar(i,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":li("error",i),li("load",i);var p=!1,b=!1,C;for(C in c)if(c.hasOwnProperty(C)){var V=c[C];if(V!=null)switch(C){case"src":p=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(R(137,o));default:on(i,o,C,V,c,null)}}b&&on(i,o,"srcSet",c.srcSet,c,null),p&&on(i,o,"src",c.src,c,null);return;case"input":li("invalid",i);var W=C=V=b=null,me=null,Ne=null;for(p in c)if(c.hasOwnProperty(p)){var et=c[p];if(et!=null)switch(p){case"name":b=et;break;case"type":V=et;break;case"checked":me=et;break;case"defaultChecked":Ne=et;break;case"value":C=et;break;case"defaultValue":W=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(R(137,o));break;default:on(i,o,p,et,c,null)}}Xo(i,C,W,me,Ne,V,b,!1),Yl(i);return;case"select":li("invalid",i),p=V=C=null;for(b in c)if(c.hasOwnProperty(b)&&(W=c[b],W!=null))switch(b){case"value":C=W;break;case"defaultValue":V=W;break;case"multiple":p=W;default:on(i,o,b,W,c,null)}o=C,c=V,i.multiple=!!p,o!=null?Vr(i,!!p,o,!1):c!=null&&Vr(i,!!p,c,!0);return;case"textarea":li("invalid",i),C=b=p=null;for(V in c)if(c.hasOwnProperty(V)&&(W=c[V],W!=null))switch(V){case"value":p=W;break;case"defaultValue":b=W;break;case"children":C=W;break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(R(91));break;default:on(i,o,V,W,c,null)}_i(i,p,b,C),Yl(i);return;case"option":for(me in c)if(c.hasOwnProperty(me)&&(p=c[me],p!=null))switch(me){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:on(i,o,me,p,c,null)}return;case"dialog":li("beforetoggle",i),li("toggle",i),li("cancel",i),li("close",i);break;case"iframe":case"object":li("load",i);break;case"video":case"audio":for(p=0;p<Oc.length;p++)li(Oc[p],i);break;case"image":li("error",i),li("load",i);break;case"details":li("toggle",i);break;case"embed":case"source":case"link":li("error",i),li("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ne in c)if(c.hasOwnProperty(Ne)&&(p=c[Ne],p!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":throw Error(R(137,o));default:on(i,o,Ne,p,c,null)}return;default:if(ir(o)){for(et in c)c.hasOwnProperty(et)&&(p=c[et],p!==void 0&&Gd(i,o,et,p,c,void 0));return}}for(W in c)c.hasOwnProperty(W)&&(p=c[W],p!=null&&on(i,o,W,p,c,null))}function Hp(i,o,c,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,C=null,V=null,W=null,me=null,Ne=null,et=null;for($e in c){var lt=c[$e];if(c.hasOwnProperty($e)&&lt!=null)switch($e){case"checked":break;case"value":break;case"defaultValue":me=lt;default:p.hasOwnProperty($e)||on(i,o,$e,null,p,lt)}}for(var Ge in p){var $e=p[Ge];if(lt=c[Ge],p.hasOwnProperty(Ge)&&($e!=null||lt!=null))switch(Ge){case"type":C=$e;break;case"name":b=$e;break;case"checked":Ne=$e;break;case"defaultChecked":et=$e;break;case"value":V=$e;break;case"defaultValue":W=$e;break;case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(R(137,o));break;default:$e!==lt&&on(i,o,Ge,$e,p,lt)}}ri(i,V,W,me,Ne,et,C,b);return;case"select":$e=V=W=Ge=null;for(C in c)if(me=c[C],c.hasOwnProperty(C)&&me!=null)switch(C){case"value":break;case"multiple":$e=me;default:p.hasOwnProperty(C)||on(i,o,C,null,p,me)}for(b in p)if(C=p[b],me=c[b],p.hasOwnProperty(b)&&(C!=null||me!=null))switch(b){case"value":Ge=C;break;case"defaultValue":W=C;break;case"multiple":V=C;default:C!==me&&on(i,o,b,C,p,me)}o=W,c=V,p=$e,Ge!=null?Vr(i,!!c,Ge,!1):!!p!=!!c&&(o!=null?Vr(i,!!c,o,!0):Vr(i,!!c,c?[]:"",!1));return;case"textarea":$e=Ge=null;for(W in c)if(b=c[W],c.hasOwnProperty(W)&&b!=null&&!p.hasOwnProperty(W))switch(W){case"value":break;case"children":break;default:on(i,o,W,null,p,b)}for(V in p)if(b=p[V],C=c[V],p.hasOwnProperty(V)&&(b!=null||C!=null))switch(V){case"value":Ge=b;break;case"defaultValue":$e=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(R(91));break;default:b!==C&&on(i,o,V,b,p,C)}As(i,Ge,$e);return;case"option":for(var ei in c)if(Ge=c[ei],c.hasOwnProperty(ei)&&Ge!=null&&!p.hasOwnProperty(ei))switch(ei){case"selected":i.selected=!1;break;default:on(i,o,ei,null,p,Ge)}for(me in p)if(Ge=p[me],$e=c[me],p.hasOwnProperty(me)&&Ge!==$e&&(Ge!=null||$e!=null))switch(me){case"selected":i.selected=Ge&&typeof Ge!="function"&&typeof Ge!="symbol";break;default:on(i,o,me,Ge,p,$e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Wt in c)Ge=c[Wt],c.hasOwnProperty(Wt)&&Ge!=null&&!p.hasOwnProperty(Wt)&&on(i,o,Wt,null,p,Ge);for(Ne in p)if(Ge=p[Ne],$e=c[Ne],p.hasOwnProperty(Ne)&&Ge!==$e&&(Ge!=null||$e!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":if(Ge!=null)throw Error(R(137,o));break;default:on(i,o,Ne,Ge,p,$e)}return;default:if(ir(o)){for(var ai in c)Ge=c[ai],c.hasOwnProperty(ai)&&Ge!==void 0&&!p.hasOwnProperty(ai)&&Gd(i,o,ai,void 0,p,Ge);for(et in p)Ge=p[et],$e=c[et],!p.hasOwnProperty(et)||Ge===$e||Ge===void 0&&$e===void 0||Gd(i,o,et,Ge,p,$e);return}}for(var Ae in c)Ge=c[Ae],c.hasOwnProperty(Ae)&&Ge!=null&&!p.hasOwnProperty(Ae)&&on(i,o,Ae,null,p,Ge);for(lt in p)Ge=p[lt],$e=c[lt],!p.hasOwnProperty(lt)||Ge===$e||Ge==null&&$e==null||on(i,o,lt,Ge,p,$e)}var Vu=null,qd=null;function Fc(i){return i.nodeType===9?i:i.ownerDocument}function Nh(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Uh(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function Zf(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Gf=null;function Mm(){var i=window.event;return i&&i.type==="popstate"?i===Gf?!1:(Gf=i,!0):(Gf=null,!1)}var Nc=typeof setTimeout=="function"?setTimeout:void 0,zr=typeof clearTimeout=="function"?clearTimeout:void 0,ll=typeof Promise=="function"?Promise:void 0,qf=typeof queueMicrotask=="function"?queueMicrotask:typeof ll<"u"?function(i){return ll.resolve(null).then(i).catch($p)}:Nc;function $p(i){setTimeout(function(){throw i})}function cl(i){return i==="head"}function Hd(i,o){var c=o,p=0,b=0;do{var C=c.nextSibling;if(i.removeChild(c),C&&C.nodeType===8)if(c=C.data,c==="/$"){if(0<p&&8>p){c=p;var V=i.ownerDocument;if(c&1&&Uc(V.documentElement),c&2&&Uc(V.body),c&4)for(c=V.head,Uc(c),V=c.firstChild;V;){var W=V.nextSibling,me=V.nodeName;V[Xt]||me==="SCRIPT"||me==="STYLE"||me==="LINK"&&V.rel.toLowerCase()==="stylesheet"||c.removeChild(V),V=W}}if(b===0){i.removeChild(C),qu(o);return}b--}else c==="$"||c==="$?"||c==="$!"?b++:p=c.charCodeAt(0)-48;else p=0;c=C}while(c);qu(o)}function Hf(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Hf(c),fn(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function Xp(i,o,c,p){for(;i.nodeType===1;){var b=c;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Xt])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(C=i.getAttribute("rel"),C==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(C!==b.rel||i.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||i.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||i.getAttribute("title")!==(b.title==null?null:b.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(C=i.getAttribute("src"),(C!==(b.src==null?null:b.src)||i.getAttribute("type")!==(b.type==null?null:b.type)||i.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&C&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var C=b.name==null?null:""+b.name;if(b.type==="hidden"&&i.getAttribute("name")===C)return i}else return i;if(i=Za(i.nextSibling),i===null)break}return null}function Yp(i,o,c){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=Za(i.nextSibling),i===null))return null;return i}function $f(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function Kp(i,o){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")o();else{var p=function(){o(),c.removeEventListener("DOMContentLoaded",p)};c.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function Za(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}var Vh=null;function Xf(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return i;o--}else c==="/$"&&o++}i=i.previousSibling}return null}function Zu(i,o,c){switch(o=Fc(c),i){case"html":if(i=o.documentElement,!i)throw Error(R(452));return i;case"head":if(i=o.head,!i)throw Error(R(453));return i;case"body":if(i=o.body,!i)throw Error(R(454));return i;default:throw Error(R(451))}}function Uc(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);fn(i)}var Ga=new Map,$d=new Set;function Vc(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var qa=xt.d;xt.d={f:Yf,r:Kf,D:r,C:t,L:a,m:s,X:g,S:d,M:_};function Yf(){var i=qa.f(),o=Ph();return i||o}function Kf(i){var o=Ft(i);o!==null&&o.tag===5&&o.type==="form"?ja(o):qa.r(i)}var Ul=typeof document>"u"?null:document;function Wp(i,o,c){var p=Ul;if(p&&typeof o=="string"&&o){var b=Bn(o);b='link[rel="'+i+'"][href="'+b+'"]',typeof c=="string"&&(b+='[crossorigin="'+c+'"]'),$d.has(b)||($d.add(b),i={rel:i,crossOrigin:c,href:o},p.querySelector(b)===null&&(o=p.createElement("link"),ar(o,"link",i),Zn(o),p.head.appendChild(o)))}}function r(i){qa.D(i),Wp("dns-prefetch",i,null)}function t(i,o){qa.C(i,o),Wp("preconnect",i,o)}function a(i,o,c){qa.L(i,o,c);var p=Ul;if(p&&i&&o){var b='link[rel="preload"][as="'+Bn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(b+='[imagesrcset="'+Bn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(b+='[imagesizes="'+Bn(c.imageSizes)+'"]')):b+='[href="'+Bn(i)+'"]';var C=b;switch(o){case"style":C=T(i);break;case"script":C=j(i)}Ga.has(C)||(i=ce({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:i,as:o},c),Ga.set(C,i),p.querySelector(b)!==null||o==="style"&&p.querySelector(M(C))||o==="script"&&p.querySelector(U(C))||(o=p.createElement("link"),ar(o,"link",i),Zn(o),p.head.appendChild(o)))}}function s(i,o){qa.m(i,o);var c=Ul;if(c&&i){var p=o&&typeof o.as=="string"?o.as:"script",b='link[rel="modulepreload"][as="'+Bn(p)+'"][href="'+Bn(i)+'"]',C=b;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=j(i)}if(!Ga.has(C)&&(i=ce({rel:"modulepreload",href:i},o),Ga.set(C,i),c.querySelector(b)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(U(C)))return}p=c.createElement("link"),ar(p,"link",i),Zn(p),c.head.appendChild(p)}}}function d(i,o,c){qa.S(i,o,c);var p=Ul;if(p&&i){var b=Pi(p).hoistableStyles,C=T(i);o=o||"default";var V=b.get(C);if(!V){var W={loading:0,preload:null};if(V=p.querySelector(M(C)))W.loading=5;else{i=ce({rel:"stylesheet",href:i,"data-precedence":o},c),(c=Ga.get(C))&&ee(i,c);var me=V=p.createElement("link");Zn(me),ar(me,"link",i),me._p=new Promise(function(Ne,et){me.onload=Ne,me.onerror=et}),me.addEventListener("load",function(){W.loading|=1}),me.addEventListener("error",function(){W.loading|=2}),W.loading|=4,X(V,o,p)}V={type:"stylesheet",instance:V,count:1,state:W},b.set(C,V)}}}function g(i,o){qa.X(i,o);var c=Ul;if(c&&i){var p=Pi(c).hoistableScripts,b=j(i),C=p.get(b);C||(C=c.querySelector(U(b)),C||(i=ce({src:i,async:!0},o),(o=Ga.get(b))&&oe(i,o),C=c.createElement("script"),Zn(C),ar(C,"link",i),c.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(b,C))}}function _(i,o){qa.M(i,o);var c=Ul;if(c&&i){var p=Pi(c).hoistableScripts,b=j(i),C=p.get(b);C||(C=c.querySelector(U(b)),C||(i=ce({src:i,async:!0,type:"module"},o),(o=Ga.get(b))&&oe(i,o),C=c.createElement("script"),Zn(C),ar(C,"link",i),c.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(b,C))}}function v(i,o,c,p){var b=(b=qt.current)?Vc(b):null;if(!b)throw Error(R(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=T(c.href),c=Pi(b).hoistableStyles,p=c.get(o),p||(p={type:"style",instance:null,count:0,state:null},c.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=T(c.href);var C=Pi(b).hoistableStyles,V=C.get(i);if(V||(b=b.ownerDocument||b,V={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(i,V),(C=b.querySelector(M(i)))&&!C._p&&(V.instance=C,V.state.loading=5),Ga.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ga.set(i,c),C||D(b,i,c,V.state))),o&&p===null)throw Error(R(528,""));return V}if(o&&p!==null)throw Error(R(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=j(c),c=Pi(b).hoistableScripts,p=c.get(o),p||(p={type:"script",instance:null,count:0,state:null},c.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(R(444,i))}}function T(i){return'href="'+Bn(i)+'"'}function M(i){return'link[rel="stylesheet"]['+i+"]"}function P(i){return ce({},i,{"data-precedence":i.precedence,precedence:null})}function D(i,o,c,p){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=i.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),ar(o,"link",c),Zn(o),i.head.appendChild(o))}function j(i){return'[src="'+Bn(i)+'"]'}function U(i){return"script[async]"+i}function G(i,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var p=i.querySelector('style[data-href~="'+Bn(c.href)+'"]');if(p)return o.instance=p,Zn(p),p;var b=ce({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Zn(p),ar(p,"style",b),X(p,c.precedence,i),o.instance=p;case"stylesheet":b=T(c.href);var C=i.querySelector(M(b));if(C)return o.state.loading|=4,o.instance=C,Zn(C),C;p=P(c),(b=Ga.get(b))&&ee(p,b),C=(i.ownerDocument||i).createElement("link"),Zn(C);var V=C;return V._p=new Promise(function(W,me){V.onload=W,V.onerror=me}),ar(C,"link",p),o.state.loading|=4,X(C,c.precedence,i),o.instance=C;case"script":return C=j(c.src),(b=i.querySelector(U(C)))?(o.instance=b,Zn(b),b):(p=c,(b=Ga.get(C))&&(p=ce({},c),oe(p,b)),i=i.ownerDocument||i,b=i.createElement("script"),Zn(b),ar(b,"link",p),i.head.appendChild(b),o.instance=b);case"void":return null;default:throw Error(R(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,X(p,c.precedence,i));return o.instance}function X(i,o,c){for(var p=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=p.length?p[p.length-1]:null,C=b,V=0;V<p.length;V++){var W=p[V];if(W.dataset.precedence===o)C=W;else if(C!==b)break}C?C.parentNode.insertBefore(i,C.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(i,o.firstChild))}function ee(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function oe(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var ye=null;function le(i,o,c){if(ye===null){var p=new Map,b=ye=new Map;b.set(c,p)}else b=ye,p=b.get(c),p||(p=new Map,b.set(c,p));if(p.has(i))return p;for(p.set(i,null),c=c.getElementsByTagName(i),b=0;b<c.length;b++){var C=c[b];if(!(C[Xt]||C[Bt]||i==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var V=C.getAttribute(o)||"";V=i+V;var W=p.get(V);W?W.push(C):p.set(V,[C])}}return p}function N(i,o,c){i=i.ownerDocument||i,i.head.insertBefore(c,o==="title"?i.querySelector("head > title"):null)}function J(i,o,c){if(c===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function de(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Le=null;function ot(){}function Ue(i,o,c){if(Le===null)throw Error(R(475));var p=Le;if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var b=T(c.href),C=i.querySelector(M(b));if(C){i=C._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(p.count++,p=ut.bind(p),i.then(p,p)),o.state.loading|=4,o.instance=C,Zn(C);return}C=i.ownerDocument||i,c=P(c),(b=Ga.get(b))&&ee(c,b),C=C.createElement("link"),Zn(C);var V=C;V._p=new Promise(function(W,me){V.onload=W,V.onerror=me}),ar(C,"link",c),o.instance=C}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=ut.bind(p),i.addEventListener("load",o),i.addEventListener("error",o))}}function Xe(){if(Le===null)throw Error(R(475));var i=Le;return i.stylesheets&&i.count===0&&ht(i,i.stylesheets),0<i.count?function(o){var c=setTimeout(function(){if(i.stylesheets&&ht(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(c)}}:null}function ut(){if(this.count--,this.count===0){if(this.stylesheets)ht(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var at=null;function ht(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,at=new Map,o.forEach(Je,i),at=null,ut.call(i))}function Je(i,o){if(!(o.state.loading&4)){var c=at.get(i);if(c)var p=c.get(null);else{c=new Map,at.set(i,c);for(var b=i.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<b.length;C++){var V=b[C];(V.nodeName==="LINK"||V.getAttribute("media")!=="not all")&&(c.set(V.dataset.precedence,V),p=V)}p&&c.set(null,p)}b=o.instance,V=b.getAttribute("data-precedence"),C=c.get(V)||p,C===p&&c.set(null,b),c.set(V,b),this.count++,p=ut.bind(this),b.addEventListener("load",p),b.addEventListener("error",p),C?C.parentNode.insertBefore(b,C.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(b,i.firstChild)),o.state.loading|=4}}var Ct={$$typeof:qe,Provider:null,Consumer:null,_currentValue:jt,_currentValue2:jt,_threadCount:0};function Zt(i,o,c,p,b,C,V,W){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ve(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ve(0),this.hiddenUpdates=ve(null),this.identifierPrefix=p,this.onUncaughtError=b,this.onCaughtError=C,this.onRecoverableError=V,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function Ut(i,o,c,p,b,C,V,W,me,Ne,et,lt){return i=new Zt(i,o,c,V,W,me,Ne,lt),o=1,C===!0&&(o|=24),C=Ir(3,null,null,o),i.current=C,C.stateNode=i,o=Zs(),o.refCount++,i.pooledCache=o,o.refCount++,C.memoizedState={element:p,isDehydrated:c,cache:o},zl(C),i}function kt(i){return i?(i=ko,i):ko}function ci(i,o,c,p,b,C){b=kt(b),p.context===null?p.context=b:p.pendingContext=b,p=Oo(o),p.payload={element:c},C=C===void 0?null:C,C!==null&&(p.callback=C),c=Ba(i,p,o),c!==null&&(Kr(c,i,o),gc(c,i,o))}function En(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function Hn(i,o){En(i,o),(i=i.alternate)&&En(i,o)}function br(i){if(i.tag===13){var o=Sl(i,67108864);o!==null&&Kr(o,i,67108864),Hn(i,67108864)}}var Wr=!0;function ha(i,o,c,p){var b=Ve.T;Ve.T=null;var C=xt.p;try{xt.p=2,sn(i,o,c,p)}finally{xt.p=C,Ve.T=b}}function wr(i,o,c,p){var b=Ve.T;Ve.T=null;var C=xt.p;try{xt.p=8,sn(i,o,c,p)}finally{xt.p=C,Ve.T=b}}function sn(i,o,c,p){if(Wr){var b=Jn(p);if(b===null)Ud(i,o,p,er,c),go(i,p);else if(Go(b,i,o,c,p))p.stopPropagation();else if(go(i,p),o&4&&-1<cn.indexOf(i)){for(;b!==null;){var C=Ft(b);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var V=Ce(C.pendingLanes);if(V!==0){var W=C;for(W.pendingLanes|=2,W.entangledLanes|=2;V;){var me=1<<31-zi(V);W.entanglements[1]|=me,V&=~me}bs(C),(Hi&6)===0&&(Bu=Mn()+500,Bh(0))}}break;case 13:W=Sl(C,2),W!==null&&Kr(W,C,2),Ph(),Hn(C,2)}if(C=Jn(p),C===null&&Ud(i,o,p,er,c),C===b)break;b=C}b!==null&&p.stopPropagation()}else Ud(i,o,p,null,c)}}function Jn(i){return i=Gn(i),or(i)}var er=null;function or(i){if(er=null,i=Ur(i),i!==null){var o=H(i);if(o===null)i=null;else{var c=o.tag;if(c===13){if(i=A(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return er=i,null}function jr(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($a()){case za:return 2;case Jr:return 8;case lr:case pt:return 32;case Mt:return 268435456;default:return 32}default:return 32}}var da=!1,yn=null,tr=null,ln=null,Nn=new Map,Un=new Map,nn=[],cn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function go(i,o){switch(i){case"focusin":case"focusout":yn=null;break;case"dragenter":case"dragleave":tr=null;break;case"mouseover":case"mouseout":ln=null;break;case"pointerover":case"pointerout":Nn.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Un.delete(o.pointerId)}}function ws(i,o,c,p,b,C){return i===null||i.nativeEvent!==C?(i={blockedOn:o,domEventName:c,eventSystemFlags:p,nativeEvent:C,targetContainers:[b]},o!==null&&(o=Ft(o),o!==null&&br(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,b!==null&&o.indexOf(b)===-1&&o.push(b),i)}function Go(i,o,c,p,b){switch(o){case"focusin":return yn=ws(yn,i,o,c,p,b),!0;case"dragenter":return tr=ws(tr,i,o,c,p,b),!0;case"mouseover":return ln=ws(ln,i,o,c,p,b),!0;case"pointerover":var C=b.pointerId;return Nn.set(C,ws(Nn.get(C)||null,i,o,c,p,b)),!0;case"gotpointercapture":return C=b.pointerId,Un.set(C,ws(Un.get(C)||null,i,o,c,p,b)),!0}return!1}function Qp(i){var o=Ur(i.target);if(o!==null){var c=H(o);if(c!==null){if(o=c.tag,o===13){if(o=A(c),o!==null){i.blockedOn=o,bt(i.priority,function(){if(c.tag===13){var p=Or();p=Re(p);var b=Sl(c,p);b!==null&&Kr(b,c,p),Hn(c,p)}});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ul(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=Jn(i.nativeEvent);if(c===null){c=i.nativeEvent;var p=new c.constructor(c.type,c);Sr=p,c.target.dispatchEvent(p),Sr=null}else return o=Ft(c),o!==null&&br(o),i.blockedOn=c,!1;o.shift()}return!0}function Vl(i,o,c){ul(i)&&c.delete(o)}function Gu(){da=!1,yn!==null&&ul(yn)&&(yn=null),tr!==null&&ul(tr)&&(tr=null),ln!==null&&ul(ln)&&(ln=null),Nn.forEach(Vl),Un.forEach(Vl)}function hl(i,o){i.blockedOn===o&&(i.blockedOn=null,da||(da=!0,x.unstable_scheduleCallback(x.unstable_NormalPriority,Gu)))}var dl=null;function Wf(i){dl!==i&&(dl=i,x.unstable_scheduleCallback(x.unstable_NormalPriority,function(){dl===i&&(dl=null);for(var o=0;o<i.length;o+=3){var c=i[o],p=i[o+1],b=i[o+2];if(typeof p!="function"){if(or(p||c)===null)continue;break}var C=Ft(c);C!==null&&(i.splice(o,3),o-=3,so(C,{pending:!0,data:b,method:c.method,action:p},p,b))}}))}function qu(i){function o(me){return hl(me,i)}yn!==null&&hl(yn,i),tr!==null&&hl(tr,i),ln!==null&&hl(ln,i),Nn.forEach(o),Un.forEach(o);for(var c=0;c<nn.length;c++){var p=nn[c];p.blockedOn===i&&(p.blockedOn=null)}for(;0<nn.length&&(c=nn[0],c.blockedOn===null);)Qp(c),c.blockedOn===null&&nn.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(p=0;p<c.length;p+=3){var b=c[p],C=c[p+1],V=b[At]||null;if(typeof C=="function")V||Wf(c);else if(V){var W=null;if(C&&C.hasAttribute("formAction")){if(b=C,V=C[At]||null)W=V.formAction;else if(or(b)!==null)continue}else W=V.action;typeof W=="function"?c[p+1]=W:(c.splice(p,3),p-=3),Wf(c)}}}function Xd(i){this._internalRoot=i}Zh.prototype.render=Xd.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(R(409));var c=o.current,p=Or();ci(c,p,i,o,null,null)},Zh.prototype.unmount=Xd.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;ci(i.current,2,null,i,null,null),Ph(),o[Gt]=null}};function Zh(i){this._internalRoot=i}Zh.prototype.unstable_scheduleHydration=function(i){if(i){var o=vt();i={blockedOn:null,target:i,priority:o};for(var c=0;c<nn.length&&o!==0&&o<nn[c].priority;c++);nn.splice(c,0,i),c===0&&Qp(i)}};var Yd=E.version;if(Yd!=="19.1.0")throw Error(R(527,Yd,"19.1.0"));xt.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(R(188)):(i=Object.keys(i).join(","),Error(R(268,i)));return i=re(o),i=i!==null?Q(i):null,i=i===null?null:i.stateNode,i};var Qf={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Ve,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _o=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_o.isDisabled&&_o.supportsFiber)try{xn=_o.inject(Qf),un=_o}catch{}}return ep.createRoot=function(i,o){if(!L(i))throw Error(R(299));var c=!1,p="",b=pp,C=cf,V=uf,W=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(b=o.onUncaughtError),o.onCaughtError!==void 0&&(C=o.onCaughtError),o.onRecoverableError!==void 0&&(V=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(W=o.unstable_transitionCallbacks)),o=Ut(i,1,!1,null,null,c,p,b,C,V,W,null),i[Gt]=o.current,Nd(i),new Xd(o)},ep.hydrateRoot=function(i,o,c){if(!L(i))throw Error(R(299));var p=!1,b="",C=pp,V=cf,W=uf,me=null,Ne=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(b=c.identifierPrefix),c.onUncaughtError!==void 0&&(C=c.onUncaughtError),c.onCaughtError!==void 0&&(V=c.onCaughtError),c.onRecoverableError!==void 0&&(W=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(me=c.unstable_transitionCallbacks),c.formState!==void 0&&(Ne=c.formState)),o=Ut(i,1,!0,o,c??null,p,b,C,V,W,me,Ne),o.context=kt(null),c=o.current,p=Or(),p=Re(p),b=Oo(p),b.callback=null,Ba(c,b,p),c=p,o.current.lanes=c,Ie(o,c),bs(o),i[Gt]=o.current,Nd(i),new Zh(o)},ep.version="19.1.0",ep}var mg;function G_(){if(mg)return Rm.exports;mg=1;function x(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x)}catch(E){console.error(E)}}return x(),Rm.exports=Z_(),Rm.exports}var q_=G_(),tp={},gg;function H_(){if(gg)return tp;gg=1,Object.defineProperty(tp,"__esModule",{value:!0}),tp.parse=A,tp.serialize=Q;const x=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,E=/^[\u0021-\u003A\u003C-\u007E]*$/,I=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,R=/^[\u0020-\u003A\u003D-\u007E]*$/,L=Object.prototype.toString,H=(()=>{const _e=function(){};return _e.prototype=Object.create(null),_e})();function A(_e,ie){const he=new H,je=_e.length;if(je<2)return he;const Me=(ie==null?void 0:ie.decode)||ce;let Oe=0;do{const Fe=_e.indexOf("=",Oe);if(Fe===-1)break;const qe=_e.indexOf(";",Oe),dt=qe===-1?je:qe;if(Fe>dt){Oe=_e.lastIndexOf(";",Fe-1)+1;continue}const mt=u(_e,Oe,Fe),zt=re(_e,Fe,mt),yt=_e.slice(mt,zt);if(he[yt]===void 0){let St=u(_e,Fe+1,dt),Qt=re(_e,dt,St);const Bi=Me(_e.slice(St,Qt));he[yt]=Bi}Oe=dt+1}while(Oe<je);return he}function u(_e,ie,he){do{const je=_e.charCodeAt(ie);if(je!==32&&je!==9)return ie}while(++ie<he);return he}function re(_e,ie,he){for(;ie>he;){const je=_e.charCodeAt(--ie);if(je!==32&&je!==9)return ie+1}return he}function Q(_e,ie,he){const je=(he==null?void 0:he.encode)||encodeURIComponent;if(!x.test(_e))throw new TypeError(`argument name is invalid: ${_e}`);const Me=je(ie);if(!E.test(Me))throw new TypeError(`argument val is invalid: ${ie}`);let Oe=_e+"="+Me;if(!he)return Oe;if(he.maxAge!==void 0){if(!Number.isInteger(he.maxAge))throw new TypeError(`option maxAge is invalid: ${he.maxAge}`);Oe+="; Max-Age="+he.maxAge}if(he.domain){if(!I.test(he.domain))throw new TypeError(`option domain is invalid: ${he.domain}`);Oe+="; Domain="+he.domain}if(he.path){if(!R.test(he.path))throw new TypeError(`option path is invalid: ${he.path}`);Oe+="; Path="+he.path}if(he.expires){if(!ze(he.expires)||!Number.isFinite(he.expires.valueOf()))throw new TypeError(`option expires is invalid: ${he.expires}`);Oe+="; Expires="+he.expires.toUTCString()}if(he.httpOnly&&(Oe+="; HttpOnly"),he.secure&&(Oe+="; Secure"),he.partitioned&&(Oe+="; Partitioned"),he.priority)switch(typeof he.priority=="string"?he.priority.toLowerCase():void 0){case"low":Oe+="; Priority=Low";break;case"medium":Oe+="; Priority=Medium";break;case"high":Oe+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${he.priority}`)}if(he.sameSite)switch(typeof he.sameSite=="string"?he.sameSite.toLowerCase():he.sameSite){case!0:case"strict":Oe+="; SameSite=Strict";break;case"lax":Oe+="; SameSite=Lax";break;case"none":Oe+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${he.sameSite}`)}return Oe}function ce(_e){if(_e.indexOf("%")===-1)return _e;try{return decodeURIComponent(_e)}catch{return _e}}function ze(_e){return L.call(_e)==="[object Date]"}return tp}H_();/**
 * react-router v7.5.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var _g="popstate";function $_(x={}){function E(R,L){let{pathname:H,search:A,hash:u}=R.location;return Fm("",{pathname:H,search:A,hash:u},L.state&&L.state.usr||null,L.state&&L.state.key||"default")}function I(R,L){return typeof L=="string"?L:rp(L)}return Y_(E,I,null,x)}function sr(x,E){if(x===!1||x===null||typeof x>"u")throw new Error(E)}function Gl(x,E){if(!x){typeof console<"u"&&console.warn(E);try{throw new Error(E)}catch{}}}function X_(){return Math.random().toString(36).substring(2,10)}function yg(x,E){return{usr:x.state,key:x.key,idx:E}}function Fm(x,E,I=null,R){return{pathname:typeof x=="string"?x:x.pathname,search:"",hash:"",...typeof E=="string"?Kd(E):E,state:I,key:E&&E.key||R||X_()}}function rp({pathname:x="/",search:E="",hash:I=""}){return E&&E!=="?"&&(x+=E.charAt(0)==="?"?E:"?"+E),I&&I!=="#"&&(x+=I.charAt(0)==="#"?I:"#"+I),x}function Kd(x){let E={};if(x){let I=x.indexOf("#");I>=0&&(E.hash=x.substring(I),x=x.substring(0,I));let R=x.indexOf("?");R>=0&&(E.search=x.substring(R),x=x.substring(0,R)),x&&(E.pathname=x)}return E}function Y_(x,E,I,R={}){let{window:L=document.defaultView,v5Compat:H=!1}=R,A=L.history,u="POP",re=null,Q=ce();Q==null&&(Q=0,A.replaceState({...A.state,idx:Q},""));function ce(){return(A.state||{idx:null}).idx}function ze(){u="POP";let Me=ce(),Oe=Me==null?null:Me-Q;Q=Me,re&&re({action:u,location:je.location,delta:Oe})}function _e(Me,Oe){u="PUSH";let Fe=Fm(je.location,Me,Oe);Q=ce()+1;let qe=yg(Fe,Q),dt=je.createHref(Fe);try{A.pushState(qe,"",dt)}catch(mt){if(mt instanceof DOMException&&mt.name==="DataCloneError")throw mt;L.location.assign(dt)}H&&re&&re({action:u,location:je.location,delta:1})}function ie(Me,Oe){u="REPLACE";let Fe=Fm(je.location,Me,Oe);Q=ce();let qe=yg(Fe,Q),dt=je.createHref(Fe);A.replaceState(qe,"",dt),H&&re&&re({action:u,location:je.location,delta:0})}function he(Me){let Oe=L.location.origin!=="null"?L.location.origin:L.location.href,Fe=typeof Me=="string"?Me:rp(Me);return Fe=Fe.replace(/ $/,"%20"),sr(Oe,`No window.location.(origin|href) available to create URL for href: ${Fe}`),new URL(Fe,Oe)}let je={get action(){return u},get location(){return x(L,A)},listen(Me){if(re)throw new Error("A history only accepts one active listener");return L.addEventListener(_g,ze),re=Me,()=>{L.removeEventListener(_g,ze),re=null}},createHref(Me){return E(L,Me)},createURL:he,encodeLocation(Me){let Oe=he(Me);return{pathname:Oe.pathname,search:Oe.search,hash:Oe.hash}},push:_e,replace:ie,go(Me){return A.go(Me)}};return je}function Ng(x,E,I="/"){return K_(x,E,I,!1)}function K_(x,E,I,R){let L=typeof E=="string"?Kd(E):E,H=qc(L.pathname||"/",I);if(H==null)return null;let A=Ug(x);W_(A);let u=null;for(let re=0;u==null&&re<A.length;++re){let Q=ly(H);u=oy(A[re],Q,R)}return u}function Ug(x,E=[],I=[],R=""){let L=(H,A,u)=>{let re={relativePath:u===void 0?H.path||"":u,caseSensitive:H.caseSensitive===!0,childrenIndex:A,route:H};re.relativePath.startsWith("/")&&(sr(re.relativePath.startsWith(R),`Absolute route path "${re.relativePath}" nested under path "${R}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),re.relativePath=re.relativePath.slice(R.length));let Q=Gc([R,re.relativePath]),ce=I.concat(re);H.children&&H.children.length>0&&(sr(H.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${Q}".`),Ug(H.children,E,ce,Q)),!(H.path==null&&!H.index)&&E.push({path:Q,score:ry(Q,H.index),routesMeta:ce})};return x.forEach((H,A)=>{var u;if(H.path===""||!((u=H.path)!=null&&u.includes("?")))L(H,A);else for(let re of Vg(H.path))L(H,A,re)}),E}function Vg(x){let E=x.split("/");if(E.length===0)return[];let[I,...R]=E,L=I.endsWith("?"),H=I.replace(/\?$/,"");if(R.length===0)return L?[H,""]:[H];let A=Vg(R.join("/")),u=[];return u.push(...A.map(re=>re===""?H:[H,re].join("/"))),L&&u.push(...A),u.map(re=>x.startsWith("/")&&re===""?"/":re)}function W_(x){x.sort((E,I)=>E.score!==I.score?I.score-E.score:ay(E.routesMeta.map(R=>R.childrenIndex),I.routesMeta.map(R=>R.childrenIndex)))}var Q_=/^:[\w-]+$/,J_=3,ey=2,ty=1,iy=10,ny=-2,vg=x=>x==="*";function ry(x,E){let I=x.split("/"),R=I.length;return I.some(vg)&&(R+=ny),E&&(R+=ey),I.filter(L=>!vg(L)).reduce((L,H)=>L+(Q_.test(H)?J_:H===""?ty:iy),R)}function ay(x,E){return x.length===E.length&&x.slice(0,-1).every((R,L)=>R===E[L])?x[x.length-1]-E[E.length-1]:0}function oy(x,E,I=!1){let{routesMeta:R}=x,L={},H="/",A=[];for(let u=0;u<R.length;++u){let re=R[u],Q=u===R.length-1,ce=H==="/"?E:E.slice(H.length)||"/",ze=om({path:re.relativePath,caseSensitive:re.caseSensitive,end:Q},ce),_e=re.route;if(!ze&&Q&&I&&!R[R.length-1].route.index&&(ze=om({path:re.relativePath,caseSensitive:re.caseSensitive,end:!1},ce)),!ze)return null;Object.assign(L,ze.params),A.push({params:L,pathname:Gc([H,ze.pathname]),pathnameBase:dy(Gc([H,ze.pathnameBase])),route:_e}),ze.pathnameBase!=="/"&&(H=Gc([H,ze.pathnameBase]))}return A}function om(x,E){typeof x=="string"&&(x={path:x,caseSensitive:!1,end:!0});let[I,R]=sy(x.path,x.caseSensitive,x.end),L=E.match(I);if(!L)return null;let H=L[0],A=H.replace(/(.)\/+$/,"$1"),u=L.slice(1);return{params:R.reduce((Q,{paramName:ce,isOptional:ze},_e)=>{if(ce==="*"){let he=u[_e]||"";A=H.slice(0,H.length-he.length).replace(/(.)\/+$/,"$1")}const ie=u[_e];return ze&&!ie?Q[ce]=void 0:Q[ce]=(ie||"").replace(/%2F/g,"/"),Q},{}),pathname:H,pathnameBase:A,pattern:x}}function sy(x,E=!1,I=!0){Gl(x==="*"||!x.endsWith("*")||x.endsWith("/*"),`Route path "${x}" will be treated as if it were "${x.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${x.replace(/\*$/,"/*")}".`);let R=[],L="^"+x.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(A,u,re)=>(R.push({paramName:u,isOptional:re!=null}),re?"/?([^\\/]+)?":"/([^\\/]+)"));return x.endsWith("*")?(R.push({paramName:"*"}),L+=x==="*"||x==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):I?L+="\\/*$":x!==""&&x!=="/"&&(L+="(?:(?=\\/|$))"),[new RegExp(L,E?void 0:"i"),R]}function ly(x){try{return x.split("/").map(E=>decodeURIComponent(E).replace(/\//g,"%2F")).join("/")}catch(E){return Gl(!1,`The URL path "${x}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${E}).`),x}}function qc(x,E){if(E==="/")return x;if(!x.toLowerCase().startsWith(E.toLowerCase()))return null;let I=E.endsWith("/")?E.length-1:E.length,R=x.charAt(I);return R&&R!=="/"?null:x.slice(I)||"/"}function cy(x,E="/"){let{pathname:I,search:R="",hash:L=""}=typeof x=="string"?Kd(x):x;return{pathname:I?I.startsWith("/")?I:uy(I,E):E,search:fy(R),hash:py(L)}}function uy(x,E){let I=E.replace(/\/+$/,"").split("/");return x.split("/").forEach(L=>{L===".."?I.length>1&&I.pop():L!=="."&&I.push(L)}),I.length>1?I.join("/"):"/"}function km(x,E,I,R){return`Cannot include a '${x}' character in a manually specified \`to.${E}\` field [${JSON.stringify(R)}].  Please separate it out to the \`to.${I}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function hy(x){return x.filter((E,I)=>I===0||E.route.path&&E.route.path.length>0)}function Zg(x){let E=hy(x);return E.map((I,R)=>R===E.length-1?I.pathname:I.pathnameBase)}function Gg(x,E,I,R=!1){let L;typeof x=="string"?L=Kd(x):(L={...x},sr(!L.pathname||!L.pathname.includes("?"),km("?","pathname","search",L)),sr(!L.pathname||!L.pathname.includes("#"),km("#","pathname","hash",L)),sr(!L.search||!L.search.includes("#"),km("#","search","hash",L)));let H=x===""||L.pathname==="",A=H?"/":L.pathname,u;if(A==null)u=I;else{let ze=E.length-1;if(!R&&A.startsWith("..")){let _e=A.split("/");for(;_e[0]==="..";)_e.shift(),ze-=1;L.pathname=_e.join("/")}u=ze>=0?E[ze]:"/"}let re=cy(L,u),Q=A&&A!=="/"&&A.endsWith("/"),ce=(H||A===".")&&I.endsWith("/");return!re.pathname.endsWith("/")&&(Q||ce)&&(re.pathname+="/"),re}var Gc=x=>x.join("/").replace(/\/\/+/g,"/"),dy=x=>x.replace(/\/+$/,"").replace(/^\/*/,"/"),fy=x=>!x||x==="?"?"":x.startsWith("?")?x:"?"+x,py=x=>!x||x==="#"?"":x.startsWith("#")?x:"#"+x;function my(x){return x!=null&&typeof x.status=="number"&&typeof x.statusText=="string"&&typeof x.internal=="boolean"&&"data"in x}var qg=["POST","PUT","PATCH","DELETE"];new Set(qg);var gy=["GET",...qg];new Set(gy);var Wd=Pe.createContext(null);Wd.displayName="DataRouter";var cm=Pe.createContext(null);cm.displayName="DataRouterState";var Hg=Pe.createContext({isTransitioning:!1});Hg.displayName="ViewTransition";var _y=Pe.createContext(new Map);_y.displayName="Fetchers";var yy=Pe.createContext(null);yy.displayName="Await";var ql=Pe.createContext(null);ql.displayName="Navigation";var sp=Pe.createContext(null);sp.displayName="Location";var Hl=Pe.createContext({outlet:null,matches:[],isDataRoute:!1});Hl.displayName="Route";var Qm=Pe.createContext(null);Qm.displayName="RouteError";function vy(x,{relative:E}={}){sr(lp(),"useHref() may be used only in the context of a <Router> component.");let{basename:I,navigator:R}=Pe.useContext(ql),{hash:L,pathname:H,search:A}=cp(x,{relative:E}),u=H;return I!=="/"&&(u=H==="/"?I:Gc([I,H])),R.createHref({pathname:u,search:A,hash:L})}function lp(){return Pe.useContext(sp)!=null}function Yh(){return sr(lp(),"useLocation() may be used only in the context of a <Router> component."),Pe.useContext(sp).location}var $g="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Xg(x){Pe.useContext(ql).static||Pe.useLayoutEffect(x)}function $c(){let{isDataRoute:x}=Pe.useContext(Hl);return x?Dy():xy()}function xy(){sr(lp(),"useNavigate() may be used only in the context of a <Router> component.");let x=Pe.useContext(Wd),{basename:E,navigator:I}=Pe.useContext(ql),{matches:R}=Pe.useContext(Hl),{pathname:L}=Yh(),H=JSON.stringify(Zg(R)),A=Pe.useRef(!1);return Xg(()=>{A.current=!0}),Pe.useCallback((re,Q={})=>{if(Gl(A.current,$g),!A.current)return;if(typeof re=="number"){I.go(re);return}let ce=Gg(re,JSON.parse(H),L,Q.relative==="path");x==null&&E!=="/"&&(ce.pathname=ce.pathname==="/"?E:Gc([E,ce.pathname])),(Q.replace?I.replace:I.push)(ce,Q.state,Q)},[E,I,H,L,x])}Pe.createContext(null);function by(){let{matches:x}=Pe.useContext(Hl),E=x[x.length-1];return E?E.params:{}}function cp(x,{relative:E}={}){let{matches:I}=Pe.useContext(Hl),{pathname:R}=Yh(),L=JSON.stringify(Zg(I));return Pe.useMemo(()=>Gg(x,JSON.parse(L),R,E==="path"),[x,L,R,E])}function wy(x,E){return Yg(x,E)}function Yg(x,E,I,R){var Fe;sr(lp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:L,static:H}=Pe.useContext(ql),{matches:A}=Pe.useContext(Hl),u=A[A.length-1],re=u?u.params:{},Q=u?u.pathname:"/",ce=u?u.pathnameBase:"/",ze=u&&u.route;{let qe=ze&&ze.path||"";Kg(Q,!ze||qe.endsWith("*")||qe.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${Q}" (under <Route path="${qe}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${qe}"> to <Route path="${qe==="/"?"*":`${qe}/*`}">.`)}let _e=Yh(),ie;if(E){let qe=typeof E=="string"?Kd(E):E;sr(ce==="/"||((Fe=qe.pathname)==null?void 0:Fe.startsWith(ce)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${ce}" but pathname "${qe.pathname}" was given in the \`location\` prop.`),ie=qe}else ie=_e;let he=ie.pathname||"/",je=he;if(ce!=="/"){let qe=ce.replace(/^\//,"").split("/");je="/"+he.replace(/^\//,"").split("/").slice(qe.length).join("/")}let Me=!H&&I&&I.matches&&I.matches.length>0?I.matches:Ng(x,{pathname:je});Gl(ze||Me!=null,`No routes matched location "${ie.pathname}${ie.search}${ie.hash}" `),Gl(Me==null||Me[Me.length-1].route.element!==void 0||Me[Me.length-1].route.Component!==void 0||Me[Me.length-1].route.lazy!==void 0,`Matched leaf route at location "${ie.pathname}${ie.search}${ie.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Oe=My(Me&&Me.map(qe=>Object.assign({},qe,{params:Object.assign({},re,qe.params),pathname:Gc([ce,L.encodeLocation?L.encodeLocation(qe.pathname).pathname:qe.pathname]),pathnameBase:qe.pathnameBase==="/"?ce:Gc([ce,L.encodeLocation?L.encodeLocation(qe.pathnameBase).pathname:qe.pathnameBase])})),A,I,R);return E&&Oe?Pe.createElement(sp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...ie},navigationType:"POP"}},Oe):Oe}function Ty(){let x=Iy(),E=my(x)?`${x.status} ${x.statusText}`:x instanceof Error?x.message:JSON.stringify(x),I=x instanceof Error?x.stack:null,R="rgba(200,200,200, 0.5)",L={padding:"0.5rem",backgroundColor:R},H={padding:"2px 4px",backgroundColor:R},A=null;return console.error("Error handled by React Router default ErrorBoundary:",x),A=Pe.createElement(Pe.Fragment,null,Pe.createElement("p",null,"💿 Hey developer 👋"),Pe.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Pe.createElement("code",{style:H},"ErrorBoundary")," or"," ",Pe.createElement("code",{style:H},"errorElement")," prop on your route.")),Pe.createElement(Pe.Fragment,null,Pe.createElement("h2",null,"Unexpected Application Error!"),Pe.createElement("h3",{style:{fontStyle:"italic"}},E),I?Pe.createElement("pre",{style:L},I):null,A)}var Sy=Pe.createElement(Ty,null),Ey=class extends Pe.Component{constructor(x){super(x),this.state={location:x.location,revalidation:x.revalidation,error:x.error}}static getDerivedStateFromError(x){return{error:x}}static getDerivedStateFromProps(x,E){return E.location!==x.location||E.revalidation!=="idle"&&x.revalidation==="idle"?{error:x.error,location:x.location,revalidation:x.revalidation}:{error:x.error!==void 0?x.error:E.error,location:E.location,revalidation:x.revalidation||E.revalidation}}componentDidCatch(x,E){console.error("React Router caught the following error during render",x,E)}render(){return this.state.error!==void 0?Pe.createElement(Hl.Provider,{value:this.props.routeContext},Pe.createElement(Qm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Cy({routeContext:x,match:E,children:I}){let R=Pe.useContext(Wd);return R&&R.static&&R.staticContext&&(E.route.errorElement||E.route.ErrorBoundary)&&(R.staticContext._deepestRenderedBoundaryId=E.route.id),Pe.createElement(Hl.Provider,{value:x},I)}function My(x,E=[],I=null,R=null){if(x==null){if(!I)return null;if(I.errors)x=I.matches;else if(E.length===0&&!I.initialized&&I.matches.length>0)x=I.matches;else return null}let L=x,H=I==null?void 0:I.errors;if(H!=null){let re=L.findIndex(Q=>Q.route.id&&(H==null?void 0:H[Q.route.id])!==void 0);sr(re>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(H).join(",")}`),L=L.slice(0,Math.min(L.length,re+1))}let A=!1,u=-1;if(I)for(let re=0;re<L.length;re++){let Q=L[re];if((Q.route.HydrateFallback||Q.route.hydrateFallbackElement)&&(u=re),Q.route.id){let{loaderData:ce,errors:ze}=I,_e=Q.route.loader&&!ce.hasOwnProperty(Q.route.id)&&(!ze||ze[Q.route.id]===void 0);if(Q.route.lazy||_e){A=!0,u>=0?L=L.slice(0,u+1):L=[L[0]];break}}}return L.reduceRight((re,Q,ce)=>{let ze,_e=!1,ie=null,he=null;I&&(ze=H&&Q.route.id?H[Q.route.id]:void 0,ie=Q.route.errorElement||Sy,A&&(u<0&&ce===0?(Kg("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_e=!0,he=null):u===ce&&(_e=!0,he=Q.route.hydrateFallbackElement||null)));let je=E.concat(L.slice(0,ce+1)),Me=()=>{let Oe;return ze?Oe=ie:_e?Oe=he:Q.route.Component?Oe=Pe.createElement(Q.route.Component,null):Q.route.element?Oe=Q.route.element:Oe=re,Pe.createElement(Cy,{match:Q,routeContext:{outlet:re,matches:je,isDataRoute:I!=null},children:Oe})};return I&&(Q.route.ErrorBoundary||Q.route.errorElement||ce===0)?Pe.createElement(Ey,{location:I.location,revalidation:I.revalidation,component:ie,error:ze,children:Me(),routeContext:{outlet:null,matches:je,isDataRoute:!0}}):Me()},null)}function Jm(x){return`${x} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ay(x){let E=Pe.useContext(Wd);return sr(E,Jm(x)),E}function zy(x){let E=Pe.useContext(cm);return sr(E,Jm(x)),E}function Ry(x){let E=Pe.useContext(Hl);return sr(E,Jm(x)),E}function eg(x){let E=Ry(x),I=E.matches[E.matches.length-1];return sr(I.route.id,`${x} can only be used on routes that contain a unique "id"`),I.route.id}function Py(){return eg("useRouteId")}function Iy(){var R;let x=Pe.useContext(Qm),E=zy("useRouteError"),I=eg("useRouteError");return x!==void 0?x:(R=E.errors)==null?void 0:R[I]}function Dy(){let{router:x}=Ay("useNavigate"),E=eg("useNavigate"),I=Pe.useRef(!1);return Xg(()=>{I.current=!0}),Pe.useCallback(async(L,H={})=>{Gl(I.current,$g),I.current&&(typeof L=="number"?x.navigate(L):await x.navigate(L,{fromRouteId:E,...H}))},[x,E])}var xg={};function Kg(x,E,I){!E&&!xg[x]&&(xg[x]=!0,Gl(!1,I))}Pe.memo(ky);function ky({routes:x,future:E,state:I}){return Yg(x,void 0,I,E)}function Zc(x){sr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ly({basename:x="/",children:E=null,location:I,navigationType:R="POP",navigator:L,static:H=!1}){sr(!lp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let A=x.replace(/^\/*/,"/"),u=Pe.useMemo(()=>({basename:A,navigator:L,static:H,future:{}}),[A,L,H]);typeof I=="string"&&(I=Kd(I));let{pathname:re="/",search:Q="",hash:ce="",state:ze=null,key:_e="default"}=I,ie=Pe.useMemo(()=>{let he=qc(re,A);return he==null?null:{location:{pathname:he,search:Q,hash:ce,state:ze,key:_e},navigationType:R}},[A,re,Q,ce,ze,_e,R]);return Gl(ie!=null,`<Router basename="${A}"> is not able to match the URL "${re}${Q}${ce}" because it does not start with the basename, so the <Router> won't render anything.`),ie==null?null:Pe.createElement(ql.Provider,{value:u},Pe.createElement(sp.Provider,{children:E,value:ie}))}function By({children:x,location:E}){return wy(Nm(x),E)}function Nm(x,E=[]){let I=[];return Pe.Children.forEach(x,(R,L)=>{if(!Pe.isValidElement(R))return;let H=[...E,L];if(R.type===Pe.Fragment){I.push.apply(I,Nm(R.props.children,H));return}sr(R.type===Zc,`[${typeof R.type=="string"?R.type:R.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),sr(!R.props.index||!R.props.children,"An index route cannot have child routes.");let A={id:R.props.id||H.join("-"),caseSensitive:R.props.caseSensitive,element:R.props.element,Component:R.props.Component,index:R.props.index,path:R.props.path,loader:R.props.loader,action:R.props.action,hydrateFallbackElement:R.props.hydrateFallbackElement,HydrateFallback:R.props.HydrateFallback,errorElement:R.props.errorElement,ErrorBoundary:R.props.ErrorBoundary,hasErrorBoundary:R.props.hasErrorBoundary===!0||R.props.ErrorBoundary!=null||R.props.errorElement!=null,shouldRevalidate:R.props.shouldRevalidate,handle:R.props.handle,lazy:R.props.lazy};R.props.children&&(A.children=Nm(R.props.children,H)),I.push(A)}),I}var em="get",tm="application/x-www-form-urlencoded";function um(x){return x!=null&&typeof x.tagName=="string"}function Oy(x){return um(x)&&x.tagName.toLowerCase()==="button"}function jy(x){return um(x)&&x.tagName.toLowerCase()==="form"}function Fy(x){return um(x)&&x.tagName.toLowerCase()==="input"}function Ny(x){return!!(x.metaKey||x.altKey||x.ctrlKey||x.shiftKey)}function Uy(x,E){return x.button===0&&(!E||E==="_self")&&!Ny(x)}var Jp=null;function Vy(){if(Jp===null)try{new FormData(document.createElement("form"),0),Jp=!1}catch{Jp=!0}return Jp}var Zy=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Lm(x){return x!=null&&!Zy.has(x)?(Gl(!1,`"${x}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${tm}"`),null):x}function Gy(x,E){let I,R,L,H,A;if(jy(x)){let u=x.getAttribute("action");R=u?qc(u,E):null,I=x.getAttribute("method")||em,L=Lm(x.getAttribute("enctype"))||tm,H=new FormData(x)}else if(Oy(x)||Fy(x)&&(x.type==="submit"||x.type==="image")){let u=x.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let re=x.getAttribute("formaction")||u.getAttribute("action");if(R=re?qc(re,E):null,I=x.getAttribute("formmethod")||u.getAttribute("method")||em,L=Lm(x.getAttribute("formenctype"))||Lm(u.getAttribute("enctype"))||tm,H=new FormData(u,x),!Vy()){let{name:Q,type:ce,value:ze}=x;if(ce==="image"){let _e=Q?`${Q}.`:"";H.append(`${_e}x`,"0"),H.append(`${_e}y`,"0")}else Q&&H.append(Q,ze)}}else{if(um(x))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');I=em,R=null,L=tm,A=x}return H&&L==="text/plain"&&(A=H,H=void 0),{action:R,method:I.toLowerCase(),encType:L,formData:H,body:A}}function tg(x,E){if(x===!1||x===null||typeof x>"u")throw new Error(E)}async function qy(x,E){if(x.id in E)return E[x.id];try{let I=await import(x.module);return E[x.id]=I,I}catch(I){return console.error(`Error loading route module \`${x.module}\`, reloading page...`),console.error(I),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Hy(x){return x==null?!1:x.href==null?x.rel==="preload"&&typeof x.imageSrcSet=="string"&&typeof x.imageSizes=="string":typeof x.rel=="string"&&typeof x.href=="string"}async function $y(x,E,I){let R=await Promise.all(x.map(async L=>{let H=E.routes[L.route.id];if(H){let A=await qy(H,I);return A.links?A.links():[]}return[]}));return Wy(R.flat(1).filter(Hy).filter(L=>L.rel==="stylesheet"||L.rel==="preload").map(L=>L.rel==="stylesheet"?{...L,rel:"prefetch",as:"style"}:{...L,rel:"prefetch"}))}function bg(x,E,I,R,L,H){let A=(re,Q)=>I[Q]?re.route.id!==I[Q].route.id:!0,u=(re,Q)=>{var ce;return I[Q].pathname!==re.pathname||((ce=I[Q].route.path)==null?void 0:ce.endsWith("*"))&&I[Q].params["*"]!==re.params["*"]};return H==="assets"?E.filter((re,Q)=>A(re,Q)||u(re,Q)):H==="data"?E.filter((re,Q)=>{var ze;let ce=R.routes[re.route.id];if(!ce||!ce.hasLoader)return!1;if(A(re,Q)||u(re,Q))return!0;if(re.route.shouldRevalidate){let _e=re.route.shouldRevalidate({currentUrl:new URL(L.pathname+L.search+L.hash,window.origin),currentParams:((ze=I[0])==null?void 0:ze.params)||{},nextUrl:new URL(x,window.origin),nextParams:re.params,defaultShouldRevalidate:!0});if(typeof _e=="boolean")return _e}return!0}):[]}function Xy(x,E,{includeHydrateFallback:I}={}){return Yy(x.map(R=>{let L=E.routes[R.route.id];if(!L)return[];let H=[L.module];return L.clientActionModule&&(H=H.concat(L.clientActionModule)),L.clientLoaderModule&&(H=H.concat(L.clientLoaderModule)),I&&L.hydrateFallbackModule&&(H=H.concat(L.hydrateFallbackModule)),L.imports&&(H=H.concat(L.imports)),H}).flat(1))}function Yy(x){return[...new Set(x)]}function Ky(x){let E={},I=Object.keys(x).sort();for(let R of I)E[R]=x[R];return E}function Wy(x,E){let I=new Set;return new Set(E),x.reduce((R,L)=>{let H=JSON.stringify(Ky(L));return I.has(H)||(I.add(H),R.push({key:H,link:L})),R},[])}function Qy(x,E){let I=typeof x=="string"?new URL(x,typeof window>"u"?"server://singlefetch/":window.location.origin):x;return I.pathname==="/"?I.pathname="_root.data":E&&qc(I.pathname,E)==="/"?I.pathname=`${E.replace(/\/$/,"")}/_root.data`:I.pathname=`${I.pathname.replace(/\/$/,"")}.data`,I}function Wg(){let x=Pe.useContext(Wd);return tg(x,"You must render this element inside a <DataRouterContext.Provider> element"),x}function Jy(){let x=Pe.useContext(cm);return tg(x,"You must render this element inside a <DataRouterStateContext.Provider> element"),x}var ig=Pe.createContext(void 0);ig.displayName="FrameworkContext";function Qg(){let x=Pe.useContext(ig);return tg(x,"You must render this element inside a <HydratedRouter> element"),x}function e0(x,E){let I=Pe.useContext(ig),[R,L]=Pe.useState(!1),[H,A]=Pe.useState(!1),{onFocus:u,onBlur:re,onMouseEnter:Q,onMouseLeave:ce,onTouchStart:ze}=E,_e=Pe.useRef(null);Pe.useEffect(()=>{if(x==="render"&&A(!0),x==="viewport"){let je=Oe=>{Oe.forEach(Fe=>{A(Fe.isIntersecting)})},Me=new IntersectionObserver(je,{threshold:.5});return _e.current&&Me.observe(_e.current),()=>{Me.disconnect()}}},[x]),Pe.useEffect(()=>{if(R){let je=setTimeout(()=>{A(!0)},100);return()=>{clearTimeout(je)}}},[R]);let ie=()=>{L(!0)},he=()=>{L(!1),A(!1)};return I?x!=="intent"?[H,_e,{}]:[H,_e,{onFocus:ip(u,ie),onBlur:ip(re,he),onMouseEnter:ip(Q,ie),onMouseLeave:ip(ce,he),onTouchStart:ip(ze,ie)}]:[!1,_e,{}]}function ip(x,E){return I=>{x&&x(I),I.defaultPrevented||E(I)}}function t0({page:x,...E}){let{router:I}=Wg(),R=Pe.useMemo(()=>Ng(I.routes,x,I.basename),[I.routes,x,I.basename]);return R?Pe.createElement(n0,{page:x,matches:R,...E}):null}function i0(x){let{manifest:E,routeModules:I}=Qg(),[R,L]=Pe.useState([]);return Pe.useEffect(()=>{let H=!1;return $y(x,E,I).then(A=>{H||L(A)}),()=>{H=!0}},[x,E,I]),R}function n0({page:x,matches:E,...I}){let R=Yh(),{manifest:L,routeModules:H}=Qg(),{basename:A}=Wg(),{loaderData:u,matches:re}=Jy(),Q=Pe.useMemo(()=>bg(x,E,re,L,R,"data"),[x,E,re,L,R]),ce=Pe.useMemo(()=>bg(x,E,re,L,R,"assets"),[x,E,re,L,R]),ze=Pe.useMemo(()=>{if(x===R.pathname+R.search+R.hash)return[];let he=new Set,je=!1;if(E.forEach(Oe=>{var qe;let Fe=L.routes[Oe.route.id];!Fe||!Fe.hasLoader||(!Q.some(dt=>dt.route.id===Oe.route.id)&&Oe.route.id in u&&((qe=H[Oe.route.id])!=null&&qe.shouldRevalidate)||Fe.hasClientLoader?je=!0:he.add(Oe.route.id))}),he.size===0)return[];let Me=Qy(x,A);return je&&he.size>0&&Me.searchParams.set("_routes",E.filter(Oe=>he.has(Oe.route.id)).map(Oe=>Oe.route.id).join(",")),[Me.pathname+Me.search]},[A,u,R,L,Q,E,x,H]),_e=Pe.useMemo(()=>Xy(ce,L),[ce,L]),ie=i0(ce);return Pe.createElement(Pe.Fragment,null,ze.map(he=>Pe.createElement("link",{key:he,rel:"prefetch",as:"fetch",href:he,...I})),_e.map(he=>Pe.createElement("link",{key:he,rel:"modulepreload",href:he,...I})),ie.map(({key:he,link:je})=>Pe.createElement("link",{key:he,...je})))}function r0(...x){return E=>{x.forEach(I=>{typeof I=="function"?I(E):I!=null&&(I.current=E)})}}var Jg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Jg&&(window.__reactRouterVersion="7.5.0")}catch{}function a0({basename:x,children:E,window:I}){let R=Pe.useRef();R.current==null&&(R.current=$_({window:I,v5Compat:!0}));let L=R.current,[H,A]=Pe.useState({action:L.action,location:L.location}),u=Pe.useCallback(re=>{Pe.startTransition(()=>A(re))},[A]);return Pe.useLayoutEffect(()=>L.listen(u),[L,u]),Pe.createElement(Ly,{basename:x,children:E,location:H.location,navigationType:H.action,navigator:L})}var e_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,t_=Pe.forwardRef(function({onClick:E,discover:I="render",prefetch:R="none",relative:L,reloadDocument:H,replace:A,state:u,target:re,to:Q,preventScrollReset:ce,viewTransition:ze,..._e},ie){let{basename:he}=Pe.useContext(ql),je=typeof Q=="string"&&e_.test(Q),Me,Oe=!1;if(typeof Q=="string"&&je&&(Me=Q,Jg))try{let Qt=new URL(window.location.href),Bi=Q.startsWith("//")?new URL(Qt.protocol+Q):new URL(Q),Si=qc(Bi.pathname,he);Bi.origin===Qt.origin&&Si!=null?Q=Si+Bi.search+Bi.hash:Oe=!0}catch{Gl(!1,`<Link to="${Q}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Fe=vy(Q,{relative:L}),[qe,dt,mt]=e0(R,_e),zt=c0(Q,{replace:A,state:u,target:re,preventScrollReset:ce,relative:L,viewTransition:ze});function yt(Qt){E&&E(Qt),Qt.defaultPrevented||zt(Qt)}let St=Pe.createElement("a",{..._e,...mt,href:Me||Fe,onClick:Oe||H?E:yt,ref:r0(ie,dt),target:re,"data-discover":!je&&I==="render"?"true":void 0});return qe&&!je?Pe.createElement(Pe.Fragment,null,St,Pe.createElement(t0,{page:Fe})):St});t_.displayName="Link";var o0=Pe.forwardRef(function({"aria-current":E="page",caseSensitive:I=!1,className:R="",end:L=!1,style:H,to:A,viewTransition:u,children:re,...Q},ce){let ze=cp(A,{relative:Q.relative}),_e=Yh(),ie=Pe.useContext(cm),{navigator:he,basename:je}=Pe.useContext(ql),Me=ie!=null&&p0(ze)&&u===!0,Oe=he.encodeLocation?he.encodeLocation(ze).pathname:ze.pathname,Fe=_e.pathname,qe=ie&&ie.navigation&&ie.navigation.location?ie.navigation.location.pathname:null;I||(Fe=Fe.toLowerCase(),qe=qe?qe.toLowerCase():null,Oe=Oe.toLowerCase()),qe&&je&&(qe=qc(qe,je)||qe);const dt=Oe!=="/"&&Oe.endsWith("/")?Oe.length-1:Oe.length;let mt=Fe===Oe||!L&&Fe.startsWith(Oe)&&Fe.charAt(dt)==="/",zt=qe!=null&&(qe===Oe||!L&&qe.startsWith(Oe)&&qe.charAt(Oe.length)==="/"),yt={isActive:mt,isPending:zt,isTransitioning:Me},St=mt?E:void 0,Qt;typeof R=="function"?Qt=R(yt):Qt=[R,mt?"active":null,zt?"pending":null,Me?"transitioning":null].filter(Boolean).join(" ");let Bi=typeof H=="function"?H(yt):H;return Pe.createElement(t_,{...Q,"aria-current":St,className:Qt,ref:ce,style:Bi,to:A,viewTransition:u},typeof re=="function"?re(yt):re)});o0.displayName="NavLink";var s0=Pe.forwardRef(({discover:x="render",fetcherKey:E,navigate:I,reloadDocument:R,replace:L,state:H,method:A=em,action:u,onSubmit:re,relative:Q,preventScrollReset:ce,viewTransition:ze,..._e},ie)=>{let he=d0(),je=f0(u,{relative:Q}),Me=A.toLowerCase()==="get"?"get":"post",Oe=typeof u=="string"&&e_.test(u),Fe=qe=>{if(re&&re(qe),qe.defaultPrevented)return;qe.preventDefault();let dt=qe.nativeEvent.submitter,mt=(dt==null?void 0:dt.getAttribute("formmethod"))||A;he(dt||qe.currentTarget,{fetcherKey:E,method:mt,navigate:I,replace:L,state:H,relative:Q,preventScrollReset:ce,viewTransition:ze})};return Pe.createElement("form",{ref:ie,method:Me,action:je,onSubmit:R?re:Fe,..._e,"data-discover":!Oe&&x==="render"?"true":void 0})});s0.displayName="Form";function l0(x){return`${x} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function i_(x){let E=Pe.useContext(Wd);return sr(E,l0(x)),E}function c0(x,{target:E,replace:I,state:R,preventScrollReset:L,relative:H,viewTransition:A}={}){let u=$c(),re=Yh(),Q=cp(x,{relative:H});return Pe.useCallback(ce=>{if(Uy(ce,E)){ce.preventDefault();let ze=I!==void 0?I:rp(re)===rp(Q);u(x,{replace:ze,state:R,preventScrollReset:L,relative:H,viewTransition:A})}},[re,u,Q,I,R,E,x,L,H,A])}var u0=0,h0=()=>`__${String(++u0)}__`;function d0(){let{router:x}=i_("useSubmit"),{basename:E}=Pe.useContext(ql),I=Py();return Pe.useCallback(async(R,L={})=>{let{action:H,method:A,encType:u,formData:re,body:Q}=Gy(R,E);if(L.navigate===!1){let ce=L.fetcherKey||h0();await x.fetch(ce,I,L.action||H,{preventScrollReset:L.preventScrollReset,formData:re,body:Q,formMethod:L.method||A,formEncType:L.encType||u,flushSync:L.flushSync})}else await x.navigate(L.action||H,{preventScrollReset:L.preventScrollReset,formData:re,body:Q,formMethod:L.method||A,formEncType:L.encType||u,replace:L.replace,state:L.state,fromRouteId:I,flushSync:L.flushSync,viewTransition:L.viewTransition})},[x,E,I])}function f0(x,{relative:E}={}){let{basename:I}=Pe.useContext(ql),R=Pe.useContext(Hl);sr(R,"useFormAction must be used inside a RouteContext");let[L]=R.matches.slice(-1),H={...cp(x||".",{relative:E})},A=Yh();if(x==null){H.search=A.search;let u=new URLSearchParams(H.search),re=u.getAll("index");if(re.some(ce=>ce==="")){u.delete("index"),re.filter(ze=>ze).forEach(ze=>u.append("index",ze));let ce=u.toString();H.search=ce?`?${ce}`:""}}return(!x||x===".")&&L.route.index&&(H.search=H.search?H.search.replace(/^\?/,"?index&"):"?index"),I!=="/"&&(H.pathname=H.pathname==="/"?I:Gc([I,H.pathname])),rp(H)}function p0(x,E={}){let I=Pe.useContext(Hg);sr(I!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:R}=i_("useViewTransitionState"),L=cp(x,{relative:E.relative});if(!I.isTransitioning)return!1;let H=qc(I.currentLocation.pathname,R)||I.currentLocation.pathname,A=qc(I.nextLocation.pathname,R)||I.nextLocation.pathname;return om(L.pathname,A)!=null||om(L.pathname,H)!=null}new TextEncoder;function m0(){const x=$c(),[E,I]=Pe.useState(!1),R=()=>{x("/signin")},L=()=>{x("/about")};return F.jsxs("div",{style:Xi.page,children:[F.jsxs("nav",{style:Xi.nav,children:[F.jsxs("div",{style:Xi.logoContainer,children:[F.jsx("span",{style:Xi.logoIcon,children:"🏠"}),F.jsx("span",{style:Xi.logoText,children:"Housing47"})]}),F.jsxs("div",{style:Xi.navLinks,children:[F.jsx("button",{onClick:L,style:Xi.navLink,children:"About"}),F.jsx("button",{onClick:R,style:Xi.loginButton,children:"Login"})]})]}),F.jsx("div",{style:Xi.heroSection,children:F.jsx("div",{style:Xi.heroContainer,children:F.jsxs("div",{style:Xi.mainContent,children:[F.jsxs("h1",{style:Xi.heading,children:["Find your perfect ",F.jsx("span",{style:Xi.headingAccent,children:"room"})]}),F.jsx("p",{style:Xi.subheading,children:"Smart housing search tailored for students. Browse rooms, connect with friends, and find your ideal space."}),F.jsx("div",{style:Xi.buttonContainer,children:F.jsx("button",{onClick:R,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),style:{...Xi.primaryButton,backgroundColor:E?"#4338ca":"#4f46e5",boxShadow:E?"0 10px 15px -3px rgba(79, 70, 229, 0.2)":"0 10px 15px -3px rgba(0, 0, 0, 0.1)"},children:"Get Started"})}),F.jsxs("div",{style:Xi.featuresGrid,children:[F.jsxs("div",{style:Xi.featureItem,children:[F.jsx("div",{style:Xi.featureIcon,children:"✓"}),F.jsxs("div",{children:[F.jsx("h3",{style:Xi.featureTitle,children:"Available Rooms"}),F.jsx("p",{style:Xi.featureDescription,children:"See which rooms speak out to you"})]})]}),F.jsxs("div",{style:Xi.featureItem,children:[F.jsx("div",{style:Xi.featureIcon,children:"✓"}),F.jsxs("div",{children:[F.jsx("h3",{style:Xi.featureTitle,children:"Roommate Selection"}),F.jsx("p",{style:Xi.featureDescription,children:"Create the perfect roommate group"})]})]})]})]})})}),F.jsx("footer",{style:Xi.footer,children:F.jsxs("div",{style:Xi.footerContainer,children:[F.jsx("div",{style:Xi.copyright,children:"© 2025 Housing47. All rights reserved."}),F.jsxs("div",{style:Xi.footerLinks,children:[F.jsx("a",{href:"#",style:Xi.footerLink,children:"Privacy"}),F.jsx("a",{href:"#",style:Xi.footerLink,children:"Terms"}),F.jsx("a",{href:"#",style:Xi.footerLink,children:"Support"})]})]})})]})}const Xi={page:{minHeight:"100vh",background:"linear-gradient(to bottom right, #EBF4FF, #E0E7FF)",display:"flex",flexDirection:"column",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif"},nav:{padding:"1rem 1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},logoContainer:{display:"flex",alignItems:"center",gap:"0.5rem"},logoIcon:{fontSize:"2rem"},logoText:{fontWeight:"bold",fontSize:"1.25rem",color:"#4F46E5"},navLinks:{display:"flex",alignItems:"center",gap:"1rem"},navLink:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#4F46E5",fontWeight:"500",background:"none",border:"none",cursor:"pointer",transition:"background-color 0.2s"},loginButton:{padding:"0.5rem 1rem",backgroundColor:"#4F46E5",color:"white",borderRadius:"0.5rem",fontWeight:"500",border:"none",cursor:"pointer",transition:"background-color 0.2s"},heroSection:{flex:"1",display:"flex",alignItems:"center",justifyContent:"center",padding:"3rem 1.5rem"},heroContainer:{display:"flex",justifyContent:"center",maxWidth:"800px",width:"100%"},mainContent:{display:"flex",flexDirection:"column",gap:"1.5rem",textAlign:"center",maxWidth:"600px"},heading:{fontSize:"2.5rem",fontWeight:"bold",color:"#1F2937",lineHeight:"1.2",margin:0},headingAccent:{color:"#4F46E5"},subheading:{fontSize:"1.125rem",color:"#4B5563",margin:0},buttonContainer:{paddingTop:"1rem",display:"flex",justifyContent:"center"},primaryButton:{padding:"0.75rem 2rem",backgroundColor:"#4F46E5",color:"white",borderRadius:"0.75rem",fontWeight:"500",fontSize:"1.125rem",border:"none",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"},featuresGrid:{display:"flex",justifyContent:"center",gap:"2rem",paddingTop:"1.5rem"},featureItem:{display:"flex",alignItems:"flex-start",gap:"0.5rem"},featureIcon:{padding:"0.5rem",backgroundColor:"#EEF2FF",borderRadius:"0.5rem",color:"#4F46E5"},featureTitle:{fontWeight:"500",margin:"0"},featureDescription:{fontSize:"0.875rem",color:"#6B7280",margin:"0",textAlign:"left"},footer:{padding:"1.5rem",textAlign:"center",color:"#6B7280",fontSize:"0.875rem",borderTop:"1px solid rgba(229, 231, 235, 0.5)"},footerContainer:{maxWidth:"1200px",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",gap:"1rem"},copyright:{marginBottom:"1rem"},footerLinks:{display:"flex",gap:"1.5rem"},footerLink:{color:"#6B7280",textDecoration:"none",transition:"color 0.2s"}};function n_(x,E){return function(){return x.apply(E,arguments)}}const{toString:g0}=Object.prototype,{getPrototypeOf:ng}=Object,hm=(x=>E=>{const I=g0.call(E);return x[I]||(x[I]=I.slice(8,-1).toLowerCase())})(Object.create(null)),fl=x=>(x=x.toLowerCase(),E=>hm(E)===x),dm=x=>E=>typeof E===x,{isArray:Qd}=Array,ap=dm("undefined");function _0(x){return x!==null&&!ap(x)&&x.constructor!==null&&!ap(x.constructor)&&qo(x.constructor.isBuffer)&&x.constructor.isBuffer(x)}const r_=fl("ArrayBuffer");function y0(x){let E;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?E=ArrayBuffer.isView(x):E=x&&x.buffer&&r_(x.buffer),E}const v0=dm("string"),qo=dm("function"),a_=dm("number"),fm=x=>x!==null&&typeof x=="object",x0=x=>x===!0||x===!1,im=x=>{if(hm(x)!=="object")return!1;const E=ng(x);return(E===null||E===Object.prototype||Object.getPrototypeOf(E)===null)&&!(Symbol.toStringTag in x)&&!(Symbol.iterator in x)},b0=fl("Date"),w0=fl("File"),T0=fl("Blob"),S0=fl("FileList"),E0=x=>fm(x)&&qo(x.pipe),C0=x=>{let E;return x&&(typeof FormData=="function"&&x instanceof FormData||qo(x.append)&&((E=hm(x))==="formdata"||E==="object"&&qo(x.toString)&&x.toString()==="[object FormData]"))},M0=fl("URLSearchParams"),[A0,z0,R0,P0]=["ReadableStream","Request","Response","Headers"].map(fl),I0=x=>x.trim?x.trim():x.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function up(x,E,{allOwnKeys:I=!1}={}){if(x===null||typeof x>"u")return;let R,L;if(typeof x!="object"&&(x=[x]),Qd(x))for(R=0,L=x.length;R<L;R++)E.call(null,x[R],R,x);else{const H=I?Object.getOwnPropertyNames(x):Object.keys(x),A=H.length;let u;for(R=0;R<A;R++)u=H[R],E.call(null,x[u],u,x)}}function o_(x,E){E=E.toLowerCase();const I=Object.keys(x);let R=I.length,L;for(;R-- >0;)if(L=I[R],E===L.toLowerCase())return L;return null}const Gh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,s_=x=>!ap(x)&&x!==Gh;function Um(){const{caseless:x}=s_(this)&&this||{},E={},I=(R,L)=>{const H=x&&o_(E,L)||L;im(E[H])&&im(R)?E[H]=Um(E[H],R):im(R)?E[H]=Um({},R):Qd(R)?E[H]=R.slice():E[H]=R};for(let R=0,L=arguments.length;R<L;R++)arguments[R]&&up(arguments[R],I);return E}const D0=(x,E,I,{allOwnKeys:R}={})=>(up(E,(L,H)=>{I&&qo(L)?x[H]=n_(L,I):x[H]=L},{allOwnKeys:R}),x),k0=x=>(x.charCodeAt(0)===65279&&(x=x.slice(1)),x),L0=(x,E,I,R)=>{x.prototype=Object.create(E.prototype,R),x.prototype.constructor=x,Object.defineProperty(x,"super",{value:E.prototype}),I&&Object.assign(x.prototype,I)},B0=(x,E,I,R)=>{let L,H,A;const u={};if(E=E||{},x==null)return E;do{for(L=Object.getOwnPropertyNames(x),H=L.length;H-- >0;)A=L[H],(!R||R(A,x,E))&&!u[A]&&(E[A]=x[A],u[A]=!0);x=I!==!1&&ng(x)}while(x&&(!I||I(x,E))&&x!==Object.prototype);return E},O0=(x,E,I)=>{x=String(x),(I===void 0||I>x.length)&&(I=x.length),I-=E.length;const R=x.indexOf(E,I);return R!==-1&&R===I},j0=x=>{if(!x)return null;if(Qd(x))return x;let E=x.length;if(!a_(E))return null;const I=new Array(E);for(;E-- >0;)I[E]=x[E];return I},F0=(x=>E=>x&&E instanceof x)(typeof Uint8Array<"u"&&ng(Uint8Array)),N0=(x,E)=>{const R=(x&&x[Symbol.iterator]).call(x);let L;for(;(L=R.next())&&!L.done;){const H=L.value;E.call(x,H[0],H[1])}},U0=(x,E)=>{let I;const R=[];for(;(I=x.exec(E))!==null;)R.push(I);return R},V0=fl("HTMLFormElement"),Z0=x=>x.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(I,R,L){return R.toUpperCase()+L}),wg=(({hasOwnProperty:x})=>(E,I)=>x.call(E,I))(Object.prototype),G0=fl("RegExp"),l_=(x,E)=>{const I=Object.getOwnPropertyDescriptors(x),R={};up(I,(L,H)=>{let A;(A=E(L,H,x))!==!1&&(R[H]=A||L)}),Object.defineProperties(x,R)},q0=x=>{l_(x,(E,I)=>{if(qo(x)&&["arguments","caller","callee"].indexOf(I)!==-1)return!1;const R=x[I];if(qo(R)){if(E.enumerable=!1,"writable"in E){E.writable=!1;return}E.set||(E.set=()=>{throw Error("Can not rewrite read-only method '"+I+"'")})}})},H0=(x,E)=>{const I={},R=L=>{L.forEach(H=>{I[H]=!0})};return Qd(x)?R(x):R(String(x).split(E)),I},$0=()=>{},X0=(x,E)=>x!=null&&Number.isFinite(x=+x)?x:E;function Y0(x){return!!(x&&qo(x.append)&&x[Symbol.toStringTag]==="FormData"&&x[Symbol.iterator])}const K0=x=>{const E=new Array(10),I=(R,L)=>{if(fm(R)){if(E.indexOf(R)>=0)return;if(!("toJSON"in R)){E[L]=R;const H=Qd(R)?[]:{};return up(R,(A,u)=>{const re=I(A,L+1);!ap(re)&&(H[u]=re)}),E[L]=void 0,H}}return R};return I(x,0)},W0=fl("AsyncFunction"),Q0=x=>x&&(fm(x)||qo(x))&&qo(x.then)&&qo(x.catch),c_=((x,E)=>x?setImmediate:E?((I,R)=>(Gh.addEventListener("message",({source:L,data:H})=>{L===Gh&&H===I&&R.length&&R.shift()()},!1),L=>{R.push(L),Gh.postMessage(I,"*")}))(`axios@${Math.random()}`,[]):I=>setTimeout(I))(typeof setImmediate=="function",qo(Gh.postMessage)),J0=typeof queueMicrotask<"u"?queueMicrotask.bind(Gh):typeof process<"u"&&process.nextTick||c_,tt={isArray:Qd,isArrayBuffer:r_,isBuffer:_0,isFormData:C0,isArrayBufferView:y0,isString:v0,isNumber:a_,isBoolean:x0,isObject:fm,isPlainObject:im,isReadableStream:A0,isRequest:z0,isResponse:R0,isHeaders:P0,isUndefined:ap,isDate:b0,isFile:w0,isBlob:T0,isRegExp:G0,isFunction:qo,isStream:E0,isURLSearchParams:M0,isTypedArray:F0,isFileList:S0,forEach:up,merge:Um,extend:D0,trim:I0,stripBOM:k0,inherits:L0,toFlatObject:B0,kindOf:hm,kindOfTest:fl,endsWith:O0,toArray:j0,forEachEntry:N0,matchAll:U0,isHTMLForm:V0,hasOwnProperty:wg,hasOwnProp:wg,reduceDescriptors:l_,freezeMethods:q0,toObjectSet:H0,toCamelCase:Z0,noop:$0,toFiniteNumber:X0,findKey:o_,global:Gh,isContextDefined:s_,isSpecCompliantForm:Y0,toJSONObject:K0,isAsyncFn:W0,isThenable:Q0,setImmediate:c_,asap:J0};function gi(x,E,I,R,L){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=x,this.name="AxiosError",E&&(this.code=E),I&&(this.config=I),R&&(this.request=R),L&&(this.response=L,this.status=L.status?L.status:null)}tt.inherits(gi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:tt.toJSONObject(this.config),code:this.code,status:this.status}}});const u_=gi.prototype,h_={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(x=>{h_[x]={value:x}});Object.defineProperties(gi,h_);Object.defineProperty(u_,"isAxiosError",{value:!0});gi.from=(x,E,I,R,L,H)=>{const A=Object.create(u_);return tt.toFlatObject(x,A,function(re){return re!==Error.prototype},u=>u!=="isAxiosError"),gi.call(A,x.message,E,I,R,L),A.cause=x,A.name=x.name,H&&Object.assign(A,H),A};const ev=null;function Vm(x){return tt.isPlainObject(x)||tt.isArray(x)}function d_(x){return tt.endsWith(x,"[]")?x.slice(0,-2):x}function Tg(x,E,I){return x?x.concat(E).map(function(L,H){return L=d_(L),!I&&H?"["+L+"]":L}).join(I?".":""):E}function tv(x){return tt.isArray(x)&&!x.some(Vm)}const iv=tt.toFlatObject(tt,{},null,function(E){return/^is[A-Z]/.test(E)});function pm(x,E,I){if(!tt.isObject(x))throw new TypeError("target must be an object");E=E||new FormData,I=tt.toFlatObject(I,{metaTokens:!0,dots:!1,indexes:!1},!1,function(je,Me){return!tt.isUndefined(Me[je])});const R=I.metaTokens,L=I.visitor||ce,H=I.dots,A=I.indexes,re=(I.Blob||typeof Blob<"u"&&Blob)&&tt.isSpecCompliantForm(E);if(!tt.isFunction(L))throw new TypeError("visitor must be a function");function Q(he){if(he===null)return"";if(tt.isDate(he))return he.toISOString();if(!re&&tt.isBlob(he))throw new gi("Blob is not supported. Use a Buffer instead.");return tt.isArrayBuffer(he)||tt.isTypedArray(he)?re&&typeof Blob=="function"?new Blob([he]):Buffer.from(he):he}function ce(he,je,Me){let Oe=he;if(he&&!Me&&typeof he=="object"){if(tt.endsWith(je,"{}"))je=R?je:je.slice(0,-2),he=JSON.stringify(he);else if(tt.isArray(he)&&tv(he)||(tt.isFileList(he)||tt.endsWith(je,"[]"))&&(Oe=tt.toArray(he)))return je=d_(je),Oe.forEach(function(qe,dt){!(tt.isUndefined(qe)||qe===null)&&E.append(A===!0?Tg([je],dt,H):A===null?je:je+"[]",Q(qe))}),!1}return Vm(he)?!0:(E.append(Tg(Me,je,H),Q(he)),!1)}const ze=[],_e=Object.assign(iv,{defaultVisitor:ce,convertValue:Q,isVisitable:Vm});function ie(he,je){if(!tt.isUndefined(he)){if(ze.indexOf(he)!==-1)throw Error("Circular reference detected in "+je.join("."));ze.push(he),tt.forEach(he,function(Oe,Fe){(!(tt.isUndefined(Oe)||Oe===null)&&L.call(E,Oe,tt.isString(Fe)?Fe.trim():Fe,je,_e))===!0&&ie(Oe,je?je.concat(Fe):[Fe])}),ze.pop()}}if(!tt.isObject(x))throw new TypeError("data must be an object");return ie(x),E}function Sg(x){const E={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(x).replace(/[!'()~]|%20|%00/g,function(R){return E[R]})}function rg(x,E){this._pairs=[],x&&pm(x,this,E)}const f_=rg.prototype;f_.append=function(E,I){this._pairs.push([E,I])};f_.toString=function(E){const I=E?function(R){return E.call(this,R,Sg)}:Sg;return this._pairs.map(function(L){return I(L[0])+"="+I(L[1])},"").join("&")};function nv(x){return encodeURIComponent(x).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function p_(x,E,I){if(!E)return x;const R=I&&I.encode||nv;tt.isFunction(I)&&(I={serialize:I});const L=I&&I.serialize;let H;if(L?H=L(E,I):H=tt.isURLSearchParams(E)?E.toString():new rg(E,I).toString(R),H){const A=x.indexOf("#");A!==-1&&(x=x.slice(0,A)),x+=(x.indexOf("?")===-1?"?":"&")+H}return x}class Eg{constructor(){this.handlers=[]}use(E,I,R){return this.handlers.push({fulfilled:E,rejected:I,synchronous:R?R.synchronous:!1,runWhen:R?R.runWhen:null}),this.handlers.length-1}eject(E){this.handlers[E]&&(this.handlers[E]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(E){tt.forEach(this.handlers,function(R){R!==null&&E(R)})}}const m_={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},rv=typeof URLSearchParams<"u"?URLSearchParams:rg,av=typeof FormData<"u"?FormData:null,ov=typeof Blob<"u"?Blob:null,sv={isBrowser:!0,classes:{URLSearchParams:rv,FormData:av,Blob:ov},protocols:["http","https","file","blob","url","data"]},ag=typeof window<"u"&&typeof document<"u",Zm=typeof navigator=="object"&&navigator||void 0,lv=ag&&(!Zm||["ReactNative","NativeScript","NS"].indexOf(Zm.product)<0),cv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",uv=ag&&window.location.href||"http://localhost",hv=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ag,hasStandardBrowserEnv:lv,hasStandardBrowserWebWorkerEnv:cv,navigator:Zm,origin:uv},Symbol.toStringTag,{value:"Module"})),Aa={...hv,...sv};function dv(x,E){return pm(x,new Aa.classes.URLSearchParams,Object.assign({visitor:function(I,R,L,H){return Aa.isNode&&tt.isBuffer(I)?(this.append(R,I.toString("base64")),!1):H.defaultVisitor.apply(this,arguments)}},E))}function fv(x){return tt.matchAll(/\w+|\[(\w*)]/g,x).map(E=>E[0]==="[]"?"":E[1]||E[0])}function pv(x){const E={},I=Object.keys(x);let R;const L=I.length;let H;for(R=0;R<L;R++)H=I[R],E[H]=x[H];return E}function g_(x){function E(I,R,L,H){let A=I[H++];if(A==="__proto__")return!0;const u=Number.isFinite(+A),re=H>=I.length;return A=!A&&tt.isArray(L)?L.length:A,re?(tt.hasOwnProp(L,A)?L[A]=[L[A],R]:L[A]=R,!u):((!L[A]||!tt.isObject(L[A]))&&(L[A]=[]),E(I,R,L[A],H)&&tt.isArray(L[A])&&(L[A]=pv(L[A])),!u)}if(tt.isFormData(x)&&tt.isFunction(x.entries)){const I={};return tt.forEachEntry(x,(R,L)=>{E(fv(R),L,I,0)}),I}return null}function mv(x,E,I){if(tt.isString(x))try{return(E||JSON.parse)(x),tt.trim(x)}catch(R){if(R.name!=="SyntaxError")throw R}return(I||JSON.stringify)(x)}const hp={transitional:m_,adapter:["xhr","http","fetch"],transformRequest:[function(E,I){const R=I.getContentType()||"",L=R.indexOf("application/json")>-1,H=tt.isObject(E);if(H&&tt.isHTMLForm(E)&&(E=new FormData(E)),tt.isFormData(E))return L?JSON.stringify(g_(E)):E;if(tt.isArrayBuffer(E)||tt.isBuffer(E)||tt.isStream(E)||tt.isFile(E)||tt.isBlob(E)||tt.isReadableStream(E))return E;if(tt.isArrayBufferView(E))return E.buffer;if(tt.isURLSearchParams(E))return I.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),E.toString();let u;if(H){if(R.indexOf("application/x-www-form-urlencoded")>-1)return dv(E,this.formSerializer).toString();if((u=tt.isFileList(E))||R.indexOf("multipart/form-data")>-1){const re=this.env&&this.env.FormData;return pm(u?{"files[]":E}:E,re&&new re,this.formSerializer)}}return H||L?(I.setContentType("application/json",!1),mv(E)):E}],transformResponse:[function(E){const I=this.transitional||hp.transitional,R=I&&I.forcedJSONParsing,L=this.responseType==="json";if(tt.isResponse(E)||tt.isReadableStream(E))return E;if(E&&tt.isString(E)&&(R&&!this.responseType||L)){const A=!(I&&I.silentJSONParsing)&&L;try{return JSON.parse(E)}catch(u){if(A)throw u.name==="SyntaxError"?gi.from(u,gi.ERR_BAD_RESPONSE,this,null,this.response):u}}return E}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Aa.classes.FormData,Blob:Aa.classes.Blob},validateStatus:function(E){return E>=200&&E<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};tt.forEach(["delete","get","head","post","put","patch"],x=>{hp.headers[x]={}});const gv=tt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),_v=x=>{const E={};let I,R,L;return x&&x.split(`
`).forEach(function(A){L=A.indexOf(":"),I=A.substring(0,L).trim().toLowerCase(),R=A.substring(L+1).trim(),!(!I||E[I]&&gv[I])&&(I==="set-cookie"?E[I]?E[I].push(R):E[I]=[R]:E[I]=E[I]?E[I]+", "+R:R)}),E},Cg=Symbol("internals");function np(x){return x&&String(x).trim().toLowerCase()}function nm(x){return x===!1||x==null?x:tt.isArray(x)?x.map(nm):String(x)}function yv(x){const E=Object.create(null),I=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let R;for(;R=I.exec(x);)E[R[1]]=R[2];return E}const vv=x=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(x.trim());function Bm(x,E,I,R,L){if(tt.isFunction(R))return R.call(this,E,I);if(L&&(E=I),!!tt.isString(E)){if(tt.isString(R))return E.indexOf(R)!==-1;if(tt.isRegExp(R))return R.test(E)}}function xv(x){return x.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(E,I,R)=>I.toUpperCase()+R)}function bv(x,E){const I=tt.toCamelCase(" "+E);["get","set","has"].forEach(R=>{Object.defineProperty(x,R+I,{value:function(L,H,A){return this[R].call(this,E,L,H,A)},configurable:!0})})}let yo=class{constructor(E){E&&this.set(E)}set(E,I,R){const L=this;function H(u,re,Q){const ce=np(re);if(!ce)throw new Error("header name must be a non-empty string");const ze=tt.findKey(L,ce);(!ze||L[ze]===void 0||Q===!0||Q===void 0&&L[ze]!==!1)&&(L[ze||re]=nm(u))}const A=(u,re)=>tt.forEach(u,(Q,ce)=>H(Q,ce,re));if(tt.isPlainObject(E)||E instanceof this.constructor)A(E,I);else if(tt.isString(E)&&(E=E.trim())&&!vv(E))A(_v(E),I);else if(tt.isHeaders(E))for(const[u,re]of E.entries())H(re,u,R);else E!=null&&H(I,E,R);return this}get(E,I){if(E=np(E),E){const R=tt.findKey(this,E);if(R){const L=this[R];if(!I)return L;if(I===!0)return yv(L);if(tt.isFunction(I))return I.call(this,L,R);if(tt.isRegExp(I))return I.exec(L);throw new TypeError("parser must be boolean|regexp|function")}}}has(E,I){if(E=np(E),E){const R=tt.findKey(this,E);return!!(R&&this[R]!==void 0&&(!I||Bm(this,this[R],R,I)))}return!1}delete(E,I){const R=this;let L=!1;function H(A){if(A=np(A),A){const u=tt.findKey(R,A);u&&(!I||Bm(R,R[u],u,I))&&(delete R[u],L=!0)}}return tt.isArray(E)?E.forEach(H):H(E),L}clear(E){const I=Object.keys(this);let R=I.length,L=!1;for(;R--;){const H=I[R];(!E||Bm(this,this[H],H,E,!0))&&(delete this[H],L=!0)}return L}normalize(E){const I=this,R={};return tt.forEach(this,(L,H)=>{const A=tt.findKey(R,H);if(A){I[A]=nm(L),delete I[H];return}const u=E?xv(H):String(H).trim();u!==H&&delete I[H],I[u]=nm(L),R[u]=!0}),this}concat(...E){return this.constructor.concat(this,...E)}toJSON(E){const I=Object.create(null);return tt.forEach(this,(R,L)=>{R!=null&&R!==!1&&(I[L]=E&&tt.isArray(R)?R.join(", "):R)}),I}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([E,I])=>E+": "+I).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(E){return E instanceof this?E:new this(E)}static concat(E,...I){const R=new this(E);return I.forEach(L=>R.set(L)),R}static accessor(E){const R=(this[Cg]=this[Cg]={accessors:{}}).accessors,L=this.prototype;function H(A){const u=np(A);R[u]||(bv(L,A),R[u]=!0)}return tt.isArray(E)?E.forEach(H):H(E),this}};yo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);tt.reduceDescriptors(yo.prototype,({value:x},E)=>{let I=E[0].toUpperCase()+E.slice(1);return{get:()=>x,set(R){this[I]=R}}});tt.freezeMethods(yo);function Om(x,E){const I=this||hp,R=E||I,L=yo.from(R.headers);let H=R.data;return tt.forEach(x,function(u){H=u.call(I,H,L.normalize(),E?E.status:void 0)}),L.normalize(),H}function __(x){return!!(x&&x.__CANCEL__)}function Jd(x,E,I){gi.call(this,x??"canceled",gi.ERR_CANCELED,E,I),this.name="CanceledError"}tt.inherits(Jd,gi,{__CANCEL__:!0});function y_(x,E,I){const R=I.config.validateStatus;!I.status||!R||R(I.status)?x(I):E(new gi("Request failed with status code "+I.status,[gi.ERR_BAD_REQUEST,gi.ERR_BAD_RESPONSE][Math.floor(I.status/100)-4],I.config,I.request,I))}function wv(x){const E=/^([-+\w]{1,25})(:?\/\/|:)/.exec(x);return E&&E[1]||""}function Tv(x,E){x=x||10;const I=new Array(x),R=new Array(x);let L=0,H=0,A;return E=E!==void 0?E:1e3,function(re){const Q=Date.now(),ce=R[H];A||(A=Q),I[L]=re,R[L]=Q;let ze=H,_e=0;for(;ze!==L;)_e+=I[ze++],ze=ze%x;if(L=(L+1)%x,L===H&&(H=(H+1)%x),Q-A<E)return;const ie=ce&&Q-ce;return ie?Math.round(_e*1e3/ie):void 0}}function Sv(x,E){let I=0,R=1e3/E,L,H;const A=(Q,ce=Date.now())=>{I=ce,L=null,H&&(clearTimeout(H),H=null),x.apply(null,Q)};return[(...Q)=>{const ce=Date.now(),ze=ce-I;ze>=R?A(Q,ce):(L=Q,H||(H=setTimeout(()=>{H=null,A(L)},R-ze)))},()=>L&&A(L)]}const sm=(x,E,I=3)=>{let R=0;const L=Tv(50,250);return Sv(H=>{const A=H.loaded,u=H.lengthComputable?H.total:void 0,re=A-R,Q=L(re),ce=A<=u;R=A;const ze={loaded:A,total:u,progress:u?A/u:void 0,bytes:re,rate:Q||void 0,estimated:Q&&u&&ce?(u-A)/Q:void 0,event:H,lengthComputable:u!=null,[E?"download":"upload"]:!0};x(ze)},I)},Mg=(x,E)=>{const I=x!=null;return[R=>E[0]({lengthComputable:I,total:x,loaded:R}),E[1]]},Ag=x=>(...E)=>tt.asap(()=>x(...E)),Ev=Aa.hasStandardBrowserEnv?((x,E)=>I=>(I=new URL(I,Aa.origin),x.protocol===I.protocol&&x.host===I.host&&(E||x.port===I.port)))(new URL(Aa.origin),Aa.navigator&&/(msie|trident)/i.test(Aa.navigator.userAgent)):()=>!0,Cv=Aa.hasStandardBrowserEnv?{write(x,E,I,R,L,H){const A=[x+"="+encodeURIComponent(E)];tt.isNumber(I)&&A.push("expires="+new Date(I).toGMTString()),tt.isString(R)&&A.push("path="+R),tt.isString(L)&&A.push("domain="+L),H===!0&&A.push("secure"),document.cookie=A.join("; ")},read(x){const E=document.cookie.match(new RegExp("(^|;\\s*)("+x+")=([^;]*)"));return E?decodeURIComponent(E[3]):null},remove(x){this.write(x,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Mv(x){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(x)}function Av(x,E){return E?x.replace(/\/?\/$/,"")+"/"+E.replace(/^\/+/,""):x}function v_(x,E,I){let R=!Mv(E);return x&&(R||I==!1)?Av(x,E):E}const zg=x=>x instanceof yo?{...x}:x;function $h(x,E){E=E||{};const I={};function R(Q,ce,ze,_e){return tt.isPlainObject(Q)&&tt.isPlainObject(ce)?tt.merge.call({caseless:_e},Q,ce):tt.isPlainObject(ce)?tt.merge({},ce):tt.isArray(ce)?ce.slice():ce}function L(Q,ce,ze,_e){if(tt.isUndefined(ce)){if(!tt.isUndefined(Q))return R(void 0,Q,ze,_e)}else return R(Q,ce,ze,_e)}function H(Q,ce){if(!tt.isUndefined(ce))return R(void 0,ce)}function A(Q,ce){if(tt.isUndefined(ce)){if(!tt.isUndefined(Q))return R(void 0,Q)}else return R(void 0,ce)}function u(Q,ce,ze){if(ze in E)return R(Q,ce);if(ze in x)return R(void 0,Q)}const re={url:H,method:H,data:H,baseURL:A,transformRequest:A,transformResponse:A,paramsSerializer:A,timeout:A,timeoutMessage:A,withCredentials:A,withXSRFToken:A,adapter:A,responseType:A,xsrfCookieName:A,xsrfHeaderName:A,onUploadProgress:A,onDownloadProgress:A,decompress:A,maxContentLength:A,maxBodyLength:A,beforeRedirect:A,transport:A,httpAgent:A,httpsAgent:A,cancelToken:A,socketPath:A,responseEncoding:A,validateStatus:u,headers:(Q,ce,ze)=>L(zg(Q),zg(ce),ze,!0)};return tt.forEach(Object.keys(Object.assign({},x,E)),function(ce){const ze=re[ce]||L,_e=ze(x[ce],E[ce],ce);tt.isUndefined(_e)&&ze!==u||(I[ce]=_e)}),I}const x_=x=>{const E=$h({},x);let{data:I,withXSRFToken:R,xsrfHeaderName:L,xsrfCookieName:H,headers:A,auth:u}=E;E.headers=A=yo.from(A),E.url=p_(v_(E.baseURL,E.url,E.allowAbsoluteUrls),x.params,x.paramsSerializer),u&&A.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let re;if(tt.isFormData(I)){if(Aa.hasStandardBrowserEnv||Aa.hasStandardBrowserWebWorkerEnv)A.setContentType(void 0);else if((re=A.getContentType())!==!1){const[Q,...ce]=re?re.split(";").map(ze=>ze.trim()).filter(Boolean):[];A.setContentType([Q||"multipart/form-data",...ce].join("; "))}}if(Aa.hasStandardBrowserEnv&&(R&&tt.isFunction(R)&&(R=R(E)),R||R!==!1&&Ev(E.url))){const Q=L&&H&&Cv.read(H);Q&&A.set(L,Q)}return E},zv=typeof XMLHttpRequest<"u",Rv=zv&&function(x){return new Promise(function(I,R){const L=x_(x);let H=L.data;const A=yo.from(L.headers).normalize();let{responseType:u,onUploadProgress:re,onDownloadProgress:Q}=L,ce,ze,_e,ie,he;function je(){ie&&ie(),he&&he(),L.cancelToken&&L.cancelToken.unsubscribe(ce),L.signal&&L.signal.removeEventListener("abort",ce)}let Me=new XMLHttpRequest;Me.open(L.method.toUpperCase(),L.url,!0),Me.timeout=L.timeout;function Oe(){if(!Me)return;const qe=yo.from("getAllResponseHeaders"in Me&&Me.getAllResponseHeaders()),mt={data:!u||u==="text"||u==="json"?Me.responseText:Me.response,status:Me.status,statusText:Me.statusText,headers:qe,config:x,request:Me};y_(function(yt){I(yt),je()},function(yt){R(yt),je()},mt),Me=null}"onloadend"in Me?Me.onloadend=Oe:Me.onreadystatechange=function(){!Me||Me.readyState!==4||Me.status===0&&!(Me.responseURL&&Me.responseURL.indexOf("file:")===0)||setTimeout(Oe)},Me.onabort=function(){Me&&(R(new gi("Request aborted",gi.ECONNABORTED,x,Me)),Me=null)},Me.onerror=function(){R(new gi("Network Error",gi.ERR_NETWORK,x,Me)),Me=null},Me.ontimeout=function(){let dt=L.timeout?"timeout of "+L.timeout+"ms exceeded":"timeout exceeded";const mt=L.transitional||m_;L.timeoutErrorMessage&&(dt=L.timeoutErrorMessage),R(new gi(dt,mt.clarifyTimeoutError?gi.ETIMEDOUT:gi.ECONNABORTED,x,Me)),Me=null},H===void 0&&A.setContentType(null),"setRequestHeader"in Me&&tt.forEach(A.toJSON(),function(dt,mt){Me.setRequestHeader(mt,dt)}),tt.isUndefined(L.withCredentials)||(Me.withCredentials=!!L.withCredentials),u&&u!=="json"&&(Me.responseType=L.responseType),Q&&([_e,he]=sm(Q,!0),Me.addEventListener("progress",_e)),re&&Me.upload&&([ze,ie]=sm(re),Me.upload.addEventListener("progress",ze),Me.upload.addEventListener("loadend",ie)),(L.cancelToken||L.signal)&&(ce=qe=>{Me&&(R(!qe||qe.type?new Jd(null,x,Me):qe),Me.abort(),Me=null)},L.cancelToken&&L.cancelToken.subscribe(ce),L.signal&&(L.signal.aborted?ce():L.signal.addEventListener("abort",ce)));const Fe=wv(L.url);if(Fe&&Aa.protocols.indexOf(Fe)===-1){R(new gi("Unsupported protocol "+Fe+":",gi.ERR_BAD_REQUEST,x));return}Me.send(H||null)})},Pv=(x,E)=>{const{length:I}=x=x?x.filter(Boolean):[];if(E||I){let R=new AbortController,L;const H=function(Q){if(!L){L=!0,u();const ce=Q instanceof Error?Q:this.reason;R.abort(ce instanceof gi?ce:new Jd(ce instanceof Error?ce.message:ce))}};let A=E&&setTimeout(()=>{A=null,H(new gi(`timeout ${E} of ms exceeded`,gi.ETIMEDOUT))},E);const u=()=>{x&&(A&&clearTimeout(A),A=null,x.forEach(Q=>{Q.unsubscribe?Q.unsubscribe(H):Q.removeEventListener("abort",H)}),x=null)};x.forEach(Q=>Q.addEventListener("abort",H));const{signal:re}=R;return re.unsubscribe=()=>tt.asap(u),re}},Iv=function*(x,E){let I=x.byteLength;if(I<E){yield x;return}let R=0,L;for(;R<I;)L=R+E,yield x.slice(R,L),R=L},Dv=async function*(x,E){for await(const I of kv(x))yield*Iv(I,E)},kv=async function*(x){if(x[Symbol.asyncIterator]){yield*x;return}const E=x.getReader();try{for(;;){const{done:I,value:R}=await E.read();if(I)break;yield R}}finally{await E.cancel()}},Rg=(x,E,I,R)=>{const L=Dv(x,E);let H=0,A,u=re=>{A||(A=!0,R&&R(re))};return new ReadableStream({async pull(re){try{const{done:Q,value:ce}=await L.next();if(Q){u(),re.close();return}let ze=ce.byteLength;if(I){let _e=H+=ze;I(_e)}re.enqueue(new Uint8Array(ce))}catch(Q){throw u(Q),Q}},cancel(re){return u(re),L.return()}},{highWaterMark:2})},mm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",b_=mm&&typeof ReadableStream=="function",Lv=mm&&(typeof TextEncoder=="function"?(x=>E=>x.encode(E))(new TextEncoder):async x=>new Uint8Array(await new Response(x).arrayBuffer())),w_=(x,...E)=>{try{return!!x(...E)}catch{return!1}},Bv=b_&&w_(()=>{let x=!1;const E=new Request(Aa.origin,{body:new ReadableStream,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!E}),Pg=64*1024,Gm=b_&&w_(()=>tt.isReadableStream(new Response("").body)),lm={stream:Gm&&(x=>x.body)};mm&&(x=>{["text","arrayBuffer","blob","formData","stream"].forEach(E=>{!lm[E]&&(lm[E]=tt.isFunction(x[E])?I=>I[E]():(I,R)=>{throw new gi(`Response type '${E}' is not supported`,gi.ERR_NOT_SUPPORT,R)})})})(new Response);const Ov=async x=>{if(x==null)return 0;if(tt.isBlob(x))return x.size;if(tt.isSpecCompliantForm(x))return(await new Request(Aa.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(tt.isArrayBufferView(x)||tt.isArrayBuffer(x))return x.byteLength;if(tt.isURLSearchParams(x)&&(x=x+""),tt.isString(x))return(await Lv(x)).byteLength},jv=async(x,E)=>{const I=tt.toFiniteNumber(x.getContentLength());return I??Ov(E)},Fv=mm&&(async x=>{let{url:E,method:I,data:R,signal:L,cancelToken:H,timeout:A,onDownloadProgress:u,onUploadProgress:re,responseType:Q,headers:ce,withCredentials:ze="same-origin",fetchOptions:_e}=x_(x);Q=Q?(Q+"").toLowerCase():"text";let ie=Pv([L,H&&H.toAbortSignal()],A),he;const je=ie&&ie.unsubscribe&&(()=>{ie.unsubscribe()});let Me;try{if(re&&Bv&&I!=="get"&&I!=="head"&&(Me=await jv(ce,R))!==0){let mt=new Request(E,{method:"POST",body:R,duplex:"half"}),zt;if(tt.isFormData(R)&&(zt=mt.headers.get("content-type"))&&ce.setContentType(zt),mt.body){const[yt,St]=Mg(Me,sm(Ag(re)));R=Rg(mt.body,Pg,yt,St)}}tt.isString(ze)||(ze=ze?"include":"omit");const Oe="credentials"in Request.prototype;he=new Request(E,{..._e,signal:ie,method:I.toUpperCase(),headers:ce.normalize().toJSON(),body:R,duplex:"half",credentials:Oe?ze:void 0});let Fe=await fetch(he);const qe=Gm&&(Q==="stream"||Q==="response");if(Gm&&(u||qe&&je)){const mt={};["status","statusText","headers"].forEach(Qt=>{mt[Qt]=Fe[Qt]});const zt=tt.toFiniteNumber(Fe.headers.get("content-length")),[yt,St]=u&&Mg(zt,sm(Ag(u),!0))||[];Fe=new Response(Rg(Fe.body,Pg,yt,()=>{St&&St(),je&&je()}),mt)}Q=Q||"text";let dt=await lm[tt.findKey(lm,Q)||"text"](Fe,x);return!qe&&je&&je(),await new Promise((mt,zt)=>{y_(mt,zt,{data:dt,headers:yo.from(Fe.headers),status:Fe.status,statusText:Fe.statusText,config:x,request:he})})}catch(Oe){throw je&&je(),Oe&&Oe.name==="TypeError"&&/fetch/i.test(Oe.message)?Object.assign(new gi("Network Error",gi.ERR_NETWORK,x,he),{cause:Oe.cause||Oe}):gi.from(Oe,Oe&&Oe.code,x,he)}}),qm={http:ev,xhr:Rv,fetch:Fv};tt.forEach(qm,(x,E)=>{if(x){try{Object.defineProperty(x,"name",{value:E})}catch{}Object.defineProperty(x,"adapterName",{value:E})}});const Ig=x=>`- ${x}`,Nv=x=>tt.isFunction(x)||x===null||x===!1,T_={getAdapter:x=>{x=tt.isArray(x)?x:[x];const{length:E}=x;let I,R;const L={};for(let H=0;H<E;H++){I=x[H];let A;if(R=I,!Nv(I)&&(R=qm[(A=String(I)).toLowerCase()],R===void 0))throw new gi(`Unknown adapter '${A}'`);if(R)break;L[A||"#"+H]=R}if(!R){const H=Object.entries(L).map(([u,re])=>`adapter ${u} `+(re===!1?"is not supported by the environment":"is not available in the build"));let A=E?H.length>1?`since :
`+H.map(Ig).join(`
`):" "+Ig(H[0]):"as no adapter specified";throw new gi("There is no suitable adapter to dispatch the request "+A,"ERR_NOT_SUPPORT")}return R},adapters:qm};function jm(x){if(x.cancelToken&&x.cancelToken.throwIfRequested(),x.signal&&x.signal.aborted)throw new Jd(null,x)}function Dg(x){return jm(x),x.headers=yo.from(x.headers),x.data=Om.call(x,x.transformRequest),["post","put","patch"].indexOf(x.method)!==-1&&x.headers.setContentType("application/x-www-form-urlencoded",!1),T_.getAdapter(x.adapter||hp.adapter)(x).then(function(R){return jm(x),R.data=Om.call(x,x.transformResponse,R),R.headers=yo.from(R.headers),R},function(R){return __(R)||(jm(x),R&&R.response&&(R.response.data=Om.call(x,x.transformResponse,R.response),R.response.headers=yo.from(R.response.headers))),Promise.reject(R)})}const S_="1.8.4",gm={};["object","boolean","number","function","string","symbol"].forEach((x,E)=>{gm[x]=function(R){return typeof R===x||"a"+(E<1?"n ":" ")+x}});const kg={};gm.transitional=function(E,I,R){function L(H,A){return"[Axios v"+S_+"] Transitional option '"+H+"'"+A+(R?". "+R:"")}return(H,A,u)=>{if(E===!1)throw new gi(L(A," has been removed"+(I?" in "+I:"")),gi.ERR_DEPRECATED);return I&&!kg[A]&&(kg[A]=!0,console.warn(L(A," has been deprecated since v"+I+" and will be removed in the near future"))),E?E(H,A,u):!0}};gm.spelling=function(E){return(I,R)=>(console.warn(`${R} is likely a misspelling of ${E}`),!0)};function Uv(x,E,I){if(typeof x!="object")throw new gi("options must be an object",gi.ERR_BAD_OPTION_VALUE);const R=Object.keys(x);let L=R.length;for(;L-- >0;){const H=R[L],A=E[H];if(A){const u=x[H],re=u===void 0||A(u,H,x);if(re!==!0)throw new gi("option "+H+" must be "+re,gi.ERR_BAD_OPTION_VALUE);continue}if(I!==!0)throw new gi("Unknown option "+H,gi.ERR_BAD_OPTION)}}const rm={assertOptions:Uv,validators:gm},Zl=rm.validators;let qh=class{constructor(E){this.defaults=E,this.interceptors={request:new Eg,response:new Eg}}async request(E,I){try{return await this._request(E,I)}catch(R){if(R instanceof Error){let L={};Error.captureStackTrace?Error.captureStackTrace(L):L=new Error;const H=L.stack?L.stack.replace(/^.+\n/,""):"";try{R.stack?H&&!String(R.stack).endsWith(H.replace(/^.+\n.+\n/,""))&&(R.stack+=`
`+H):R.stack=H}catch{}}throw R}}_request(E,I){typeof E=="string"?(I=I||{},I.url=E):I=E||{},I=$h(this.defaults,I);const{transitional:R,paramsSerializer:L,headers:H}=I;R!==void 0&&rm.assertOptions(R,{silentJSONParsing:Zl.transitional(Zl.boolean),forcedJSONParsing:Zl.transitional(Zl.boolean),clarifyTimeoutError:Zl.transitional(Zl.boolean)},!1),L!=null&&(tt.isFunction(L)?I.paramsSerializer={serialize:L}:rm.assertOptions(L,{encode:Zl.function,serialize:Zl.function},!0)),I.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?I.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:I.allowAbsoluteUrls=!0),rm.assertOptions(I,{baseUrl:Zl.spelling("baseURL"),withXsrfToken:Zl.spelling("withXSRFToken")},!0),I.method=(I.method||this.defaults.method||"get").toLowerCase();let A=H&&tt.merge(H.common,H[I.method]);H&&tt.forEach(["delete","get","head","post","put","patch","common"],he=>{delete H[he]}),I.headers=yo.concat(A,H);const u=[];let re=!0;this.interceptors.request.forEach(function(je){typeof je.runWhen=="function"&&je.runWhen(I)===!1||(re=re&&je.synchronous,u.unshift(je.fulfilled,je.rejected))});const Q=[];this.interceptors.response.forEach(function(je){Q.push(je.fulfilled,je.rejected)});let ce,ze=0,_e;if(!re){const he=[Dg.bind(this),void 0];for(he.unshift.apply(he,u),he.push.apply(he,Q),_e=he.length,ce=Promise.resolve(I);ze<_e;)ce=ce.then(he[ze++],he[ze++]);return ce}_e=u.length;let ie=I;for(ze=0;ze<_e;){const he=u[ze++],je=u[ze++];try{ie=he(ie)}catch(Me){je.call(this,Me);break}}try{ce=Dg.call(this,ie)}catch(he){return Promise.reject(he)}for(ze=0,_e=Q.length;ze<_e;)ce=ce.then(Q[ze++],Q[ze++]);return ce}getUri(E){E=$h(this.defaults,E);const I=v_(E.baseURL,E.url,E.allowAbsoluteUrls);return p_(I,E.params,E.paramsSerializer)}};tt.forEach(["delete","get","head","options"],function(E){qh.prototype[E]=function(I,R){return this.request($h(R||{},{method:E,url:I,data:(R||{}).data}))}});tt.forEach(["post","put","patch"],function(E){function I(R){return function(H,A,u){return this.request($h(u||{},{method:E,headers:R?{"Content-Type":"multipart/form-data"}:{},url:H,data:A}))}}qh.prototype[E]=I(),qh.prototype[E+"Form"]=I(!0)});let Vv=class E_{constructor(E){if(typeof E!="function")throw new TypeError("executor must be a function.");let I;this.promise=new Promise(function(H){I=H});const R=this;this.promise.then(L=>{if(!R._listeners)return;let H=R._listeners.length;for(;H-- >0;)R._listeners[H](L);R._listeners=null}),this.promise.then=L=>{let H;const A=new Promise(u=>{R.subscribe(u),H=u}).then(L);return A.cancel=function(){R.unsubscribe(H)},A},E(function(H,A,u){R.reason||(R.reason=new Jd(H,A,u),I(R.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(E){if(this.reason){E(this.reason);return}this._listeners?this._listeners.push(E):this._listeners=[E]}unsubscribe(E){if(!this._listeners)return;const I=this._listeners.indexOf(E);I!==-1&&this._listeners.splice(I,1)}toAbortSignal(){const E=new AbortController,I=R=>{E.abort(R)};return this.subscribe(I),E.signal.unsubscribe=()=>this.unsubscribe(I),E.signal}static source(){let E;return{token:new E_(function(L){E=L}),cancel:E}}};function Zv(x){return function(I){return x.apply(null,I)}}function Gv(x){return tt.isObject(x)&&x.isAxiosError===!0}const Hm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Hm).forEach(([x,E])=>{Hm[E]=x});function C_(x){const E=new qh(x),I=n_(qh.prototype.request,E);return tt.extend(I,qh.prototype,E,{allOwnKeys:!0}),tt.extend(I,E,null,{allOwnKeys:!0}),I.create=function(L){return C_($h(x,L))},I}const fi=C_(hp);fi.Axios=qh;fi.CanceledError=Jd;fi.CancelToken=Vv;fi.isCancel=__;fi.VERSION=S_;fi.toFormData=pm;fi.AxiosError=gi;fi.Cancel=fi.CanceledError;fi.all=function(E){return Promise.all(E)};fi.spread=Zv;fi.isAxiosError=Gv;fi.mergeConfig=$h;fi.AxiosHeaders=yo;fi.formToJSON=x=>g_(tt.isHTMLForm(x)?new FormData(x):x);fi.getAdapter=T_.getAdapter;fi.HttpStatusCode=Hm;fi.default=fi;const{Axios:Nx,AxiosError:Ux,CanceledError:Vx,isCancel:Zx,CancelToken:Gx,VERSION:qx,all:Hx,Cancel:$x,isAxiosError:Xx,spread:Yx,toFormData:Kx,AxiosHeaders:Wx,HttpStatusCode:Qx,formToJSON:Jx,getAdapter:eb,mergeConfig:tb}=fi;function qv(){const x=$c(),[E,I]=Pe.useState({username:"",email:"",password:"",class_year:""}),[R,L]=Pe.useState({}),[H,A]=Pe.useState(!1),[u,re]=Pe.useState(""),Q=ie=>{const{name:he,value:je}=ie.target;I({...E,[he]:je}),R[he]&&L({...R,[he]:""})},ce=()=>{const ie={};return E.username.trim()||(ie.username="Username is required"),E.email.trim()?/\S+@\S+\.\S+/.test(E.email)||(ie.email="Email is invalid"):ie.email="Email is required",E.password?E.password.length<6&&(ie.password="Password must be at least 6 characters"):ie.password="Password is required",E.class_year||(ie.class_year="Class year is required"),ie},ze=async ie=>{ie.preventDefault();const he=ce();if(Object.keys(he).length>0){L(he);return}A(!0),re("");try{const je={...E,class_year:parseInt(E.class_year,10)};console.log("Sending data to server:",je);const Me=await fi.post("https://backend-housing47.onrender.comusers/create",je);console.log("Registration successful:",Me.data),localStorage.setItem("userId",Me.data.userId),x("/dashboard")}catch(je){console.error("Registration failed:",je),je.response?(console.error("Server error data:",je.response.data),console.error("Server error status:",je.response.status),re(je.response.data.message||"Registration failed. Please try again.")):je.request?(console.error("No response received"),re("Server not responding. Please try again later.")):(console.error("Request setup error:",je.message),re("An unexpected error occurred. Please try again."))}finally{A(!1)}},_e=()=>{x("/signin")};return F.jsx("div",{style:ki.page,children:F.jsxs("div",{style:ki.loginContainer,children:[F.jsxs("div",{style:ki.header,children:[F.jsx("button",{onClick:_e,style:ki.backButton,children:"← Back"}),F.jsxs("div",{style:ki.logoContainer,children:[F.jsx("span",{style:ki.logoIcon,children:"🏠"}),F.jsx("span",{style:ki.logoText,children:"Housing47"})]})]}),F.jsx("h1",{style:ki.title,children:"Create Your Account"}),F.jsx("p",{style:ki.subtitle,children:"Find your perfect campus housing match"}),u&&F.jsx("div",{style:ki.submitErrorContainer,children:F.jsx("p",{style:ki.submitErrorText,children:u})}),F.jsxs("form",{onSubmit:ze,style:ki.form,children:[F.jsxs("div",{style:ki.formGroup,children:[F.jsx("label",{htmlFor:"username",style:ki.label,children:"Username"}),F.jsx("input",{type:"text",id:"username",name:"username",value:E.username,onChange:Q,style:{...ki.input,...R.username?ki.inputError:{}},placeholder:"johndoe"}),R.username&&F.jsx("p",{style:ki.errorText,children:R.username})]}),F.jsxs("div",{style:ki.formGroup,children:[F.jsx("label",{htmlFor:"email",style:ki.label,children:"Email"}),F.jsx("input",{type:"email",id:"email",name:"email",value:E.email,onChange:Q,style:{...ki.input,...R.email?ki.inputError:{}},placeholder:"john.doe@university.edu"}),R.email&&F.jsx("p",{style:ki.errorText,children:R.email})]}),F.jsxs("div",{style:ki.formGroup,children:[F.jsx("label",{htmlFor:"password",style:ki.label,children:"Password"}),F.jsx("input",{type:"password",id:"password",name:"password",value:E.password,onChange:Q,style:{...ki.input,...R.password?ki.inputError:{}},placeholder:"••••••••"}),R.password&&F.jsx("p",{style:ki.errorText,children:R.password})]}),F.jsxs("div",{style:ki.formGroup,children:[F.jsx("label",{htmlFor:"class_year",style:ki.label,children:"Class Year"}),F.jsxs("select",{id:"class_year",name:"class_year",value:E.class_year,onChange:Q,style:{...ki.input,...R.class_year?ki.inputError:{}},children:[F.jsx("option",{value:"",disabled:!0,children:"Select your class year"}),F.jsx("option",{value:"1",children:"Freshman"}),F.jsx("option",{value:"2",children:"Sophomore"}),F.jsx("option",{value:"3",children:"Junior"}),F.jsx("option",{value:"4",children:"Senior"})]}),R.class_year&&F.jsx("p",{style:ki.errorText,children:R.class_year})]}),F.jsx("button",{type:"submit",style:ki.submitButton,disabled:H,children:H?"Creating Account...":"Create Account"})]}),F.jsxs("div",{style:ki.loginLink,children:["Already have an account? ",F.jsx("a",{href:"#",style:ki.link,children:"Sign in"})]})]})})}const ki={page:{minHeight:"100vh",background:"linear-gradient(to bottom right, #EBF4FF, #E0E7FF)",display:"flex",justifyContent:"center",alignItems:"center",padding:"2rem",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif"},loginContainer:{backgroundColor:"white",borderRadius:"1rem",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",padding:"2rem",width:"100%",maxWidth:"500px"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"2rem"},backButton:{background:"none",border:"none",color:"#4F46E5",fontSize:"1rem",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",padding:"0.5rem"},logoContainer:{display:"flex",alignItems:"center",gap:"0.5rem"},logoIcon:{fontSize:"1.5rem"},logoText:{fontWeight:"bold",fontSize:"1.25rem",color:"#4F46E5"},title:{fontSize:"1.875rem",fontWeight:"bold",color:"#1F2937",marginBottom:"0.5rem",textAlign:"center"},subtitle:{fontSize:"1rem",color:"#6B7280",marginBottom:"2rem",textAlign:"center"},submitErrorContainer:{backgroundColor:"#FEF2F2",borderRadius:"0.5rem",padding:"1rem",marginBottom:"1.5rem",borderLeft:"4px solid #EF4444"},submitErrorText:{color:"#B91C1C",margin:0,fontSize:"0.875rem"},form:{display:"flex",flexDirection:"column",gap:"1.25rem"},formGroup:{display:"flex",flexDirection:"column",gap:"0.5rem"},label:{fontSize:"0.875rem",fontWeight:"500",color:"#374151"},input:{padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #D1D5DB",fontSize:"1rem",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},inputError:{borderColor:"#EF4444",backgroundColor:"#FEF2F2"},errorText:{color:"#EF4444",fontSize:"0.75rem",margin:"0.25rem 0 0 0"},submitButton:{backgroundColor:"#4F46E5",color:"white",fontWeight:"500",fontSize:"1rem",padding:"0.75rem",borderRadius:"0.5rem",border:"none",cursor:"pointer",transition:"background-color 0.2s",marginTop:"0.5rem"},loginLink:{textAlign:"center",marginTop:"1.5rem",fontSize:"0.875rem",color:"#6B7280"},link:{color:"#4F46E5",fontWeight:"500",textDecoration:"none"}};var am={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.3.0/LICENSE.txt
 */var Hv=am.exports,Lg;function $v(){return Lg||(Lg=1,function(x,E){(function(I,R){x.exports=R()})(Hv,function(){var I={},R={};function L(A,u,re){if(R[A]=re,A==="index"){var Q="var sharedModule = {}; ("+R.shared+")(sharedModule); ("+R.worker+")(sharedModule);",ce={};return R.shared(ce),R.index(I,ce),typeof window<"u"&&I.setWorkerUrl(window.URL.createObjectURL(new Blob([Q],{type:"text/javascript"}))),I}}L("shared",["exports"],function(A){function u(r,t,a,s){return new(a||(a=Promise))(function(d,g){function _(M){try{T(s.next(M))}catch(P){g(P)}}function v(M){try{T(s.throw(M))}catch(P){g(P)}}function T(M){var P;M.done?d(M.value):(P=M.value,P instanceof a?P:new a(function(D){D(P)})).then(_,v)}T((s=s.apply(r,t||[])).next())})}function re(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Q,ce;function ze(){if(ce)return Q;function r(t,a){this.x=t,this.y=a}return ce=1,Q=r,r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,a){return this.clone()._rotateAround(t,a)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var a=t.x-this.x,s=t.y-this.y;return a*a+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,a){return Math.atan2(this.x*a-this.y*t,this.x*t+this.y*a)},_matMult:function(t){var a=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=a,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var a=Math.cos(t),s=Math.sin(t),d=s*this.x+a*this.y;return this.x=a*this.x-s*this.y,this.y=d,this},_rotateAround:function(t,a){var s=Math.cos(t),d=Math.sin(t),g=a.y+d*(this.x-a.x)+s*(this.y-a.y);return this.x=a.x+s*(this.x-a.x)-d*(this.y-a.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t},Q}typeof SuppressedError=="function"&&SuppressedError;var _e,ie,he=re(ze()),je=function(){if(ie)return _e;function r(t,a,s,d){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(d-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=s,this.p2y=d}return ie=1,_e=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,d=0;d<8;d++){var g=this.sampleCurveX(s)-t;if(Math.abs(g)<a)return s;var _=this.sampleCurveDerivativeX(s);if(Math.abs(_)<1e-6)break;s-=g/_}var v=0,T=1;for(s=t,d=0;d<20&&(g=this.sampleCurveX(s),!(Math.abs(g-t)<a));d++)t>g?v=s:T=s,s=.5*(T-v)+v;return s},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},_e}(),Me=re(je);let Oe,Fe;function qe(){return Oe==null&&(Oe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Oe}function dt(){if(Fe==null&&(Fe=!1,qe())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let s=0;s<5*5;s++){const d=4*s;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(s%5,Math.floor(s/5),1,1)}const a=t.getImageData(0,0,5,5).data;for(let s=0;s<5*5*4;s++)if(s%4!=3&&a[s]!==s){Fe=!0;break}}}return Fe||!1}var mt,zt=1e-6,yt=typeof Float32Array<"u"?Float32Array:Array;function St(){var r=new yt(9);return yt!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Qt(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Bi(){var r=new yt(3);return yt!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Si(r,t,a){var s=new yt(3);return s[0]=r,s[1]=t,s[2]=a,s}function Mi(r,t,a){var s=t[0],d=t[1],g=t[2],_=t[3];return r[0]=a[0]*s+a[4]*d+a[8]*g+a[12]*_,r[1]=a[1]*s+a[5]*d+a[9]*g+a[13]*_,r[2]=a[2]*s+a[6]*d+a[10]*g+a[14]*_,r[3]=a[3]*s+a[7]*d+a[11]*g+a[15]*_,r}function Ui(){var r=new yt(4);return yt!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Ki(){var r=new yt(2);return yt!=Float32Array&&(r[0]=0,r[1]=0),r}function Vi(r,t){var a=new yt(2);return a[0]=r,a[1]=t,a}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)}),Bi(),mt=new yt(4),yt!=Float32Array&&(mt[0]=0,mt[1]=0,mt[2]=0,mt[3]=0),Bi(),Si(1,0,0),Si(0,1,0),Ui(),Ui(),St(),Ki();const Ve=8192;function xt(r,t,a){return t*(Ve/(r.tileSize*Math.pow(2,a-r.tileID.overscaledZ)))}function jt(r,t){return(r%t+t)%t}function ui(r,t,a){return r*(1-a)+t*a}function Te(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,a=t*r;return 4*(r<.5?a:3*(r-t)+a-.75)}function ct(r,t,a,s){const d=new Me(r,t,a,s);return g=>d.solve(g)}const Et=ct(.25,.1,.25,1);function wt(r,t,a){return Math.min(a,Math.max(t,r))}function Ot(r,t,a){const s=a-t,d=((r-t)%s+s)%s+t;return d===t?a:d}function $t(r,...t){for(const a of t)for(const s in a)r[s]=a[s];return r}let qt=1;function kn(r,t,a){const s={};for(const d in r)s[d]=t.call(this,r[d],d,r);return s}function Ai(r,t,a){const s={};for(const d in r)t.call(this,r[d],d,r)&&(s[d]=r[d]);return s}function Ln(r){return Array.isArray(r)?r.map(Ln):typeof r=="object"&&r?kn(r,Ln):r}const vo={};function Vn(r){vo[r]||(typeof console<"u"&&console.warn(r),vo[r]=!0)}function Cn(r,t,a){return(a.y-r.y)*(t.x-r.x)>(t.y-r.y)*(a.x-r.x)}function Fr(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let Wi=null;function xo(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const bo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Mn(r,t,a,s,d){return u(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(r,{timestamp:0});try{const _=g==null?void 0:g.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const v=_.startsWith("BGR"),T=new Uint8ClampedArray(s*d*4);if(yield g.copyTo(T,function(M,P,D,j,U){const G=4*Math.max(1,0),X=(Math.max(0,D)-D)*j*4+G,ee=4*j,oe=Math.max(0,P),ye=Math.max(0,D);return{rect:{x:oe,y:ye,width:Math.min(M.width,P+j)-oe,height:Math.min(M.height,D+U)-ye},layout:[{offset:X,stride:ee}]}}(r,t,a,s,d)),v)for(let M=0;M<T.length;M+=4){const P=T[M];T[M]=T[M+2],T[M+2]=P}return T}finally{g.close()}})}let $a,za;function Jr(r,t,a,s){return r.addEventListener(t,a,s),{unsubscribe:()=>{r.removeEventListener(t,a,s)}}}function lr(r){return r/Math.PI*180}const pt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Mt={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},hi="AbortError";function Ri(){return new Error(hi)}const xn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function un(r){return xn.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const hn="global-dispatcher";class zi extends Error{constructor(t,a,s,d){super(`AJAXError: ${a} (${t}): ${s}`),this.status=t,this.statusText=a,this.url=s,this.body=d}}const dn=()=>Fr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,An=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const s=un(r.url);if(s)return s(r,t);if(Fr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:hn},t)}if(!(/^file:/.test(a=r.url)||/^file:/.test(dn())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(s,d){return u(this,void 0,void 0,function*(){const g=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:dn(),signal:d.signal});let _,v;s.type!=="json"||g.headers.has("Accept")||g.headers.set("Accept","application/json");try{_=yield fetch(g)}catch(M){throw new zi(0,M.message,s.url,new Blob)}if(!_.ok){const M=yield _.blob();throw new zi(_.status,_.statusText,s.url,M)}v=s.type==="arrayBuffer"||s.type==="image"?_.arrayBuffer():s.type==="json"?_.json():_.text();const T=yield v;if(d.signal.aborted)throw Ri();return{data:T,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(r,t);if(Fr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:hn},t)}var a;return function(s,d){return new Promise((g,_)=>{var v;const T=new XMLHttpRequest;T.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(T.responseType="arraybuffer");for(const M in s.headers)T.setRequestHeader(M,s.headers[M]);s.type==="json"&&(T.responseType="text",!((v=s.headers)===null||v===void 0)&&v.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=s.credentials==="include",T.onerror=()=>{_(new Error(T.statusText))},T.onload=()=>{if(!d.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let M=T.response;if(s.type==="json")try{M=JSON.parse(T.response)}catch(P){return void _(P)}g({data:M,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const M=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});_(new zi(T.status,T.statusText,s.url,M))}},d.signal.addEventListener("abort",()=>{T.abort(),_(Ri())}),T.send(s.body)})}(r,t)};function ea(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),a=window.location;return t.protocol===a.protocol&&t.host===a.host}function ta(r,t,a){a[r]&&a[r].indexOf(t)!==-1||(a[r]=a[r]||[],a[r].push(t))}function Nr(r,t,a){if(a&&a[r]){const s=a[r].indexOf(t);s!==-1&&a[r].splice(s,1)}}class Ce{constructor(t,a={}){$t(this,a),this.type=t}}class $ extends Ce{constructor(t,a={}){super("error",$t({error:t},a))}}class K{on(t,a){return this._listeners=this._listeners||{},ta(t,a,this._listeners),{unsubscribe:()=>{this.off(t,a)}}}off(t,a){return Nr(t,a,this._listeners),Nr(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},ta(t,a,this._oneTimeListeners),this):new Promise(s=>this.once(t,s))}fire(t,a){typeof t=="string"&&(t=new Ce(t,a||{}));const s=t.type;if(this.listens(s)){t.target=this;const d=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const v of d)v.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const v of g)Nr(s,v,this._oneTimeListeners),v.call(this,t);const _=this._eventedParent;_&&($t(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof $&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var Z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ue=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function be(r,t){const a={};for(const s in r)s!=="ref"&&(a[s]=r[s]);return ue.forEach(s=>{s in t&&(a[s]=t[s])}),a}function ve(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let a=0;a<r.length;a++)if(!ve(r[a],t[a]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const a in r)if(!ve(r[a],t[a]))return!1;return!0}return r===t}function Ie(r,t){r.push(t)}function Ee(r,t,a){Ie(a,{command:"addSource",args:[r,t[r]]})}function Ke(r,t,a){Ie(t,{command:"removeSource",args:[r]}),a[r]=!0}function He(r,t,a,s){Ke(r,a,s),Ee(r,t,a)}function Re(r,t,a){let s;for(s in r[a])if(Object.prototype.hasOwnProperty.call(r[a],s)&&s!=="data"&&!ve(r[a][s],t[a][s]))return!1;for(s in t[a])if(Object.prototype.hasOwnProperty.call(t[a],s)&&s!=="data"&&!ve(r[a][s],t[a][s]))return!1;return!0}function nt(r,t,a,s,d,g){r=r||{},t=t||{};for(const _ in r)Object.prototype.hasOwnProperty.call(r,_)&&(ve(r[_],t[_])||a.push({command:g,args:[s,_,t[_],d]}));for(const _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(r,_)&&(ve(r[_],t[_])||a.push({command:g,args:[s,_,t[_],d]}))}function vt(r){return r.id}function bt(r,t){return r[t.id]=t,r}class Ze{constructor(t,a,s,d){this.message=(t?`${t}: `:"")+s,d&&(this.identifier=d),a!=null&&a.__line__&&(this.line=a.__line__)}}function Bt(r,...t){for(const a of t)for(const s in a)r[s]=a[s];return r}class At extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class Gt{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[s,d]of a)this.bindings[s]=d}concat(t){return new Gt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const pi={kind:"null"},st={kind:"number"},Rt={kind:"string"},_t={kind:"boolean"},Xt={kind:"color"},fn={kind:"projectionDefinition"},Ur={kind:"object"},Ft={kind:"value"},zn={kind:"collator"},Pi={kind:"formatted"},Zn={kind:"padding"},Ts={kind:"resolvedImage"},wo={kind:"variableAnchorOffsetCollection"};function Xn(r,t){return{kind:"array",itemType:r,N:t}}function Fi(r){if(r.kind==="array"){const t=Fi(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const ef=[pi,st,Rt,_t,Xt,fn,Pi,Ur,Xn(Ft),Zn,Ts,wo];function Ss(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ss(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const a of ef)if(!Ss(a,t))return null}}return`Expected ${Fi(r)} but found ${Fi(t)} instead.`}function Xc(r,t){return t.some(a=>a.kind===r.kind)}function Ho(r,t){return t.some(a=>a==="null"?r===null:a==="array"?Array.isArray(r):a==="object"?r&&!Array.isArray(r)&&typeof r=="object":a===typeof r)}function To(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const $l=.96422,Xa=.82521,Yc=4/29,Es=6/29,Cs=3*Es*Es,$u=Es*Es*Es,Kc=Math.PI/180,Xl=180/Math.PI;function Xu(r){return(r%=360)<0&&(r+=360),r}function ia([r,t,a,s]){let d,g;const _=Yu((.2225045*(r=$o(r))+.7168786*(t=$o(t))+.0606169*(a=$o(a)))/1);r===t&&t===a?d=g=_:(d=Yu((.4360747*r+.3850649*t+.1430804*a)/$l),g=Yu((.0139322*r+.0971045*t+.7141733*a)/Xa));const v=116*_-16;return[v<0?0:v,500*(d-_),200*(_-g),s]}function $o(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Yu(r){return r>$u?Math.pow(r,1/3):r/Cs+Yc}function Yl([r,t,a,s]){let d=(r+16)/116,g=isNaN(t)?d:d+t/500,_=isNaN(a)?d:d-a/200;return d=1*Ms(d),g=$l*Ms(g),_=Xa*Ms(_),[Wc(3.1338561*g-1.6168667*d-.4906146*_),Wc(-.9787684*g+1.9161415*d+.033454*_),Wc(.0719453*g-.2289914*d+1.4052427*_),s]}function Wc(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function Ms(r){return r>Es?r*r*r:Cs*(r-Yc)}function Kl(r){return parseInt(r.padEnd(2,r),16)/255}function Bn(r,t){return ri(t?r/100:r,0,1)}function ri(r,t,a){return Math.min(Math.max(t,r),a)}function Xo(r){return!r.some(Number.isNaN)}const Ya={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Vr(r,t,a){return r+a*(t-r)}function As(r,t,a){return r.map((s,d)=>Vr(s,t[d],a))}class _i{constructor(t,a,s,d=1,g=!0){this.r=t,this.g=a,this.b=s,this.a=d,g||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,a,s,d]))}static parse(t){if(t instanceof _i)return t;if(typeof t!="string")return;const a=function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=Ya[s];if(d){const[_,v,T]=d;return[_/255,v/255,T/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const _=s.length<6?1:2;let v=1;return[Kl(s.slice(v,v+=_)),Kl(s.slice(v,v+=_)),Kl(s.slice(v,v+=_)),Kl(s.slice(v,v+_)||"ff")]}if(s.startsWith("rgb")){const _=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[v,T,M,P,D,j,U,G,X,ee,oe,ye]=_,le=[P||" ",U||" ",ee].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const N=[M,j,X].join(""),J=N==="%%%"?100:N===""?255:0;if(J){const de=[ri(+T/J,0,1),ri(+D/J,0,1),ri(+G/J,0,1),oe?Bn(+oe,ye):1];if(Xo(de))return de}}return}}const g=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,v,T,M,P,D,j,U,G]=g,X=[T||" ",P||" ",j].join("");if(X==="  "||X==="  /"||X===",,"||X===",,,"){const ee=[+v,ri(+M,0,100),ri(+D,0,100),U?Bn(+U,G):1];if(Xo(ee))return function([oe,ye,le,N]){function J(de){const Le=(de+oe/30)%12,ot=ye*Math.min(le,1-le);return le-ot*Math.max(-1,Math.min(Le-3,9-Le,1))}return oe=Xu(oe),ye/=100,le/=100,[J(0),J(8),J(4),N]}(ee)}}}(t);return a?new _i(...a,!1):void 0}get rgb(){const{r:t,g:a,b:s,a:d}=this,g=d||1/0;return this.overwriteGetter("rgb",[t/g,a/g,s/g,d])}get hcl(){return this.overwriteGetter("hcl",function(t){const[a,s,d,g]=ia(t),_=Math.sqrt(s*s+d*d);return[Math.round(1e4*_)?Xu(Math.atan2(d,s)*Xl):NaN,_,a,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ia(this.rgb))}overwriteGetter(t,a){return Object.defineProperty(this,t,{value:a}),a}toString(){const[t,a,s,d]=this.rgb;return`rgba(${[t,a,s].map(g=>Math.round(255*g)).join(",")},${d})`}static interpolate(t,a,s,d="rgb"){switch(d){case"rgb":{const[g,_,v,T]=As(t.rgb,a.rgb,s);return new _i(g,_,v,T,!1)}case"hcl":{const[g,_,v,T]=t.hcl,[M,P,D,j]=a.hcl;let U,G;if(isNaN(g)||isNaN(M))isNaN(g)?isNaN(M)?U=NaN:(U=M,v!==1&&v!==0||(G=P)):(U=g,D!==1&&D!==0||(G=_));else{let le=M-g;M>g&&le>180?le-=360:M<g&&g-M>180&&(le+=360),U=g+s*le}const[X,ee,oe,ye]=function([le,N,J,de]){return le=isNaN(le)?0:le*Kc,Yl([J,Math.cos(le)*N,Math.sin(le)*N,de])}([U,G??Vr(_,P,s),Vr(v,D,s),Vr(T,j,s)]);return new _i(X,ee,oe,ye,!1)}case"lab":{const[g,_,v,T]=Yl(As(t.lab,a.lab,s));return new _i(g,_,v,T,!1)}}}}_i.black=new _i(0,0,0,1),_i.white=new _i(1,1,1,1),_i.transparent=new _i(0,0,0,0),_i.red=new _i(1,0,0,1);class fr{constructor(t,a,s){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Wl=["bottom","center","top"];class zs{constructor(t,a,s,d,g,_){this.text=t,this.image=a,this.scale=s,this.fontStack=d,this.textColor=g,this.verticalAlign=_}}class Tr{constructor(t){this.sections=t}static fromString(t){return new Tr([new zs(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Tr?t:Tr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class ir{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ir)return t;if(typeof t=="number")return new ir([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new ir(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,s){return new ir(As(t.values,a.values,s))}}class pn{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Qc=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class cr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof cr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let a=0;a<t.length;a+=2){const s=t[a],d=t[a+1];if(typeof s!="string"||!Qc.has(s)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new cr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,s){const d=t.values,g=a.values;if(d.length!==g.length)throw new pn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${a.toString()}`);const _=[];for(let v=0;v<d.length;v+=2){if(d[v]!==g[v])throw new pn(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${d[v]}, to[${v}]: ${g[v]}`);_.push(d[v]);const[T,M]=d[v+1],[P,D]=g[v+1];_.push([Vr(T,P,s),Vr(M,D,s)])}return new cr(_)}}class Sr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Sr({name:t,available:!1}):null}}class Gn{constructor(t,a,s){this.from=t,this.to=a,this.transition=s}static interpolate(t,a,s){return new Gn(t,a,s)}static parse(t){return t instanceof Gn?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Gn(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Gn(t.from,t.to,t.transition):typeof t=="string"?new Gn(t,t,1):void 0}}function Rs(r,t,a,s){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[r,t,a,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[r,t,a,s]:[r,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function na(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Gn||r instanceof _i||r instanceof fr||r instanceof Tr||r instanceof ir||r instanceof cr||r instanceof Sr)return!0;if(Array.isArray(r)){for(const t of r)if(!na(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!na(r[t]))return!1;return!0}return!1}function rn(r){if(r===null)return pi;if(typeof r=="string")return Rt;if(typeof r=="boolean")return _t;if(typeof r=="number")return st;if(r instanceof _i)return Xt;if(r instanceof Gn)return fn;if(r instanceof fr)return zn;if(r instanceof Tr)return Pi;if(r instanceof ir)return Zn;if(r instanceof cr)return wo;if(r instanceof Sr)return Ts;if(Array.isArray(r)){const t=r.length;let a;for(const s of r){const d=rn(s);if(a){if(a===d)continue;a=Ft;break}a=d}return Xn(a||Ft,t)}return Ur}function Yo(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof _i||r instanceof Gn||r instanceof Tr||r instanceof ir||r instanceof cr||r instanceof Sr?r.toString():JSON.stringify(r)}class So{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!na(t[1]))return a.error("invalid value");const s=t[1];let d=rn(s);const g=a.expectedType;return d.kind!=="array"||d.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(d=g),new So(d,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Eo={string:Rt,number:st,boolean:_t,object:Ur};class On{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let s,d=1;const g=t[0];if(g==="array"){let v,T;if(t.length>2){const M=t[1];if(typeof M!="string"||!(M in Eo)||M==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);v=Eo[M],d++}else v=Ft;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);T=t[2],d++}s=Xn(v,T)}else{if(!Eo[g])throw new Error(`Types doesn't contain name = ${g}`);s=Eo[g]}const _=[];for(;d<t.length;d++){const v=a.parse(t[d],d,Ft);if(!v)return null;_.push(v)}return new On(s,_)}evaluate(t){for(let a=0;a<this.args.length;a++){const s=this.args[a].evaluate(t);if(!Ss(this.type,rn(s)))return s;if(a===this.args.length-1)throw new pn(`Expected value to be of type ${Fi(this.type)}, but found ${Fi(rn(s))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Zi={"to-boolean":_t,"to-color":Xt,"to-number":st,"to-string":Rt};class Zr{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const s=t[0];if(!Zi[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&t.length!==2)return a.error("Expected one argument.");const d=Zi[s],g=[];for(let _=1;_<t.length;_++){const v=a.parse(t[_],_,Ft);if(!v)return null;g.push(v)}return new Zr(d,g)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let a,s;for(const d of this.args){if(a=d.evaluate(t),s=null,a instanceof _i)return a;if(typeof a=="string"){const g=t.parseColor(a);if(g)return g}else if(Array.isArray(a)&&(s=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Rs(a[0],a[1],a[2],a[3]),!s))return new _i(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new pn(s||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const s of this.args){a=s.evaluate(t);const d=ir.parse(a);if(d)return d}throw new pn(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const s of this.args){a=s.evaluate(t);const d=cr.parse(a);if(d)return d}throw new pn(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const s of this.args){if(a=s.evaluate(t),a===null)return 0;const d=Number(a);if(!isNaN(d))return d}throw new pn(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return Tr.fromString(Yo(this.args[0].evaluate(t)));case"resolvedImage":return Sr.fromString(Yo(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Yo(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const oi=["Unknown","Point","LineString","Polygon"];class ii{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?oi[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache[t];return a||(a=this._parseColorCache[t]=_i.parse(t)),a}}class Co{constructor(t,a,s=[],d,g=new Gt,_=[]){this.registry=t,this.path=s,this.key=s.map(v=>`[${v}]`).join(""),this.scope=g,this.errors=_,this.expectedType=d,this._isConstant=a}parse(t,a,s,d,g={}){return a?this.concat(a,s,d)._parse(t,g):this._parse(t,g)}_parse(t,a){function s(d,g,_){return _==="assert"?new On(g,[d]):_==="coerce"?new Zr(g,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[d];if(g){let _=g.parse(t,this);if(!_)return null;if(this.expectedType){const v=this.expectedType,T=_.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="projectionDefinition"||T.kind!=="string"&&T.kind!=="array")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(v.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(v,T))return null}else _=s(_,v,a.typeAnnotation||"coerce");else _=s(_,v,a.typeAnnotation||"coerce");else _=s(_,v,a.typeAnnotation||"coerce");else _=s(_,v,a.typeAnnotation||"coerce");else _=s(_,v,a.typeAnnotation||"assert")}if(!(_ instanceof So)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const v=new ii;try{_=new So(_.type,_.evaluate(v))}catch(T){return this.error(T.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,s){const d=typeof t=="number"?this.path.concat(t):this.path,g=s?this.scope.concat(s):this.scope;return new Co(this.registry,this._isConstant,d,a||null,g,this.errors)}error(t,...a){const s=`${this.key}${a.map(d=>`[${d}]`).join("")}`;this.errors.push(new At(s,t))}checkSubtype(t,a){const s=Ss(t,a);return s&&this.error(s),s}}class mi{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let g=1;g<t.length-1;g+=2){const _=t[g];if(typeof _!="string")return a.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return a.error("Variable names must contain only alphanumeric characters or '_'.",g);const v=a.parse(t[g+1],g+1);if(!v)return null;s.push([_,v])}const d=a.parse(t[t.length-1],t.length-1,a.expectedType,s);return d?new mi(s,d):null}outputDefined(){return this.result.outputDefined()}}class Mo{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const s=t[1];return a.scope.has(s)?new Mo(s,a.scope.get(s)):a.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Gr{constructor(t,a,s){this.type=t,this.index=a,this.input=s}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=a.parse(t[1],1,st),d=a.parse(t[2],2,Xn(a.expectedType||Ft));return s&&d?new Gr(d.type.itemType,s,d):null}evaluate(t){const a=this.index.evaluate(t),s=this.input.evaluate(t);if(a<0)throw new pn(`Array index out of bounds: ${a} < 0.`);if(a>=s.length)throw new pn(`Array index out of bounds: ${a} > ${s.length-1}.`);if(a!==Math.floor(a))throw new pn(`Array index must be an integer, but found ${a} instead.`);return s[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class pl{constructor(t,a){this.type=_t,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=a.parse(t[1],1,Ft),d=a.parse(t[2],2,Ft);return s&&d?Xc(s.type,[_t,Rt,st,pi,Ft])?new pl(s,d):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(s.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!s)return!1;if(!Ho(a,["boolean","string","number","null"]))throw new pn(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(rn(a))} instead.`);if(!Ho(s,["string","array"]))throw new pn(`Expected second argument to be of type array or string, but found ${Fi(rn(s))} instead.`);return s.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class ur{constructor(t,a,s){this.type=st,this.needle=t,this.haystack=a,this.fromIndex=s}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=a.parse(t[1],1,Ft),d=a.parse(t[2],2,Ft);if(!s||!d)return null;if(!Xc(s.type,[_t,Rt,st,pi,Ft]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(s.type)} instead`);if(t.length===4){const g=a.parse(t[3],3,st);return g?new ur(s,d,g):null}return new ur(s,d)}evaluate(t){const a=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!Ho(a,["boolean","string","number","null"]))throw new pn(`Expected first argument to be of type boolean, string, number or null, but found ${Fi(rn(a))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(t)),Ho(s,["string"])){const g=s.indexOf(a,d);return g===-1?-1:[...s.slice(0,g)].length}if(Ho(s,["array"]))return s.indexOf(a,d);throw new pn(`Expected second argument to be of type array or string, but found ${Fi(rn(s))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Ka{constructor(t,a,s,d,g,_){this.inputType=t,this.type=a,this.input=s,this.cases=d,this.outputs=g,this.otherwise=_}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let s,d;a.expectedType&&a.expectedType.kind!=="value"&&(d=a.expectedType);const g={},_=[];for(let M=2;M<t.length-1;M+=2){let P=t[M];const D=t[M+1];Array.isArray(P)||(P=[P]);const j=a.concat(M);if(P.length===0)return j.error("Expected at least one branch label.");for(const G of P){if(typeof G!="number"&&typeof G!="string")return j.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return j.error("Numeric branch labels must be integer values.");if(s){if(j.checkSubtype(s,rn(G)))return null}else s=rn(G);if(g[String(G)]!==void 0)return j.error("Branch labels must be unique.");g[String(G)]=_.length}const U=a.parse(D,M,d);if(!U)return null;d=d||U.type,_.push(U)}const v=a.parse(t[1],1,Ft);if(!v)return null;const T=a.parse(t[t.length-1],t.length-1,d);return T?v.type.kind!=="value"&&a.concat(1).checkSubtype(s,v.type)?null:new Ka(s,d,v,g,_,T):null}evaluate(t){const a=this.input.evaluate(t);return(rn(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Ko{constructor(t,a,s){this.type=t,this.branches=a,this.otherwise=s}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let s;a.expectedType&&a.expectedType.kind!=="value"&&(s=a.expectedType);const d=[];for(let _=1;_<t.length-1;_+=2){const v=a.parse(t[_],_,_t);if(!v)return null;const T=a.parse(t[_+1],_+1,s);if(!T)return null;d.push([v,T]),s=s||T.type}const g=a.parse(t[t.length-1],t.length-1,s);if(!g)return null;if(!s)throw new Error("Can't infer output type");return new Ko(s,d,g)}evaluate(t){for(const[a,s]of this.branches)if(a.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,s]of this.branches)t(a),t(s);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class Ao{constructor(t,a,s,d){this.type=t,this.input=a,this.beginIndex=s,this.endIndex=d}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=a.parse(t[1],1,Ft),d=a.parse(t[2],2,st);if(!s||!d)return null;if(!Xc(s.type,[Xn(Ft),Rt,Ft]))return a.error(`Expected first argument to be of type array or string, but found ${Fi(s.type)} instead`);if(t.length===4){const g=a.parse(t[3],3,st);return g?new Ao(s.type,s,d,g):null}return new Ao(s.type,s,d)}evaluate(t){const a=this.input.evaluate(t),s=this.beginIndex.evaluate(t);let d;if(this.endIndex&&(d=this.endIndex.evaluate(t)),Ho(a,["string"]))return[...a].slice(s,d).join("");if(Ho(a,["array"]))return a.slice(s,d);throw new pn(`Expected first argument to be of type array or string, but found ${Fi(rn(a))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Jc(r,t){const a=r.length-1;let s,d,g=0,_=a,v=0;for(;g<=_;)if(v=Math.floor((g+_)/2),s=r[v],d=r[v+1],s<=t){if(v===a||t<d)return v;g=v+1}else{if(!(s>t))throw new pn("Input is not a number.");_=v-1}return 0}class Wo{constructor(t,a,s){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[d,g]of s)this.labels.push(d),this.outputs.push(g)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const s=a.parse(t[1],1,st);if(!s)return null;const d=[];let g=null;a.expectedType&&a.expectedType.kind!=="value"&&(g=a.expectedType);for(let _=1;_<t.length;_+=2){const v=_===1?-1/0:t[_],T=t[_+1],M=_,P=_+1;if(typeof v!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(d.length&&d[d.length-1][0]>=v)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const D=a.parse(T,P,g);if(!D)return null;g=g||D.type,d.push([v,D])}return new Wo(g,s,d)}evaluate(t){const a=this.labels,s=this.outputs;if(a.length===1)return s[0].evaluate(t);const d=this.input.evaluate(t);if(d<=a[0])return s[0].evaluate(t);const g=a.length;return d>=a[g-1]?s[g-1].evaluate(t):s[Jc(a,d)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function eu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ra,Yn,Ql=function(){if(Yn)return Ra;function r(t,a,s,d){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(d-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=s,this.p2y=d}return Yn=1,Ra=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,d=0;d<8;d++){var g=this.sampleCurveX(s)-t;if(Math.abs(g)<a)return s;var _=this.sampleCurveDerivativeX(s);if(Math.abs(_)<1e-6)break;s-=g/_}var v=0,T=1;for(s=t,d=0;d<20&&(g=this.sampleCurveX(s),!(Math.abs(g-t)<a));d++)t>g?v=s:T=s,s=.5*(T-v)+v;return s},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},Ra}(),Kh=eu(Ql);class Er{constructor(t,a,s,d,g){this.type=t,this.operator=a,this.interpolation=s,this.input=d,this.labels=[],this.outputs=[];for(const[_,v]of g)this.labels.push(_),this.outputs.push(v)}static interpolationFactor(t,a,s,d){let g=0;if(t.name==="exponential")g=Kn(a,t.base,s,d);else if(t.name==="linear")g=Kn(a,1,s,d);else if(t.name==="cubic-bezier"){const _=t.controlPoints;g=new Kh(_[0],_[1],_[2],_[3]).solve(Kn(a,1,s,d))}return g}static parse(t,a){let[s,d,g,..._]=t;if(!Array.isArray(d)||d.length===0)return a.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const M=d[1];if(typeof M!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:M}}else{if(d[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const M=d.slice(1);if(M.length!==4||M.some(P=>typeof P!="number"||P<0||P>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:M}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(g=a.parse(g,2,st),!g)return null;const v=[];let T=null;s==="interpolate-hcl"||s==="interpolate-lab"?T=Xt:a.expectedType&&a.expectedType.kind!=="value"&&(T=a.expectedType);for(let M=0;M<_.length;M+=2){const P=_[M],D=_[M+1],j=M+3,U=M+4;if(typeof P!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(v.length&&v[v.length-1][0]>=P)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const G=a.parse(D,U,T);if(!G)return null;T=T||G.type,v.push([P,G])}return To(T,st)||To(T,fn)||To(T,Xt)||To(T,Zn)||To(T,wo)||To(T,Xn(st))?new Er(T,s,d,g,v):a.error(`Type ${Fi(T)} is not interpolatable.`)}evaluate(t){const a=this.labels,s=this.outputs;if(a.length===1)return s[0].evaluate(t);const d=this.input.evaluate(t);if(d<=a[0])return s[0].evaluate(t);const g=a.length;if(d>=a[g-1])return s[g-1].evaluate(t);const _=Jc(a,d),v=Er.interpolationFactor(this.interpolation,d,a[_],a[_+1]),T=s[_].evaluate(t),M=s[_+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Vr(T,M,v);case"color":return _i.interpolate(T,M,v);case"padding":return ir.interpolate(T,M,v);case"variableAnchorOffsetCollection":return cr.interpolate(T,M,v);case"array":return As(T,M,v);case"projectionDefinition":return Gn.interpolate(T,M,v)}case"interpolate-hcl":return _i.interpolate(T,M,v,"hcl");case"interpolate-lab":return _i.interpolate(T,M,v,"lab")}}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Kn(r,t,a,s){const d=s-a,g=r-a;return d===0?0:t===1?g/d:(Math.pow(t,g)-1)/(Math.pow(t,d)-1)}const ra={color:_i.interpolate,number:Vr,padding:ir.interpolate,variableAnchorOffsetCollection:cr.interpolate,array:As};class ml{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let s=null;const d=a.expectedType;d&&d.kind!=="value"&&(s=d);const g=[];for(const v of t.slice(1)){const T=a.parse(v,1+g.length,s,void 0,{typeAnnotation:"omit"});if(!T)return null;s=s||T.type,g.push(T)}if(!s)throw new Error("No output type");const _=d&&g.some(v=>Ss(d,v.type));return new ml(_?Ft:s,g)}evaluate(t){let a,s=null,d=0;for(const g of this.args)if(d++,s=g.evaluate(t),s&&s instanceof Sr&&!s.available&&(a||(a=s.name),s=null,d===this.args.length&&(s=a)),s!==null)break;return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Ku(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Wh(r,t,a,s){return s.compare(t,a)===0}function zo(r,t,a){const s=r!=="=="&&r!=="!=";return class M_{constructor(g,_,v){this.type=_t,this.lhs=g,this.rhs=_,this.collator=v,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const v=g[0];let T=_.parse(g[1],1,Ft);if(!T)return null;if(!Ku(v,T.type))return _.concat(1).error(`"${v}" comparisons are not supported for type '${Fi(T.type)}'.`);let M=_.parse(g[2],2,Ft);if(!M)return null;if(!Ku(v,M.type))return _.concat(2).error(`"${v}" comparisons are not supported for type '${Fi(M.type)}'.`);if(T.type.kind!==M.type.kind&&T.type.kind!=="value"&&M.type.kind!=="value")return _.error(`Cannot compare types '${Fi(T.type)}' and '${Fi(M.type)}'.`);s&&(T.type.kind==="value"&&M.type.kind!=="value"?T=new On(M.type,[T]):T.type.kind!=="value"&&M.type.kind==="value"&&(M=new On(T.type,[M])));let P=null;if(g.length===4){if(T.type.kind!=="string"&&M.type.kind!=="string"&&T.type.kind!=="value"&&M.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(P=_.parse(g[3],3,zn),!P)return null}return new M_(T,M,P)}evaluate(g){const _=this.lhs.evaluate(g),v=this.rhs.evaluate(g);if(s&&this.hasUntypedArgument){const T=rn(_),M=rn(v);if(T.kind!==M.kind||T.kind!=="string"&&T.kind!=="number")throw new pn(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${T.kind}, ${M.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const T=rn(_),M=rn(v);if(T.kind!=="string"||M.kind!=="string")return t(g,_,v)}return this.collator?a(g,_,v,this.collator.evaluate(g)):t(g,_,v)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const Wu=zo("==",function(r,t,a){return t===a},Wh),Qh=zo("!=",function(r,t,a){return t!==a},function(r,t,a,s){return!Wh(0,t,a,s)}),tu=zo("<",function(r,t,a){return t<a},function(r,t,a,s){return s.compare(t,a)<0}),iu=zo(">",function(r,t,a){return t>a},function(r,t,a,s){return s.compare(t,a)>0}),Pa=zo("<=",function(r,t,a){return t<=a},function(r,t,a,s){return s.compare(t,a)<=0}),Jh=zo(">=",function(r,t,a){return t>=a},function(r,t,a,s){return s.compare(t,a)>=0});class Ro{constructor(t,a,s){this.type=zn,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const s=t[1];if(typeof s!="object"||Array.isArray(s))return a.error("Collator options argument must be an object.");const d=a.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,_t);if(!d)return null;const g=a.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,_t);if(!g)return null;let _=null;return s.locale&&(_=a.parse(s.locale,1,Rt),!_)?null:new Ro(d,g,_)}evaluate(t){return new fr(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Qu{constructor(t,a,s,d,g){this.type=Rt,this.number=t,this.locale=a,this.currency=s,this.minFractionDigits=d,this.maxFractionDigits=g}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const s=a.parse(t[1],1,st);if(!s)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return a.error("NumberFormat options argument must be an object.");let g=null;if(d.locale&&(g=a.parse(d.locale,1,Rt),!g))return null;let _=null;if(d.currency&&(_=a.parse(d.currency,1,Rt),!_))return null;let v=null;if(d["min-fraction-digits"]&&(v=a.parse(d["min-fraction-digits"],1,st),!v))return null;let T=null;return d["max-fraction-digits"]&&(T=a.parse(d["max-fraction-digits"],1,st),!T)?null:new Qu(s,g,_,v,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class gl{constructor(t){this.type=Pi,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&typeof s=="object")return a.error("First argument must be an image or text section.");const d=[];let g=!1;for(let _=1;_<=t.length-1;++_){const v=t[_];if(g&&typeof v=="object"&&!Array.isArray(v)){g=!1;let T=null;if(v["font-scale"]&&(T=a.parse(v["font-scale"],1,st),!T))return null;let M=null;if(v["text-font"]&&(M=a.parse(v["text-font"],1,Xn(Rt)),!M))return null;let P=null;if(v["text-color"]&&(P=a.parse(v["text-color"],1,Xt),!P))return null;let D=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!Wl.includes(v["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(D=a.parse(v["vertical-align"],1,Rt),!D)return null}const j=d[d.length-1];j.scale=T,j.font=M,j.textColor=P,j.verticalAlign=D}else{const T=a.parse(t[_],1,Ft);if(!T)return null;const M=T.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,d.push({content:T,scale:null,font:null,textColor:null,verticalAlign:null})}}return new gl(d)}evaluate(t){return new Tr(this.sections.map(a=>{const s=a.content.evaluate(t);return rn(s)===Ts?new zs("",s,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(t):null):new zs(Yo(s),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null,a.verticalAlign?a.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor),a.verticalAlign&&t(a.verticalAlign)}outputDefined(){return!1}}class Ju{constructor(t){this.type=Ts,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const s=a.parse(t[1],1,Rt);return s?new Ju(s):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),s=Sr.fromString(a);return s&&t.availableImages&&(s.available=t.availableImages.indexOf(a)>-1),s}eachChild(t){t(this.input)}outputDefined(){return!1}}class nu{constructor(t){this.type=st,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=a.parse(t[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${Fi(s.type)} instead.`):new nu(s):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new pn(`Expected value to be of type string or array, but found ${Fi(rn(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Wa=8192;function tf(r,t){const a=(180+r[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(a*d*Wa),Math.round(s*d*Wa)]}function _l(r,t){const a=Math.pow(2,t.z);return[(d=(r[0]/Wa+t.x)/a,360*d-180),(s=(r[1]/Wa+t.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,d}function Jl(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function yl(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function ed(r,t,a){const s=r[0]-t[0],d=r[1]-t[1],g=r[0]-a[0],_=r[1]-a[1];return s*_-g*d==0&&s*g<=0&&d*_<=0}function ru(r,t,a,s){return(d=[s[0]-a[0],s[1]-a[1]])[0]*(g=[t[0]-r[0],t[1]-r[1]])[1]-d[1]*g[0]!=0&&!(!th(r,t,a,s)||!th(a,s,r,t));var d,g}function td(r,t,a){for(const s of a)for(let d=0;d<s.length-1;++d)if(ru(r,t,s[d],s[d+1]))return!0;return!1}function vl(r,t,a=!1){let s=!1;for(const v of t)for(let T=0;T<v.length-1;T++){if(ed(r,v[T],v[T+1]))return a;(g=v[T])[1]>(d=r)[1]!=(_=v[T+1])[1]>d[1]&&d[0]<(_[0]-g[0])*(d[1]-g[1])/(_[1]-g[1])+g[0]&&(s=!s)}var d,g,_;return s}function eh(r,t){for(const a of t)if(vl(r,a))return!0;return!1}function xl(r,t){for(const a of r)if(!vl(a,t))return!1;for(let a=0;a<r.length-1;++a)if(td(r[a],r[a+1],t))return!1;return!0}function nf(r,t){for(const a of t)if(xl(r,a))return!0;return!1}function th(r,t,a,s){const d=s[0]-a[0],g=s[1]-a[1],_=(r[0]-a[0])*g-d*(r[1]-a[1]),v=(t[0]-a[0])*g-d*(t[1]-a[1]);return _>0&&v<0||_<0&&v>0}function ec(r,t,a){const s=[];for(let d=0;d<r.length;d++){const g=[];for(let _=0;_<r[d].length;_++){const v=tf(r[d][_],a);Jl(t,v),g.push(v)}s.push(g)}return s}function au(r,t,a){const s=[];for(let d=0;d<r.length;d++){const g=ec(r[d],t,a);s.push(g)}return s}function ou(r,t,a,s){if(r[0]<a[0]||r[0]>a[2]){const d=.5*s;let g=r[0]-a[0]>d?-s:a[0]-r[0]>d?s:0;g===0&&(g=r[0]-a[2]>d?-s:a[2]-r[0]>d?s:0),r[0]+=g}Jl(t,r)}function ih(r,t,a,s){const d=Math.pow(2,s.z)*Wa,g=[s.x*Wa,s.y*Wa],_=[];for(const v of r)for(const T of v){const M=[T.x+g[0],T.y+g[1]];ou(M,t,a,d),_.push(M)}return _}function Ps(r,t,a,s){const d=Math.pow(2,s.z)*Wa,g=[s.x*Wa,s.y*Wa],_=[];for(const T of r){const M=[];for(const P of T){const D=[P.x+g[0],P.y+g[1]];Jl(t,D),M.push(D)}_.push(M)}if(t[2]-t[0]<=d/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const T of _)for(const M of T)ou(M,t,a,d)}var v;return _}class Is{constructor(t,a){this.type=_t,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(na(t[1])){const s=t[1];if(s.type==="FeatureCollection"){const d=[];for(const g of s.features){const{type:_,coordinates:v}=g.geometry;_==="Polygon"&&d.push(v),_==="MultiPolygon"&&d.push(...v)}if(d.length)return new Is(s,{type:"MultiPolygon",coordinates:d})}else if(s.type==="Feature"){const d=s.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Is(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new Is(s,s)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,s){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=a.canonicalID();if(s.type==="Polygon"){const v=ec(s.coordinates,g,_),T=ih(a.geometry(),d,g,_);if(!yl(d,g))return!1;for(const M of T)if(!vl(M,v))return!1}if(s.type==="MultiPolygon"){const v=au(s.coordinates,g,_),T=ih(a.geometry(),d,g,_);if(!yl(d,g))return!1;for(const M of T)if(!eh(M,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,s){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=a.canonicalID();if(s.type==="Polygon"){const v=ec(s.coordinates,g,_),T=Ps(a.geometry(),d,g,_);if(!yl(d,g))return!1;for(const M of T)if(!xl(M,v))return!1}if(s.type==="MultiPolygon"){const v=au(s.coordinates,g,_),T=Ps(a.geometry(),d,g,_);if(!yl(d,g))return!1;for(const M of T)if(!nf(M,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let su=class{constructor(r=[],t=(a,s)=>a<s?-1:a>s?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:a}=this,s=t[r];for(;r>0;){const d=r-1>>1,g=t[d];if(a(s,g)>=0)break;t[r]=g,r=d}t[r]=s}_down(r){const{data:t,compare:a}=this,s=this.length>>1,d=t[r];for(;r<s;){let g=1+(r<<1);const _=g+1;if(_<this.length&&a(t[_],t[g])<0&&(g=_),a(t[g],d)>=0)break;t[r]=t[g],r=g}t[r]=d}};function id(r,t,a=0,s=r.length-1,d=nd){for(;s>a;){if(s-a>600){const T=s-a+1,M=t-a+1,P=Math.log(T),D=.5*Math.exp(2*P/3),j=.5*Math.sqrt(P*D*(T-D)/T)*(M-T/2<0?-1:1);id(r,t,Math.max(a,Math.floor(t-M*D/T+j)),Math.min(s,Math.floor(t+(T-M)*D/T+j)),d)}const g=r[t];let _=a,v=s;for(bl(r,a,t),d(r[s],g)>0&&bl(r,a,s);_<v;){for(bl(r,_,v),_++,v--;d(r[_],g)<0;)_++;for(;d(r[v],g)>0;)v--}d(r[a],g)===0?bl(r,a,v):(v++,bl(r,v,s)),v<=t&&(a=v+1),t<=v&&(s=v-1)}}function bl(r,t,a){const s=r[t];r[t]=r[a],r[a]=s}function nd(r,t){return r<t?-1:r>t?1:0}function Po(r,t){if(r.length<=1)return[r];const a=[];let s,d;for(const g of r){const _=rf(g);_!==0&&(g.area=Math.abs(_),d===void 0&&(d=_<0),d===_<0?(s&&a.push(s),s=[g]):s.push(g))}if(s&&a.push(s),t>1)for(let g=0;g<a.length;g++)a[g].length<=t||(id(a[g],t,1,a[g].length-1,wl),a[g]=a[g].slice(0,t));return a}function wl(r,t){return t.area-r.area}function rf(r){let t=0;for(let a,s,d=0,g=r.length,_=g-1;d<g;_=d++)a=r[d],s=r[_],t+=(s.x-a.x)*(a.y+s.y);return t}const tc=1/298.257223563,lu=tc*(2-tc),cu=Math.PI/180;class ic{constructor(t){const a=6378.137*cu*1e3,s=Math.cos(t*cu),d=1/(1-lu*(1-s*s)),g=Math.sqrt(d);this.kx=a*g*s,this.ky=a*g*d*(1-lu)}distance(t,a){const s=this.wrap(t[0]-a[0])*this.kx,d=(t[1]-a[1])*this.ky;return Math.sqrt(s*s+d*d)}pointOnLine(t,a){let s,d,g,_,v=1/0;for(let T=0;T<t.length-1;T++){let M=t[T][0],P=t[T][1],D=this.wrap(t[T+1][0]-M)*this.kx,j=(t[T+1][1]-P)*this.ky,U=0;D===0&&j===0||(U=(this.wrap(a[0]-M)*this.kx*D+(a[1]-P)*this.ky*j)/(D*D+j*j),U>1?(M=t[T+1][0],P=t[T+1][1]):U>0&&(M+=D/this.kx*U,P+=j/this.ky*U)),D=this.wrap(a[0]-M)*this.kx,j=(a[1]-P)*this.ky;const G=D*D+j*j;G<v&&(v=G,s=M,d=P,g=T,_=U)}return{point:[s,d],index:g,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function uu(r,t){return t[0]-r[0]}function nc(r){return r[1]-r[0]+1}function Ia(r,t){return r[1]>=r[0]&&r[1]<t}function hu(r,t){if(r[0]>r[1])return[null,null];const a=nc(r);if(t){if(a===2)return[r,null];const d=Math.floor(a/2);return[[r[0],r[0]+d],[r[0]+d,r[1]]]}if(a===1)return[r,null];const s=Math.floor(a/2)-1;return[[r[0],r[0]+s],[r[0]+s+1,r[1]]]}function nh(r,t){if(!Ia(t,r.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let s=t[0];s<=t[1];++s)Jl(a,r[s]);return a}function rh(r){const t=[1/0,1/0,-1/0,-1/0];for(const a of r)for(const s of a)Jl(t,s);return t}function rd(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function Ei(r,t,a){if(!rd(r)||!rd(t))return NaN;let s=0,d=0;return r[2]<t[0]&&(s=t[0]-r[2]),r[0]>t[2]&&(s=r[0]-t[2]),r[1]>t[3]&&(d=r[1]-t[3]),r[3]<t[1]&&(d=t[1]-r[3]),a.distance([0,0],[s,d])}function Ds(r,t,a){const s=a.pointOnLine(t,r);return a.distance(r,s.point)}function Rr(r,t,a,s,d){const g=Math.min(Ds(r,[a,s],d),Ds(t,[a,s],d)),_=Math.min(Ds(a,[r,t],d),Ds(s,[r,t],d));return Math.min(g,_)}function rc(r,t,a,s,d){if(!Ia(t,r.length)||!Ia(s,a.length))return 1/0;let g=1/0;for(let _=t[0];_<t[1];++_){const v=r[_],T=r[_+1];for(let M=s[0];M<s[1];++M){const P=a[M],D=a[M+1];if(ru(v,T,P,D))return 0;g=Math.min(g,Rr(v,T,P,D,d))}}return g}function ad(r,t,a,s,d){if(!Ia(t,r.length)||!Ia(s,a.length))return NaN;let g=1/0;for(let _=t[0];_<=t[1];++_)for(let v=s[0];v<=s[1];++v)if(g=Math.min(g,d.distance(r[_],a[v])),g===0)return g;return g}function od(r,t,a){if(vl(r,t,!0))return 0;let s=1/0;for(const d of t){const g=d[0],_=d[d.length-1];if(g!==_&&(s=Math.min(s,Ds(r,[_,g],a)),s===0))return s;const v=a.pointOnLine(d,r);if(s=Math.min(s,a.distance(r,v.point)),s===0)return s}return s}function sd(r,t,a,s){if(!Ia(t,r.length))return NaN;for(let g=t[0];g<=t[1];++g)if(vl(r[g],a,!0))return 0;let d=1/0;for(let g=t[0];g<t[1];++g){const _=r[g],v=r[g+1];for(const T of a)for(let M=0,P=T.length,D=P-1;M<P;D=M++){const j=T[D],U=T[M];if(ru(_,v,j,U))return 0;d=Math.min(d,Rr(_,v,j,U,s))}}return d}function ah(r,t){for(const a of r)for(const s of a)if(vl(s,t,!0))return!0;return!1}function oh(r,t,a,s=1/0){const d=rh(r),g=rh(t);if(s!==1/0&&Ei(d,g,a)>=s)return s;if(yl(d,g)){if(ah(r,t))return 0}else if(ah(t,r))return 0;let _=1/0;for(const v of r)for(let T=0,M=v.length,P=M-1;T<M;P=T++){const D=v[P],j=v[T];for(const U of t)for(let G=0,X=U.length,ee=X-1;G<X;ee=G++){const oe=U[ee],ye=U[G];if(ru(D,j,oe,ye))return 0;_=Math.min(_,Rr(D,j,oe,ye,a))}}return _}function ld(r,t,a,s,d,g){if(!g)return;const _=Ei(nh(s,g),d,a);_<t&&r.push([_,g,[0,0]])}function Io(r,t,a,s,d,g,_){if(!g||!_)return;const v=Ei(nh(s,g),nh(d,_),a);v<t&&r.push([v,g,_])}function Tl(r,t,a,s,d=1/0){let g=Math.min(s.distance(r[0],a[0][0]),d);if(g===0)return g;const _=new su([[0,[0,r.length-1],[0,0]]],uu),v=rh(a);for(;_.length>0;){const T=_.pop();if(T[0]>=g)continue;const M=T[1],P=t?50:100;if(nc(M)<=P){if(!Ia(M,r.length))return NaN;if(t){const D=sd(r,M,a,s);if(isNaN(D)||D===0)return D;g=Math.min(g,D)}else for(let D=M[0];D<=M[1];++D){const j=od(r[D],a,s);if(g=Math.min(g,j),g===0)return 0}}else{const D=hu(M,t);ld(_,g,s,r,v,D[0]),ld(_,g,s,r,v,D[1])}}return g}function Qo(r,t,a,s,d,g=1/0){let _=Math.min(g,d.distance(r[0],a[0]));if(_===0)return _;const v=new su([[0,[0,r.length-1],[0,a.length-1]]],uu);for(;v.length>0;){const T=v.pop();if(T[0]>=_)continue;const M=T[1],P=T[2],D=t?50:100,j=s?50:100;if(nc(M)<=D&&nc(P)<=j){if(!Ia(M,r.length)&&Ia(P,a.length))return NaN;let U;if(t&&s)U=rc(r,M,a,P,d),_=Math.min(_,U);else if(t&&!s){const G=r.slice(M[0],M[1]+1);for(let X=P[0];X<=P[1];++X)if(U=Ds(a[X],G,d),_=Math.min(_,U),_===0)return _}else if(!t&&s){const G=a.slice(P[0],P[1]+1);for(let X=M[0];X<=M[1];++X)if(U=Ds(r[X],G,d),_=Math.min(_,U),_===0)return _}else U=ad(r,M,a,P,d),_=Math.min(_,U)}else{const U=hu(M,t),G=hu(P,s);Io(v,_,d,r,a,U[0],G[0]),Io(v,_,d,r,a,U[0],G[1]),Io(v,_,d,r,a,U[1],G[0]),Io(v,_,d,r,a,U[1],G[1])}}return _}function ac(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class Jo{constructor(t,a){this.type=st,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(na(t[1])){const s=t[1];if(s.type==="FeatureCollection")return new Jo(s,s.features.map(d=>ac(d.geometry)).flat());if(s.type==="Feature")return new Jo(s,ac(s.geometry));if("type"in s&&"coordinates"in s)return new Jo(s,ac(s))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,s){const d=a.geometry(),g=d.flat().map(T=>_l([T.x,T.y],a.canonical));if(d.length===0)return NaN;const _=new ic(g[0][1]);let v=1/0;for(const T of s){switch(T.type){case"Point":v=Math.min(v,Qo(g,!1,[T.coordinates],!1,_,v));break;case"LineString":v=Math.min(v,Qo(g,!1,T.coordinates,!0,_,v));break;case"Polygon":v=Math.min(v,Tl(g,!1,T.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,s){const d=a.geometry(),g=d.flat().map(T=>_l([T.x,T.y],a.canonical));if(d.length===0)return NaN;const _=new ic(g[0][1]);let v=1/0;for(const T of s){switch(T.type){case"Point":v=Math.min(v,Qo(g,!0,[T.coordinates],!1,_,v));break;case"LineString":v=Math.min(v,Qo(g,!0,T.coordinates,!0,_,v));break;case"Polygon":v=Math.min(v,Tl(g,!0,T.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="Polygon")return function(a,s){const d=a.geometry();if(d.length===0||d[0].length===0)return NaN;const g=Po(d,0).map(T=>T.map(M=>M.map(P=>_l([P.x,P.y],a.canonical)))),_=new ic(g[0][0][0][1]);let v=1/0;for(const T of s)for(const M of g){switch(T.type){case"Point":v=Math.min(v,Tl([T.coordinates],!1,M,_,v));break;case"LineString":v=Math.min(v,Tl(T.coordinates,!0,M,_,v));break;case"Polygon":v=Math.min(v,oh(M,T.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const fa={"==":Wu,"!=":Qh,">":iu,"<":tu,">=":Jh,"<=":Pa,array:On,at:Gr,boolean:On,case:Ko,coalesce:ml,collator:Ro,format:gl,image:Ju,in:pl,"index-of":ur,interpolate:Er,"interpolate-hcl":Er,"interpolate-lab":Er,length:nu,let:mi,literal:So,match:Ka,number:On,"number-format":Qu,object:On,slice:Ao,step:Wo,string:On,"to-boolean":Zr,"to-color":Zr,"to-number":Zr,"to-string":Zr,var:Mo,within:Is,distance:Jo};class pr{constructor(t,a,s,d){this.name=t,this.type=a,this._evaluate=s,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const s=t[0],d=pr.definitions[s];if(!d)return a.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,v=_.filter(([M])=>!Array.isArray(M)||M.length===t.length-1);let T=null;for(const[M,P]of v){T=new Co(a.registry,oc,a.path,null,a.scope);const D=[];let j=!1;for(let U=1;U<t.length;U++){const G=t[U],X=Array.isArray(M)?M[U-1]:M.type,ee=T.parse(G,1+D.length,X);if(!ee){j=!0;break}D.push(ee)}if(!j)if(Array.isArray(M)&&M.length!==D.length)T.error(`Expected ${M.length} arguments, but found ${D.length} instead.`);else{for(let U=0;U<D.length;U++){const G=Array.isArray(M)?M[U]:M.type,X=D[U];T.concat(U+1).checkSubtype(G,X.type)}if(T.errors.length===0)return new pr(s,g,P,D)}}if(v.length===1)a.errors.push(...T.errors);else{const M=(v.length?v:_).map(([D])=>{return j=D,Array.isArray(j)?`(${j.map(Fi).join(", ")})`:`(${Fi(j.type)}...)`;var j}).join(" | "),P=[];for(let D=1;D<t.length;D++){const j=a.parse(t[D],1+P.length);if(!j)return null;P.push(Fi(j.type))}a.error(`Expected arguments of type ${M}, but found (${P.join(", ")}) instead.`)}return null}static register(t,a){pr.definitions=a;for(const s in a)t[s]=pr}}function du(r,[t,a,s,d]){t=t.evaluate(r),a=a.evaluate(r),s=s.evaluate(r);const g=d?d.evaluate(r):1,_=Rs(t,a,s,g);if(_)throw new pn(_);return new _i(t/255,a/255,s/255,g,!1)}function sh(r,t){return r in t}function Do(r,t){const a=t[r];return a===void 0?null:a}function es(r){return{type:r}}function oc(r){if(r instanceof Mo)return oc(r.boundExpression);if(r instanceof pr&&r.name==="error"||r instanceof Ro||r instanceof Is||r instanceof Jo)return!1;const t=r instanceof Zr||r instanceof On;let a=!0;return r.eachChild(s=>{a=t?a&&oc(s):a&&s instanceof So}),!!a&&sc(r)&&fu(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function sc(r){if(r instanceof pr&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Is||r instanceof Jo)return!1;let t=!0;return r.eachChild(a=>{t&&!sc(a)&&(t=!1)}),t}function lc(r){if(r instanceof pr&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(a=>{t&&!lc(a)&&(t=!1)}),t}function fu(r,t){if(r instanceof pr&&t.indexOf(r.name)>=0)return!1;let a=!0;return r.eachChild(s=>{a&&!fu(s,t)&&(a=!1)}),a}function cd(r){return{result:"success",value:r}}function ks(r){return{result:"error",value:r}}function Ls(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function pu(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function aa(r){return!!r.expression&&r.expression.interpolated}function xi(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Pr(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function qr(r){return r}function Bs(r,t){const a=t.type==="color",s=r.stops&&typeof r.stops[0][0]=="object",d=s||!(s||r.property!==void 0),g=r.type||(aa(t)?"exponential":"interval");if(a||t.type==="padding"){const P=a?_i.parse:ir.parse;(r=Bt({},r)).stops&&(r.stops=r.stops.map(D=>[D[0],P(D[1])])),r.default=P(r.default?r.default:t.default)}if(r.colorSpace&&(_=r.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var _;let v,T,M;if(g==="exponential")v=gu;else if(g==="interval")v=cc;else if(g==="categorical"){v=mu,T=Object.create(null);for(const P of r.stops)T[P[0]]=P[1];M=typeof r.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);v=Sl}if(s){const P={},D=[];for(let G=0;G<r.stops.length;G++){const X=r.stops[G],ee=X[0].zoom;P[ee]===void 0&&(P[ee]={zoom:ee,type:r.type,property:r.property,default:r.default,stops:[]},D.push(ee)),P[ee].stops.push([X[0].value,X[1]])}const j=[];for(const G of D)j.push([P[G].zoom,Bs(P[G],t)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Er.interpolationFactor.bind(void 0,U),zoomStops:j.map(G=>G[0]),evaluate:({zoom:G},X)=>gu({stops:j,base:r.base},t,G).evaluate(G,X)}}if(d){const P=g==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Er.interpolationFactor.bind(void 0,P),zoomStops:r.stops.map(D=>D[0]),evaluate:({zoom:D})=>v(r,t,D,T,M)}}return{kind:"source",evaluate(P,D){const j=D&&D.properties?D.properties[r.property]:void 0;return j===void 0?Os(r.default,t.default):v(r,t,j,T,M)}}}function Os(r,t,a){return r!==void 0?r:t!==void 0?t:a!==void 0?a:void 0}function mu(r,t,a,s,d){return Os(typeof a===d?s[a]:void 0,r.default,t.default)}function cc(r,t,a){if(xi(a)!=="number")return Os(r.default,t.default);const s=r.stops.length;if(s===1||a<=r.stops[0][0])return r.stops[0][1];if(a>=r.stops[s-1][0])return r.stops[s-1][1];const d=Jc(r.stops.map(g=>g[0]),a);return r.stops[d][1]}function gu(r,t,a){const s=r.base!==void 0?r.base:1;if(xi(a)!=="number")return Os(r.default,t.default);const d=r.stops.length;if(d===1||a<=r.stops[0][0])return r.stops[0][1];if(a>=r.stops[d-1][0])return r.stops[d-1][1];const g=Jc(r.stops.map(P=>P[0]),a),_=function(P,D,j,U){const G=U-j,X=P-j;return G===0?0:D===1?X/G:(Math.pow(D,X)-1)/(Math.pow(D,G)-1)}(a,s,r.stops[g][0],r.stops[g+1][0]),v=r.stops[g][1],T=r.stops[g+1][1],M=ra[t.type]||qr;return typeof v.evaluate=="function"?{evaluate(...P){const D=v.evaluate.apply(void 0,P),j=T.evaluate.apply(void 0,P);if(D!==void 0&&j!==void 0)return M(D,j,_,r.colorSpace)}}:M(v,T,_,r.colorSpace)}function Sl(r,t,a){switch(t.type){case"color":a=_i.parse(a);break;case"formatted":a=Tr.fromString(a.toString());break;case"resolvedImage":a=Sr.fromString(a.toString());break;case"padding":a=ir.parse(a);break;default:xi(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return Os(a,r.default,t.default)}pr.register(fa,{error:[{kind:"error"},[Rt],(r,[t])=>{throw new pn(t.evaluate(r))}],typeof:[Rt,[Ft],(r,[t])=>Fi(rn(t.evaluate(r)))],"to-rgba":[Xn(st,4),[Xt],(r,[t])=>{const[a,s,d,g]=t.evaluate(r).rgb;return[255*a,255*s,255*d,g]}],rgb:[Xt,[st,st,st],du],rgba:[Xt,[st,st,st,st],du],has:{type:_t,overloads:[[[Rt],(r,[t])=>sh(t.evaluate(r),r.properties())],[[Rt,Ur],(r,[t,a])=>sh(t.evaluate(r),a.evaluate(r))]]},get:{type:Ft,overloads:[[[Rt],(r,[t])=>Do(t.evaluate(r),r.properties())],[[Rt,Ur],(r,[t,a])=>Do(t.evaluate(r),a.evaluate(r))]]},"feature-state":[Ft,[Rt],(r,[t])=>Do(t.evaluate(r),r.featureState||{})],properties:[Ur,[],r=>r.properties()],"geometry-type":[Rt,[],r=>r.geometryType()],id:[Ft,[],r=>r.id()],zoom:[st,[],r=>r.globals.zoom],"heatmap-density":[st,[],r=>r.globals.heatmapDensity||0],"line-progress":[st,[],r=>r.globals.lineProgress||0],accumulated:[Ft,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[st,es(st),(r,t)=>{let a=0;for(const s of t)a+=s.evaluate(r);return a}],"*":[st,es(st),(r,t)=>{let a=1;for(const s of t)a*=s.evaluate(r);return a}],"-":{type:st,overloads:[[[st,st],(r,[t,a])=>t.evaluate(r)-a.evaluate(r)],[[st],(r,[t])=>-t.evaluate(r)]]},"/":[st,[st,st],(r,[t,a])=>t.evaluate(r)/a.evaluate(r)],"%":[st,[st,st],(r,[t,a])=>t.evaluate(r)%a.evaluate(r)],ln2:[st,[],()=>Math.LN2],pi:[st,[],()=>Math.PI],e:[st,[],()=>Math.E],"^":[st,[st,st],(r,[t,a])=>Math.pow(t.evaluate(r),a.evaluate(r))],sqrt:[st,[st],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[st,[st],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[st,[st],(r,[t])=>Math.log(t.evaluate(r))],log2:[st,[st],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[st,[st],(r,[t])=>Math.sin(t.evaluate(r))],cos:[st,[st],(r,[t])=>Math.cos(t.evaluate(r))],tan:[st,[st],(r,[t])=>Math.tan(t.evaluate(r))],asin:[st,[st],(r,[t])=>Math.asin(t.evaluate(r))],acos:[st,[st],(r,[t])=>Math.acos(t.evaluate(r))],atan:[st,[st],(r,[t])=>Math.atan(t.evaluate(r))],min:[st,es(st),(r,t)=>Math.min(...t.map(a=>a.evaluate(r)))],max:[st,es(st),(r,t)=>Math.max(...t.map(a=>a.evaluate(r)))],abs:[st,[st],(r,[t])=>Math.abs(t.evaluate(r))],round:[st,[st],(r,[t])=>{const a=t.evaluate(r);return a<0?-Math.round(-a):Math.round(a)}],floor:[st,[st],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[st,[st],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[_t,[Rt,Ft],(r,[t,a])=>r.properties()[t.value]===a.value],"filter-id-==":[_t,[Ft],(r,[t])=>r.id()===t.value],"filter-type-==":[_t,[Rt],(r,[t])=>r.geometryType()===t.value],"filter-<":[_t,[Rt,Ft],(r,[t,a])=>{const s=r.properties()[t.value],d=a.value;return typeof s==typeof d&&s<d}],"filter-id-<":[_t,[Ft],(r,[t])=>{const a=r.id(),s=t.value;return typeof a==typeof s&&a<s}],"filter->":[_t,[Rt,Ft],(r,[t,a])=>{const s=r.properties()[t.value],d=a.value;return typeof s==typeof d&&s>d}],"filter-id->":[_t,[Ft],(r,[t])=>{const a=r.id(),s=t.value;return typeof a==typeof s&&a>s}],"filter-<=":[_t,[Rt,Ft],(r,[t,a])=>{const s=r.properties()[t.value],d=a.value;return typeof s==typeof d&&s<=d}],"filter-id-<=":[_t,[Ft],(r,[t])=>{const a=r.id(),s=t.value;return typeof a==typeof s&&a<=s}],"filter->=":[_t,[Rt,Ft],(r,[t,a])=>{const s=r.properties()[t.value],d=a.value;return typeof s==typeof d&&s>=d}],"filter-id->=":[_t,[Ft],(r,[t])=>{const a=r.id(),s=t.value;return typeof a==typeof s&&a>=s}],"filter-has":[_t,[Ft],(r,[t])=>t.value in r.properties()],"filter-has-id":[_t,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[_t,[Xn(Rt)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[_t,[Xn(Ft)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[_t,[Rt,Xn(Ft)],(r,[t,a])=>a.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[_t,[Rt,Xn(Ft)],(r,[t,a])=>function(s,d,g,_){for(;g<=_;){const v=g+_>>1;if(d[v]===s)return!0;d[v]>s?_=v-1:g=v+1}return!1}(r.properties()[t.value],a.value,0,a.value.length-1)],all:{type:_t,overloads:[[[_t,_t],(r,[t,a])=>t.evaluate(r)&&a.evaluate(r)],[es(_t),(r,t)=>{for(const a of t)if(!a.evaluate(r))return!1;return!0}]]},any:{type:_t,overloads:[[[_t,_t],(r,[t,a])=>t.evaluate(r)||a.evaluate(r)],[es(_t),(r,t)=>{for(const a of t)if(a.evaluate(r))return!0;return!1}]]},"!":[_t,[_t],(r,[t])=>!t.evaluate(r)],"is-supported-script":[_t,[Rt],(r,[t])=>{const a=r.globals&&r.globals.isSupportedScript;return!a||a(t.evaluate(r))}],upcase:[Rt,[Rt],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[Rt,[Rt],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[Rt,es(Ft),(r,t)=>t.map(a=>Yo(a.evaluate(r))).join("")],"resolved-locale":[Rt,[zn],(r,[t])=>t.evaluate(r).resolvedLocale()]});class js{constructor(t,a){var s;this.expression=t,this._warningHistory={},this._evaluator=new ii,this._defaultValue=a?(s=a).type==="color"&&Pr(s.default)?new _i(0,0,0,0):s.type==="color"?_i.parse(s.default)||null:s.type==="padding"?ir.parse(s.default)||null:s.type==="variableAnchorOffsetCollection"?cr.parse(s.default)||null:s.type==="projectionDefinition"?Gn.parse(s.default)||null:s.default===void 0?null:s.default:null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,s,d,g,_){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=s,this._evaluator.canonical=d,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,a,s,d,g,_){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=s||null,this._evaluator.canonical=d,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new pn(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function ts(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in fa}function ko(r,t){const a=new Co(fa,oc,[],t?function(d){const g={color:Xt,string:Rt,number:st,enum:Rt,boolean:_t,formatted:Pi,padding:Zn,projectionDefinition:fn,resolvedImage:Ts,variableAnchorOffsetCollection:wo};return d.type==="array"?Xn(g[d.value]||Ft,d.length):g[d.type]}(t):void 0),s=a.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?cd(new js(s,t)):ks(a.errors)}class lh{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!lc(a.expression)}evaluateWithoutErrorHandling(t,a,s,d,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,a,s,d,g,_)}evaluate(t,a,s,d,g,_){return this._styleExpression.evaluate(t,a,s,d,g,_)}}class Ir{constructor(t,a,s,d){this.kind=t,this.zoomStops=s,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!lc(a.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,a,s,d,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,a,s,d,g,_)}evaluate(t,a,s,d,g,_){return this._styleExpression.evaluate(t,a,s,d,g,_)}interpolationFactor(t,a,s){return this.interpolationType?Er.interpolationFactor(this.interpolationType,t,a,s):0}}function _u(r,t){const a=ko(r,t);if(a.result==="error")return a;const s=a.value.expression,d=sc(s);if(!d&&!Ls(t))return ks([new At("","data expressions not supported")]);const g=fu(s,["zoom"]);if(!g&&!pu(t))return ks([new At("","zoom expressions not supported")]);const _=El(s);return _||g?_ instanceof At?ks([_]):_ instanceof Er&&!aa(t)?ks([new At("",'"interpolate" expressions cannot be used with this property')]):cd(_?new Ir(d?"camera":"composite",a.value,_.labels,_ instanceof Er?_.interpolation:void 0):new lh(d?"constant":"source",a.value)):ks([new At("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class pa{constructor(t,a){this._parameters=t,this._specification=a,Bt(this,Bs(this._parameters,this._specification))}static deserialize(t){return new pa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function El(r){let t=null;if(r instanceof mi)t=El(r.result);else if(r instanceof ml){for(const a of r.args)if(t=El(a),t)break}else(r instanceof Wo||r instanceof Er)&&r.input instanceof pr&&r.input.name==="zoom"&&(t=r);return t instanceof At||r.eachChild(a=>{const s=El(a);s instanceof At?t=s:!t&&s?t=new At("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&s&&t!==s&&(t=new At("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Fs(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Fs(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Ns={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function uc(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Fs(r)||(r=Qa(r));const t=ko(r,Ns);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,s,d)=>t.value.evaluate(a,s,{},d),needGeometry:is(r)}}function yu(r,t){return r<t?-1:r>t?1:0}function is(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(is(r[t]))return!0;return!1}function Qa(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?Us(r[1],r[2],"=="):t==="!="?mr(Us(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Us(r[1],r[2],t):t==="any"?(a=r.slice(1),["any"].concat(a.map(Qa))):t==="all"?["all"].concat(r.slice(1).map(Qa)):t==="none"?["all"].concat(r.slice(1).map(Qa).map(mr)):t==="in"?Vs(r[1],r.slice(2)):t==="!in"?mr(Vs(r[1],r.slice(2))):t==="has"?Dr(r[1]):t!=="!has"||mr(Dr(r[1]));var a}function Us(r,t,a){switch(r){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,r,t]}}function Vs(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",r,["literal",t.sort(yu)]]:["filter-in-small",r,["literal",t]]}}function Dr(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function mr(r){return["!",r]}function ma(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let d="[";for(const g of r)d+=`${ma(g)},`;return`${d}]`}const a=Object.keys(r).sort();let s="{";for(let d=0;d<a.length;d++)s+=`${JSON.stringify(a[d])}:${ma(r[a[d]])},`;return`${s}}`}function Lo(r){let t="";for(const a of ue)t+=`/${ma(r[a])}`;return t}function Ja(r){const t=r.value;return t?[new Ze(r.key,t,"constants have been deprecated as of v8")]:[]}function Gi(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function ns(r){if(Array.isArray(r))return r.map(ns);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const a in r)t[a]=ns(r[a]);return t}return Gi(r)}function Hr(r){const t=r.key,a=r.value,s=r.valueSpec||{},d=r.objectElementValidators||{},g=r.style,_=r.styleSpec,v=r.validateSpec;let T=[];const M=xi(a);if(M!=="object")return[new Ze(t,a,`object expected, ${M} found`)];for(const P in a){const D=P.split(".")[0],j=s[D]||s["*"];let U;if(d[D])U=d[D];else if(s[D])U=v;else if(d["*"])U=d["*"];else{if(!s["*"]){T.push(new Ze(t,a[P],`unknown property "${P}"`));continue}U=v}T=T.concat(U({key:(t&&`${t}.`)+P,value:a[P],valueSpec:j,style:g,styleSpec:_,object:a,objectKey:P,validateSpec:v},a))}for(const P in s)d[P]||s[P].required&&s[P].default===void 0&&a[P]===void 0&&T.push(new Ze(t,a,`missing required property "${P}"`));return T}function hc(r){const t=r.value,a=r.valueSpec,s=r.style,d=r.styleSpec,g=r.key,_=r.arrayElementValidator||r.validateSpec;if(xi(t)!=="array")return[new Ze(g,t,`array expected, ${xi(t)} found`)];if(a.length&&t.length!==a.length)return[new Ze(g,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new Ze(g,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let v={type:a.value,values:a.values};d.$version<7&&(v.function=a.function),xi(a.value)==="object"&&(v=a.value);let T=[];for(let M=0;M<t.length;M++)T=T.concat(_({array:t,arrayIndex:M,value:t[M],valueSpec:v,validateSpec:r.validateSpec,style:s,styleSpec:d,key:`${g}[${M}]`}));return T}function hr(r){const t=r.key,a=r.value,s=r.valueSpec;let d=xi(a);return d==="number"&&a!=a&&(d="NaN"),d!=="number"?[new Ze(t,a,`number expected, ${d} found`)]:"minimum"in s&&a<s.minimum?[new Ze(t,a,`${a} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&a>s.maximum?[new Ze(t,a,`${a} is greater than the maximum value ${s.maximum}`)]:[]}function bn(r){const t=r.valueSpec,a=Gi(r.value.type);let s,d,g,_={};const v=a!=="categorical"&&r.value.property===void 0,T=!v,M=xi(r.value.stops)==="array"&&xi(r.value.stops[0])==="array"&&xi(r.value.stops[0][0])==="object",P=Hr({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(U){if(a==="identity")return[new Ze(U.key,U.value,'identity function may not have a "stops" property')];let G=[];const X=U.value;return G=G.concat(hc({key:U.key,value:X,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:D})),xi(X)==="array"&&X.length===0&&G.push(new Ze(U.key,X,"array must have at least one stop")),G},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return a==="identity"&&v&&P.push(new Ze(r.key,r.value,'missing required property "property"')),a==="identity"||r.value.stops||P.push(new Ze(r.key,r.value,'missing required property "stops"')),a==="exponential"&&r.valueSpec.expression&&!aa(r.valueSpec)&&P.push(new Ze(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(T&&!Ls(r.valueSpec)?P.push(new Ze(r.key,r.value,"property functions not supported")):v&&!pu(r.valueSpec)&&P.push(new Ze(r.key,r.value,"zoom functions not supported"))),a!=="categorical"&&!M||r.value.property!==void 0||P.push(new Ze(r.key,r.value,'"property" property is required')),P;function D(U){let G=[];const X=U.value,ee=U.key;if(xi(X)!=="array")return[new Ze(ee,X,`array expected, ${xi(X)} found`)];if(X.length!==2)return[new Ze(ee,X,`array length 2 expected, length ${X.length} found`)];if(M){if(xi(X[0])!=="object")return[new Ze(ee,X,`object expected, ${xi(X[0])} found`)];if(X[0].zoom===void 0)return[new Ze(ee,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new Ze(ee,X,"object stop key must have value")];if(g&&g>Gi(X[0].zoom))return[new Ze(ee,X[0].zoom,"stop zoom values must appear in ascending order")];Gi(X[0].zoom)!==g&&(g=Gi(X[0].zoom),d=void 0,_={}),G=G.concat(Hr({key:`${ee}[0]`,value:X[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:hr,value:j}}))}else G=G.concat(j({key:`${ee}[0]`,value:X[0],validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},X));return ts(ns(X[1]))?G.concat([new Ze(`${ee}[1]`,X[1],"expressions are not allowed in function stops.")]):G.concat(U.validateSpec({key:`${ee}[1]`,value:X[1],valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function j(U,G){const X=xi(U.value),ee=Gi(U.value),oe=U.value!==null?U.value:G;if(s){if(X!==s)return[new Ze(U.key,oe,`${X} stop domain type must match previous stop domain type ${s}`)]}else s=X;if(X!=="number"&&X!=="string"&&X!=="boolean")return[new Ze(U.key,oe,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&a!=="categorical"){let ye=`number expected, ${X} found`;return Ls(t)&&a===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ze(U.key,oe,ye)]}return a!=="categorical"||X!=="number"||isFinite(ee)&&Math.floor(ee)===ee?a!=="categorical"&&X==="number"&&d!==void 0&&ee<d?[new Ze(U.key,oe,"stop domain values must appear in ascending order")]:(d=ee,a==="categorical"&&ee in _?[new Ze(U.key,oe,"stop domain values must be unique")]:(_[ee]=!0,[])):[new Ze(U.key,oe,`integer expected, found ${ee}`)]}}function di(r){const t=(r.expressionContext==="property"?_u:ko)(ns(r.value),r.valueSpec);if(t.result==="error")return t.value.map(s=>new Ze(`${r.key}${s.key}`,r.value,s.message));const a=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!a.outputDefined())return[new Ze(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!lc(a))return[new Ze(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!lc(a))return[new Ze(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!fu(a,["zoom","feature-state"]))return[new Ze(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!sc(a))return[new Ze(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Da(r){const t=r.key,a=r.value,s=r.valueSpec,d=[];return Array.isArray(s.values)?s.values.indexOf(Gi(a))===-1&&d.push(new Ze(t,a,`expected one of [${s.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(s.values).indexOf(Gi(a))===-1&&d.push(new Ze(t,a,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(a)} found`)),d}function oa(r){return Fs(ns(r.value))?di(Bt({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):dc(r)}function dc(r){const t=r.value,a=r.key;if(xi(t)!=="array")return[new Ze(a,t,`array expected, ${xi(t)} found`)];const s=r.styleSpec;let d,g=[];if(t.length<1)return[new Ze(a,t,"filter array must have at least 1 element")];switch(g=g.concat(Da({key:`${a}[0]`,value:t[0],valueSpec:s.filter_operator,style:r.style,styleSpec:r.styleSpec})),Gi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Gi(t[1])==="$type"&&g.push(new Ze(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new Ze(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=xi(t[1]),d!=="string"&&g.push(new Ze(`${a}[1]`,t[1],`string expected, ${d} found`)));for(let _=2;_<t.length;_++)d=xi(t[_]),Gi(t[1])==="$type"?g=g.concat(Da({key:`${a}[${_}]`,value:t[_],valueSpec:s.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&g.push(new Ze(`${a}[${_}]`,t[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)g=g.concat(dc({key:`${a}[${_}]`,value:t[_],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=xi(t[1]),t.length!==2?g.push(new Ze(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&g.push(new Ze(`${a}[1]`,t[1],`string expected, ${d} found`))}return g}function rs(r,t){const a=r.key,s=r.validateSpec,d=r.style,g=r.styleSpec,_=r.value,v=r.objectKey,T=g[`${t}_${r.layerType}`];if(!T)return[];const M=v.match(/^(.*)-transition$/);if(t==="paint"&&M&&T[M[1]]&&T[M[1]].transition)return s({key:a,value:_,valueSpec:g.transition,style:d,styleSpec:g});const P=r.valueSpec||T[v];if(!P)return[new Ze(a,_,`unknown property "${v}"`)];let D;if(xi(_)==="string"&&Ls(P)&&!P.tokens&&(D=/^{([^}]+)}$/.exec(_)))return[new Ze(a,_,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];const j=[];return r.layerType==="symbol"&&(v==="text-field"&&d&&!d.glyphs&&j.push(new Ze(a,_,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Pr(ns(_))&&Gi(_.type)==="identity"&&j.push(new Ze(a,_,'"text-font" does not support identity functions'))),j.concat(s({key:r.key,value:_,valueSpec:P,style:d,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:v}))}function vu(r){return rs(r,"paint")}function xu(r){return rs(r,"layout")}function eo(r){let t=[];const a=r.value,s=r.key,d=r.style,g=r.styleSpec;a.type||a.ref||t.push(new Ze(s,a,'either "type" or "ref" is required'));let _=Gi(a.type);const v=Gi(a.ref);if(a.id){const T=Gi(a.id);for(let M=0;M<r.arrayIndex;M++){const P=d.layers[M];Gi(P.id)===T&&t.push(new Ze(s,a.id,`duplicate layer id "${a.id}", previously used at line ${P.id.__line__}`))}}if("ref"in a){let T;["type","source","source-layer","filter","layout"].forEach(M=>{M in a&&t.push(new Ze(s,a[M],`"${M}" is prohibited for ref layers`))}),d.layers.forEach(M=>{Gi(M.id)===v&&(T=M)}),T?T.ref?t.push(new Ze(s,a.ref,"ref cannot reference another ref layer")):_=Gi(T.type):t.push(new Ze(s,a.ref,`ref layer "${v}" not found`))}else if(_!=="background")if(a.source){const T=d.sources&&d.sources[a.source],M=T&&Gi(T.type);T?M==="vector"&&_==="raster"?t.push(new Ze(s,a.source,`layer "${a.id}" requires a raster source`)):M!=="raster-dem"&&_==="hillshade"?t.push(new Ze(s,a.source,`layer "${a.id}" requires a raster-dem source`)):M==="raster"&&_!=="raster"?t.push(new Ze(s,a.source,`layer "${a.id}" requires a vector source`)):M!=="vector"||a["source-layer"]?M==="raster-dem"&&_!=="hillshade"?t.push(new Ze(s,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!a.paint||!a.paint["line-gradient"]||M==="geojson"&&T.lineMetrics||t.push(new Ze(s,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ze(s,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new Ze(s,a.source,`source "${a.source}" not found`))}else t.push(new Ze(s,a,'missing required property "source"'));return t=t.concat(Hr({key:s,value:a,valueSpec:g.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${s}.type`,value:a.type,valueSpec:g.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:a,objectKey:"type"}),filter:oa,layout:T=>Hr({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>xu(Bt({layerType:_},M))}}),paint:T=>Hr({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>vu(Bt({layerType:_},M))}})}})),t}function ka(r){const t=r.value,a=r.key,s=xi(t);return s!=="string"?[new Ze(a,t,`string expected, ${s} found`)]:[]}const ch={promoteId:function({key:r,value:t}){if(xi(t)==="string")return ka({key:r,value:t});{const a=[];for(const s in t)a.push(...ka({key:`${r}.${s}`,value:t[s]}));return a}}};function Cl(r){const t=r.value,a=r.key,s=r.styleSpec,d=r.style,g=r.validateSpec;if(!t.type)return[new Ze(a,t,'"type" is required')];const _=Gi(t.type);let v;switch(_){case"vector":case"raster":return v=Hr({key:a,value:t,valueSpec:s[`source_${_.replace("-","_")}`],style:r.style,styleSpec:s,objectElementValidators:ch,validateSpec:g}),v;case"raster-dem":return v=function(T){var M;const P=(M=T.sourceName)!==null&&M!==void 0?M:"",D=T.value,j=T.styleSpec,U=j.source_raster_dem,G=T.style;let X=[];const ee=xi(D);if(D===void 0)return X;if(ee!=="object")return X.push(new Ze("source_raster_dem",D,`object expected, ${ee} found`)),X;const oe=Gi(D.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],le=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const N in D)!oe&&ye.includes(N)?X.push(new Ze(N,D[N],`In "${P}": "${N}" is only valid when "encoding" is set to "custom". ${le} encoding found`)):U[N]?X=X.concat(T.validateSpec({key:N,value:D[N],valueSpec:U[N],validateSpec:T.validateSpec,style:G,styleSpec:j})):X.push(new Ze(N,D[N],`unknown property "${N}"`));return X}({sourceName:a,value:t,style:r.style,styleSpec:s,validateSpec:g}),v;case"geojson":if(v=Hr({key:a,value:t,valueSpec:s.source_geojson,style:d,styleSpec:s,validateSpec:g,objectElementValidators:ch}),t.cluster)for(const T in t.clusterProperties){const[M,P]=t.clusterProperties[T],D=typeof M=="string"?[M,["accumulated"],["get",T]]:M;v.push(...di({key:`${a}.${T}.map`,value:P,expressionContext:"cluster-map"})),v.push(...di({key:`${a}.${T}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return v;case"video":return Hr({key:a,value:t,valueSpec:s.source_video,style:d,validateSpec:g,styleSpec:s});case"image":return Hr({key:a,value:t,valueSpec:s.source_image,style:d,validateSpec:g,styleSpec:s});case"canvas":return[new Ze(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Da({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function bu(r){const t=r.value,a=r.styleSpec,s=a.light,d=r.style;let g=[];const _=xi(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new Ze("light",t,`object expected, ${_} found`)]),g;for(const v in t){const T=v.match(/^(.*)-transition$/);g=g.concat(T&&s[T[1]]&&s[T[1]].transition?r.validateSpec({key:v,value:t[v],valueSpec:a.transition,validateSpec:r.validateSpec,style:d,styleSpec:a}):s[v]?r.validateSpec({key:v,value:t[v],valueSpec:s[v],validateSpec:r.validateSpec,style:d,styleSpec:a}):[new Ze(v,t[v],`unknown property "${v}"`)])}return g}function as(r){const t=r.value,a=r.styleSpec,s=a.sky,d=r.style,g=xi(t);if(t===void 0)return[];if(g!=="object")return[new Ze("sky",t,`object expected, ${g} found`)];let _=[];for(const v in t)_=_.concat(s[v]?r.validateSpec({key:v,value:t[v],valueSpec:s[v],style:d,styleSpec:a}):[new Ze(v,t[v],`unknown property "${v}"`)]);return _}function to(r){const t=r.value,a=r.styleSpec,s=a.terrain,d=r.style;let g=[];const _=xi(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new Ze("terrain",t,`object expected, ${_} found`)]),g;for(const v in t)g=g.concat(s[v]?r.validateSpec({key:v,value:t[v],valueSpec:s[v],validateSpec:r.validateSpec,style:d,styleSpec:a}):[new Ze(v,t[v],`unknown property "${v}"`)]);return g}function sa(r){let t=[];const a=r.value,s=r.key;if(Array.isArray(a)){const d=[],g=[];for(const _ in a)a[_].id&&d.includes(a[_].id)&&t.push(new Ze(s,a,`all the sprites' ids must be unique, but ${a[_].id} is duplicated`)),d.push(a[_].id),a[_].url&&g.includes(a[_].url)&&t.push(new Ze(s,a,`all the sprites' URLs must be unique, but ${a[_].url} is duplicated`)),g.push(a[_].url),t=t.concat(Hr({key:`${s}[${_}]`,value:a[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return ka({key:s,value:a})}const $r={"*":()=>[],array:hc,boolean:function(r){const t=r.value,a=r.key,s=xi(t);return s!=="boolean"?[new Ze(a,t,`boolean expected, ${s} found`)]:[]},number:hr,color:function(r){const t=r.key,a=r.value,s=xi(a);return s!=="string"?[new Ze(t,a,`color expected, ${s} found`)]:_i.parse(String(a))?[]:[new Ze(t,a,`color expected, "${a}" found`)]},constants:Ja,enum:Da,filter:oa,function:bn,layer:eo,object:Hr,source:Cl,light:bu,sky:as,terrain:to,projection:function(r){const t=r.value,a=r.styleSpec,s=a.projection,d=r.style,g=xi(t);if(t===void 0)return[];if(g!=="object")return[new Ze("projection",t,`object expected, ${g} found`)];let _=[];for(const v in t)_=_.concat(s[v]?r.validateSpec({key:v,value:t[v],valueSpec:s[v],style:d,styleSpec:a}):[new Ze(v,t[v],`unknown property "${v}"`)]);return _},projectionDefinition:function(r){const t=r.key;let a=r.value;a=a instanceof String?a.valueOf():a;const s=xi(a);return s!=="array"||function(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"}(a)||function(d){return!!["interpolate","step","literal"].includes(d[0])}(a)?["array","string"].includes(s)?[]:[new Ze(t,a,`projection expected, invalid type "${s}" found`)]:[new Ze(t,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:ka,formatted:function(r){return ka(r).length===0?[]:di(r)},resolvedImage:function(r){return ka(r).length===0?[]:di(r)},padding:function(r){const t=r.key,a=r.value;if(xi(a)==="array"){if(a.length<1||a.length>4)return[new Ze(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const s={type:"number"};let d=[];for(let g=0;g<a.length;g++)d=d.concat(r.validateSpec({key:`${t}[${g}]`,value:a[g],validateSpec:r.validateSpec,valueSpec:s}));return d}return hr({key:t,value:a,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const t=r.key,a=r.value,s=xi(a),d=r.styleSpec;if(s!=="array"||a.length<1||a.length%2!=0)return[new Ze(t,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let _=0;_<a.length;_+=2)g=g.concat(Da({key:`${t}[${_}]`,value:a[_],valueSpec:d.layout_symbol["text-anchor"]})),g=g.concat(hc({key:`${t}[${_+1}]`,value:a[_+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:d}));return g},sprite:sa};function dr(r){const t=r.value,a=r.valueSpec,s=r.styleSpec;return r.validateSpec=dr,a.expression&&Pr(Gi(t))?bn(r):a.expression&&ts(ns(t))?di(r):a.type&&$r[a.type]?$r[a.type](r):Hr(Bt({},r,{valueSpec:a.type?s[a.type]:a}))}function os(r){const t=r.value,a=r.key,s=ka(r);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new Ze(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new Ze(a,t,'"glyphs" url must include a "{range}" token'))),s}function Cr(r,t=Z){let a=[];return a=a.concat(dr({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:dr,objectElementValidators:{glyphs:os,"*":()=>[]}})),r.constants&&(a=a.concat(Ja({key:"constants",value:r.constants}))),ss(a)}function la(r){return function(t){return r({...t,validateSpec:dr})}}function ss(r){return[].concat(r).sort((t,a)=>t.line-a.line)}function Ni(r){return function(...t){return ss(r.apply(this,t))}}Cr.source=Ni(la(Cl)),Cr.sprite=Ni(la(sa)),Cr.glyphs=Ni(la(os)),Cr.light=Ni(la(bu)),Cr.sky=Ni(la(as)),Cr.terrain=Ni(la(to)),Cr.layer=Ni(la(eo)),Cr.filter=Ni(la(oa)),Cr.paintProperty=Ni(la(vu)),Cr.layoutProperty=Ni(la(xu));const io=Cr,wu=io.light,af=io.sky,uh=io.paintProperty,of=io.layoutProperty;function wn(r,t){let a=!1;if(t&&t.length)for(const s of t)r.fire(new $(new Error(s.message))),a=!0;return a}class Zs{constructor(t,a,s){const d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(a=_[1])+2*(s=_[2]);for(let T=0;T<this.d*this.d;T++){const M=_[3+T],P=_[3+T+1];d.push(M===P?null:_.subarray(M,P))}const v=_[3+d.length+1];this.keys=_.subarray(_[3+d.length],v),this.bboxes=_.subarray(v),this.insert=this._insertReadonly}else{this.d=a+2*s;for(let _=0;_<this.d*this.d;_++)d.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=s,this.scale=a/t,this.uid=0;const g=s/a*t;this.min=-g,this.max=t+g}insert(t,a,s,d,g){this._forEachCell(a,s,d,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,s,d,g,_){this.cells[g].push(_)}query(t,a,s,d,g){const _=this.min,v=this.max;if(t<=_&&a<=_&&v<=s&&v<=d&&!g)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(t,a,s,d,this._queryCell,T,{},g),T}}_queryCell(t,a,s,d,g,_,v,T){const M=this.cells[g];if(M!==null){const P=this.keys,D=this.bboxes;for(let j=0;j<M.length;j++){const U=M[j];if(v[U]===void 0){const G=4*U;(T?T(D[G+0],D[G+1],D[G+2],D[G+3]):t<=D[G+2]&&a<=D[G+3]&&s>=D[G+0]&&d>=D[G+1])?(v[U]=!0,_.push(P[U])):v[U]=!1}}}}_forEachCell(t,a,s,d,g,_,v,T){const M=this._convertToCellCoord(t),P=this._convertToCellCoord(a),D=this._convertToCellCoord(s),j=this._convertToCellCoord(d);for(let U=M;U<=D;U++)for(let G=P;G<=j;G++){const X=this.d*G+U;if((!T||T(this._convertFromCellCoord(U),this._convertFromCellCoord(G),this._convertFromCellCoord(U+1),this._convertFromCellCoord(G+1)))&&g.call(this,t,a,s,d,X,_,v,T))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let s=0;for(let _=0;_<this.cells.length;_++)s+=this.cells[_].length;const d=new Int32Array(a+s+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let g=a;for(let _=0;_<t.length;_++){const v=t[_];d[3+_]=g,d.set(v,g),g+=v.length}return d[3+t.length]=g,d.set(this.keys,g),g+=this.keys.length,d[3+t.length+1]=g,d.set(this.bboxes,g),g+=this.bboxes.length,d.buffer}static serialize(t,a){const s=t.toArrayBuffer();return a&&a.push(s),{buffer:s}}static deserialize(t){return new Zs(t.buffer)}}const gr={};function Tt(r,t,a={}){if(gr[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),gr[r]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}Tt("Object",Object),Tt("TransferableGridIndex",Zs),Tt("Color",_i),Tt("Error",Error),Tt("AJAXError",zi),Tt("ResolvedImage",Sr),Tt("StylePropertyFunction",pa),Tt("StyleExpression",js,{omit:["_evaluator"]}),Tt("ZoomDependentExpression",Ir),Tt("ZoomConstantExpression",lh),Tt("CompoundExpression",pr,{omit:["_evaluate"]});for(const r in fa)fa[r]._classRegistryKey||Tt(`Expression_${r}`,fa[r]);function Tu(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function La(r){return r.$name||r.constructor._classRegistryKey}function Gs(r){return!function(t){if(t===null||typeof t!="object")return!1;const a=La(t);return!(!a||a==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Tu(r)||xo(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function qs(r,t){if(Gs(r))return(Tu(r)||xo(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const g=[];for(const _ of r)g.push(qs(_,t));return g}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const a=La(r);if(!a)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!gr[a])throw new Error(`${a} is not registered.`);const{klass:s}=gr[a],d=s.serialize?s.serialize(r,t):{};if(s.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in r){if(!r.hasOwnProperty(g)||gr[a].omit.indexOf(g)>=0)continue;const _=r[g];d[g]=gr[a].shallow.indexOf(g)>=0?_:qs(_,t)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(d.$name=a),d}function Bo(r){if(Gs(r))return r;if(Array.isArray(r))return r.map(Bo);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=La(r)||"Object";if(!gr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=gr[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(r);const s=Object.create(a.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const g=r[d];s[d]=gr[t].shallow.indexOf(d)>=0?g:Bo(g)}return s}class hh{constructor(){this.first=!0}update(t,a){const s=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=s,!0))}}const si={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Hangul Syllables":r=>r>=44032&&r<=55215,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function no(r){for(const t of r)if(Ml(t.charCodeAt(0)))return!0;return!1}function Su(r){for(const t of r)if(!fc(t.charCodeAt(0)))return!1;return!0}function ls(r){const t=r.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(t.join("|"),"u")}const dh=ls(["Arab","Dupl","Mong","Ougr","Syrc"]);function fc(r){return!dh.test(String.fromCodePoint(r))}const Eu=ls(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ml(r){return!(r!==746&&r!==747&&(r<4352||!(si["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||si["CJK Compatibility"](r)||si["CJK Strokes"](r)||!(!si["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||si["Enclosed CJK Letters and Months"](r)||si["Ideographic Description Characters"](r)||si.Kanbun(r)||si.Katakana(r)&&r!==12540||!(!si["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!si["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||si["Vertical Forms"](r)||si["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||Eu.test(String.fromCodePoint(r)))))}function pc(r){return!(Ml(r)||function(t){return!!(si["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||si["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||si["Letterlike Symbols"](t)||si["Number Forms"](t)||si["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||si["Control Pictures"](t)&&t!==9251||si["Optical Character Recognition"](t)||si["Enclosed Alphanumerics"](t)||si["Geometric Shapes"](t)||si["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||si["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||si["CJK Symbols and Punctuation"](t)||si.Katakana(t)||si["Private Use Area"](t)||si["CJK Compatibility Forms"](t)||si["Small Form Variants"](t)||si["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}const fh=ls(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Al(r){return fh.test(String.fromCodePoint(r))}function ud(r,t){return!(!t&&Al(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||si.Khmer(r))}function mc(r){for(const t of r)if(Al(t.charCodeAt(0)))return!0;return!1}const ro=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){if(ro.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(r,t){return u(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(r.pluginStatus!=="loading")return this.setState(r),r;const a=r.pluginURL,s=new Promise(g=>{this.loadScriptResolve=g});t(a);const d=new Promise(g=>setTimeout(()=>g(),this.TIMEOUT));if(yield Promise.race([s,d]),this.isParsed()){const g={pluginStatus:"loaded",pluginURL:a};return this.setState(g),g}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class Qi{constructor(t,a){this.zoom=t,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new hh,this.transition={})}isSupportedScript(t){return function(a,s){for(const d of a)if(!ud(d.charCodeAt(0),s))return!1;return!0}(t,ro.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),s=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*a}}}class ga{constructor(t,a){this.property=t,this.value=a,this.expression=function(s,d){if(Pr(s))return new pa(s,d);if(ts(s)){const g=_u(s,d);if(g.result==="error")throw new Error(g.value.map(_=>`${_.key}: ${_.message}`).join(", "));return g.value}{let g=s;return d.type==="color"&&typeof s=="string"?g=_i.parse(s):d.type!=="padding"||typeof s!="number"&&!Array.isArray(s)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(s)?g=cr.parse(s):d.type==="projectionDefinition"&&typeof s=="string"&&(g=Gn.parse(s)):g=ir.parse(s),{kind:"constant",evaluate:()=>g}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,a,s){return this.property.possiblyEvaluate(this,t,a,s)}}class zl{constructor(t){this.property=t,this.value=new ga(t,void 0)}transitioned(t,a){return new Oo(this.property,this.value,a,$t({},t.transition,this.transition),t.now)}untransitioned(){return new Oo(this.property,this.value,null,{},0)}}class Hs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Ln(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new zl(this._values[t].property)),this._values[t].value=new ga(this._values[t].property,a===null?void 0:Ln(a))}getTransition(t){return Ln(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new zl(this._values[t].property)),this._values[t].transition=Ln(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const s=this.getValue(a);s!==void 0&&(t[a]=s);const d=this.getTransition(a);d!==void 0&&(t[`${a}-transition`]=d)}return t}transitioned(t,a){const s=new Ba(this._properties);for(const d of Object.keys(this._values))s._values[d]=this._values[d].transitioned(t,a._values[d]);return s}untransitioned(){const t=new Ba(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class Oo{constructor(t,a,s,d,g){this.property=t,this.value=a,this.begin=g+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=s)}possiblyEvaluate(t,a,s){const d=t.now||0,g=this.value.possiblyEvaluate(t,a,s),_=this.prior;if(_){if(d>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(d<this.begin)return _.possiblyEvaluate(t,a,s);{const v=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,a,s),g,Te(v))}}return g}}class Ba{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,s){const d=new $s(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(t,a,s);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class gc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Ln(this._values[t].value)}setValue(t,a){this._values[t]=new ga(this._values[t].property,a===null?void 0:Ln(a))}serialize(){const t={};for(const a of Object.keys(this._values)){const s=this.getValue(a);s!==void 0&&(t[a]=s)}return t}possiblyEvaluate(t,a,s){const d=new $s(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(t,a,s);return d}}class _a{constructor(t,a,s){this.property=t,this.value=a,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,s,d){return this.property.evaluate(this.value,this.parameters,t,a,s,d)}}class $s{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Dt{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,s){const d=ra[this.specification.type];return d?d(t,a,s):t}}class Nt{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,s,d){return new _a(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},s,d)}:t.expression,a)}interpolate(t,a,s){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new _a(this,{kind:"constant",value:void 0},t.parameters);const d=ra[this.specification.type];if(d){const g=d(t.value.value,a.value.value,s);return new _a(this,{kind:"constant",value:g},t.parameters)}return t}evaluate(t,a,s,d,g,_){return t.kind==="constant"?t.value:t.evaluate(a,s,d,g,_)}}class _c extends Nt{possiblyEvaluate(t,a,s,d){if(t.value===void 0)return new _a(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const g=t.expression.evaluate(a,null,{},s,d),_=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,v=this._calculate(_,_,_,a);return new _a(this,{kind:"constant",value:v},a)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new _a(this,{kind:"constant",value:g},a)}return new _a(this,t.expression,a)}evaluate(t,a,s,d,g,_){if(t.kind==="source"){const v=t.evaluate(a,s,d,g,_);return this._calculate(v,v,v,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},s,d),t.evaluate({zoom:Math.floor(a.zoom)},s,d),t.evaluate({zoom:Math.floor(a.zoom)+1},s,d),a):t.value}_calculate(t,a,s,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:s,to:a}}interpolate(t){return t}}class Cu{constructor(t){this.specification=t}possiblyEvaluate(t,a,s,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(a,null,{},s,d);return this._calculate(g,g,g,a)}return this._calculate(t.expression.evaluate(new Qi(Math.floor(a.zoom-1),a)),t.expression.evaluate(new Qi(Math.floor(a.zoom),a)),t.expression.evaluate(new Qi(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,s,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:s,to:a}}interpolate(t){return t}}class cs{constructor(t){this.specification=t}possiblyEvaluate(t,a,s,d){return!!t.expression.evaluate(a,null,{},s,d)}interpolate(){return!1}}class _r{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const s=t[a];s.specification.overridable&&this.overridableProperties.push(a);const d=this.defaultPropertyValues[a]=new ga(s,void 0),g=this.defaultTransitionablePropertyValues[a]=new zl(s);this.defaultTransitioningPropertyValues[a]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=d.possiblyEvaluate({})}}}Tt("DataDrivenProperty",Nt),Tt("DataConstantProperty",Dt),Tt("CrossFadedDataDrivenProperty",_c),Tt("CrossFadedProperty",Cu),Tt("ColorRampProperty",cs);const ph="-transition";class yr extends K{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),a.layout&&(this._unevaluatedLayout=new gc(a.layout)),a.paint)){this._transitionablePaint=new Hs(a.paint);for(const s in t.paint)this.setPaintProperty(s,t.paint[s],{validate:!1});for(const s in t.layout)this.setLayoutProperty(s,t.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new $s(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,a,s={}){a!=null&&this._validate(of,`layers.${this.id}.layout.${t}`,t,a,s)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(ph)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,s={}){if(a!=null&&this._validate(uh,`layers.${this.id}.paint.${t}`,t,a,s))return!1;if(t.endsWith(ph))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{const d=this._transitionablePaint._values[t],g=d.property.specification["property-type"]==="cross-faded-data-driven",_=d.value.isDataDriven(),v=d.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const T=this._transitionablePaint._values[t].value;return T.isDataDriven()||_||g||this._handleOverridablePaintPropertyUpdate(t,v,T)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Ai(t,(a,s)=>!(a===void 0||s==="layout"&&!Object.keys(a).length||s==="paint"&&!Object.keys(a).length))}_validate(t,a,s,d,g={}){return(!g||g.validate!==!1)&&wn(this,t.call(io,{key:a,layerType:this.type,objectKey:s,value:d,styleSpec:Z,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof _a&&Ls(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const mh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ya{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Vt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Kt(r,t=1){let a=0,s=0;return{members:r.map(d=>{const g=mh[d.type].BYTES_PER_ELEMENT,_=a=qn(a,Math.max(t,g)),v=d.components||1;return s=Math.max(s,g),a+=g*v,{name:d.name,type:d.type,components:v,offset:_}}),size:qn(a,Math.max(s,t)),alignment:t}}function qn(r,t){return Math.ceil(r/t)*t}class us extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,a)}emplace(t,a,s){const d=2*t;return this.int16[d+0]=a,this.int16[d+1]=s,t}}us.prototype.bytesPerElement=4,Tt("StructArrayLayout2i4",us);class kr extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,s)}emplace(t,a,s,d){const g=3*t;return this.int16[g+0]=a,this.int16[g+1]=s,this.int16[g+2]=d,t}}kr.prototype.bytesPerElement=6,Tt("StructArrayLayout3i6",kr);class ao extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,s,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,s,d)}emplace(t,a,s,d,g){const _=4*t;return this.int16[_+0]=a,this.int16[_+1]=s,this.int16[_+2]=d,this.int16[_+3]=g,t}}ao.prototype.bytesPerElement=8,Tt("StructArrayLayout4i8",ao);class hs extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,s,d,g,_)}emplace(t,a,s,d,g,_,v){const T=6*t;return this.int16[T+0]=a,this.int16[T+1]=s,this.int16[T+2]=d,this.int16[T+3]=g,this.int16[T+4]=_,this.int16[T+5]=v,t}}hs.prototype.bytesPerElement=12,Tt("StructArrayLayout2i4i12",hs);class ds extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,s,d,g,_)}emplace(t,a,s,d,g,_,v){const T=4*t,M=8*t;return this.int16[T+0]=a,this.int16[T+1]=s,this.uint8[M+4]=d,this.uint8[M+5]=g,this.uint8[M+6]=_,this.uint8[M+7]=v,t}}ds.prototype.bytesPerElement=8,Tt("StructArrayLayout2i4ub8",ds);class va extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,a)}emplace(t,a,s){const d=2*t;return this.float32[d+0]=a,this.float32[d+1]=s,t}}va.prototype.bytesPerElement=8,Tt("StructArrayLayout2f8",va);class gh extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_,v,T,M,P){const D=this.length;return this.resize(D+1),this.emplace(D,t,a,s,d,g,_,v,T,M,P)}emplace(t,a,s,d,g,_,v,T,M,P,D){const j=10*t;return this.uint16[j+0]=a,this.uint16[j+1]=s,this.uint16[j+2]=d,this.uint16[j+3]=g,this.uint16[j+4]=_,this.uint16[j+5]=v,this.uint16[j+6]=T,this.uint16[j+7]=M,this.uint16[j+8]=P,this.uint16[j+9]=D,t}}gh.prototype.bytesPerElement=20,Tt("StructArrayLayout10ui20",gh);class an extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_,v,T,M,P,D,j){const U=this.length;return this.resize(U+1),this.emplace(U,t,a,s,d,g,_,v,T,M,P,D,j)}emplace(t,a,s,d,g,_,v,T,M,P,D,j,U){const G=12*t;return this.int16[G+0]=a,this.int16[G+1]=s,this.int16[G+2]=d,this.int16[G+3]=g,this.uint16[G+4]=_,this.uint16[G+5]=v,this.uint16[G+6]=T,this.uint16[G+7]=M,this.int16[G+8]=P,this.int16[G+9]=D,this.int16[G+10]=j,this.int16[G+11]=U,t}}an.prototype.bytesPerElement=24,Tt("StructArrayLayout4i4ui4i24",an);class jo extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,s)}emplace(t,a,s,d){const g=3*t;return this.float32[g+0]=a,this.float32[g+1]=s,this.float32[g+2]=d,t}}jo.prototype.bytesPerElement=12,Tt("StructArrayLayout3f12",jo);class yc extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}yc.prototype.bytesPerElement=4,Tt("StructArrayLayout1ul4",yc);class vc extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_,v,T,M){const P=this.length;return this.resize(P+1),this.emplace(P,t,a,s,d,g,_,v,T,M)}emplace(t,a,s,d,g,_,v,T,M,P){const D=10*t,j=5*t;return this.int16[D+0]=a,this.int16[D+1]=s,this.int16[D+2]=d,this.int16[D+3]=g,this.int16[D+4]=_,this.int16[D+5]=v,this.uint32[j+3]=T,this.uint16[D+8]=M,this.uint16[D+9]=P,t}}vc.prototype.bytesPerElement=20,Tt("StructArrayLayout6i1ul2ui20",vc);class fs extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,s,d,g,_)}emplace(t,a,s,d,g,_,v){const T=6*t;return this.int16[T+0]=a,this.int16[T+1]=s,this.int16[T+2]=d,this.int16[T+3]=g,this.int16[T+4]=_,this.int16[T+5]=v,t}}fs.prototype.bytesPerElement=12,Tt("StructArrayLayout2i2i2i12",fs);class _h extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,s,d,g)}emplace(t,a,s,d,g,_){const v=4*t,T=8*t;return this.float32[v+0]=a,this.float32[v+1]=s,this.float32[v+2]=d,this.int16[T+6]=g,this.int16[T+7]=_,t}}_h.prototype.bytesPerElement=16,Tt("StructArrayLayout2f1f2i16",_h);class xc extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,s,d,g,_)}emplace(t,a,s,d,g,_,v){const T=16*t,M=4*t,P=8*t;return this.uint8[T+0]=a,this.uint8[T+1]=s,this.float32[M+1]=d,this.float32[M+2]=g,this.int16[P+6]=_,this.int16[P+7]=v,t}}xc.prototype.bytesPerElement=16,Tt("StructArrayLayout2ub2f2i16",xc);class Xs extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,s)}emplace(t,a,s,d){const g=3*t;return this.uint16[g+0]=a,this.uint16[g+1]=s,this.uint16[g+2]=d,t}}Xs.prototype.bytesPerElement=6,Tt("StructArrayLayout3ui6",Xs);class bc extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_,v,T,M,P,D,j,U,G,X,ee,oe){const ye=this.length;return this.resize(ye+1),this.emplace(ye,t,a,s,d,g,_,v,T,M,P,D,j,U,G,X,ee,oe)}emplace(t,a,s,d,g,_,v,T,M,P,D,j,U,G,X,ee,oe,ye){const le=24*t,N=12*t,J=48*t;return this.int16[le+0]=a,this.int16[le+1]=s,this.uint16[le+2]=d,this.uint16[le+3]=g,this.uint32[N+2]=_,this.uint32[N+3]=v,this.uint32[N+4]=T,this.uint16[le+10]=M,this.uint16[le+11]=P,this.uint16[le+12]=D,this.float32[N+7]=j,this.float32[N+8]=U,this.uint8[J+36]=G,this.uint8[J+37]=X,this.uint8[J+38]=ee,this.uint32[N+10]=oe,this.int16[le+22]=ye,t}}bc.prototype.bytesPerElement=48,Tt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",bc);class f extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,s,d,g,_,v,T,M,P,D,j,U,G,X,ee,oe,ye,le,N,J,de,Le,ot,Ue,Xe,ut,at){const ht=this.length;return this.resize(ht+1),this.emplace(ht,t,a,s,d,g,_,v,T,M,P,D,j,U,G,X,ee,oe,ye,le,N,J,de,Le,ot,Ue,Xe,ut,at)}emplace(t,a,s,d,g,_,v,T,M,P,D,j,U,G,X,ee,oe,ye,le,N,J,de,Le,ot,Ue,Xe,ut,at,ht){const Je=32*t,Ct=16*t;return this.int16[Je+0]=a,this.int16[Je+1]=s,this.int16[Je+2]=d,this.int16[Je+3]=g,this.int16[Je+4]=_,this.int16[Je+5]=v,this.int16[Je+6]=T,this.int16[Je+7]=M,this.uint16[Je+8]=P,this.uint16[Je+9]=D,this.uint16[Je+10]=j,this.uint16[Je+11]=U,this.uint16[Je+12]=G,this.uint16[Je+13]=X,this.uint16[Je+14]=ee,this.uint16[Je+15]=oe,this.uint16[Je+16]=ye,this.uint16[Je+17]=le,this.uint16[Je+18]=N,this.uint16[Je+19]=J,this.uint16[Je+20]=de,this.uint16[Je+21]=Le,this.uint16[Je+22]=ot,this.uint32[Ct+12]=Ue,this.float32[Ct+13]=Xe,this.float32[Ct+14]=ut,this.uint16[Je+30]=at,this.uint16[Je+31]=ht,t}}f.prototype.bytesPerElement=64,Tt("StructArrayLayout8i15ui1ul2f2ui64",f);class e extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}e.prototype.bytesPerElement=4,Tt("StructArrayLayout1f4",e);class n extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,s)}emplace(t,a,s,d){const g=3*t;return this.uint16[6*t+0]=a,this.float32[g+1]=s,this.float32[g+2]=d,t}}n.prototype.bytesPerElement=12,Tt("StructArrayLayout1ui2f12",n);class l extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,a,s)}emplace(t,a,s,d){const g=4*t;return this.uint32[2*t+0]=a,this.uint16[g+2]=s,this.uint16[g+3]=d,t}}l.prototype.bytesPerElement=8,Tt("StructArrayLayout1ul2ui8",l);class h extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,a)}emplace(t,a,s){const d=2*t;return this.uint16[d+0]=a,this.uint16[d+1]=s,t}}h.prototype.bytesPerElement=4,Tt("StructArrayLayout2ui4",h);class m extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}m.prototype.bytesPerElement=2,Tt("StructArrayLayout1ui2",m);class y extends Vt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,s,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,a,s,d)}emplace(t,a,s,d,g){const _=4*t;return this.float32[_+0]=a,this.float32[_+1]=s,this.float32[_+2]=d,this.float32[_+3]=g,t}}y.prototype.bytesPerElement=16,Tt("StructArrayLayout4f16",y);class w extends ya{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new he(this.anchorPointX,this.anchorPointY)}}w.prototype.size=20;class S extends vc{get(t){return new w(this,t)}}Tt("CollisionBoxArray",S);class z extends ya{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}z.prototype.size=48;class k extends bc{get(t){return new z(this,t)}}Tt("PlacedSymbolArray",k);class O extends ya{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}O.prototype.size=64;class B extends f{get(t){return new O(this,t)}}Tt("SymbolInstanceArray",B);class q extends e{getoffsetX(t){return this.float32[1*t+0]}}Tt("GlyphOffsetArray",q);class Y extends kr{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Tt("SymbolLineVertexArray",Y);class ne extends ya{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ne.prototype.size=12;class te extends n{get(t){return new ne(this,t)}}Tt("TextAnchorOffsetArray",te);class ae extends ya{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ae.prototype.size=8;class se extends l{get(t){return new ae(this,t)}}Tt("FeatureIndexArray",se);class fe extends us{}class pe extends us{}class ge extends us{}class we extends hs{}class xe extends ds{}class Be extends va{}class ke extends gh{}class We extends an{}class Qe extends jo{}class Ye extends yc{}class gt extends fs{}class ft extends xc{}class it extends Xs{}class Pt extends h{}const Jt=Kt([{name:"a_pos",components:2,type:"Int16"}],4),{members:yi}=Jt;class ni{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,a,s,d){const g=this.segments[this.segments.length-1];return t>ni.MAX_VERTEX_ARRAY_LENGTH&&Vn(`Max vertices per segment is ${ni.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ni.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!g||g.vertexLength+t>ni.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==d?this.createNewSegment(a,s,d):g}createNewSegment(t,a,s){const d={vertexOffset:t.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return s!==void 0&&(d.sortKey=s),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(t,a,s){return this.prepareSegment(0,t,a,s)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,s,d){return new ni([{vertexOffset:t,primitiveOffset:a,vertexLength:s,primitiveLength:d,vaos:{},sortKey:0}])}}function Oi(r,t){return 256*(r=wt(Math.floor(r),0,255))+wt(Math.floor(t),0,255)}ni.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Tt("SegmentVector",ni);const qi=Kt([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ji,Ii,ji,Rn={exports:{}},Wn={exports:{}},nr={exports:{}},Mr=function(){if(ji)return Rn.exports;ji=1;var r=(Ji||(Ji=1,Wn.exports=function(a,s){var d,g,_,v,T,M,P,D;for(g=a.length-(d=3&a.length),_=s,T=3432918353,M=461845907,D=0;D<g;)P=255&a.charCodeAt(D)|(255&a.charCodeAt(++D))<<8|(255&a.charCodeAt(++D))<<16|(255&a.charCodeAt(++D))<<24,++D,_=27492+(65535&(v=5*(65535&(_=(_^=P=(65535&(P=(P=(65535&P)*T+(((P>>>16)*T&65535)<<16)&4294967295)<<15|P>>>17))*M+(((P>>>16)*M&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(P=0,d){case 3:P^=(255&a.charCodeAt(D+2))<<16;case 2:P^=(255&a.charCodeAt(D+1))<<8;case 1:_^=P=(65535&(P=(P=(65535&(P^=255&a.charCodeAt(D)))*T+(((P>>>16)*T&65535)<<16)&4294967295)<<15|P>>>17))*M+(((P>>>16)*M&65535)<<16)&4294967295}return _^=a.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),Wn.exports),t=(Ii||(Ii=1,nr.exports=function(a,s){for(var d,g=a.length,_=s^g,v=0;g>=4;)d=1540483477*(65535&(d=255&a.charCodeAt(v)|(255&a.charCodeAt(++v))<<8|(255&a.charCodeAt(++v))<<16|(255&a.charCodeAt(++v))<<24))+((1540483477*(d>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),g-=4,++v;switch(g){case 3:_^=(255&a.charCodeAt(v+2))<<16;case 2:_^=(255&a.charCodeAt(v+1))<<8;case 1:_=1540483477*(65535&(_^=255&a.charCodeAt(v)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),nr.exports);return Rn.exports=r,Rn.exports.murmur3=r,Rn.exports.murmur2=t,Rn.exports}(),oo=re(Mr);class Oa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,s,d){this.ids.push(ps(t)),this.positions.push(a,s,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=ps(t);let s=0,d=this.ids.length-1;for(;s<d;){const _=s+d>>1;this.ids[_]>=a?d=_:s=_+1}const g=[];for(;this.ids[s]===a;)g.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return g}static serialize(t,a){const s=new Float64Array(t.ids),d=new Uint32Array(t.positions);return so(s,d,0,s.length-1),a&&a.push(s.buffer,d.buffer),{ids:s,positions:d}}static deserialize(t){const a=new Oa;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function ps(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:oo(String(r))}function so(r,t,a,s){for(;a<s;){const d=r[a+s>>1];let g=a-1,_=s+1;for(;;){do g++;while(r[g]<d);do _--;while(r[_]>d);if(g>=_)break;ms(r,g,_),ms(t,3*g,3*_),ms(t,3*g+1,3*_+1),ms(t,3*g+2,3*_+2)}_-a<s-_?(so(r,t,a,_),a=_+1):(so(r,t,_+1,s),s=_)}}function ms(r,t,a){const s=r[t];r[t]=r[a],r[a]=s}Tt("FeaturePositionMap",Oa);class ja{constructor(t,a){this.gl=t.gl,this.location=a}}class Fa extends ja{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Xr extends ja{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class lo extends ja{constructor(t,a){super(t,a),this.current=_i.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Ys=new Float32Array(16);function Ks(r){return[Oi(255*r.r,255*r.g),Oi(255*r.b,255*r.a)]}class Tn{constructor(t,a,s){this.value=t,this.uniformNames=a.map(d=>`u_${d}`),this.type=s}setUniform(t,a,s){t.set(s.constantOr(this.value))}getBinding(t,a,s){return this.type==="color"?new lo(t,a):new Fa(t,a)}}class en{constructor(t,a){this.uniformNames=a.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,s,d){const g=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,a,s){return s.substr(0,9)==="u_pattern"?new Xr(t,a):new Fa(t,a)}}class jn{constructor(t,a,s,d){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=a.map(g=>({name:`a_${g}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(t,a,s,d,g){const _=this.paintVertexArray.length,v=this.expression.evaluate(new Qi(0),a,{},d,[],g);this.paintVertexArray.resize(t),this._setPaintValue(_,t,v)}updatePaintArray(t,a,s,d){const g=this.expression.evaluate({zoom:0},s,d);this._setPaintValue(t,a,g)}_setPaintValue(t,a,s){if(this.type==="color"){const d=Ks(s);for(let g=t;g<a;g++)this.paintVertexArray.emplace(g,d[0],d[1])}else{for(let d=t;d<a;d++)this.paintVertexArray.emplace(d,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Di{constructor(t,a,s,d,g,_){this.expression=t,this.uniformNames=a.map(v=>`u_${v}_t`),this.type=s,this.useIntegerZoom=d,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=a.map(v=>({name:`a_${v}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,a,s,d,g){const _=this.expression.evaluate(new Qi(this.zoom),a,{},d,[],g),v=this.expression.evaluate(new Qi(this.zoom+1),a,{},d,[],g),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,_,v)}updatePaintArray(t,a,s,d){const g=this.expression.evaluate({zoom:this.zoom},s,d),_=this.expression.evaluate({zoom:this.zoom+1},s,d);this._setPaintValue(t,a,g,_)}_setPaintValue(t,a,s,d){if(this.type==="color"){const g=Ks(s),_=Ks(d);for(let v=t;v<a;v++)this.paintVertexArray.emplace(v,g[0],g[1],_[0],_[1])}else{for(let g=t;g<a;g++)this.paintVertexArray.emplace(g,s,d);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const s=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,d=wt(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,a,s){return new Fa(t,a)}}class Fo{constructor(t,a,s,d,g,_){this.expression=t,this.type=a,this.useIntegerZoom=s,this.zoom=d,this.layerId=_,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,a,s){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,a.patterns&&a.patterns[this.layerId],s)}updatePaintArray(t,a,s,d,g){this._setPaintValues(t,a,s.patterns&&s.patterns[this.layerId],g)}_setPaintValues(t,a,s,d){if(!d||!s)return;const{min:g,mid:_,max:v}=s,T=d[g],M=d[_],P=d[v];if(T&&M&&P)for(let D=t;D<a;D++)this.zoomInPaintVertexArray.emplace(D,M.tl[0],M.tl[1],M.br[0],M.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],M.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,M.tl[0],M.tl[1],M.br[0],M.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],M.pixelRatio,P.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,qi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,qi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class yh{constructor(t,a,s){this.binders={},this._buffers=[];const d=[];for(const g in t.paint._values){if(!s(g))continue;const _=t.paint.get(g);if(!(_ instanceof _a&&Ls(_.property.specification)))continue;const v=hd(g,t.type),T=_.value,M=_.property.specification.type,P=_.property.useIntegerZoom,D=_.property.specification["property-type"],j=D==="cross-faded"||D==="cross-faded-data-driven";if(T.kind==="constant")this.binders[g]=j?new en(T.value,v):new Tn(T.value,v,M),d.push(`/u_${g}`);else if(T.kind==="source"||j){const U=vh(g,M,"source");this.binders[g]=j?new Fo(T,M,P,a,U,t.id):new jn(T,v,M,U),d.push(`/a_${g}`)}else{const U=vh(g,M,"composite");this.binders[g]=new Di(T,v,M,P,a,U),d.push(`/z_${g}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof jn||a instanceof Di?a.maxValue:0}populatePaintArrays(t,a,s,d,g){for(const _ in this.binders){const v=this.binders[_];(v instanceof jn||v instanceof Di||v instanceof Fo)&&v.populatePaintArray(t,a,s,d,g)}}setConstantPatternPositions(t,a){for(const s in this.binders){const d=this.binders[s];d instanceof en&&d.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,s,d,g){let _=!1;for(const v in t){const T=a.getPositions(v);for(const M of T){const P=s.feature(M.index);for(const D in this.binders){const j=this.binders[D];if((j instanceof jn||j instanceof Di||j instanceof Fo)&&j.expression.isStateDependent===!0){const U=d.paint.get(D);j.expression=U.value,j.updatePaintArray(M.start,M.end,P,t[v],g),_=!0}}}}return _}defines(){const t=[];for(const a in this.binders){const s=this.binders[a];(s instanceof Tn||s instanceof en)&&t.push(...s.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const s=this.binders[a];if(s instanceof jn||s instanceof Di)for(let d=0;d<s.paintVertexAttributes.length;d++)t.push(s.paintVertexAttributes[d].name);else if(s instanceof Fo)for(let d=0;d<qi.members.length;d++)t.push(qi.members[d].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const s=this.binders[a];if(s instanceof Tn||s instanceof en||s instanceof Di)for(const d of s.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const s=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof Tn||g instanceof en||g instanceof Di){for(const _ of g.uniformNames)if(a[_]){const v=g.getBinding(t,a[_],_);s.push({name:_,property:d,binding:v})}}}return s}setUniforms(t,a,s,d){for(const{name:g,property:_,binding:v}of a)this.binders[_].setUniform(v,d,s.get(_),g)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const s=this.binders[a];if(t&&s instanceof Fo){const d=t.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(s instanceof jn||s instanceof Di)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(t){for(const a in this.binders){const s=this.binders[a];(s instanceof jn||s instanceof Di||s instanceof Fo)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof jn||a instanceof Di||a instanceof Fo)&&a.destroy()}}}class co{constructor(t,a,s=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new yh(d,a,s);this.needsUpload=!1,this._featureMap=new Oa,this._bufferOffset=0}populatePaintArrays(t,a,s,d,g,_){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,a,d,g,_);a.id!==void 0&&this._featureMap.add(a.id,s,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,s,d){for(const g of s)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,a,g,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function hd(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function vh(r,t,a){const s={color:{source:va,composite:y},number:{source:e,composite:va}},d=function(g){return{"line-pattern":{source:ke,composite:ke},"fill-pattern":{source:ke,composite:ke},"fill-extrusion-pattern":{source:ke,composite:ke}}[g]}(r);return d&&d[a]||s[t][a]}Tt("ConstantBinder",Tn),Tt("CrossFadedConstantBinder",en),Tt("SourceExpressionBinder",jn),Tt("CrossFadedCompositeBinder",Fo),Tt("CompositeExpressionBinder",Di),Tt("ProgramConfiguration",yh,{omit:["_buffers"]}),Tt("ProgramConfigurationSet",co);const xh=Math.pow(2,14)-1,ca=-xh-1;function xa(r){const t=Ve/r.extent,a=r.loadGeometry();for(let s=0;s<a.length;s++){const d=a[s];for(let g=0;g<d.length;g++){const _=d[g],v=Math.round(_.x*t),T=Math.round(_.y*t);_.x=wt(v,ca,xh),_.y=wt(T,ca,xh),(v<_.x||v>_.x+1||T<_.y||T>_.y+1)&&Vn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function Na(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?xa(r):[]}}const Ws=-32768;function Rl(r,t,a,s,d){r.emplaceBack(Ws+8*t+s,Ws+8*a+d)}class wc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new pe,this.indexArray=new it,this.segments=new ni,this.programConfigurations=new co(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,s){const d=this.layers[0],g=[];let _=null,v=!1,T=d.type==="heatmap";if(d.type==="circle"){const P=d;_=P.layout.get("circle-sort-key"),v=!_.isConstant(),T=T||P.paint.get("circle-pitch-alignment")==="map"}const M=T?a.subdivisionGranularity.circle:1;for(const{feature:P,id:D,index:j,sourceLayerIndex:U}of t){const G=this.layers[0]._featureFilter.needGeometry,X=Na(P,G);if(!this.layers[0]._featureFilter.filter(new Qi(this.zoom),X,s))continue;const ee=v?_.evaluate(X,{},s):void 0,oe={id:D,properties:P.properties,type:P.type,sourceLayerIndex:U,index:j,geometry:G?X.geometry:xa(P),patterns:{},sortKey:ee};g.push(oe)}v&&g.sort((P,D)=>P.sortKey-D.sortKey);for(const P of g){const{geometry:D,index:j,sourceLayerIndex:U}=P,G=t[j].feature;this.addFeature(P,D,j,s,M),a.featureIndex.insert(G,D,j,U,this.index)}}update(t,a,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,s,d,g=1){let _;switch(g){case 1:_=[0,7];break;case 3:_=[0,2,5,7];break;case 5:_=[0,1,3,4,6,7];break;case 7:_=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${g}; valid values are 1, 3, 5, 7.`)}const v=_.length;for(const T of a)for(const M of T){const P=M.x,D=M.y;if(P<0||P>=Ve||D<0||D>=Ve)continue;const j=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),U=j.vertexLength;for(let G=0;G<v;G++)for(let X=0;X<v;X++)Rl(this.layoutVertexArray,P,D,_[X],_[G]);for(let G=0;G<v-1;G++)for(let X=0;X<v-1;X++){const ee=U+G*v+X,oe=U+(G+1)*v+X;this.indexArray.emplaceBack(ee,oe+1,ee+1),this.indexArray.emplaceBack(ee,oe,oe+1)}j.vertexLength+=v*v,j.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{},d)}}function Tc(r,t){for(let a=0;a<r.length;a++)if(Pn(t,r[a]))return!0;for(let a=0;a<t.length;a++)if(Pn(r,t[a]))return!0;return!!ho(r,t)}function Mu(r,t,a){return!!Pn(r,t)||!!dd(t,r,a)}function sf(r,t){if(r.length===1)return gs(t,r[0]);for(let a=0;a<t.length;a++){const s=t[a];for(let d=0;d<s.length;d++)if(Pn(r,s[d]))return!0}for(let a=0;a<r.length;a++)if(gs(t,r[a]))return!0;for(let a=0;a<t.length;a++)if(ho(r,t[a]))return!0;return!1}function uo(r,t,a){if(r.length>1){if(ho(r,t))return!0;for(let s=0;s<t.length;s++)if(dd(t[s],r,a))return!0}for(let s=0;s<r.length;s++)if(dd(r[s],t,a))return!0;return!1}function ho(r,t){if(r.length===0||t.length===0)return!1;for(let a=0;a<r.length-1;a++){const s=r[a],d=r[a+1];for(let g=0;g<t.length-1;g++)if(Pl(s,d,t[g],t[g+1]))return!0}return!1}function Pl(r,t,a,s){return Cn(r,a,s)!==Cn(t,a,s)&&Cn(r,t,a)!==Cn(r,t,s)}function dd(r,t,a){const s=a*a;if(t.length===1)return r.distSqr(t[0])<s;for(let d=1;d<t.length;d++)if(Qs(r,t[d-1],t[d])<s)return!0;return!1}function Qs(r,t,a){const s=t.distSqr(a);if(s===0)return r.distSqr(t);const d=((r.x-t.x)*(a.x-t.x)+(r.y-t.y)*(a.y-t.y))/s;return r.distSqr(d<0?t:d>1?a:a.sub(t)._mult(d)._add(t))}function gs(r,t){for(let a=0;a<r.length;a++)if(Pn(r[a],t))return!0;return!1}function Pn(r,t){let a=!1;for(let s=0,d=r.length-1;s<r.length;d=s++){const g=r[s],_=r[d];g.y>t.y!=_.y>t.y&&t.x<(_.x-g.x)*(t.y-g.y)/(_.y-g.y)+g.x&&(a=!a)}return a}function fd(r,t,a){const s=a[0],d=a[2];if(r.x<s.x&&t.x<s.x||r.x>d.x&&t.x>d.x||r.y<s.y&&t.y<s.y||r.y>d.y&&t.y>d.y)return!1;const g=Cn(r,t,a[0]);return g!==Cn(r,t,a[1])||g!==Cn(r,t,a[2])||g!==Cn(r,t,a[3])}function Sc(r,t,a){const s=t.paint.get(r).value;return s.kind==="constant"?s.value:a.programConfigurations.get(t.id).getMaxValue(r)}function Au(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function bh(r,t,a,s,d){if(!t[0]&&!t[1])return r;const g=he.convert(t)._mult(d);a==="viewport"&&g._rotate(-s);const _=[];for(let v=0;v<r.length;v++)_.push(r[v].sub(g));return _}let lf,Il;Tt("CircleBucket",wc,{omit:["layers"]});var pd={get paint(){return Il=Il||new _r({"circle-radius":new Nt(Z.paint_circle["circle-radius"]),"circle-color":new Nt(Z.paint_circle["circle-color"]),"circle-blur":new Nt(Z.paint_circle["circle-blur"]),"circle-opacity":new Nt(Z.paint_circle["circle-opacity"]),"circle-translate":new Dt(Z.paint_circle["circle-translate"]),"circle-translate-anchor":new Dt(Z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Dt(Z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Dt(Z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Nt(Z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Nt(Z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Nt(Z.paint_circle["circle-stroke-opacity"])})},get layout(){return lf=lf||new _r({"circle-sort-key":new Nt(Z.layout_circle["circle-sort-key"])})}};class pp extends yr{constructor(t){super(t,pd)}createBucket(t){return new wc(t)}queryRadius(t){const a=t;return Sc("circle-radius",this,a)+Sc("circle-stroke-width",this,a)+Au(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:s,geometry:d,transform:g,pixelsToTileUnits:_,unwrappedTileID:v,getElevation:T}){const M=bh(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-g.bearingInRadians,_),P=this.paint.get("circle-radius").evaluate(a,s)+this.paint.get("circle-stroke-width").evaluate(a,s),D=this.paint.get("circle-pitch-alignment")==="map",j=D?M:function(G,X,ee,oe){return G.map(ye=>cf(ye,X,ee,oe))}(M,g,v,T),U=D?P*_:P;for(const G of d)for(const X of G){const ee=D?X:cf(X,g,v,T);let oe=U;const ye=g.projectTileCoordinates(X.x,X.y,v,T).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?oe*=ye/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(oe*=g.cameraToCenterDistance/ye),Mu(j,ee,oe))return!0}return!1}}function cf(r,t,a,s){const d=t.projectTileCoordinates(r.x,r.y,a,s).point;return new he((.5*d.x+.5)*t.width,(.5*-d.y+.5)*t.height)}class uf extends wc{}let wh;Tt("HeatmapBucket",uf,{omit:["layers"]});var mp={get paint(){return wh=wh||new _r({"heatmap-radius":new Nt(Z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Nt(Z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Dt(Z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new cs(Z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Dt(Z.paint_heatmap["heatmap-opacity"])})}};function Th(r,{width:t,height:a},s,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*a*s)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*a*s}`)}else d=new Uint8Array(t*a*s);return r.width=t,r.height=a,r.data=d,r}function hf(r,{width:t,height:a},s){if(t===r.width&&a===r.height)return;const d=Th({},{width:t,height:a},s);md(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,a)},s),r.width=t,r.height=a,r.data=d.data}function md(r,t,a,s,d,g){if(d.width===0||d.height===0)return t;if(d.width>r.width||d.height>r.height||a.x>r.width-d.width||a.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||s.x>t.width-d.width||s.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const _=r.data,v=t.data;if(_===v)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<d.height;T++){const M=((a.y+T)*r.width+a.x)*g,P=((s.y+T)*t.width+s.x)*g;for(let D=0;D<d.width*g;D++)v[P+D]=_[M+D]}return t}class Sh{constructor(t,a){Th(this,t,1,a)}resize(t){hf(this,t,1)}clone(){return new Sh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,s,d,g){md(t,a,s,d,g,1)}}class ba{constructor(t,a){Th(this,t,4,a)}resize(t){hf(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ba({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,s,d,g){md(t,a,s,d,g,4)}}function vr(r){const t={},a=r.resolution||256,s=r.clips?r.clips.length:1,d=r.image||new ba({width:a,height:s});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const g=(_,v,T)=>{t[r.evaluationKey]=T;const M=r.expression.evaluate(t);d.data[_+v+0]=Math.floor(255*M.r/M.a),d.data[_+v+1]=Math.floor(255*M.g/M.a),d.data[_+v+2]=Math.floor(255*M.b/M.a),d.data[_+v+3]=Math.floor(255*M.a)};if(r.clips)for(let _=0,v=0;_<s;++_,v+=4*a)for(let T=0,M=0;T<a;T++,M+=4){const P=T/(a-1),{start:D,end:j}=r.clips[_];g(v,M,D*(1-P)+j*P)}else for(let _=0,v=0;_<a;_++,v+=4)g(0,v,_/(a-1));return d}Tt("AlphaImage",Sh),Tt("RGBAImage",ba);const xr="big-fb";class gp extends yr{createBucket(t){return new uf(t)}constructor(t){super(t,mp),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=vr({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(xr)&&this.heatmapFbos.delete(xr)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let df;var _p={get paint(){return df=df||new _r({"hillshade-illumination-direction":new Dt(Z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Dt(Z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Dt(Z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Dt(Z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Dt(Z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Dt(Z.paint_hillshade["hillshade-accent-color"])})}};class yp extends yr{constructor(t){super(t,_p)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const vp=Kt([{name:"a_pos",components:2,type:"Int16"}],4),{members:gd}=vp;function Eh(r,t,a){const s=a.patternDependencies;let d=!1;for(const g of t){const _=g.paint.get(`${r}-pattern`);_.isConstant()||(d=!0);const v=_.constantOr(null);v&&(d=!0,s[v.to]=!0,s[v.from]=!0)}return d}function _d(r,t,a,s,d){const g=d.patternDependencies;for(const _ of t){const v=_.paint.get(`${r}-pattern`).value;if(v.kind!=="constant"){let T=v.evaluate({zoom:s-1},a,{},d.availableImages),M=v.evaluate({zoom:s},a,{},d.availableImages),P=v.evaluate({zoom:s+1},a,{},d.availableImages);T=T&&T.name?T.name:T,M=M&&M.name?M.name:M,P=P&&P.name?P.name:P,g[T]=!0,g[M]=!0,g[P]=!0,a.patterns[_.id]={min:T,mid:M,max:P}}}return a}function ff(r,t,a,s,d){let g;if(d===function(_,v,T,M){let P=0;for(let D=v,j=T-M;D<T;D+=M)P+=(_[j]-_[D])*(_[D+1]+_[j+1]),j=D;return P}(r,t,a,s)>0)for(let _=t;_<a;_+=s)g=Sp(_/s|0,r[_],r[_+1],g);else for(let _=a-s;_>=t;_-=s)g=Sp(_/s|0,r[_],r[_+1],g);return g&&wa(g,g.next)&&(zu(g),g=g.next),g}function Dl(r,t){if(!r)return r;t||(t=r);let a,s=r;do if(a=!1,s.steiner||!wa(s,s.next)&&Fn(s.prev,s,s.next)!==0)s=s.next;else{if(zu(s),s=t=s.prev,s===s.next)break;a=!0}while(a||s!==t);return t}function Ec(r,t,a,s,d,g,_){if(!r)return;!_&&g&&function(T,M,P,D){let j=T;do j.z===0&&(j.z=Ch(j.x,j.y,M,P,D)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==T);j.prevZ.nextZ=null,j.prevZ=null,function(U){let G,X=1;do{let ee,oe=U;U=null;let ye=null;for(G=0;oe;){G++;let le=oe,N=0;for(let de=0;de<X&&(N++,le=le.nextZ,le);de++);let J=X;for(;N>0||J>0&&le;)N!==0&&(J===0||!le||oe.z<=le.z)?(ee=oe,oe=oe.nextZ,N--):(ee=le,le=le.nextZ,J--),ye?ye.nextZ=ee:U=ee,ee.prevZ=ye,ye=ee;oe=le}ye.nextZ=null,X*=2}while(G>1)}(j)}(r,s,d,g);let v=r;for(;r.prev!==r.next;){const T=r.prev,M=r.next;if(g?mf(r,s,d,g):pf(r))t.push(T.i,r.i,M.i),zu(r),r=M.next,v=M.next;else if((r=M)===v){_?_===1?Ec(r=xp(Dl(r),t),t,a,s,d,g,2):_===2&&gf(r,t,a,s,d,g):Ec(Dl(r),t,a,s,d,g,1);break}}}function pf(r){const t=r.prev,a=r,s=r.next;if(Fn(t,a,s)>=0)return!1;const d=t.x,g=a.x,_=s.x,v=t.y,T=a.y,M=s.y,P=Math.min(d,g,_),D=Math.min(v,T,M),j=Math.max(d,g,_),U=Math.max(v,T,M);let G=s.next;for(;G!==t;){if(G.x>=P&&G.x<=j&&G.y>=D&&G.y<=U&&Cc(d,v,g,T,_,M,G.x,G.y)&&Fn(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function mf(r,t,a,s){const d=r.prev,g=r,_=r.next;if(Fn(d,g,_)>=0)return!1;const v=d.x,T=g.x,M=_.x,P=d.y,D=g.y,j=_.y,U=Math.min(v,T,M),G=Math.min(P,D,j),X=Math.max(v,T,M),ee=Math.max(P,D,j),oe=Ch(U,G,t,a,s),ye=Ch(X,ee,t,a,s);let le=r.prevZ,N=r.nextZ;for(;le&&le.z>=oe&&N&&N.z<=ye;){if(le.x>=U&&le.x<=X&&le.y>=G&&le.y<=ee&&le!==d&&le!==_&&Cc(v,P,T,D,M,j,le.x,le.y)&&Fn(le.prev,le,le.next)>=0||(le=le.prevZ,N.x>=U&&N.x<=X&&N.y>=G&&N.y<=ee&&N!==d&&N!==_&&Cc(v,P,T,D,M,j,N.x,N.y)&&Fn(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;le&&le.z>=oe;){if(le.x>=U&&le.x<=X&&le.y>=G&&le.y<=ee&&le!==d&&le!==_&&Cc(v,P,T,D,M,j,le.x,le.y)&&Fn(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;N&&N.z<=ye;){if(N.x>=U&&N.x<=X&&N.y>=G&&N.y<=ee&&N!==d&&N!==_&&Cc(v,P,T,D,M,j,N.x,N.y)&&Fn(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function xp(r,t){let a=r;do{const s=a.prev,d=a.next.next;!wa(s,d)&&yf(s,a,a.next,d)&&mn(s,d)&&mn(d,s)&&(t.push(s.i,a.i,d.i),zu(a),zu(a.next),a=r=d),a=a.next}while(a!==r);return Dl(a)}function gf(r,t,a,s,d,g){let _=r;do{let v=_.next.next;for(;v!==_.prev;){if(_.i!==v.i&&xm(_,v)){let T=Tp(_,v);return _=Dl(_,_.next),T=Dl(T,T.next),Ec(_,t,a,s,d,g,0),void Ec(T,t,a,s,d,g,0)}v=v.next}_=_.next}while(_!==r)}function yd(r,t){let a=r.x-t.x;return a===0&&(a=r.y-t.y,a===0)&&(a=(r.next.y-r.y)/(r.next.x-r.x)-(t.next.y-t.y)/(t.next.x-t.x)),a}function _f(r,t){const a=function(d,g){let _=g;const v=d.x,T=d.y;let M,P=-1/0;if(wa(d,_))return _;do{if(wa(d,_.next))return _.next;if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){const X=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(X<=v&&X>P&&(P=X,M=_.x<_.next.x?_:_.next,X===v))return M}_=_.next}while(_!==g);if(!M)return null;const D=M,j=M.x,U=M.y;let G=1/0;_=M;do{if(v>=_.x&&_.x>=j&&v!==_.x&&_s(T<U?v:P,T,j,U,T<U?P:v,T,_.x,_.y)){const X=Math.abs(T-_.y)/(v-_.x);mn(_,d)&&(X<G||X===G&&(_.x>M.x||_.x===M.x&&bp(M,_)))&&(M=_,G=X)}_=_.next}while(_!==D);return M}(r,t);if(!a)return t;const s=Tp(a,r);return Dl(s,s.next),Dl(a,a.next)}function bp(r,t){return Fn(r.prev,r,t.prev)<0&&Fn(t.next,r,r.next)<0}function Ch(r,t,a,s,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-a)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function wp(r){let t=r,a=r;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==r);return a}function _s(r,t,a,s,d,g,_,v){return(d-_)*(t-v)>=(r-_)*(g-v)&&(r-_)*(s-v)>=(a-_)*(t-v)&&(a-_)*(g-v)>=(d-_)*(s-v)}function Cc(r,t,a,s,d,g,_,v){return!(r===_&&t===v)&&_s(r,t,a,s,d,g,_,v)}function xm(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(a,s){let d=a;do{if(d.i!==a.i&&d.next.i!==a.i&&d.i!==s.i&&d.next.i!==s.i&&yf(d,d.next,a,s))return!0;d=d.next}while(d!==a);return!1}(r,t)&&(mn(r,t)&&mn(t,r)&&function(a,s){let d=a,g=!1;const _=(a.x+s.x)/2,v=(a.y+s.y)/2;do d.y>v!=d.next.y>v&&d.next.y!==d.y&&_<(d.next.x-d.x)*(v-d.y)/(d.next.y-d.y)+d.x&&(g=!g),d=d.next;while(d!==a);return g}(r,t)&&(Fn(r.prev,r,t.prev)||Fn(r,t.prev,t))||wa(r,t)&&Fn(r.prev,r,r.next)>0&&Fn(t.prev,t,t.next)>0)}function Fn(r,t,a){return(t.y-r.y)*(a.x-t.x)-(t.x-r.x)*(a.y-t.y)}function wa(r,t){return r.x===t.x&&r.y===t.y}function yf(r,t,a,s){const d=kl(Fn(r,t,a)),g=kl(Fn(r,t,s)),_=kl(Fn(a,s,r)),v=kl(Fn(a,s,t));return d!==g&&_!==v||!(d!==0||!Mc(r,a,t))||!(g!==0||!Mc(r,s,t))||!(_!==0||!Mc(a,r,s))||!(v!==0||!Mc(a,t,s))}function Mc(r,t,a){return t.x<=Math.max(r.x,a.x)&&t.x>=Math.min(r.x,a.x)&&t.y<=Math.max(r.y,a.y)&&t.y>=Math.min(r.y,a.y)}function kl(r){return r>0?1:r<0?-1:0}function mn(r,t){return Fn(r.prev,r,r.next)<0?Fn(r,t,r.next)>=0&&Fn(r,r.prev,t)>=0:Fn(r,t,r.prev)<0||Fn(r,r.next,t)<0}function Tp(r,t){const a=Ac(r.i,r.x,r.y),s=Ac(t.i,t.x,t.y),d=r.next,g=t.prev;return r.next=t,t.prev=r,a.next=d,d.prev=a,s.next=a,a.prev=s,g.next=s,s.prev=g,s}function Sp(r,t,a,s){const d=Ac(r,t,a);return s?(d.next=s.next,d.prev=s,s.next.prev=d,s.next=d):(d.prev=d,d.next=d),d}function zu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Ac(r,t,a){return{i:r,x:t,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Ua{constructor(t,a){if(a>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=a}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Mh{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Mh.noSubdivision=new Mh({fill:new Ua(0,0),line:new Ua(0,0),tile:new Ua(0,0),stencil:new Ua(0,0),circle:1}),Tt("SubdivisionGranularityExpression",Ua),Tt("SubdivisionGranularitySetting",Mh);const zc=-32768,Js=32767;class ys{constructor(t,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Ve/t,this._canonical=a}_getKey(t,a){return(t+=32768)<<16|(a+=32768)<<0}_vertexToIndex(t,a){if(t<-32768||a<-32768||t>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const s=0|Math.round(t),d=0|Math.round(a),g=this._getKey(s,d);if(this._vertexDictionary.has(g))return this._vertexDictionary.get(g);const _=this._vertexBuffer.length/2;return this._vertexDictionary.set(g,_),this._vertexBuffer.push(s,d),_}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(d,g){const _=[];for(let v=0;v<g.length;v+=3){const T=g[v],M=g[v+1],P=g[v+2],D=d[2*T],j=d[2*T+1];(d[2*M]-D)*(d[2*P+1]-j)-(d[2*M+1]-j)*(d[2*P]-D)>0?(_.push(T),_.push(P),_.push(M)):(_.push(T),_.push(M),_.push(P))}return _}(this._vertexBuffer,t);const a=[],s=t.length;for(let d=0;d<s;d+=3){const g=[t[d+0],t[d+1],t[d+2]],_=[this._vertexBuffer[2*t[d+0]+0],this._vertexBuffer[2*t[d+0]+1],this._vertexBuffer[2*t[d+1]+0],this._vertexBuffer[2*t[d+1]+1],this._vertexBuffer[2*t[d+2]+0],this._vertexBuffer[2*t[d+2]+1]];let v=1/0,T=1/0,M=-1/0,P=-1/0;for(let X=0;X<3;X++){const ee=_[2*X],oe=_[2*X+1];v=Math.min(v,ee),M=Math.max(M,ee),T=Math.min(T,oe),P=Math.max(P,oe)}if(v===M||T===P)continue;const D=Math.floor(v/this._granularityCellSize),j=Math.ceil(M/this._granularityCellSize),U=Math.floor(T/this._granularityCellSize),G=Math.ceil(P/this._granularityCellSize);if(D!==j||U!==G)for(let X=U;X<G;X++){const ee=this._scanlineGenerateVertexRingForCellRow(X,_,g);Ep(this._vertexBuffer,ee,a)}else a.push(...g)}return a}_scanlineGenerateVertexRingForCellRow(t,a,s){const d=t*this._granularityCellSize,g=d+this._granularityCellSize,_=[];for(let v=0;v<3;v++){const T=a[2*v],M=a[2*v+1],P=a[2*(v+1)%6],D=a[(2*(v+1)+1)%6],j=a[2*(v+2)%6],U=a[(2*(v+2)+1)%6],G=P-T,X=D-M,ee=G===0,oe=X===0,ye=(d-M)/X,le=(g-M)/X,N=Math.min(ye,le),J=Math.max(ye,le);if(!oe&&(N>=1||J<=0)||oe&&(M<d||M>g)){D>=d&&D<=g&&_.push(s[(v+1)%3]);continue}!oe&&N>0&&_.push(this._vertexToIndex(T+G*N,M+X*N));const de=T+G*Math.max(N,0),Le=T+G*Math.min(J,1);ee||this._generateIntraEdgeVertices(_,T,M,P,D,de,Le),!oe&&J<1&&_.push(this._vertexToIndex(T+G*J,M+X*J)),(oe||D>=d&&D<=g)&&_.push(s[(v+1)%3]),!oe&&(D<=d||D>=g)&&this._generateInterEdgeVertices(_,T,M,P,D,j,U,Le,d,g)}return _}_generateIntraEdgeVertices(t,a,s,d,g,_,v){const T=d-a,M=g-s,P=M===0,D=P?Math.min(a,d):Math.min(_,v),j=P?Math.max(a,d):Math.max(_,v),U=Math.floor(D/this._granularityCellSize)+1,G=Math.ceil(j/this._granularityCellSize)-1;if(P?a<d:_<v)for(let X=U;X<=G;X++){const ee=X*this._granularityCellSize;t.push(this._vertexToIndex(ee,s+M*(ee-a)/T))}else for(let X=G;X>=U;X--){const ee=X*this._granularityCellSize;t.push(this._vertexToIndex(ee,s+M*(ee-a)/T))}}_generateInterEdgeVertices(t,a,s,d,g,_,v,T,M,P){const D=g-s,j=_-d,U=v-g,G=(M-g)/U,X=(P-g)/U,ee=Math.min(G,X),oe=Math.max(G,X),ye=d+j*ee;let le=Math.floor(Math.min(ye,T)/this._granularityCellSize)+1,N=Math.ceil(Math.max(ye,T)/this._granularityCellSize)-1,J=T<ye;const de=U===0;if(de&&(v===M||v===P))return;if(de||ee>=1||oe<=0){const ot=s-v,Ue=_+(a-_)*Math.min((M-v)/ot,(P-v)/ot);le=Math.floor(Math.min(Ue,T)/this._granularityCellSize)+1,N=Math.ceil(Math.max(Ue,T)/this._granularityCellSize)-1,J=T<Ue}const Le=D>0?P:M;if(J)for(let ot=le;ot<=N;ot++)t.push(this._vertexToIndex(ot*this._granularityCellSize,Le));else for(let ot=N;ot>=le;ot--)t.push(this._vertexToIndex(ot*this._granularityCellSize,Le))}_generateOutline(t){const a=[];for(const s of t){const d=el(s,this._granularity,!0),g=this._pointArrayToIndices(d),_=[];for(let v=1;v<g.length;v++)_.push(g[v-1]),_.push(g[v]);a.push(_)}return a}_handlePoles(t){let a=!1,s=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(s=!0)),(a||s)&&this._fillPoles(t,a,s)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let a=0;a<t.length;a+=2){const s=t[a+1];s===zc&&(t[a+1]=-32767),s===Js&&(t[a+1]=32766)}}_generatePoleQuad(t,a,s,d,g,_){d>g!=(_===zc)?(t.push(a),t.push(s),t.push(this._vertexToIndex(d,_)),t.push(s),t.push(this._vertexToIndex(g,_)),t.push(this._vertexToIndex(d,_))):(t.push(s),t.push(a),t.push(this._vertexToIndex(d,_)),t.push(this._vertexToIndex(g,_)),t.push(s),t.push(this._vertexToIndex(d,_)))}_fillPoles(t,a,s){const d=this._vertexBuffer,g=Ve,_=t.length;for(let v=2;v<_;v+=3){const T=t[v-2],M=t[v-1],P=t[v],D=d[2*T],j=d[2*T+1],U=d[2*M],G=d[2*M+1],X=d[2*P],ee=d[2*P+1];a&&(j===0&&G===0&&this._generatePoleQuad(t,T,M,D,U,zc),G===0&&ee===0&&this._generatePoleQuad(t,M,P,U,X,zc),ee===0&&j===0&&this._generatePoleQuad(t,P,T,X,D,zc)),s&&(j===g&&G===g&&this._generatePoleQuad(t,T,M,D,U,Js),G===g&&ee===g&&this._generatePoleQuad(t,M,P,U,X,Js),ee===g&&j===g&&this._generatePoleQuad(t,P,T,X,D,Js))}}_initializeVertices(t){for(let a=0;a<t.length;a+=2)this._vertexToIndex(t[a],t[a+1])}subdividePolygonInternal(t,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:s,holeIndices:d}=function(v){const T=[],M=[];for(const P of v)if(P.length!==0){P!==v[0]&&T.push(M.length/2);for(let D=0;D<P.length;D++)M.push(P[D].x),M.push(P[D].y)}return{flattened:M,holeIndices:T}}(t);let g;this._initializeVertices(s);try{const v=function(M,P,D=2){const j=P&&P.length,U=j?P[0]*D:M.length;let G=ff(M,0,U,D,!0);const X=[];if(!G||G.next===G.prev)return X;let ee,oe,ye;if(j&&(G=function(le,N,J,de){const Le=[];for(let ot=0,Ue=N.length;ot<Ue;ot++){const Xe=ff(le,N[ot]*de,ot<Ue-1?N[ot+1]*de:le.length,de,!1);Xe===Xe.next&&(Xe.steiner=!0),Le.push(wp(Xe))}Le.sort(yd);for(let ot=0;ot<Le.length;ot++)J=_f(Le[ot],J);return J}(M,P,G,D)),M.length>80*D){ee=1/0,oe=1/0;let le=-1/0,N=-1/0;for(let J=D;J<U;J+=D){const de=M[J],Le=M[J+1];de<ee&&(ee=de),Le<oe&&(oe=Le),de>le&&(le=de),Le>N&&(N=Le)}ye=Math.max(le-ee,N-oe),ye=ye!==0?32767/ye:0}return Ec(G,X,D,ee,oe,ye,0),X}(s,d),T=this._convertIndices(s,v);g=this._subdivideTrianglesScanline(T)}catch(v){console.error(v)}let _=[];return a&&(_=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(g),{verticesFlattened:this._vertexBuffer,indicesTriangles:g,indicesLineList:_}}_convertIndices(t,a){const s=[];for(let d=0;d<a.length;d++)s.push(this._vertexToIndex(t[2*a[d]],t[2*a[d]+1]));return s}_pointArrayToIndices(t){const a=[];for(let s=0;s<t.length;s++){const d=t[s];a.push(this._vertexToIndex(d.x,d.y))}return a}}function vf(r,t,a,s=!0){return new ys(a,t).subdividePolygonInternal(r,s)}function el(r,t,a=!1){if(!r||r.length<1)return[];if(r.length<2)return[];const s=r[0],d=r[r.length-1],g=a&&(s.x!==d.x||s.y!==d.y);if(t<2)return g?[...r,r[0]]:[...r];const _=Math.floor(Ve/t),v=[];v.push(new he(r[0].x,r[0].y));const T=r.length,M=g?T:T-1;for(let P=0;P<M;P++){const D=r[P],j=P<T-1?r[P+1]:r[0],U=D.x,G=D.y,X=j.x,ee=j.y,oe=U!==X,ye=G!==ee;if(!oe&&!ye)continue;const le=X-U,N=ee-G,J=Math.abs(le),de=Math.abs(N);let Le=U,ot=G;for(;;){const Xe=le>0?(Math.floor(Le/_)+1)*_:(Math.ceil(Le/_)-1)*_,ut=N>0?(Math.floor(ot/_)+1)*_:(Math.ceil(ot/_)-1)*_,at=Math.abs(Le-Xe),ht=Math.abs(ot-ut),Je=Math.abs(Le-X),Ct=Math.abs(ot-ee),Zt=oe?at/J:Number.POSITIVE_INFINITY,Ut=ye?ht/de:Number.POSITIVE_INFINITY;if((Je<=at||!oe)&&(Ct<=ht||!ye))break;if(Zt<Ut&&oe||!ye){Le=Xe,ot+=N*Zt;const kt=new he(Le,Math.round(ot));v[v.length-1].x===kt.x&&v[v.length-1].y===kt.y||v.push(kt)}else{Le+=le*Ut,ot=ut;const kt=new he(Math.round(Le),ot);v[v.length-1].x===kt.x&&v[v.length-1].y===kt.y||v.push(kt)}}const Ue=new he(X,ee);v[v.length-1].x===Ue.x&&v[v.length-1].y===Ue.y||v.push(Ue)}return v}function Ep(r,t,a){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let s=0,d=r[2*t[0]];for(let T=1;T<t.length;T++){const M=r[2*t[T]];M<d&&(d=M,s=T)}const g=t.length;let _=s,v=(_+1)%g;for(;;){const T=_-1>=0?_-1:g-1,M=(v+1)%g,P=r[2*t[T]],D=r[2*t[M]],j=r[2*t[_]],U=r[2*t[_]+1],G=r[2*t[v]+1];let X=!1;if(P<D)X=!0;else if(P>D)X=!1;else{const ee=G-U,oe=-(r[2*t[v]]-j),ye=U<G?1:-1;((P-j)*ee+(r[2*t[T]+1]-U)*oe)*ye>((D-j)*ee+(r[2*t[M]+1]-U)*oe)*ye&&(X=!0)}if(X){const ee=t[T],oe=t[_],ye=t[v];ee!==oe&&ee!==ye&&oe!==ye&&a.push(ye,oe,ee),_--,_<0&&(_=g-1)}else{const ee=t[M],oe=t[_],ye=t[v];ee!==oe&&ee!==ye&&oe!==ye&&a.push(ye,oe,ee),v++,v>=g&&(v=0)}if(T===M)break}}function vd(r,t,a,s,d,g,_,v,T){const M=d.length/2,P=_&&v&&T;if(M<ni.MAX_VERTEX_ARRAY_LENGTH){const D=t.prepareSegment(M,a,s),j=D.vertexLength;for(let X=0;X<g.length;X+=3)s.emplaceBack(j+g[X],j+g[X+1],j+g[X+2]);let U,G;D.vertexLength+=M,D.primitiveLength+=g.length/3,P&&(G=_.prepareSegment(M,a,v),U=G.vertexLength,G.vertexLength+=M);for(let X=0;X<d.length;X+=2)r(d[X],d[X+1]);if(P)for(let X=0;X<T.length;X++){const ee=T[X];for(let oe=1;oe<ee.length;oe+=2)v.emplaceBack(U+ee[oe-1],U+ee[oe]);G.primitiveLength+=ee.length/2}}else(function(D,j,U,G,X,ee){const oe=[];for(let de=0;de<G.length/2;de++)oe.push(-1);const ye={count:0};let le=0,N=D.getOrCreateLatestSegment(j,U),J=N.vertexLength;for(let de=2;de<X.length;de+=3){const Le=X[de-2],ot=X[de-1],Ue=X[de];let Xe=oe[Le]<le,ut=oe[ot]<le,at=oe[Ue]<le;N.vertexLength+((Xe?1:0)+(ut?1:0)+(at?1:0))>ni.MAX_VERTEX_ARRAY_LENGTH&&(N=D.createNewSegment(j,U),le=ye.count,Xe=!0,ut=!0,at=!0,J=0);const ht=Rc(oe,G,ee,ye,Le,Xe,N),Je=Rc(oe,G,ee,ye,ot,ut,N),Ct=Rc(oe,G,ee,ye,Ue,at,N);U.emplaceBack(J+ht-le,J+Je-le,J+Ct-le),N.primitiveLength++}})(t,a,s,d,g,r),P&&function(D,j,U,G,X,ee){const oe=[];for(let de=0;de<G.length/2;de++)oe.push(-1);const ye={count:0};let le=0,N=D.getOrCreateLatestSegment(j,U),J=N.vertexLength;for(let de=0;de<X.length;de++){const Le=X[de];for(let ot=1;ot<X[de].length;ot+=2){const Ue=Le[ot-1],Xe=Le[ot];let ut=oe[Ue]<le,at=oe[Xe]<le;N.vertexLength+((ut?1:0)+(at?1:0))>ni.MAX_VERTEX_ARRAY_LENGTH&&(N=D.createNewSegment(j,U),le=ye.count,ut=!0,at=!0,J=0);const ht=Rc(oe,G,ee,ye,Ue,ut,N),Je=Rc(oe,G,ee,ye,Xe,at,N);U.emplaceBack(J+ht-le,J+Je-le),N.primitiveLength++}}}(_,a,v,d,T,r),t.forceNewSegmentOnNextPrepare(),_==null||_.forceNewSegmentOnNextPrepare()}function Rc(r,t,a,s,d,g,_){if(g){const v=s.count;return a(t[2*d],t[2*d+1]),r[d]=s.count,s.count++,_.vertexLength++,v}return r[d]}class Ru{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ge,this.indexArray=new it,this.indexArray2=new Pt,this.programConfigurations=new co(t.layers,t.zoom),this.segments=new ni,this.segments2=new ni,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,s){this.hasPattern=Eh("fill",this.layers,a);const d=this.layers[0].layout.get("fill-sort-key"),g=!d.isConstant(),_=[];for(const{feature:v,id:T,index:M,sourceLayerIndex:P}of t){const D=this.layers[0]._featureFilter.needGeometry,j=Na(v,D);if(!this.layers[0]._featureFilter.filter(new Qi(this.zoom),j,s))continue;const U=g?d.evaluate(j,{},s,a.availableImages):void 0,G={id:T,properties:v.properties,type:v.type,sourceLayerIndex:P,index:M,geometry:D?j.geometry:xa(v),patterns:{},sortKey:U};_.push(G)}g&&_.sort((v,T)=>v.sortKey-T.sortKey);for(const v of _){const{geometry:T,index:M,sourceLayerIndex:P}=v;if(this.hasPattern){const D=_d("fill",this.layers,v,this.zoom,a);this.patternFeatures.push(D)}else this.addFeature(v,T,M,s,{},a.subdivisionGranularity);a.featureIndex.insert(t[M].feature,T,M,P,this.index)}}update(t,a,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,s)}addFeatures(t,a,s){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,a,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gd),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,s,d,g,_){for(const v of Po(a,500)){const T=vf(v,d,_.fill.getGranularityForZoomLevel(d.z)),M=this.layoutVertexArray;vd((P,D)=>{M.emplaceBack(P,D)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles,this.segments2,this.indexArray2,T.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,g,d)}}let xf,vs;Tt("FillBucket",Ru,{omit:["layers","patternFeatures"]});var rr={get paint(){return vs=vs||new _r({"fill-antialias":new Dt(Z.paint_fill["fill-antialias"]),"fill-opacity":new Nt(Z.paint_fill["fill-opacity"]),"fill-color":new Nt(Z.paint_fill["fill-color"]),"fill-outline-color":new Nt(Z.paint_fill["fill-outline-color"]),"fill-translate":new Dt(Z.paint_fill["fill-translate"]),"fill-translate-anchor":new Dt(Z.paint_fill["fill-translate-anchor"]),"fill-pattern":new _c(Z.paint_fill["fill-pattern"])})},get layout(){return xf=xf||new _r({"fill-sort-key":new Nt(Z.layout_fill["fill-sort-key"])})}};class bf extends yr{constructor(t){super(t,rr)}recalculate(t,a){super.recalculate(t,a);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Ru(t)}queryRadius(){return Au(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:a,transform:s,pixelsToTileUnits:d}){return sf(bh(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-s.bearingInRadians,d),a)}isTileClipped(){return!0}}const Cp=Kt([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ar=Kt([{name:"a_centroid",components:2,type:"Int16"}],4),{members:bm}=Cp;var xd,wf,Sn,ua,No,Tf,Sf,bd={};function wd(){if(wf)return xd;wf=1;var r=ze();function t(d,g,_,v,T){this.properties={},this.extent=_,this.type=0,this._pbf=d,this._geometry=-1,this._keys=v,this._values=T,d.readFields(a,this,g)}function a(d,g,_){d==1?g.id=_.readVarint():d==2?function(v,T){for(var M=v.readVarint()+v.pos;v.pos<M;){var P=T._keys[v.readVarint()],D=T._values[v.readVarint()];T.properties[P]=D}}(_,g):d==3?g.type=_.readVarint():d==4&&(g._geometry=_.pos)}function s(d){for(var g,_,v=0,T=0,M=d.length,P=M-1;T<M;P=T++)v+=((_=d[P]).x-(g=d[T]).x)*(g.y+_.y);return v}return xd=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var d=this._pbf;d.pos=this._geometry;for(var g,_=d.readVarint()+d.pos,v=1,T=0,M=0,P=0,D=[];d.pos<_;){if(T<=0){var j=d.readVarint();v=7&j,T=j>>3}if(T--,v===1||v===2)M+=d.readSVarint(),P+=d.readSVarint(),v===1&&(g&&D.push(g),g=[]),g.push(new r(M,P));else{if(v!==7)throw new Error("unknown command "+v);g&&g.push(g[0].clone())}}return g&&D.push(g),D},t.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var g=d.readVarint()+d.pos,_=1,v=0,T=0,M=0,P=1/0,D=-1/0,j=1/0,U=-1/0;d.pos<g;){if(v<=0){var G=d.readVarint();_=7&G,v=G>>3}if(v--,_===1||_===2)(T+=d.readSVarint())<P&&(P=T),T>D&&(D=T),(M+=d.readSVarint())<j&&(j=M),M>U&&(U=M);else if(_!==7)throw new Error("unknown command "+_)}return[P,j,D,U]},t.prototype.toGeoJSON=function(d,g,_){var v,T,M=this.extent*Math.pow(2,_),P=this.extent*d,D=this.extent*g,j=this.loadGeometry(),U=t.types[this.type];function G(oe){for(var ye=0;ye<oe.length;ye++){var le=oe[ye];oe[ye]=[360*(le.x+P)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*(le.y+D)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var X=[];for(v=0;v<j.length;v++)X[v]=j[v][0];G(j=X);break;case 2:for(v=0;v<j.length;v++)G(j[v]);break;case 3:for(j=function(oe){var ye=oe.length;if(ye<=1)return[oe];for(var le,N,J=[],de=0;de<ye;de++){var Le=s(oe[de]);Le!==0&&(N===void 0&&(N=Le<0),N===Le<0?(le&&J.push(le),le=[oe[de]]):le.push(oe[de]))}return le&&J.push(le),J}(j),v=0;v<j.length;v++)for(T=0;T<j[v].length;T++)G(j[v][T])}j.length===1?j=j[0]:U="Multi"+U;var ee={type:"Feature",geometry:{type:U,coordinates:j},properties:this.properties};return"id"in this&&(ee.id=this.id),ee},xd}function Ta(){if(ua)return Sn;ua=1;var r=wd();function t(s,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(a,this,d),this.length=this._features.length}function a(s,d,g){s===15?d.version=g.readVarint():s===1?d.name=g.readString():s===5?d.extent=g.readVarint():s===2?d._features.push(g.pos):s===3?d._keys.push(g.readString()):s===4&&d._values.push(function(_){for(var v=null,T=_.readVarint()+_.pos;_.pos<T;){var M=_.readVarint()>>3;v=M===1?_.readString():M===2?_.readFloat():M===3?_.readDouble():M===4?_.readVarint64():M===5?_.readVarint():M===6?_.readSVarint():M===7?_.readBoolean():null}return v}(g))}return Sn=t,t.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var d=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,d,this.extent,this._keys,this._values)},Sn}function fo(){return Sf||(Sf=1,bd.VectorTile=function(){if(Tf)return No;Tf=1;var r=Ta();function t(a,s,d){if(a===3){var g=new r(d,d.readVarint()+d.pos);g.length&&(s[g.name]=g)}}return No=function(a,s){this.layers=a.readFields(t,{},s)},No}(),bd.VectorTileFeature=wd(),bd.VectorTileLayer=Ta()),bd}var Pu=re(fo());const Va=Pu.VectorTileFeature.types,Td=Math.pow(2,13);function po(r,t,a,s,d,g,_,v){r.emplaceBack(t,a,2*Math.floor(s*Td)+_,d*Td*2,g*Td*2,Math.round(v))}class tl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new we,this.centroidVertexArray=new fe,this.indexArray=new it,this.programConfigurations=new co(t.layers,t.zoom),this.segments=new ni,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,s){this.features=[],this.hasPattern=Eh("fill-extrusion",this.layers,a);for(const{feature:d,id:g,index:_,sourceLayerIndex:v}of t){const T=this.layers[0]._featureFilter.needGeometry,M=Na(d,T);if(!this.layers[0]._featureFilter.filter(new Qi(this.zoom),M,s))continue;const P={id:g,sourceLayerIndex:v,index:_,geometry:T?M.geometry:xa(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(_d("fill-extrusion",this.layers,P,this.zoom,a)):this.addFeature(P,P.geometry,_,s,{},a.subdivisionGranularity),a.featureIndex.insert(d,P.geometry,_,v,this.index,!0)}}addFeatures(t,a,s){for(const d of this.features){const{geometry:g}=d;this.addFeature(d,g,d.index,a,s,t.subdivisionGranularity)}}update(t,a,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bm),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Ar.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,s,d,g,_){for(const v of Po(a,500)){const T={x:0,y:0,sampleCount:0},M=this.layoutVertexArray.length;this.processPolygon(T,d,t,v,_);const P=this.layoutVertexArray.length-M,D=Math.floor(T.x/T.sampleCount),j=Math.floor(T.y/T.sampleCount);for(let U=0;U<P;U++)this.centroidVertexArray.emplaceBack(D,j)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,g,d)}processPolygon(t,a,s,d,g){if(d.length<1||Sd(d[0]))return;for(const D of d)D.length!==0&&Ll(t,D);const _={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=g.fill.getGranularityForZoomLevel(a.z),T=Va[s.type]==="Polygon";for(const D of d){if(D.length===0||Sd(D))continue;const j=el(D,v,T);this._generateSideFaces(j,_)}if(!T)return;const M=vf(d,a,v,!1),P=this.layoutVertexArray;vd((D,j)=>{po(P,D,j,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,M.verticesFlattened,M.indicesTriangles)}_generateSideFaces(t,a){let s=0;for(let d=1;d<t.length;d++){const g=t[d],_=t[d-1];if(Ef(g,_))continue;a.segment.vertexLength+4>ni.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=g.sub(_)._perp()._unit(),T=_.dist(g);s+T>32768&&(s=0),po(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,s),po(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,s),s+=T,po(this.layoutVertexArray,_.x,_.y,v.x,v.y,0,0,s),po(this.layoutVertexArray,_.x,_.y,v.x,v.y,0,1,s);const M=a.segment.vertexLength;this.indexArray.emplaceBack(M,M+2,M+1),this.indexArray.emplaceBack(M+1,M+2,M+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function Ll(r,t){for(let a=0;a<t.length;a++){const s=t[a];a===t.length-1&&t[0].x===s.x&&t[0].y===s.y||(r.x+=s.x,r.y+=s.y,r.sampleCount++)}}function Ef(r,t){return r.x===t.x&&(r.x<0||r.x>Ve)||r.y===t.y&&(r.y<0||r.y>Ve)}function Sd(r){return r.every(t=>t.x<0)||r.every(t=>t.x>Ve)||r.every(t=>t.y<0)||r.every(t=>t.y>Ve)}let Uo;Tt("FillExtrusionBucket",tl,{omit:["layers","features"]});var Mp={get paint(){return Uo=Uo||new _r({"fill-extrusion-opacity":new Dt(Z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Nt(Z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Dt(Z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Dt(Z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _c(Z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Nt(Z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Nt(Z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Dt(Z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Iu extends yr{constructor(t){super(t,Mp)}createBucket(t){return new tl(t)}queryRadius(){return Au(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:s,geometry:d,transform:g,pixelsToTileUnits:_,pixelPosMatrix:v}){const T=bh(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-g.bearingInRadians,_),M=this.paint.get("fill-extrusion-height").evaluate(a,s),P=this.paint.get("fill-extrusion-base").evaluate(a,s),D=function(U,G,X){const ee=[];for(const oe of U){const ye=[oe.x,oe.y,0,1];Mi(ye,ye,G),ee.push(new he(ye[0]/ye[3],ye[1]/ye[3]))}return ee}(T,v),j=function(U,G,X,ee){const oe=[],ye=[],le=ee[8]*G,N=ee[9]*G,J=ee[10]*G,de=ee[11]*G,Le=ee[8]*X,ot=ee[9]*X,Ue=ee[10]*X,Xe=ee[11]*X;for(const ut of U){const at=[],ht=[];for(const Je of ut){const Ct=Je.x,Zt=Je.y,Ut=ee[0]*Ct+ee[4]*Zt+ee[12],kt=ee[1]*Ct+ee[5]*Zt+ee[13],ci=ee[2]*Ct+ee[6]*Zt+ee[14],En=ee[3]*Ct+ee[7]*Zt+ee[15],Hn=ci+J,br=En+de,Wr=Ut+Le,ha=kt+ot,wr=ci+Ue,sn=En+Xe,Jn=new he((Ut+le)/br,(kt+N)/br);Jn.z=Hn/br,at.push(Jn);const er=new he(Wr/sn,ha/sn);er.z=wr/sn,ht.push(er)}oe.push(at),ye.push(ht)}return[oe,ye]}(d,P,M,v);return function(U,G,X){let ee=1/0;sf(X,G)&&(ee=Du(X,G[0]));for(let oe=0;oe<G.length;oe++){const ye=G[oe],le=U[oe];for(let N=0;N<ye.length-1;N++){const J=ye[N],de=[J,ye[N+1],le[N+1],le[N],J];Tc(X,de)&&(ee=Math.min(ee,Du(X,de)))}}return ee!==1/0&&ee}(j[0],j[1],D)}}function il(r,t){return r.x*t.x+r.y*t.y}function Du(r,t){if(r.length===1){let a=0;const s=t[a++];let d;for(;!d||s.equals(d);)if(d=t[a++],!d)return 1/0;for(;a<t.length;a++){const g=t[a],_=r[0],v=d.sub(s),T=g.sub(s),M=_.sub(s),P=il(v,v),D=il(v,T),j=il(T,T),U=il(M,v),G=il(M,T),X=P*j-D*D,ee=(j*U-D*G)/X,oe=(P*G-D*U)/X,ye=s.z*(1-ee-oe)+d.z*ee+g.z*oe;if(isFinite(ye))return ye}return 1/0}{let a=1/0;for(const s of t)a=Math.min(a,s.z);return a}}const ku=Kt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ap}=ku,zp=Kt([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ah}=zp,Rp=Pu.VectorTileFeature.types,Ed=Math.cos(Math.PI/180*37.5),Cf=Math.pow(2,14)/.5;class Mf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new xe,this.layoutVertexArray2=new Be,this.indexArray=new it,this.programConfigurations=new co(t.layers,t.zoom),this.segments=new ni,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,s){this.hasPattern=Eh("line",this.layers,a);const d=this.layers[0].layout.get("line-sort-key"),g=!d.isConstant(),_=[];for(const{feature:v,id:T,index:M,sourceLayerIndex:P}of t){const D=this.layers[0]._featureFilter.needGeometry,j=Na(v,D);if(!this.layers[0]._featureFilter.filter(new Qi(this.zoom),j,s))continue;const U=g?d.evaluate(j,{},s):void 0,G={id:T,properties:v.properties,type:v.type,sourceLayerIndex:P,index:M,geometry:D?j.geometry:xa(v),patterns:{},sortKey:U};_.push(G)}g&&_.sort((v,T)=>v.sortKey-T.sortKey);for(const v of _){const{geometry:T,index:M,sourceLayerIndex:P}=v;if(this.hasPattern){const D=_d("line",this.layers,v,this.zoom,a);this.patternFeatures.push(D)}else this.addFeature(v,T,M,s,{},a.subdivisionGranularity);a.featureIndex.insert(t[M].feature,T,M,P,this.index)}}update(t,a,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,s)}addFeatures(t,a,s){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,a,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Ah)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ap),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,s,d,g,_){const v=this.layers[0].layout,T=v.get("line-join").evaluate(t,{}),M=v.get("line-cap"),P=v.get("line-miter-limit"),D=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const j of a)this.addLine(j,t,T,M,P,D,d,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,g,d)}addLine(t,a,s,d,g,_,v,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=el(t,v?T.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<t.length-1;le++)this.totalDistance+=t[le].dist(t[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=Rp[a.type]==="Polygon";let P=t.length;for(;P>=2&&t[P-1].equals(t[P-2]);)P--;let D=0;for(;D<P-1&&t[D].equals(t[D+1]);)D++;if(P<(M?3:2))return;s==="bevel"&&(g=1.05);const j=this.overscaling<=16?15*Ve/(512*this.overscaling):0,U=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let G,X,ee,oe,ye;this.e1=this.e2=-1,M&&(G=t[P-2],ye=t[D].sub(G)._unit()._perp());for(let le=D;le<P;le++){if(ee=le===P-1?M?t[D+1]:void 0:t[le+1],ee&&t[le].equals(ee))continue;ye&&(oe=ye),G&&(X=G),G=t[le],ye=ee?ee.sub(G)._unit()._perp():oe,oe=oe||ye;let N=oe.add(ye);N.x===0&&N.y===0||N._unit();const J=oe.x*ye.x+oe.y*ye.y,de=N.x*ye.x+N.y*ye.y,Le=de!==0?1/de:1/0,ot=2*Math.sqrt(2-2*de),Ue=de<Ed&&X&&ee,Xe=oe.x*ye.y-oe.y*ye.x>0;if(Ue&&le>D){const ht=G.dist(X);if(ht>2*j){const Je=G.sub(G.sub(X)._mult(j/ht)._round());this.updateDistance(X,Je),this.addCurrentVertex(Je,oe,0,0,U),X=Je}}const ut=X&&ee;let at=ut?s:M?"butt":d;if(ut&&at==="round"&&(Le<_?at="miter":Le<=2&&(at="fakeround")),at==="miter"&&Le>g&&(at="bevel"),at==="bevel"&&(Le>2&&(at="flipbevel"),Le<g&&(at="miter")),X&&this.updateDistance(X,G),at==="miter")N._mult(Le),this.addCurrentVertex(G,N,0,0,U);else if(at==="flipbevel"){if(Le>100)N=ye.mult(-1);else{const ht=Le*oe.add(ye).mag()/oe.sub(ye).mag();N._perp()._mult(ht*(Xe?-1:1))}this.addCurrentVertex(G,N,0,0,U),this.addCurrentVertex(G,N.mult(-1),0,0,U)}else if(at==="bevel"||at==="fakeround"){const ht=-Math.sqrt(Le*Le-1),Je=Xe?ht:0,Ct=Xe?0:ht;if(X&&this.addCurrentVertex(G,oe,Je,Ct,U),at==="fakeround"){const Zt=Math.round(180*ot/Math.PI/20);for(let Ut=1;Ut<Zt;Ut++){let kt=Ut/Zt;if(kt!==.5){const En=kt-.5;kt+=kt*En*(kt-1)*((1.0904+J*(J*(3.55645-1.43519*J)-3.2452))*En*En+(.848013+J*(.215638*J-1.06021)))}const ci=ye.sub(oe)._mult(kt)._add(oe)._unit()._mult(Xe?-1:1);this.addHalfVertex(G,ci.x,ci.y,!1,Xe,0,U)}}ee&&this.addCurrentVertex(G,ye,-Je,-Ct,U)}else if(at==="butt")this.addCurrentVertex(G,N,0,0,U);else if(at==="square"){const ht=X?1:-1;this.addCurrentVertex(G,N,ht,ht,U)}else at==="round"&&(X&&(this.addCurrentVertex(G,oe,0,0,U),this.addCurrentVertex(G,oe,1,1,U,!0)),ee&&(this.addCurrentVertex(G,ye,-1,-1,U,!0),this.addCurrentVertex(G,ye,0,0,U)));if(Ue&&le<P-1){const ht=G.dist(ee);if(ht>2*j){const Je=G.add(ee.sub(G)._mult(j/ht)._round());this.updateDistance(G,Je),this.addCurrentVertex(Je,ye,0,0,U),G=Je}}}}addCurrentVertex(t,a,s,d,g,_=!1){const v=a.y*d-a.x,T=-a.y-a.x*d;this.addHalfVertex(t,a.x+a.y*s,a.y-a.x*s,_,!1,s,g),this.addHalfVertex(t,v,T,_,!0,-d,g),this.distance>Cf/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,a,s,d,g,_))}addHalfVertex({x:t,y:a},s,d,g,_,v,T){const M=.5*(this.lineClips?this.scaledDistance*(Cf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(a<<1)+(_?1:0),Math.round(63*s)+128,Math.round(63*d)+128,1+(v===0?0:v<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,P,this.e2),T.primitiveLength++),_?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}let Pp,Hi;Tt("LineBucket",Mf,{omit:["layers","patternFeatures"]});var gn={get paint(){return Hi=Hi||new _r({"line-opacity":new Nt(Z.paint_line["line-opacity"]),"line-color":new Nt(Z.paint_line["line-color"]),"line-translate":new Dt(Z.paint_line["line-translate"]),"line-translate-anchor":new Dt(Z.paint_line["line-translate-anchor"]),"line-width":new Nt(Z.paint_line["line-width"]),"line-gap-width":new Nt(Z.paint_line["line-gap-width"]),"line-offset":new Nt(Z.paint_line["line-offset"]),"line-blur":new Nt(Z.paint_line["line-blur"]),"line-dasharray":new Cu(Z.paint_line["line-dasharray"]),"line-pattern":new _c(Z.paint_line["line-pattern"]),"line-gradient":new cs(Z.paint_line["line-gradient"])})},get layout(){return Pp=Pp||new _r({"line-cap":new Dt(Z.layout_line["line-cap"]),"line-join":new Nt(Z.layout_line["line-join"]),"line-miter-limit":new Dt(Z.layout_line["line-miter-limit"]),"line-round-limit":new Dt(Z.layout_line["line-round-limit"]),"line-sort-key":new Nt(Z.layout_line["line-sort-key"])})}};class bi extends Nt{possiblyEvaluate(t,a){return a=new Qi(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(t,a)}evaluate(t,a,s,d){return a=$t({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(t,a,s,d)}}let wi;class tn extends yr{constructor(t){super(t,gn),this.gradientVersion=0,wi||(wi=new bi(gn.paint.properties["line-width"].specification),wi.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(s){return s._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Wo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,a){super.recalculate(t,a),this.paint._values["line-floorwidth"]=wi.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Mf(t)}queryRadius(t){const a=t,s=Sa(Sc("line-width",this,a),Sc("line-gap-width",this,a)),d=Sc("line-offset",this,a);return s/2+Math.abs(d)+Au(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:s,geometry:d,transform:g,pixelsToTileUnits:_}){const v=bh(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-g.bearingInRadians,_),T=_/2*Sa(this.paint.get("line-width").evaluate(a,s),this.paint.get("line-gap-width").evaluate(a,s)),M=this.paint.get("line-offset").evaluate(a,s);return M&&(d=function(P,D){const j=[];for(let U=0;U<P.length;U++){const G=P[U],X=[];for(let ee=0;ee<G.length;ee++){const oe=G[ee-1],ye=G[ee],le=G[ee+1],N=ee===0?new he(0,0):ye.sub(oe)._unit()._perp(),J=ee===G.length-1?new he(0,0):le.sub(ye)._unit()._perp(),de=N._add(J)._unit(),Le=de.x*J.x+de.y*J.y;Le!==0&&de._mult(1/Le),X.push(de._mult(D)._add(ye))}j.push(X)}return j}(d,M*_)),function(P,D,j){for(let U=0;U<D.length;U++){const G=D[U];if(P.length>=3){for(let X=0;X<G.length;X++)if(Pn(P,G[X]))return!0}if(uo(P,G,j))return!0}return!1}(v,d,T)}isTileClipped(){return!0}}function Sa(r,t){return t>0?t+2*r:r}const Bl=Kt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Lu=Kt([{name:"a_projected_pos",components:3,type:"Float32"}],4);Kt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Af=Kt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Kt([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const xs=Kt([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qn=Kt([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ol(r,t,a){return r.sections.forEach(s=>{s.text=function(d,g,_){const v=g.layout.get("text-transform").evaluate(_,{});return v==="uppercase"?d=d.toLocaleUpperCase():v==="lowercase"&&(d=d.toLocaleLowerCase()),ro.applyArabicShaping&&(d=ro.applyArabicShaping(d)),d}(s.text,t,a)}),r}Kt([{name:"triangle",components:3,type:"Uint16"}]),Kt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Kt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Kt([{type:"Float32",name:"offsetX"}]),Kt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Kt([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Vo={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Cd,Ea,Pc,In=24,Yr={};function zf(){return Cd||(Cd=1,Yr.read=function(r,t,a,s,d){var g,_,v=8*d-s-1,T=(1<<v)-1,M=T>>1,P=-7,D=a?d-1:0,j=a?-1:1,U=r[t+D];for(D+=j,g=U&(1<<-P)-1,U>>=-P,P+=v;P>0;g=256*g+r[t+D],D+=j,P-=8);for(_=g&(1<<-P)-1,g>>=-P,P+=s;P>0;_=256*_+r[t+D],D+=j,P-=8);if(g===0)g=1-M;else{if(g===T)return _?NaN:1/0*(U?-1:1);_+=Math.pow(2,s),g-=M}return(U?-1:1)*_*Math.pow(2,g-s)},Yr.write=function(r,t,a,s,d,g){var _,v,T,M=8*g-d-1,P=(1<<M)-1,D=P>>1,j=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=s?0:g-1,G=s?1:-1,X=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,_=P):(_=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-_))<1&&(_--,T*=2),(t+=_+D>=1?j/T:j*Math.pow(2,1-D))*T>=2&&(_++,T/=2),_+D>=P?(v=0,_=P):_+D>=1?(v=(t*T-1)*Math.pow(2,d),_+=D):(v=t*Math.pow(2,D-1)*Math.pow(2,d),_=0));d>=8;r[a+U]=255&v,U+=G,v/=256,d-=8);for(_=_<<d|v,M+=d;M>0;r[a+U]=255&_,U+=G,_/=256,M-=8);r[a+U-G]|=128*X}),Yr}function Md(){if(Pc)return Ea;Pc=1,Ea=t;var r=zf();function t(N){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(N)?N:new Uint8Array(N||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var a=4294967296,s=1/a,d=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function g(N){return N.type===t.Bytes?N.readVarint()+N.pos:N.pos+1}function _(N,J,de){return de?4294967296*J+(N>>>0):4294967296*(J>>>0)+(N>>>0)}function v(N,J,de){var Le=J<=16383?1:J<=2097151?2:J<=268435455?3:Math.floor(Math.log(J)/(7*Math.LN2));de.realloc(Le);for(var ot=de.pos-1;ot>=N;ot--)de.buf[ot+Le]=de.buf[ot]}function T(N,J){for(var de=0;de<N.length;de++)J.writeVarint(N[de])}function M(N,J){for(var de=0;de<N.length;de++)J.writeSVarint(N[de])}function P(N,J){for(var de=0;de<N.length;de++)J.writeFloat(N[de])}function D(N,J){for(var de=0;de<N.length;de++)J.writeDouble(N[de])}function j(N,J){for(var de=0;de<N.length;de++)J.writeBoolean(N[de])}function U(N,J){for(var de=0;de<N.length;de++)J.writeFixed32(N[de])}function G(N,J){for(var de=0;de<N.length;de++)J.writeSFixed32(N[de])}function X(N,J){for(var de=0;de<N.length;de++)J.writeFixed64(N[de])}function ee(N,J){for(var de=0;de<N.length;de++)J.writeSFixed64(N[de])}function oe(N,J){return(N[J]|N[J+1]<<8|N[J+2]<<16)+16777216*N[J+3]}function ye(N,J,de){N[de]=J,N[de+1]=J>>>8,N[de+2]=J>>>16,N[de+3]=J>>>24}function le(N,J){return(N[J]|N[J+1]<<8|N[J+2]<<16)+(N[J+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(N,J,de){for(de=de||this.length;this.pos<de;){var Le=this.readVarint(),ot=Le>>3,Ue=this.pos;this.type=7&Le,N(ot,J,this),this.pos===Ue&&this.skip(Le)}return J},readMessage:function(N,J){return this.readFields(N,J,this.readVarint()+this.pos)},readFixed32:function(){var N=oe(this.buf,this.pos);return this.pos+=4,N},readSFixed32:function(){var N=le(this.buf,this.pos);return this.pos+=4,N},readFixed64:function(){var N=oe(this.buf,this.pos)+oe(this.buf,this.pos+4)*a;return this.pos+=8,N},readSFixed64:function(){var N=oe(this.buf,this.pos)+le(this.buf,this.pos+4)*a;return this.pos+=8,N},readFloat:function(){var N=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,N},readDouble:function(){var N=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,N},readVarint:function(N){var J,de,Le=this.buf;return J=127&(de=Le[this.pos++]),de<128?J:(J|=(127&(de=Le[this.pos++]))<<7,de<128?J:(J|=(127&(de=Le[this.pos++]))<<14,de<128?J:(J|=(127&(de=Le[this.pos++]))<<21,de<128?J:function(ot,Ue,Xe){var ut,at,ht=Xe.buf;if(ut=(112&(at=ht[Xe.pos++]))>>4,at<128||(ut|=(127&(at=ht[Xe.pos++]))<<3,at<128)||(ut|=(127&(at=ht[Xe.pos++]))<<10,at<128)||(ut|=(127&(at=ht[Xe.pos++]))<<17,at<128)||(ut|=(127&(at=ht[Xe.pos++]))<<24,at<128)||(ut|=(1&(at=ht[Xe.pos++]))<<31,at<128))return _(ot,ut,Ue);throw new Error("Expected varint not more than 10 bytes")}(J|=(15&(de=Le[this.pos]))<<28,N,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var N=this.readVarint();return N%2==1?(N+1)/-2:N/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var N=this.readVarint()+this.pos,J=this.pos;return this.pos=N,N-J>=12&&d?function(de,Le,ot){return d.decode(de.subarray(Le,ot))}(this.buf,J,N):function(de,Le,ot){for(var Ue="",Xe=Le;Xe<ot;){var ut,at,ht,Je=de[Xe],Ct=null,Zt=Je>239?4:Je>223?3:Je>191?2:1;if(Xe+Zt>ot)break;Zt===1?Je<128&&(Ct=Je):Zt===2?(192&(ut=de[Xe+1]))==128&&(Ct=(31&Je)<<6|63&ut)<=127&&(Ct=null):Zt===3?(at=de[Xe+2],(192&(ut=de[Xe+1]))==128&&(192&at)==128&&((Ct=(15&Je)<<12|(63&ut)<<6|63&at)<=2047||Ct>=55296&&Ct<=57343)&&(Ct=null)):Zt===4&&(at=de[Xe+2],ht=de[Xe+3],(192&(ut=de[Xe+1]))==128&&(192&at)==128&&(192&ht)==128&&((Ct=(15&Je)<<18|(63&ut)<<12|(63&at)<<6|63&ht)<=65535||Ct>=1114112)&&(Ct=null)),Ct===null?(Ct=65533,Zt=1):Ct>65535&&(Ct-=65536,Ue+=String.fromCharCode(Ct>>>10&1023|55296),Ct=56320|1023&Ct),Ue+=String.fromCharCode(Ct),Xe+=Zt}return Ue}(this.buf,J,N)},readBytes:function(){var N=this.readVarint()+this.pos,J=this.buf.subarray(this.pos,N);return this.pos=N,J},readPackedVarint:function(N,J){if(this.type!==t.Bytes)return N.push(this.readVarint(J));var de=g(this);for(N=N||[];this.pos<de;)N.push(this.readVarint(J));return N},readPackedSVarint:function(N){if(this.type!==t.Bytes)return N.push(this.readSVarint());var J=g(this);for(N=N||[];this.pos<J;)N.push(this.readSVarint());return N},readPackedBoolean:function(N){if(this.type!==t.Bytes)return N.push(this.readBoolean());var J=g(this);for(N=N||[];this.pos<J;)N.push(this.readBoolean());return N},readPackedFloat:function(N){if(this.type!==t.Bytes)return N.push(this.readFloat());var J=g(this);for(N=N||[];this.pos<J;)N.push(this.readFloat());return N},readPackedDouble:function(N){if(this.type!==t.Bytes)return N.push(this.readDouble());var J=g(this);for(N=N||[];this.pos<J;)N.push(this.readDouble());return N},readPackedFixed32:function(N){if(this.type!==t.Bytes)return N.push(this.readFixed32());var J=g(this);for(N=N||[];this.pos<J;)N.push(this.readFixed32());return N},readPackedSFixed32:function(N){if(this.type!==t.Bytes)return N.push(this.readSFixed32());var J=g(this);for(N=N||[];this.pos<J;)N.push(this.readSFixed32());return N},readPackedFixed64:function(N){if(this.type!==t.Bytes)return N.push(this.readFixed64());var J=g(this);for(N=N||[];this.pos<J;)N.push(this.readFixed64());return N},readPackedSFixed64:function(N){if(this.type!==t.Bytes)return N.push(this.readSFixed64());var J=g(this);for(N=N||[];this.pos<J;)N.push(this.readSFixed64());return N},skip:function(N){var J=7&N;if(J===t.Varint)for(;this.buf[this.pos++]>127;);else if(J===t.Bytes)this.pos=this.readVarint()+this.pos;else if(J===t.Fixed32)this.pos+=4;else{if(J!==t.Fixed64)throw new Error("Unimplemented type: "+J);this.pos+=8}},writeTag:function(N,J){this.writeVarint(N<<3|J)},realloc:function(N){for(var J=this.length||16;J<this.pos+N;)J*=2;if(J!==this.length){var de=new Uint8Array(J);de.set(this.buf),this.buf=de,this.length=J}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(N){this.realloc(4),ye(this.buf,N,this.pos),this.pos+=4},writeSFixed32:function(N){this.realloc(4),ye(this.buf,N,this.pos),this.pos+=4},writeFixed64:function(N){this.realloc(8),ye(this.buf,-1&N,this.pos),ye(this.buf,Math.floor(N*s),this.pos+4),this.pos+=8},writeSFixed64:function(N){this.realloc(8),ye(this.buf,-1&N,this.pos),ye(this.buf,Math.floor(N*s),this.pos+4),this.pos+=8},writeVarint:function(N){(N=+N||0)>268435455||N<0?function(J,de){var Le,ot;if(J>=0?(Le=J%4294967296|0,ot=J/4294967296|0):(ot=~(-J/4294967296),4294967295^(Le=~(-J%4294967296))?Le=Le+1|0:(Le=0,ot=ot+1|0)),J>=18446744073709552e3||J<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");de.realloc(10),function(Ue,Xe,ut){ut.buf[ut.pos++]=127&Ue|128,Ue>>>=7,ut.buf[ut.pos++]=127&Ue|128,Ue>>>=7,ut.buf[ut.pos++]=127&Ue|128,Ue>>>=7,ut.buf[ut.pos++]=127&Ue|128,ut.buf[ut.pos]=127&(Ue>>>=7)}(Le,0,de),function(Ue,Xe){var ut=(7&Ue)<<4;Xe.buf[Xe.pos++]|=ut|((Ue>>>=3)?128:0),Ue&&(Xe.buf[Xe.pos++]=127&Ue|((Ue>>>=7)?128:0),Ue&&(Xe.buf[Xe.pos++]=127&Ue|((Ue>>>=7)?128:0),Ue&&(Xe.buf[Xe.pos++]=127&Ue|((Ue>>>=7)?128:0),Ue&&(Xe.buf[Xe.pos++]=127&Ue|((Ue>>>=7)?128:0),Ue&&(Xe.buf[Xe.pos++]=127&Ue)))))}(ot,de)}(N,this):(this.realloc(4),this.buf[this.pos++]=127&N|(N>127?128:0),N<=127||(this.buf[this.pos++]=127&(N>>>=7)|(N>127?128:0),N<=127||(this.buf[this.pos++]=127&(N>>>=7)|(N>127?128:0),N<=127||(this.buf[this.pos++]=N>>>7&127))))},writeSVarint:function(N){this.writeVarint(N<0?2*-N-1:2*N)},writeBoolean:function(N){this.writeVarint(!!N)},writeString:function(N){N=String(N),this.realloc(4*N.length),this.pos++;var J=this.pos;this.pos=function(Le,ot,Ue){for(var Xe,ut,at=0;at<ot.length;at++){if((Xe=ot.charCodeAt(at))>55295&&Xe<57344){if(!ut){Xe>56319||at+1===ot.length?(Le[Ue++]=239,Le[Ue++]=191,Le[Ue++]=189):ut=Xe;continue}if(Xe<56320){Le[Ue++]=239,Le[Ue++]=191,Le[Ue++]=189,ut=Xe;continue}Xe=ut-55296<<10|Xe-56320|65536,ut=null}else ut&&(Le[Ue++]=239,Le[Ue++]=191,Le[Ue++]=189,ut=null);Xe<128?Le[Ue++]=Xe:(Xe<2048?Le[Ue++]=Xe>>6|192:(Xe<65536?Le[Ue++]=Xe>>12|224:(Le[Ue++]=Xe>>18|240,Le[Ue++]=Xe>>12&63|128),Le[Ue++]=Xe>>6&63|128),Le[Ue++]=63&Xe|128)}return Ue}(this.buf,N,this.pos);var de=this.pos-J;de>=128&&v(J,de,this),this.pos=J-1,this.writeVarint(de),this.pos+=de},writeFloat:function(N){this.realloc(4),r.write(this.buf,N,this.pos,!0,23,4),this.pos+=4},writeDouble:function(N){this.realloc(8),r.write(this.buf,N,this.pos,!0,52,8),this.pos+=8},writeBytes:function(N){var J=N.length;this.writeVarint(J),this.realloc(J);for(var de=0;de<J;de++)this.buf[this.pos++]=N[de]},writeRawMessage:function(N,J){this.pos++;var de=this.pos;N(J,this);var Le=this.pos-de;Le>=128&&v(de,Le,this),this.pos=de-1,this.writeVarint(Le),this.pos+=Le},writeMessage:function(N,J,de){this.writeTag(N,t.Bytes),this.writeRawMessage(J,de)},writePackedVarint:function(N,J){J.length&&this.writeMessage(N,T,J)},writePackedSVarint:function(N,J){J.length&&this.writeMessage(N,M,J)},writePackedBoolean:function(N,J){J.length&&this.writeMessage(N,j,J)},writePackedFloat:function(N,J){J.length&&this.writeMessage(N,P,J)},writePackedDouble:function(N,J){J.length&&this.writeMessage(N,D,J)},writePackedFixed32:function(N,J){J.length&&this.writeMessage(N,U,J)},writePackedSFixed32:function(N,J){J.length&&this.writeMessage(N,G,J)},writePackedFixed64:function(N,J){J.length&&this.writeMessage(N,X,J)},writePackedSFixed64:function(N,J){J.length&&this.writeMessage(N,ee,J)},writeBytesField:function(N,J){this.writeTag(N,t.Bytes),this.writeBytes(J)},writeFixed32Field:function(N,J){this.writeTag(N,t.Fixed32),this.writeFixed32(J)},writeSFixed32Field:function(N,J){this.writeTag(N,t.Fixed32),this.writeSFixed32(J)},writeFixed64Field:function(N,J){this.writeTag(N,t.Fixed64),this.writeFixed64(J)},writeSFixed64Field:function(N,J){this.writeTag(N,t.Fixed64),this.writeSFixed64(J)},writeVarintField:function(N,J){this.writeTag(N,t.Varint),this.writeVarint(J)},writeSVarintField:function(N,J){this.writeTag(N,t.Varint),this.writeSVarint(J)},writeStringField:function(N,J){this.writeTag(N,t.Bytes),this.writeString(J)},writeFloatField:function(N,J){this.writeTag(N,t.Fixed32),this.writeFloat(J)},writeDoubleField:function(N,J){this.writeTag(N,t.Fixed64),this.writeDouble(J)},writeBooleanField:function(N,J){this.writeVarintField(N,!!J)}},Ea}var Bu=re(Md());const Ou=3;function jl(r,t,a){r===1&&a.readMessage(Lr,t)}function Lr(r,t,a){if(r===3){const{id:s,bitmap:d,width:g,height:_,left:v,top:T,advance:M}=a.readMessage(Fl,{});t.push({id:s,bitmap:new Sh({width:g+2*Ou,height:_+2*Ou},d),metrics:{width:g,height:_,left:v,top:T,advance:M}})}}function Fl(r,t,a){r===1?t.id=a.readVarint():r===2?t.bitmap=a.readBytes():r===3?t.width=a.readVarint():r===4?t.height=a.readVarint():r===5?t.left=a.readSVarint():r===6?t.top=a.readSVarint():r===7&&(t.advance=a.readVarint())}const ju=Ou;function Ic(r){let t=0,a=0;for(const _ of r)t+=_.w*_.h,a=Math.max(a,_.w);r.sort((_,v)=>v.h-_.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let d=0,g=0;for(const _ of r)for(let v=s.length-1;v>=0;v--){const T=s[v];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,g=Math.max(g,_.y+_.h),d=Math.max(d,_.x+_.w),_.w===T.w&&_.h===T.h){const M=s.pop();v<s.length&&(s[v]=M)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(s.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:d,h:g,fill:t/(d*g)||0}}const Br=1;class zh{constructor(t,{pixelRatio:a,version:s,stretchX:d,stretchY:g,content:_,textFitWidth:v,textFitHeight:T}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=d,this.stretchY=g,this.content=_,this.version=s,this.textFitWidth=v,this.textFitHeight=T}get tl(){return[this.paddedRect.x+Br,this.paddedRect.y+Br]}get br(){return[this.paddedRect.x+this.paddedRect.w-Br,this.paddedRect.y+this.paddedRect.h-Br]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Br)/this.pixelRatio,(this.paddedRect.h-2*Br)/this.pixelRatio]}}class Rf{constructor(t,a){const s={},d={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,s,g),this.addImages(a,d,g);const{w:_,h:v}=Ic(g),T=new ba({width:_||1,height:v||1});for(const M in t){const P=t[M],D=s[M].paddedRect;ba.copy(P.data,T,{x:0,y:0},{x:D.x+Br,y:D.y+Br},P.data)}for(const M in a){const P=a[M],D=d[M].paddedRect,j=D.x+Br,U=D.y+Br,G=P.data.width,X=P.data.height;ba.copy(P.data,T,{x:0,y:0},{x:j,y:U},P.data),ba.copy(P.data,T,{x:0,y:X-1},{x:j,y:U-1},{width:G,height:1}),ba.copy(P.data,T,{x:0,y:0},{x:j,y:U+X},{width:G,height:1}),ba.copy(P.data,T,{x:G-1,y:0},{x:j-1,y:U},{width:1,height:X}),ba.copy(P.data,T,{x:0,y:0},{x:j+G,y:U},{width:1,height:X})}this.image=T,this.iconPositions=s,this.patternPositions=d}addImages(t,a,s){for(const d in t){const g=t[d],_={x:0,y:0,w:g.data.width+2*Br,h:g.data.height+2*Br};s.push(_),a[d]=new zh(_,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in t.updatedImages)this.patchUpdatedImage(this.iconPositions[s],t.getImage(s),a),this.patchUpdatedImage(this.patternPositions[s],t.getImage(s),a)}patchUpdatedImage(t,a,s){if(!t||!a||t.version===a.version)return;t.version=a.version;const[d,g]=t.tl;s.update(a.data,void 0,{x:d,y:g})}}var mo;Tt("ImagePosition",zh),Tt("ImageAtlas",Rf),A.ah=void 0,(mo=A.ah||(A.ah={}))[mo.none=0]="none",mo[mo.horizontal=1]="horizontal",mo[mo.vertical=2]="vertical",mo[mo.horizontalOnly=3]="horizontalOnly";const Fu=-17;class Or{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,a,s){const d=new Or;return d.scale=t||1,d.fontStack=a,d.verticalAlign=s||"bottom",d}static forImage(t,a){const s=new Or;return s.imageName=t,s.verticalAlign=a||"bottom",s}}class Dc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const s=new Dc;for(let d=0;d<t.sections.length;d++){const g=t.sections[d];g.image?s.addImageSection(g):s.addTextSection(g,a)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let s=0;s<t.length;s++){const d=t.charCodeAt(s+1)||null,g=t.charCodeAt(s-1)||null;a+=d&&pc(d)&&!Vo[t[s+1]]||g&&pc(g)&&!Vo[t[s-1]]||!Vo[t[s]]?t[s]:Vo[t[s]]}return a}(this.text)}trim(){let t=0;for(let s=0;s<this.text.length&&Rh[this.text.charCodeAt(s)];s++)t++;let a=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&Rh[this.text.charCodeAt(s)];s--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const s=new Dc;return s.text=this.text.substring(t,a),s.sectionIndex=this.sectionIndex.slice(t,a),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}getMaxImageSize(t){let a=0,s=0;for(let d=0;d<this.length();d++){const g=this.getSection(d);if(g.imageName){const _=t[g.imageName];if(!_)continue;const v=_.displaySize;a=Math.max(a,v[0]),s=Math.max(s,v[1])}}return{maxImageWidth:a,maxImageHeight:s}}addTextSection(t,a){this.text+=t.text,this.sections.push(Or.forText(t.scale,t.fontStack||a,t.verticalAlign));const s=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(s)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void Vn("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Or.forImage(a,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Vn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Kr(r,t,a,s,d,g,_,v,T,M,P,D,j,U,G){const X=Dc.fromFeature(r,d);let ee;D===A.ah.vertical&&X.verticalizePunctuation();const{processBidirectionalText:oe,processStyledBidirectionalText:ye}=ro;if(oe&&X.sections.length===1){ee=[];const J=oe(X.toString(),Ad(X,M,g,t,s,U));for(const de of J){const Le=new Dc;Le.text=de,Le.sections=X.sections;for(let ot=0;ot<de.length;ot++)Le.sectionIndex.push(0);ee.push(Le)}}else if(ye){ee=[];const J=ye(X.text,X.sectionIndex,Ad(X,M,g,t,s,U));for(const de of J){const Le=new Dc;Le.text=de[0],Le.sectionIndex=de[1],Le.sections=X.sections,ee.push(Le)}}else ee=function(J,de){const Le=[],ot=J.text;let Ue=0;for(const Xe of de)Le.push(J.substring(Ue,Xe)),Ue=Xe;return Ue<ot.length&&Le.push(J.substring(Ue,ot.length)),Le}(X,Ad(X,M,g,t,s,U));const le=[],N={positionedLines:le,text:X.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(J,de,Le,ot,Ue,Xe,ut,at,ht,Je,Ct,Zt){let Ut=0,kt=0,ci=0,En=0;const Hn=at==="right"?1:at==="left"?0:.5,br=In/Zt;let Wr=0;for(const sn of Ue){sn.trim();const Jn=sn.getMaxScale(),er={positionedGlyphs:[],lineOffset:0};J.positionedLines[Wr]=er;const or=er.positionedGlyphs;let jr=0;if(!sn.length()){kt+=Xe,++Wr;continue}const da=Df(ot,sn,br);for(let tr=0;tr<sn.length();tr++){const ln=sn.getSection(tr),Nn=sn.getSectionIndex(tr),Un=sn.getCharCode(tr),nn=Tm(ht,Ct,Un);let cn;if(ln.imageName){if(J.iconsInText=!0,ln.scale=ln.scale*br,cn=Em(ln,nn,Jn,da,ot),!cn)continue;jr=Math.max(jr,cn.imageOffset)}else if(cn=Sm(ln,Un,nn,da,de,Le),!cn)continue;const{rect:go,metrics:ws,baselineOffset:Go}=cn;or.push({glyph:Un,imageName:ln.imageName,x:Ut,y:kt+Go+Fu,vertical:nn,scale:ln.scale,fontStack:ln.fontStack,sectionIndex:Nn,metrics:ws,rect:go}),nn?(J.verticalizable=!0,Ut+=(ln.imageName?ws.advance:In)*ln.scale+Je):Ut+=ws.advance*ln.scale+Je}or.length!==0&&(ci=Math.max(Ut-Je,ci),Dp(or,0,or.length-1,Hn)),Ut=0,er.lineOffset=Math.max(jr,(Jn-1)*In);const yn=Xe*Jn+jr;kt+=yn,En=Math.max(yn,En),++Wr}const{horizontalAlign:ha,verticalAlign:wr}=zd(ut);(function(sn,Jn,er,or,jr,da,yn,tr,ln){const Nn=(Jn-er)*jr;let Un=0;Un=da!==yn?-tr*or-Fu:-or*ln*yn+.5*yn;for(const nn of sn)for(const cn of nn.positionedGlyphs)cn.x+=Nn,cn.y+=Un})(J.positionedLines,Hn,ha,wr,ci,En,Xe,kt,Ue.length),J.top+=-wr*kt,J.bottom=J.top+kt,J.left+=-ha*ci,J.right=J.left+ci}(N,t,a,s,ee,_,v,T,D,M,j,G),!function(J){for(const de of J)if(de.positionedGlyphs.length!==0)return!1;return!0}(le)&&N}const Rh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ip={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},wm={40:!0};function nl(r,t,a,s,d,g){if(t.imageName){const _=s[t.imageName];return _?_.displaySize[0]*t.scale*In/g+d:0}{const _=a[t.fontStack],v=_&&_[r];return v?v.metrics.advance*t.scale+d:0}}function Ph(r,t,a,s){const d=Math.pow(r-t,2);return s?r<t?d/2:2*d:d+Math.abs(a)*a}function Pf(r,t,a){let s=0;return r===10&&(s-=1e4),a&&(s+=150),r!==40&&r!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function kc(r,t,a,s,d,g){let _=null,v=Ph(t,a,d,g);for(const T of s){const M=Ph(t-T.x,a,d,g)+T.badness;M<=v&&(_=T,v=M)}return{index:r,x:t,priorBreak:_,badness:v}}function If(r){return r?If(r.priorBreak).concat(r.index):[]}function Ad(r,t,a,s,d,g){if(!r)return[];const _=[],v=function(D,j,U,G,X,ee){let oe=0;for(let ye=0;ye<D.length();ye++){const le=D.getSection(ye);oe+=nl(D.getCharCode(ye),le,G,X,j,ee)}return oe/Math.max(1,Math.ceil(oe/U))}(r,t,a,s,d,g),T=r.text.indexOf("​")>=0;let M=0;for(let D=0;D<r.length();D++){const j=r.getSection(D),U=r.getCharCode(D);if(Rh[U]||(M+=nl(U,j,s,d,t,g)),D<r.length()-1){const G=!((P=U)<11904)&&(!!si["CJK Compatibility Forms"](P)||!!si["CJK Compatibility"](P)||!!si["CJK Strokes"](P)||!!si["CJK Symbols and Punctuation"](P)||!!si["Enclosed CJK Letters and Months"](P)||!!si["Halfwidth and Fullwidth Forms"](P)||!!si["Ideographic Description Characters"](P)||!!si["Vertical Forms"](P)||Eu.test(String.fromCodePoint(P)));(Ip[U]||G||j.imageName||D!==r.length()-2&&wm[r.getCharCode(D+1)])&&_.push(kc(D+1,M,v,_,Pf(U,r.getCharCode(D+1),G&&T),!1))}}var P;return If(kc(r.length(),M,v,_,0,!0))}function zd(r){let t=.5,a=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function Df(r,t,a){const s=t.getMaxScale()*In,{maxImageWidth:d,maxImageHeight:g}=t.getMaxImageSize(r),_=Math.max(s,g*a);return{verticalLineContentWidth:Math.max(s,d*a),horizontalLineContentHeight:_}}function Rd(r){switch(r){case"top":return 0;case"center":return .5;default:return 1}}function Tm(r,t,a){return!(r===A.ah.horizontal||!t&&!Ml(a)||t&&(Rh[a]||(s=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(s)))));var s}function Sm(r,t,a,s,d,g){const _=g[r.fontStack],v=function(M,P,D,j){if(M&&M.rect)return M;const U=P[D.fontStack],G=U&&U[j];return G?{rect:null,metrics:G.metrics}:null}(_&&_[t],d,r,t);if(v===null)return null;let T;if(a)T=s.verticalLineContentWidth-r.scale*In;else{const M=Rd(r.verticalAlign);T=(s.horizontalLineContentHeight-r.scale*In)*M}return{rect:v.rect,metrics:v.metrics,baselineOffset:T}}function Em(r,t,a,s,d){const g=d[r.imageName];if(!g)return null;const _=g.paddedRect,v=g.displaySize,T={width:v[0],height:v[1],left:Br,top:-3,advance:t?v[1]:v[0]};let M;if(t)M=s.verticalLineContentWidth-v[1]*r.scale;else{const P=Rd(r.verticalAlign);M=(s.horizontalLineContentHeight-v[1]*r.scale)*P}return{rect:_,metrics:T,baselineOffset:M,imageOffset:(t?v[0]:v[1])*r.scale-In*a}}function Dp(r,t,a,s){if(s===0)return;const d=r[a],g=(r[a].x+d.metrics.advance*d.scale)*s;for(let _=t;_<=a;_++)r[_].x-=g}function kp(r,t,a){const{horizontalAlign:s,verticalAlign:d}=zd(a),g=t[0]-r.displaySize[0]*s,_=t[1]-r.displaySize[1]*d;return{image:r,top:_,bottom:_+r.displaySize[1],left:g,right:g+r.displaySize[0]}}function Lc(r){var t,a;let s=r.left,d=r.top,g=r.right-s,_=r.bottom-d;const v=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",T=(a=r.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",M=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(T==="proportional"){if(v==="stretchOnly"&&g/_<M||v==="proportional"){const P=Math.ceil(_*M);s*=P/g,g=P}}else if(v==="proportional"&&T==="stretchOnly"&&M!==0&&g/_>M){const P=Math.ceil(g/M);d*=P/_,_=P}return{x1:s,y1:d,x2:s+g,y2:d+_}}function Ih(r,t,a,s,d,g){const _=r.image;let v;if(_.content){const ee=_.content,oe=_.pixelRatio||1;v=[ee[0]/oe,ee[1]/oe,_.displaySize[0]-ee[2]/oe,_.displaySize[1]-ee[3]/oe]}const T=t.left*g,M=t.right*g;let P,D,j,U;a==="width"||a==="both"?(U=d[0]+T-s[3],D=d[0]+M+s[1]):(U=d[0]+(T+M-_.displaySize[0])/2,D=U+_.displaySize[0]);const G=t.top*g,X=t.bottom*g;return a==="height"||a==="both"?(P=d[1]+G-s[0],j=d[1]+X+s[2]):(P=d[1]+(G+X-_.displaySize[1])/2,j=P+_.displaySize[1]),{image:_,top:P,right:D,bottom:j,left:U,collisionPadding:v}}const Nu=255,Zo=128,rl=Nu*Zo;function kf(r,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Qi(r+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:d}=a;let g=0;for(;g<s.length&&s[g]<=r;)g++;g=Math.max(0,g-1);let _=g;for(;_<s.length&&s[_]<r+1;)_++;_=Math.min(s.length-1,_);const v=s[g],T=s[_];return a.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:T,interpolationType:d}:{kind:"camera",minZoom:v,maxZoom:T,minSize:a.evaluate(new Qi(v)),maxSize:a.evaluate(new Qi(T)),interpolationType:d}}}function Pd(r,t,a){let s="never";const d=r.get(t);return d?s=d:r.get(a)&&(s="always"),s}const Lp=Pu.VectorTileFeature.types,Id=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Dh(r,t,a,s,d,g,_,v,T,M,P,D,j){const U=v?Math.min(rl,Math.round(v[0])):0,G=v?Math.min(rl,Math.round(v[1])):0;r.emplaceBack(t,a,Math.round(32*s),Math.round(32*d),g,_,(U<<1)+(T?1:0),G,16*M,16*P,256*D,256*j)}function Dd(r,t,a){r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a)}function _n(r){for(const t of r.sections)if(mc(t.text))return!0;return!1}class kh{constructor(t){this.layoutVertexArray=new We,this.indexArray=new it,this.programConfigurations=t,this.segments=new ni,this.dynamicLayoutVertexArray=new Qe,this.opacityVertexArray=new Ye,this.hasVisibleVertices=!1,this.placedSymbolArray=new k}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,s,d){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Lu.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Id,!0),this.opacityVertexBuffer.itemSize=1),(s||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Tt("SymbolBuffers",kh);class Lf{constructor(t,a,s){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new s,this.segments=new ni,this.collisionVertexArray=new ft}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Af.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Tt("CollisionBuffers",Lf);class Bc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=kf(this.zoom,a["text-size"]),this.iconSizeData=kf(this.zoom,a["icon-size"]);const s=this.layers[0].layout,d=s.get("symbol-sort-key"),g=s.get("symbol-z-order");this.canOverlap=Pd(s,"text-overlap","text-allow-overlap")!=="never"||Pd(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map(_=>A.ah[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new kh(new co(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new kh(new co(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new q,this.lineVertexArray=new Y,this.symbolInstances=new B,this.textAnchorOffsets=new te}calculateGlyphDependencies(t,a,s,d,g){for(let _=0;_<t.length;_++)if(a[t.charCodeAt(_)]=!0,(s||d)&&g){const v=Vo[t.charAt(_)];v&&(a[v.charCodeAt(0)]=!0)}}populate(t,a,s){const d=this.layers[0],g=d.layout,_=g.get("text-font"),v=g.get("text-field"),T=g.get("icon-image"),M=(v.value.kind!=="constant"||v.value.value instanceof Tr&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),P=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,D=g.get("symbol-sort-key");if(this.features=[],!M&&!P)return;const j=a.iconDependencies,U=a.glyphDependencies,G=a.availableImages,X=new Qi(this.zoom);for(const{feature:ee,id:oe,index:ye,sourceLayerIndex:le}of t){const N=d._featureFilter.needGeometry,J=Na(ee,N);if(!d._featureFilter.filter(X,J,s))continue;let de,Le;if(N||(J.geometry=xa(ee)),M){const Ue=d.getValueAndResolveTokens("text-field",J,s,G),Xe=Tr.factory(Ue),ut=this.hasRTLText=this.hasRTLText||_n(Xe);(!ut||ro.getRTLTextPluginStatus()==="unavailable"||ut&&ro.isParsed())&&(de=Ol(Xe,d,J))}if(P){const Ue=d.getValueAndResolveTokens("icon-image",J,s,G);Le=Ue instanceof Sr?Ue:Sr.fromString(Ue)}if(!de&&!Le)continue;const ot=this.sortFeaturesByKey?D.evaluate(J,{},s):void 0;if(this.features.push({id:oe,text:de,icon:Le,index:ye,sourceLayerIndex:le,geometry:J.geometry,properties:ee.properties,type:Lp[ee.type],sortKey:ot}),Le&&(j[Le.name]=!0),de){const Ue=_.evaluate(J,{},s).join(","),Xe=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(A.ah.vertical)>=0;for(const ut of de.sections)if(ut.image)j[ut.image.name]=!0;else{const at=no(de.toString()),ht=ut.fontStack||Ue,Je=U[ht]=U[ht]||{};this.calculateGlyphDependencies(ut.text,Je,Xe,this.allowVerticalPlacement,at)}}}g.get("symbol-placement")==="line"&&(this.features=function(ee){const oe={},ye={},le=[];let N=0;function J(Ue){le.push(ee[Ue]),N++}function de(Ue,Xe,ut){const at=ye[Ue];return delete ye[Ue],ye[Xe]=at,le[at].geometry[0].pop(),le[at].geometry[0]=le[at].geometry[0].concat(ut[0]),at}function Le(Ue,Xe,ut){const at=oe[Xe];return delete oe[Xe],oe[Ue]=at,le[at].geometry[0].shift(),le[at].geometry[0]=ut[0].concat(le[at].geometry[0]),at}function ot(Ue,Xe,ut){const at=ut?Xe[0][Xe[0].length-1]:Xe[0][0];return`${Ue}:${at.x}:${at.y}`}for(let Ue=0;Ue<ee.length;Ue++){const Xe=ee[Ue],ut=Xe.geometry,at=Xe.text?Xe.text.toString():null;if(!at){J(Ue);continue}const ht=ot(at,ut),Je=ot(at,ut,!0);if(ht in ye&&Je in oe&&ye[ht]!==oe[Je]){const Ct=Le(ht,Je,ut),Zt=de(ht,Je,le[Ct].geometry);delete oe[ht],delete ye[Je],ye[ot(at,le[Zt].geometry,!0)]=Zt,le[Ct].geometry=null}else ht in ye?de(ht,Je,ut):Je in oe?Le(ht,Je,ut):(J(Ue),oe[ht]=N-1,ye[Je]=N-1)}return le.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ee,oe)=>ee.sortKey-oe.sortKey)}update(t,a,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,s),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,s))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const s=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(a[t.segment+1]),g=t.dist(a[t.segment]);const _={};for(let v=t.segment+1;v<a.length;v++)_[v]={x:a[v].x,y:a[v].y,tileUnitDistanceFromAnchor:d},v<a.length-1&&(d+=a[v+1].dist(a[v]));for(let v=t.segment||0;v>=0;v--)_[v]={x:a[v].x,y:a[v].y,tileUnitDistanceFromAnchor:g},v>0&&(g+=a[v-1].dist(a[v]));for(let v=0;v<a.length;v++){const T=_[v];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,a,s,d,g,_,v,T,M,P,D,j){const U=t.indexArray,G=t.layoutVertexArray,X=t.segments.prepareSegment(4*a.length,G,U,this.canOverlap?_.sortKey:void 0),ee=this.glyphOffsetArray.length,oe=X.vertexLength,ye=this.allowVerticalPlacement&&v===A.ah.vertical?Math.PI/2:0,le=_.text&&_.text.sections;for(let N=0;N<a.length;N++){const{tl:J,tr:de,bl:Le,br:ot,tex:Ue,pixelOffsetTL:Xe,pixelOffsetBR:ut,minFontScaleX:at,minFontScaleY:ht,glyphOffset:Je,isSDF:Ct,sectionIndex:Zt}=a[N],Ut=X.vertexLength,kt=Je[1];Dh(G,T.x,T.y,J.x,kt+J.y,Ue.x,Ue.y,s,Ct,Xe.x,Xe.y,at,ht),Dh(G,T.x,T.y,de.x,kt+de.y,Ue.x+Ue.w,Ue.y,s,Ct,ut.x,Xe.y,at,ht),Dh(G,T.x,T.y,Le.x,kt+Le.y,Ue.x,Ue.y+Ue.h,s,Ct,Xe.x,ut.y,at,ht),Dh(G,T.x,T.y,ot.x,kt+ot.y,Ue.x+Ue.w,Ue.y+Ue.h,s,Ct,ut.x,ut.y,at,ht),Dd(t.dynamicLayoutVertexArray,T,ye),U.emplaceBack(Ut,Ut+2,Ut+1),U.emplaceBack(Ut+1,Ut+2,Ut+3),X.vertexLength+=4,X.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Je[0]),N!==a.length-1&&Zt===a[N+1].sectionIndex||t.programConfigurations.populatePaintArrays(G.length,_,_.index,{},j,le&&le[Zt])}t.placedSymbolArray.emplaceBack(T.x,T.y,ee,this.glyphOffsetArray.length-ee,oe,M,P,T.segment,s?s[0]:0,s?s[1]:0,d[0],d[1],v,0,!1,0,D)}_addCollisionDebugVertex(t,a,s,d,g,_){return a.emplaceBack(0,0),t.emplaceBack(s.x,s.y,d,g,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,a,s,d,g,_,v){const T=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),M=T.vertexLength,P=g.layoutVertexArray,D=g.collisionVertexArray,j=v.anchorX,U=v.anchorY;this._addCollisionDebugVertex(P,D,_,j,U,new he(t,a)),this._addCollisionDebugVertex(P,D,_,j,U,new he(s,a)),this._addCollisionDebugVertex(P,D,_,j,U,new he(s,d)),this._addCollisionDebugVertex(P,D,_,j,U,new he(t,d)),T.vertexLength+=4;const G=g.indexArray;G.emplaceBack(M,M+1),G.emplaceBack(M+1,M+2),G.emplaceBack(M+2,M+3),G.emplaceBack(M+3,M),T.primitiveLength+=4}addDebugCollisionBoxes(t,a,s,d){for(let g=t;g<a;g++){const _=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,d?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Lf(gt,xs.members,Pt),this.iconCollisionBox=new Lf(gt,xs.members,Pt);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,s,d,g,_,v,T,M){const P={};for(let D=a;D<s;D++){const j=t.get(D);P.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},P.textFeatureIndex=j.featureIndex;break}for(let D=d;D<g;D++){const j=t.get(D);P.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},P.verticalTextFeatureIndex=j.featureIndex;break}for(let D=_;D<v;D++){const j=t.get(D);P.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},P.iconFeatureIndex=j.featureIndex;break}for(let D=T;D<M;D++){const j=t.get(D);P.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},P.verticalIconFeatureIndex=j.featureIndex;break}return P}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const s=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const s=t.placedSymbolArray.get(a),d=s.vertexStartIndex+4*s.numGlyphs;for(let g=s.vertexStartIndex;g<d;g+=4)t.indexArray.emplaceBack(g,g+2,g+1),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),s=Math.cos(t),d=[],g=[],_=[];for(let v=0;v<this.symbolInstances.length;++v){_.push(v);const T=this.symbolInstances.get(v);d.push(0|Math.round(a*T.anchorX+s*T.anchorY)),g.push(T.featureIndex)}return _.sort((v,T)=>d[v]-d[T]||g[T]-g[v]),_}addToSortKeyRanges(t,a){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===a?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const s=this.symbolInstances.get(a);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((d,g,_)=>{d>=0&&_.indexOf(d)===g&&this.addIndicesForPlacedSymbol(this.text,d)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Bp,Op;Tt("SymbolBucket",Bc,{omit:["layers","collisionBoxArray","features","compareText"]}),Bc.MAX_GLYPHS=65535,Bc.addDynamicAttributes=Dd;var Bf={get paint(){return Op=Op||new _r({"icon-opacity":new Nt(Z.paint_symbol["icon-opacity"]),"icon-color":new Nt(Z.paint_symbol["icon-color"]),"icon-halo-color":new Nt(Z.paint_symbol["icon-halo-color"]),"icon-halo-width":new Nt(Z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Nt(Z.paint_symbol["icon-halo-blur"]),"icon-translate":new Dt(Z.paint_symbol["icon-translate"]),"icon-translate-anchor":new Dt(Z.paint_symbol["icon-translate-anchor"]),"text-opacity":new Nt(Z.paint_symbol["text-opacity"]),"text-color":new Nt(Z.paint_symbol["text-color"],{runtimeType:Xt,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Nt(Z.paint_symbol["text-halo-color"]),"text-halo-width":new Nt(Z.paint_symbol["text-halo-width"]),"text-halo-blur":new Nt(Z.paint_symbol["text-halo-blur"]),"text-translate":new Dt(Z.paint_symbol["text-translate"]),"text-translate-anchor":new Dt(Z.paint_symbol["text-translate-anchor"])})},get layout(){return Bp=Bp||new _r({"symbol-placement":new Dt(Z.layout_symbol["symbol-placement"]),"symbol-spacing":new Dt(Z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Dt(Z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Nt(Z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Dt(Z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Dt(Z.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Dt(Z.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Dt(Z.layout_symbol["icon-ignore-placement"]),"icon-optional":new Dt(Z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Dt(Z.layout_symbol["icon-rotation-alignment"]),"icon-size":new Nt(Z.layout_symbol["icon-size"]),"icon-text-fit":new Dt(Z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Dt(Z.layout_symbol["icon-text-fit-padding"]),"icon-image":new Nt(Z.layout_symbol["icon-image"]),"icon-rotate":new Nt(Z.layout_symbol["icon-rotate"]),"icon-padding":new Nt(Z.layout_symbol["icon-padding"]),"icon-keep-upright":new Dt(Z.layout_symbol["icon-keep-upright"]),"icon-offset":new Nt(Z.layout_symbol["icon-offset"]),"icon-anchor":new Nt(Z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Dt(Z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Dt(Z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Dt(Z.layout_symbol["text-rotation-alignment"]),"text-field":new Nt(Z.layout_symbol["text-field"]),"text-font":new Nt(Z.layout_symbol["text-font"]),"text-size":new Nt(Z.layout_symbol["text-size"]),"text-max-width":new Nt(Z.layout_symbol["text-max-width"]),"text-line-height":new Dt(Z.layout_symbol["text-line-height"]),"text-letter-spacing":new Nt(Z.layout_symbol["text-letter-spacing"]),"text-justify":new Nt(Z.layout_symbol["text-justify"]),"text-radial-offset":new Nt(Z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Dt(Z.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Nt(Z.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Nt(Z.layout_symbol["text-anchor"]),"text-max-angle":new Dt(Z.layout_symbol["text-max-angle"]),"text-writing-mode":new Dt(Z.layout_symbol["text-writing-mode"]),"text-rotate":new Nt(Z.layout_symbol["text-rotate"]),"text-padding":new Dt(Z.layout_symbol["text-padding"]),"text-keep-upright":new Dt(Z.layout_symbol["text-keep-upright"]),"text-transform":new Nt(Z.layout_symbol["text-transform"]),"text-offset":new Nt(Z.layout_symbol["text-offset"]),"text-allow-overlap":new Dt(Z.layout_symbol["text-allow-overlap"]),"text-overlap":new Dt(Z.layout_symbol["text-overlap"]),"text-ignore-placement":new Dt(Z.layout_symbol["text-ignore-placement"]),"text-optional":new Dt(Z.layout_symbol["text-optional"])})}};class Lh{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:pi,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Tt("FormatSectionOverride",Lh,{omit:["defaultValue"]});class al extends yr{constructor(t){super(t,Bf)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const d=[];for(const g of s)d.indexOf(g)<0&&d.push(g);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,s,d){const g=this.layout.get(t).evaluate(a,{},s,d),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||ts(_.value)||!g?g:function(v,T){return T.replace(/{([^{}]+)}/g,(M,P)=>v&&P in v?String(v[P]):"")}(a.properties,g)}createBucket(t){return new Bc(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Bf.paint.overridableProperties){if(!al.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),s=new Lh(a),d=new js(s,a.property.specification);let g=null;g=a.value.kind==="constant"||a.value.kind==="source"?new lh("source",d):new Ir("composite",d,a.value.zoomStops),this.paint._values[t]=new _a(a.property,g,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,s){return!(!this.layout||a.isDataDriven()||s.isDataDriven())&&al.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const s=t.get("text-field"),d=Bf.paint.properties[a];let g=!1;const _=v=>{for(const T of v)if(d.overrides&&d.overrides.hasOverride(T))return void(g=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Tr)_(s.value.value.sections);else if(s.value.kind==="source"){const v=M=>{g||(M instanceof So&&rn(M.value)===Pi?_(M.value.sections):M instanceof gl?_(M.sections):M.eachChild(v))},T=s.value;T._styleExpression&&v(T._styleExpression.expression)}return g}}let kd;var Ld={get paint(){return kd=kd||new _r({"background-color":new Dt(Z.paint_background["background-color"]),"background-pattern":new Cu(Z.paint_background["background-pattern"]),"background-opacity":new Dt(Z.paint_background["background-opacity"])})}};class Of extends yr{constructor(t){super(t,Ld)}}let Nl;var bs={get paint(){return Nl=Nl||new _r({"raster-opacity":new Dt(Z.paint_raster["raster-opacity"]),"raster-hue-rotate":new Dt(Z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Dt(Z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Dt(Z.paint_raster["raster-brightness-max"]),"raster-saturation":new Dt(Z.paint_raster["raster-saturation"]),"raster-contrast":new Dt(Z.paint_raster["raster-contrast"]),"raster-resampling":new Dt(Z.paint_raster["raster-resampling"]),"raster-fade-duration":new Dt(Z.paint_raster["raster-fade-duration"])})}};class Bh extends yr{constructor(t){super(t,bs)}}class Cm extends yr{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class jp{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Fp={once:!0},Bd=63710088e-1;class ol{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ol(Ot(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,s=this.lat*a,d=t.lat*a,g=Math.sin(s)*Math.sin(d)+Math.cos(s)*Math.cos(d)*Math.cos((t.lng-this.lng)*a);return Bd*Math.acos(Math.min(g,1))}static convert(t){if(t instanceof ol)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new ol(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new ol(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Np=2*Math.PI*Bd;function Od(r){return Np*Math.cos(r*Math.PI/180)}function jf(r){return(180+r)/360}function Ff(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Up(r,t){return r/Od(t)}function Oh(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function jd(r,t){return r*Od(Oh(t))}class jh{constructor(t,a,s=0){this.x=+t,this.y=+a,this.z=+s}static fromLngLat(t,a=0){const s=ol.convert(t);return new jh(jf(s.lng),Ff(s.lat),Up(a,s.lat))}toLngLat(){return new ol(360*this.x-180,Oh(this.y))}toAltitude(){return jd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Np*(t=Oh(this.y),1/Math.cos(t*Math.PI/180));var t}}function Vp(r,t,a){var s=2*Math.PI*6378137/256/Math.pow(2,a);return[r*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}class Oc{constructor(t,a,s){if(!function(d,g,_){return!(d<0||d>25||_<0||_>=Math.pow(2,d)||g<0||g>=Math.pow(2,d))}(t,a,s))throw new Error(`x=${a}, y=${s}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=s,this.key=li(0,t,t,a,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,s){const d=(_=this.y,v=this.z,T=Vp(256*(g=this.x),256*(_=Math.pow(2,v)-_-1),v),M=Vp(256*(g+1),256*(_+1),v),T[0]+","+T[1]+","+M[0]+","+M[1]);var g,_,v,T,M;const P=function(D,j,U){let G,X="";for(let ee=D;ee>0;ee--)G=1<<ee-1,X+=(j&G?1:0)+(U&G?2:0);return X}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new he((t.x*a-this.x)*Ve,(t.y*a-this.y)*Ve)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Zp{constructor(t,a){this.wrap=t,this.canonical=a,this.key=li(t,a.z,a.z,a.x,a.y)}}class Ca{constructor(t,a,s,d,g){if(this.terrainRttPosMatrix32f=null,t<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${s}`);this.overscaledZ=t,this.wrap=a,this.canonical=new Oc(s,+d,+g),this.key=li(a,t,s,d,g)}clone(){return new Ca(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new Ca(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ca(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?li(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):li(this.wrap*+a,t,t,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new Ca(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,s=2*this.canonical.x,d=2*this.canonical.y;return[new Ca(a,this.wrap,a,s,d),new Ca(a,this.wrap,a,s+1,d),new Ca(a,this.wrap,a,s,d+1),new Ca(a,this.wrap,a,s+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ca(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ca(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Zp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new jh(t.x-this.wrap,t.y))}}function li(r,t,a,s,d){(r*=2)<0&&(r=-1*r-1);const g=1<<a;return(g*g*r+g*d+s).toString(36)+a.toString(36)+t.toString(36)}Tt("CanonicalTileID",Oc),Tt("OverscaledTileID",Ca,{omit:["terrainRttPosMatrix32f"]});class Fd{constructor(t,a,s,d=1,g=1,_=1,v=0){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(s&&!["mapbox","terrarium","custom"].includes(s))return void Vn(`"${s}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const T=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),s){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=g,this.blueFactor=_,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<T;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(T,M)]=this.data[this._idx(T-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,T)]=this.data[this._idx(M,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<T;M++)for(let P=0;P<T;P++){const D=this.get(M,P);D>this.max&&(this.max=D),D<this.min&&(this.min=D)}}get(t,a){const s=new Uint8Array(this.data.buffer),d=4*this._idx(t,a);return this.unpack(s[d],s[d+1],s[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}unpack(t,a,s){return t*this.redFactor+a*this.greenFactor+s*this.blueFactor-this.baseShift}getPixels(){return new ba({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=a*this.dim,g=a*this.dim+this.dim,_=s*this.dim,v=s*this.dim+this.dim;switch(a){case-1:d=g-1;break;case 1:g=d+1}switch(s){case-1:_=v-1;break;case 1:v=_+1}const T=-a*this.dim,M=-s*this.dim;for(let P=_;P<v;P++)for(let D=d;D<g;D++)this.data[this._idx(D,P)]=t.data[this._idx(D+T,P+M)]}}Tt("DEMData",Fd);class Fh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const s=t[a];this._stringToNumber[s]=a,this._numberToString[a]=s}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Nd{constructor(t,a,s,d,g){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=s,t._y=d,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class Nf{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Zs(Ve,16,0),this.grid3D=new Zs(Ve,16,0),this.featureIndexArray=new se,this.promoteId=a}insert(t,a,s,d,g,_){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,d,g);const T=_?this.grid3D:this.grid;for(let M=0;M<a.length;M++){const P=a[M],D=[1/0,1/0,-1/0,-1/0];for(let j=0;j<P.length;j++){const U=P[j];D[0]=Math.min(D[0],U.x),D[1]=Math.min(D[1],U.y),D[2]=Math.max(D[2],U.x),D[3]=Math.max(D[3],U.y)}D[0]<Ve&&D[1]<Ve&&D[2]>=0&&D[3]>=0&&T.insert(v,D[0],D[1],D[2],D[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Pu.VectorTile(new Bu(this.rawTileData)).layers,this.sourceLayerCoder=new Fh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,s,d){this.loadVTLayers();const g=t.params,_=Ve/t.tileSize/t.scale,v=uc(g.filter),T=t.queryGeometry,M=t.queryPadding*_,P=Uu(T),D=this.grid.query(P.minX-M,P.minY-M,P.maxX+M,P.maxY+M),j=Uu(t.cameraQueryGeometry),U=this.grid3D.query(j.minX-M,j.minY-M,j.maxX+M,j.maxY+M,(ee,oe,ye,le)=>function(N,J,de,Le,ot){for(const Xe of N)if(J<=Xe.x&&de<=Xe.y&&Le>=Xe.x&&ot>=Xe.y)return!0;const Ue=[new he(J,de),new he(J,ot),new he(Le,ot),new he(Le,de)];if(N.length>2){for(const Xe of Ue)if(Pn(N,Xe))return!0}for(let Xe=0;Xe<N.length-1;Xe++)if(fd(N[Xe],N[Xe+1],Ue))return!0;return!1}(t.cameraQueryGeometry,ee-M,oe-M,ye+M,le+M));for(const ee of U)D.push(ee);D.sort(Vd);const G={};let X;for(let ee=0;ee<D.length;ee++){const oe=D[ee];if(oe===X)continue;X=oe;const ye=this.featureIndexArray.get(oe);let le=null;this.loadMatchingFeature(G,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,v,g.layers,g.availableImages,a,s,d,(N,J,de)=>(le||(le=xa(N)),J.queryIntersectsFeature({queryGeometry:T,feature:N,featureState:de,geometry:le,zoom:this.z,transform:t.transform,pixelsToTileUnits:_,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return G}loadMatchingFeature(t,a,s,d,g,_,v,T,M,P,D){const j=this.bucketLayerIDs[a];if(_&&!j.some(ee=>_.has(ee)))return;const U=this.sourceLayerCoder.decode(s),G=this.vtLayers[U].feature(d);if(g.needGeometry){const ee=Na(G,!0);if(!g.filter(new Qi(this.tileID.overscaledZ),ee,this.tileID.canonical))return}else if(!g.filter(new Qi(this.tileID.overscaledZ),G))return;const X=this.getId(G,U);for(let ee=0;ee<j.length;ee++){const oe=j[ee];if(_&&!_.has(oe))continue;const ye=T[oe];if(!ye)continue;let le={};X&&P&&(le=P.getState(ye.sourceLayer||"_geojsonTileLayer",X));const N=$t({},M[oe]);N.paint=Ud(N.paint,ye.paint,G,le,v),N.layout=Ud(N.layout,ye.layout,G,le,v);const J=!D||D(G,ye,le);if(!J)continue;const de=new Nd(G,this.z,this.x,this.y,X);de.layer=N;let Le=t[oe];Le===void 0&&(Le=t[oe]=[]),Le.push({featureIndex:d,feature:de,intersectionZ:J})}}lookupSymbolFeatures(t,a,s,d,g,_,v,T){const M={};this.loadVTLayers();const P=uc(g);for(const D of t)this.loadMatchingFeature(M,s,d,D,P,_,v,T,a);return M}hasLayer(t){for(const a of this.bucketLayerIDs)for(const s of a)if(t===s)return!0;return!1}getId(t,a){var s;let d=t.id;return this.promoteId&&(d=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof d=="boolean"&&(d=Number(d)),d===void 0&&(!((s=t.properties)===null||s===void 0)&&s.cluster)&&this.promoteId&&(d=Number(t.properties.cluster_id))),d}}function Ud(r,t,a,s,d){return kn(r,(g,_)=>{const v=t instanceof $s?t.get(_):null;return v&&v.evaluate?v.evaluate(a,s,d):v})}function Uu(r){let t=1/0,a=1/0,s=-1/0,d=-1/0;for(const g of r)t=Math.min(t,g.x),a=Math.min(a,g.y),s=Math.max(s,g.x),d=Math.max(d,g.y);return{minX:t,minY:a,maxX:s,maxY:d}}function Vd(r,t){return t-r}function jc(r,t,a,s,d){const g=[];for(let _=0;_<r.length;_++){const v=r[_];let T;for(let M=0;M<v.length-1;M++){let P=v[M],D=v[M+1];P.x<t&&D.x<t||(P.x<t?P=new he(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x<t&&(D=new he(t,P.y+(t-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y<a&&D.y<a||(P.y<a?P=new he(P.x+(a-P.y)/(D.y-P.y)*(D.x-P.x),a)._round():D.y<a&&(D=new he(P.x+(a-P.y)/(D.y-P.y)*(D.x-P.x),a)._round()),P.x>=s&&D.x>=s||(P.x>=s?P=new he(s,P.y+(s-P.x)/(D.x-P.x)*(D.y-P.y))._round():D.x>=s&&(D=new he(s,P.y+(s-P.x)/(D.x-P.x)*(D.y-P.y))._round()),P.y>=d&&D.y>=d||(P.y>=d?P=new he(P.x+(d-P.y)/(D.y-P.y)*(D.x-P.x),d)._round():D.y>=d&&(D=new he(P.x+(d-P.y)/(D.y-P.y)*(D.x-P.x),d)._round()),T&&P.equals(T[T.length-1])||(T=[P],g.push(T)),T.push(D)))))}}return g}Tt("FeatureIndex",Nf,{omit:["rawTileData","sourceLayerCoder"]});class sl extends he{constructor(t,a,s,d){super(t,a),this.angle=s,d!==void 0&&(this.segment=d)}clone(){return new sl(this.x,this.y,this.angle,this.segment)}}function Gp(r,t,a,s,d){if(t.segment===void 0||a===0)return!0;let g=t,_=t.segment+1,v=0;for(;v>-a/2;){if(_--,_<0)return!1;v-=r[_].dist(g),g=r[_]}v+=r[_].dist(r[_+1]),_++;const T=[];let M=0;for(;v<a/2;){const P=r[_],D=r[_+1];if(!D)return!1;let j=r[_-1].angleTo(P)-P.angleTo(D);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:v,angleDelta:j}),M+=j;v-T[0].distance>s;)M-=T.shift().angleDelta;if(M>d)return!1;_++,v+=P.dist(D)}return!0}function qp(r){let t=0;for(let a=0;a<r.length-1;a++)t+=r[a].dist(r[a+1]);return t}function Uf(r,t,a){return r?.6*t*a:0}function Vf(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function Zd(r,t,a,s,d,g){const _=Uf(a,d,g),v=Vf(a,s)*g;let T=0;const M=qp(r)/2;for(let P=0;P<r.length-1;P++){const D=r[P],j=r[P+1],U=D.dist(j);if(T+U>M){const G=(M-T)/U,X=ra.number(D.x,j.x,G),ee=ra.number(D.y,j.y,G),oe=new sl(X,ee,j.angleTo(D),P);return oe._round(),!_||Gp(r,oe,v,_,t)?oe:void 0}T+=U}}function on(r,t,a,s,d,g,_,v,T){const M=Uf(s,g,_),P=Vf(s,d),D=P*_,j=r[0].x===0||r[0].x===T||r[0].y===0||r[0].y===T;return t-D<t/4&&(t=D+t/4),Gd(r,j?t/2*v%t:(P/2+2*g)*_*v%t,t,M,a,D,j,!1,T)}function Gd(r,t,a,s,d,g,_,v,T){const M=g/2,P=qp(r);let D=0,j=t-a,U=[];for(let G=0;G<r.length-1;G++){const X=r[G],ee=r[G+1],oe=X.dist(ee),ye=ee.angleTo(X);for(;j+a<D+oe;){j+=a;const le=(j-D)/oe,N=ra.number(X.x,ee.x,le),J=ra.number(X.y,ee.y,le);if(N>=0&&N<T&&J>=0&&J<T&&j-M>=0&&j+M<=P){const de=new sl(N,J,ye,G);de._round(),s&&!Gp(r,de,g,s,d)||U.push(de)}}D+=oe}return v||U.length||_||(U=Gd(r,D/2,a,s,d,g,_,!0,T)),U}Tt("Anchor",sl);const ar=Br;function Hp(r,t,a,s){const d=[],g=r.image,_=g.pixelRatio,v=g.paddedRect.w-2*ar,T=g.paddedRect.h-2*ar;let M={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const P=g.stretchX||[[0,v]],D=g.stretchY||[[0,T]],j=(Je,Ct)=>Je+Ct[1]-Ct[0],U=P.reduce(j,0),G=D.reduce(j,0),X=v-U,ee=T-G;let oe=0,ye=U,le=0,N=G,J=0,de=X,Le=0,ot=ee;if(g.content&&s){const Je=g.content,Ct=Je[2]-Je[0],Zt=Je[3]-Je[1];(g.textFitWidth||g.textFitHeight)&&(M=Lc(r)),oe=Vu(P,0,Je[0]),le=Vu(D,0,Je[1]),ye=Vu(P,Je[0],Je[2]),N=Vu(D,Je[1],Je[3]),J=Je[0]-oe,Le=Je[1]-le,de=Ct-ye,ot=Zt-N}const Ue=M.x1,Xe=M.y1,ut=M.x2-Ue,at=M.y2-Xe,ht=(Je,Ct,Zt,Ut)=>{const kt=Fc(Je.stretch-oe,ye,ut,Ue),ci=Nh(Je.fixed-J,de,Je.stretch,U),En=Fc(Ct.stretch-le,N,at,Xe),Hn=Nh(Ct.fixed-Le,ot,Ct.stretch,G),br=Fc(Zt.stretch-oe,ye,ut,Ue),Wr=Nh(Zt.fixed-J,de,Zt.stretch,U),ha=Fc(Ut.stretch-le,N,at,Xe),wr=Nh(Ut.fixed-Le,ot,Ut.stretch,G),sn=new he(kt,En),Jn=new he(br,En),er=new he(br,ha),or=new he(kt,ha),jr=new he(ci/_,Hn/_),da=new he(Wr/_,wr/_),yn=t*Math.PI/180;if(yn){const Nn=Math.sin(yn),Un=Math.cos(yn),nn=[Un,-Nn,Nn,Un];sn._matMult(nn),Jn._matMult(nn),or._matMult(nn),er._matMult(nn)}const tr=Je.stretch+Je.fixed,ln=Ct.stretch+Ct.fixed;return{tl:sn,tr:Jn,bl:or,br:er,tex:{x:g.paddedRect.x+ar+tr,y:g.paddedRect.y+ar+ln,w:Zt.stretch+Zt.fixed-tr,h:Ut.stretch+Ut.fixed-ln},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:jr,pixelOffsetBR:da,minFontScaleX:de/_/ut,minFontScaleY:ot/_/at,isSDF:a}};if(s&&(g.stretchX||g.stretchY)){const Je=qd(P,X,U),Ct=qd(D,ee,G);for(let Zt=0;Zt<Je.length-1;Zt++){const Ut=Je[Zt],kt=Je[Zt+1];for(let ci=0;ci<Ct.length-1;ci++)d.push(ht(Ut,Ct[ci],kt,Ct[ci+1]))}}else d.push(ht({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:T+1}));return d}function Vu(r,t,a){let s=0;for(const d of r)s+=Math.max(t,Math.min(a,d[1]))-Math.max(t,Math.min(a,d[0]));return s}function qd(r,t,a){const s=[{fixed:-1,stretch:0}];for(const[d,g]of r){const _=s[s.length-1];s.push({fixed:d-_.stretch,stretch:_.stretch}),s.push({fixed:d-_.stretch,stretch:_.stretch+(g-d)})}return s.push({fixed:t+ar,stretch:a}),s}function Fc(r,t,a,s){return r/t*a+s}function Nh(r,t,a,s){return r-t*a/s}class Uh{constructor(t,a,s,d,g,_,v,T,M,P){var D;if(this.boxStartIndex=t.length,M){let j=_.top,U=_.bottom;const G=_.collisionPadding;G&&(j-=G[1],U+=G[3]);let X=U-j;X>0&&(X=Math.max(10,X),this.circleDiameter=X)}else{const j=!((D=_.image)===null||D===void 0)&&D.content&&(_.image.textFitWidth||_.image.textFitHeight)?Lc(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};j.y1=j.y1*v-T[0],j.y2=j.y2*v+T[2],j.x1=j.x1*v-T[3],j.x2=j.x2*v+T[1];const U=_.collisionPadding;if(U&&(j.x1-=U[0]*v,j.y1-=U[1]*v,j.x2+=U[2]*v,j.y2+=U[3]*v),P){const G=new he(j.x1,j.y1),X=new he(j.x2,j.y1),ee=new he(j.x1,j.y2),oe=new he(j.x2,j.y2),ye=P*Math.PI/180;G._rotate(ye),X._rotate(ye),ee._rotate(ye),oe._rotate(ye),j.x1=Math.min(G.x,X.x,ee.x,oe.x),j.x2=Math.max(G.x,X.x,ee.x,oe.x),j.y1=Math.min(G.y,X.y,ee.y,oe.y),j.y2=Math.max(G.y,X.y,ee.y,oe.y)}t.emplaceBack(a.x,a.y,j.x1,j.y1,j.x2,j.y2,s,d,g)}this.boxEndIndex=t.length}}class Zf{constructor(t=[],a=(s,d)=>s<d?-1:s>d?1:0){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:s}=this,d=a[t];for(;t>0;){const g=t-1>>1,_=a[g];if(s(d,_)>=0)break;a[t]=_,t=g}a[t]=d}_down(t){const{data:a,compare:s}=this,d=this.length>>1,g=a[t];for(;t<d;){let _=1+(t<<1);const v=_+1;if(v<this.length&&s(a[v],a[_])<0&&(_=v),s(a[_],g)>=0)break;a[t]=a[_],t=_}a[t]=g}}function Gf(r,t=1,a=!1){let s=1/0,d=1/0,g=-1/0,_=-1/0;const v=r[0];for(let U=0;U<v.length;U++){const G=v[U];(!U||G.x<s)&&(s=G.x),(!U||G.y<d)&&(d=G.y),(!U||G.x>g)&&(g=G.x),(!U||G.y>_)&&(_=G.y)}const T=Math.min(g-s,_-d);let M=T/2;const P=new Zf([],Mm);if(T===0)return new he(s,d);for(let U=s;U<g;U+=T)for(let G=d;G<_;G+=T)P.push(new Nc(U+M,G+M,M,r));let D=function(U){let G=0,X=0,ee=0;const oe=U[0];for(let ye=0,le=oe.length,N=le-1;ye<le;N=ye++){const J=oe[ye],de=oe[N],Le=J.x*de.y-de.x*J.y;X+=(J.x+de.x)*Le,ee+=(J.y+de.y)*Le,G+=3*Le}return new Nc(X/G,ee/G,0,U)}(r),j=P.length;for(;P.length;){const U=P.pop();(U.d>D.d||!D.d)&&(D=U,a&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,j)),U.max-D.d<=t||(M=U.h/2,P.push(new Nc(U.p.x-M,U.p.y-M,M,r)),P.push(new Nc(U.p.x+M,U.p.y-M,M,r)),P.push(new Nc(U.p.x-M,U.p.y+M,M,r)),P.push(new Nc(U.p.x+M,U.p.y+M,M,r)),j+=4)}return a&&(console.log(`num probes: ${j}`),console.log(`best distance: ${D.d}`)),D.p}function Mm(r,t){return t.max-r.max}function Nc(r,t,a,s){this.p=new he(r,t),this.h=a,this.d=function(d,g){let _=!1,v=1/0;for(let T=0;T<g.length;T++){const M=g[T];for(let P=0,D=M.length,j=D-1;P<D;j=P++){const U=M[P],G=M[j];U.y>d.y!=G.y>d.y&&d.x<(G.x-U.x)*(d.y-U.y)/(G.y-U.y)+U.x&&(_=!_),v=Math.min(v,Qs(d,U,G))}}return(_?1:-1)*Math.sqrt(v)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}var zr;A.ay=void 0,(zr=A.ay||(A.ay={}))[zr.center=1]="center",zr[zr.left=2]="left",zr[zr.right=3]="right",zr[zr.top=4]="top",zr[zr.bottom=5]="bottom",zr[zr["top-left"]=6]="top-left",zr[zr["top-right"]=7]="top-right",zr[zr["bottom-left"]=8]="bottom-left",zr[zr["bottom-right"]=9]="bottom-right";const ll=7,qf=Number.POSITIVE_INFINITY;function $p(r,t){return t[1]!==qf?function(a,s,d){let g=0,_=0;switch(s=Math.abs(s),d=Math.abs(d),a){case"top-right":case"top-left":case"top":_=d-ll;break;case"bottom-right":case"bottom-left":case"bottom":_=-d+ll}switch(a){case"top-right":case"bottom-right":case"right":g=-s;break;case"top-left":case"bottom-left":case"left":g=s}return[g,_]}(r,t[0],t[1]):function(a,s){let d=0,g=0;s<0&&(s=0);const _=s/Math.SQRT2;switch(a){case"top-right":case"top-left":g=_-ll;break;case"bottom-right":case"bottom-left":g=-_+ll;break;case"bottom":g=-s+ll;break;case"top":g=s-ll}switch(a){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=s;break;case"right":d=-s}return[d,g]}(r,t[0])}function cl(r,t,a){var s;const d=r.layout,g=(s=d.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(t,{},a);if(g){const v=g.values,T=[];for(let M=0;M<v.length;M+=2){const P=T[M]=v[M],D=v[M+1].map(j=>j*In);P.startsWith("top")?D[1]-=ll:P.startsWith("bottom")&&(D[1]+=ll),T[M+1]=D}return new cr(T)}const _=d.get("text-variable-anchor");if(_){let v;v=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},a)*In,qf]:d.get("text-offset").evaluate(t,{},a).map(M=>M*In);const T=[];for(const M of _)T.push(M,$p(M,v));return new cr(T)}return null}function Hd(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Hf(r,t,a,s,d,g,_,v,T,M,P,D){let j=g.textMaxSize.evaluate(t,{});j===void 0&&(j=_);const U=r.layers[0].layout,G=U.get("icon-offset").evaluate(t,{},P),X=Yp(a.horizontal),ee=_/24,oe=r.tilePixelRatio*ee,ye=r.tilePixelRatio*j/24,le=r.tilePixelRatio*v,N=r.tilePixelRatio*U.get("symbol-spacing"),J=U.get("text-padding")*r.tilePixelRatio,de=function(Zt,Ut,kt,ci=1){const En=Zt.get("icon-padding").evaluate(Ut,{},kt),Hn=En&&En.values;return[Hn[0]*ci,Hn[1]*ci,Hn[2]*ci,Hn[3]*ci]}(U,t,P,r.tilePixelRatio),Le=U.get("text-max-angle")/180*Math.PI,ot=U.get("text-rotation-alignment")!=="viewport"&&U.get("symbol-placement")!=="point",Ue=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Xe=U.get("symbol-placement"),ut=N/2,at=U.get("icon-text-fit");let ht;s&&at!=="none"&&(r.allowVerticalPlacement&&a.vertical&&(ht=Ih(s,a.vertical,at,U.get("icon-text-fit-padding"),G,ee)),X&&(s=Ih(s,X,at,U.get("icon-text-fit-padding"),G,ee)));const Je=P?D.line.getGranularityForZoomLevel(P.z):1,Ct=(Zt,Ut)=>{Ut.x<0||Ut.x>=Ve||Ut.y<0||Ut.y>=Ve||function(kt,ci,En,Hn,br,Wr,ha,wr,sn,Jn,er,or,jr,da,yn,tr,ln,Nn,Un,nn,cn,go,ws,Go,Qp){const ul=kt.addToLineVertexArray(ci,En);let Vl,Gu,hl,dl,Wf=0,qu=0,Xd=0,Zh=0,Yd=-1,Qf=-1;const _o={};let i=oo("");if(kt.allowVerticalPlacement&&Hn.vertical){const ai=wr.layout.get("text-rotate").evaluate(cn,{},Go)+90;hl=new Uh(sn,ci,Jn,er,or,Hn.vertical,jr,da,yn,ai),ha&&(dl=new Uh(sn,ci,Jn,er,or,ha,ln,Nn,yn,ai))}if(br){const ai=wr.layout.get("icon-rotate").evaluate(cn,{}),Ae=wr.layout.get("icon-text-fit")!=="none",Se=Hp(br,ai,ws,Ae),De=ha?Hp(ha,ai,ws,Ae):void 0;Gu=new Uh(sn,ci,Jn,er,or,br,ln,Nn,!1,ai),Wf=4*Se.length;const rt=kt.iconSizeData;let It=null;rt.kind==="source"?(It=[Zo*wr.layout.get("icon-size").evaluate(cn,{})],It[0]>rl&&Vn(`${kt.layerIds[0]}: Value for "icon-size" is >= ${Nu}. Reduce your "icon-size".`)):rt.kind==="composite"&&(It=[Zo*go.compositeIconSizes[0].evaluate(cn,{},Go),Zo*go.compositeIconSizes[1].evaluate(cn,{},Go)],(It[0]>rl||It[1]>rl)&&Vn(`${kt.layerIds[0]}: Value for "icon-size" is >= ${Nu}. Reduce your "icon-size".`)),kt.addSymbols(kt.icon,Se,It,nn,Un,cn,A.ah.none,ci,ul.lineStartIndex,ul.lineLength,-1,Go),Yd=kt.icon.placedSymbolArray.length-1,De&&(qu=4*De.length,kt.addSymbols(kt.icon,De,It,nn,Un,cn,A.ah.vertical,ci,ul.lineStartIndex,ul.lineLength,-1,Go),Qf=kt.icon.placedSymbolArray.length-1)}const o=Object.keys(Hn.horizontal);for(const ai of o){const Ae=Hn.horizontal[ai];if(!Vl){i=oo(Ae.text);const De=wr.layout.get("text-rotate").evaluate(cn,{},Go);Vl=new Uh(sn,ci,Jn,er,or,Ae,jr,da,yn,De)}const Se=Ae.positionedLines.length===1;if(Xd+=Xp(kt,ci,Ae,Wr,wr,yn,cn,tr,ul,Hn.vertical?A.ah.horizontal:A.ah.horizontalOnly,Se?o:[ai],_o,Yd,go,Go),Se)break}Hn.vertical&&(Zh+=Xp(kt,ci,Hn.vertical,Wr,wr,yn,cn,tr,ul,A.ah.vertical,["vertical"],_o,Qf,go,Go));const c=Vl?Vl.boxStartIndex:kt.collisionBoxArray.length,p=Vl?Vl.boxEndIndex:kt.collisionBoxArray.length,b=hl?hl.boxStartIndex:kt.collisionBoxArray.length,C=hl?hl.boxEndIndex:kt.collisionBoxArray.length,V=Gu?Gu.boxStartIndex:kt.collisionBoxArray.length,W=Gu?Gu.boxEndIndex:kt.collisionBoxArray.length,me=dl?dl.boxStartIndex:kt.collisionBoxArray.length,Ne=dl?dl.boxEndIndex:kt.collisionBoxArray.length;let et=-1;const lt=(ai,Ae)=>ai&&ai.circleDiameter?Math.max(ai.circleDiameter,Ae):Ae;et=lt(Vl,et),et=lt(hl,et),et=lt(Gu,et),et=lt(dl,et);const Ge=et>-1?1:0;Ge&&(et*=Qp/In),kt.glyphOffsetArray.length>=Bc.MAX_GLYPHS&&Vn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),cn.sortKey!==void 0&&kt.addToSortKeyRanges(kt.symbolInstances.length,cn.sortKey);const $e=cl(wr,cn,Go),[ei,Wt]=function(ai,Ae){const Se=ai.length,De=Ae==null?void 0:Ae.values;if((De==null?void 0:De.length)>0)for(let rt=0;rt<De.length;rt+=2){const It=De[rt+1];ai.emplaceBack(A.ay[De[rt]],It[0],It[1])}return[Se,ai.length]}(kt.textAnchorOffsets,$e);kt.symbolInstances.emplaceBack(ci.x,ci.y,_o.right>=0?_o.right:-1,_o.center>=0?_o.center:-1,_o.left>=0?_o.left:-1,_o.vertical||-1,Yd,Qf,i,c,p,b,C,V,W,me,Ne,Jn,Xd,Zh,Wf,qu,Ge,0,jr,et,ei,Wt)}(r,Ut,Zt,a,s,d,ht,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,oe,[J,J,J,J],ot,T,le,de,Ue,G,t,g,M,P,_)};if(Xe==="line")for(const Zt of jc(t.geometry,0,0,Ve,Ve)){const Ut=el(Zt,Je),kt=on(Ut,N,Le,a.vertical||X,s,24,ye,r.overscaling,Ve);for(const ci of kt)X&&$f(r,X.text,ut,ci)||Ct(Ut,ci)}else if(Xe==="line-center"){for(const Zt of t.geometry)if(Zt.length>1){const Ut=el(Zt,Je),kt=Zd(Ut,Le,a.vertical||X,s,24,ye);kt&&Ct(Ut,kt)}}else if(t.type==="Polygon")for(const Zt of Po(t.geometry,0)){const Ut=Gf(Zt,16);Ct(el(Zt[0],Je,!0),new sl(Ut.x,Ut.y,0))}else if(t.type==="LineString")for(const Zt of t.geometry){const Ut=el(Zt,Je);Ct(Ut,new sl(Ut[0].x,Ut[0].y,0))}else if(t.type==="Point")for(const Zt of t.geometry)for(const Ut of Zt)Ct([Ut],new sl(Ut.x,Ut.y,0))}function Xp(r,t,a,s,d,g,_,v,T,M,P,D,j,U,G){const X=function(ye,le,N,J,de,Le,ot,Ue){const Xe=J.layout.get("text-rotate").evaluate(Le,{})*Math.PI/180,ut=[];for(const at of le.positionedLines)for(const ht of at.positionedGlyphs){if(!ht.rect)continue;const Je=ht.rect||{};let Ct=ju+1,Zt=!0,Ut=1,kt=0;const ci=(de||Ue)&&ht.vertical,En=ht.metrics.advance*ht.scale/2;if(Ue&&le.verticalizable&&(kt=at.lineOffset/2-(ht.imageName?-(In-ht.metrics.width*ht.scale)/2:(ht.scale-1)*In)),ht.imageName){const Nn=ot[ht.imageName];Zt=Nn.sdf,Ut=Nn.pixelRatio,Ct=Br/Ut}const Hn=de?[ht.x+En,ht.y]:[0,0];let br=de?[0,0]:[ht.x+En+N[0],ht.y+N[1]-kt],Wr=[0,0];ci&&(Wr=br,br=[0,0]);const ha=ht.metrics.isDoubleResolution?2:1,wr=(ht.metrics.left-Ct)*ht.scale-En+br[0],sn=(-ht.metrics.top-Ct)*ht.scale+br[1],Jn=wr+Je.w/ha*ht.scale/Ut,er=sn+Je.h/ha*ht.scale/Ut,or=new he(wr,sn),jr=new he(Jn,sn),da=new he(wr,er),yn=new he(Jn,er);if(ci){const Nn=new he(-En,En-Fu),Un=-Math.PI/2,nn=In/2-En,cn=new he(5-Fu-nn,-(ht.imageName?nn:0)),go=new he(...Wr);or._rotateAround(Un,Nn)._add(cn)._add(go),jr._rotateAround(Un,Nn)._add(cn)._add(go),da._rotateAround(Un,Nn)._add(cn)._add(go),yn._rotateAround(Un,Nn)._add(cn)._add(go)}if(Xe){const Nn=Math.sin(Xe),Un=Math.cos(Xe),nn=[Un,-Nn,Nn,Un];or._matMult(nn),jr._matMult(nn),da._matMult(nn),yn._matMult(nn)}const tr=new he(0,0),ln=new he(0,0);ut.push({tl:or,tr:jr,bl:da,br:yn,tex:Je,writingMode:le.writingMode,glyphOffset:Hn,sectionIndex:ht.sectionIndex,isSDF:Zt,pixelOffsetTL:tr,pixelOffsetBR:ln,minFontScaleX:0,minFontScaleY:0})}return ut}(0,a,v,d,g,_,s,r.allowVerticalPlacement),ee=r.textSizeData;let oe=null;ee.kind==="source"?(oe=[Zo*d.layout.get("text-size").evaluate(_,{})],oe[0]>rl&&Vn(`${r.layerIds[0]}: Value for "text-size" is >= ${Nu}. Reduce your "text-size".`)):ee.kind==="composite"&&(oe=[Zo*U.compositeTextSizes[0].evaluate(_,{},G),Zo*U.compositeTextSizes[1].evaluate(_,{},G)],(oe[0]>rl||oe[1]>rl)&&Vn(`${r.layerIds[0]}: Value for "text-size" is >= ${Nu}. Reduce your "text-size".`)),r.addSymbols(r.text,X,oe,v,g,_,M,t,T.lineStartIndex,T.lineLength,j,G);for(const ye of P)D[ye]=r.text.placedSymbolArray.length-1;return 4*X.length}function Yp(r){for(const t in r)return r[t];return null}function $f(r,t,a,s){const d=r.compareText;if(t in d){const g=d[t];for(let _=g.length-1;_>=0;_--)if(s.dist(g[_])<a)return!0}else d[t]=[];return d[t].push(s),!1}const Kp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Za{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,s]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=s>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const g=Kp[15&s];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new Za(v,_,g,t)}constructor(t,a=64,s=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=Kp.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-v%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${s}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+T,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+v+T),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+T,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=a,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Vh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,s,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:v}=this,T=[0,g.length-1,0],M=[];for(;T.length;){const P=T.pop()||0,D=T.pop()||0,j=T.pop()||0;if(D-j<=v){for(let ee=j;ee<=D;ee++){const oe=_[2*ee],ye=_[2*ee+1];oe>=t&&oe<=s&&ye>=a&&ye<=d&&M.push(g[ee])}continue}const U=j+D>>1,G=_[2*U],X=_[2*U+1];G>=t&&G<=s&&X>=a&&X<=d&&M.push(g[U]),(P===0?t<=G:a<=X)&&(T.push(j),T.push(U-1),T.push(1-P)),(P===0?s>=G:d>=X)&&(T.push(U+1),T.push(D),T.push(1-P))}return M}within(t,a,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:g,nodeSize:_}=this,v=[0,d.length-1,0],T=[],M=s*s;for(;v.length;){const P=v.pop()||0,D=v.pop()||0,j=v.pop()||0;if(D-j<=_){for(let ee=j;ee<=D;ee++)Ga(g[2*ee],g[2*ee+1],t,a)<=M&&T.push(d[ee]);continue}const U=j+D>>1,G=g[2*U],X=g[2*U+1];Ga(G,X,t,a)<=M&&T.push(d[U]),(P===0?t-s<=G:a-s<=X)&&(v.push(j),v.push(U-1),v.push(1-P)),(P===0?t+s>=G:a+s>=X)&&(v.push(U+1),v.push(D),v.push(1-P))}return T}}function Vh(r,t,a,s,d,g){if(d-s<=a)return;const _=s+d>>1;Xf(r,t,_,s,d,g),Vh(r,t,a,s,_-1,1-g),Vh(r,t,a,_+1,d,1-g)}function Xf(r,t,a,s,d,g){for(;d>s;){if(d-s>600){const M=d-s+1,P=a-s+1,D=Math.log(M),j=.5*Math.exp(2*D/3),U=.5*Math.sqrt(D*j*(M-j)/M)*(P-M/2<0?-1:1);Xf(r,t,a,Math.max(s,Math.floor(a-P*j/M+U)),Math.min(d,Math.floor(a+(M-P)*j/M+U)),g)}const _=t[2*a+g];let v=s,T=d;for(Zu(r,t,s,a),t[2*d+g]>_&&Zu(r,t,s,d);v<T;){for(Zu(r,t,v,T),v++,T--;t[2*v+g]<_;)v++;for(;t[2*T+g]>_;)T--}t[2*s+g]===_?Zu(r,t,s,T):(T++,Zu(r,t,T,d)),T<=a&&(s=T+1),a<=T&&(d=T-1)}}function Zu(r,t,a,s){Uc(r,a,s),Uc(t,2*a,2*s),Uc(t,2*a+1,2*s+1)}function Uc(r,t,a){const s=r[t];r[t]=r[a],r[a]=s}function Ga(r,t,a,s){const d=r-a,g=t-s;return d*d+g*g}var $d;A.ck=void 0,($d=A.ck||(A.ck={})).create="create",$d.load="load",$d.fullLoad="fullLoad";let Vc=null,qa=[];const Yf=1e3/60,Kf="loadTime",Ul="fullLoadTime",Wp={mark(r){performance.mark(r)},frame(r){const t=r;Vc!=null&&qa.push(t-Vc),Vc=t},clearMetrics(){Vc=null,qa=[],performance.clearMeasures(Kf),performance.clearMeasures(Ul);for(const r in A.ck)performance.clearMarks(A.ck[r])},getPerformanceMetrics(){performance.measure(Kf,A.ck.create,A.ck.load),performance.measure(Ul,A.ck.create,A.ck.fullLoad);const r=performance.getEntriesByName(Kf)[0].duration,t=performance.getEntriesByName(Ul)[0].duration,a=qa.length,s=1/(qa.reduce((g,_)=>g+_,0)/a/1e3),d=qa.filter(g=>g>Yf).reduce((g,_)=>g+(_-Yf)/Yf,0);return{loadTime:r,fullLoadTime:t,fps:s,percentDroppedFrames:d/(a+d)*100,totalFrames:a}}};A.$=jh,A.A=yt,A.B=ra,A.C=Qi,A.D=Dt,A.E=K,A.F=af,A.G=function(r){if(Wi==null){const t=r.navigator?r.navigator.userAgent:null;Wi=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Wi},A.H=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new jp(()=>this.process()),this.subscription=Jr(this.target,"message",a=>this.receive(a),!1),this.globalScope=Fr(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise((a,s)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10),g=t?Jr(t.signal,"abort",()=>{g==null||g.unsubscribe(),delete this.resolveRejects[d];const T={id:d,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)},Fp):null;this.resolveRejects[d]={resolve:T=>{g==null||g.unsubscribe(),a(T)},reject:T=>{g==null||g.unsubscribe(),s(T)}};const _=[],v=Object.assign(Object.assign({},r),{id:d,sourceMapId:this.mapId,origin:location.origin,data:qs(r.data,_)});this.target.postMessage(v,{transfer:_})})}receive(r){const t=r.data,a=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[a];const s=this.abortControllers[a];return delete this.abortControllers[a],void(s&&s.abort())}if(Fr(self)||t.mustQueue)return this.tasks[a]=t,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return u(this,void 0,void 0,function*(){if(t.type==="<response>"){const d=this.resolveRejects[r];return delete this.resolveRejects[r],d?void(t.error?d.reject(Bo(t.error)):d.resolve(Bo(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=Bo(t.data),s=new AbortController;this.abortControllers[r]=s;try{const d=yield this.messageHandlers[t.type](t.sourceMapId,a,s);this.completeTask(r,null,d)}catch(d){this.completeTask(r,d)}})}completeTask(r,t,a){const s=[];delete this.abortControllers[r];const d={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?qs(t):null,data:qs(a,s)};this.target.postMessage(d,{transfer:s})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},A.I=zh,A.J=hn,A.K=function(){var r=new yt(16);return yt!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},A.L=function(r,t,a){var s,d,g,_,v,T,M,P,D,j,U,G,X=a[0],ee=a[1],oe=a[2];return t===r?(r[12]=t[0]*X+t[4]*ee+t[8]*oe+t[12],r[13]=t[1]*X+t[5]*ee+t[9]*oe+t[13],r[14]=t[2]*X+t[6]*ee+t[10]*oe+t[14],r[15]=t[3]*X+t[7]*ee+t[11]*oe+t[15]):(d=t[1],g=t[2],_=t[3],v=t[4],T=t[5],M=t[6],P=t[7],D=t[8],j=t[9],U=t[10],G=t[11],r[0]=s=t[0],r[1]=d,r[2]=g,r[3]=_,r[4]=v,r[5]=T,r[6]=M,r[7]=P,r[8]=D,r[9]=j,r[10]=U,r[11]=G,r[12]=s*X+v*ee+D*oe+t[12],r[13]=d*X+T*ee+j*oe+t[13],r[14]=g*X+M*ee+U*oe+t[14],r[15]=_*X+P*ee+G*oe+t[15]),r},A.M=function(r,t,a){var s=a[0],d=a[1],g=a[2];return r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r[3]=t[3]*s,r[4]=t[4]*d,r[5]=t[5]*d,r[6]=t[6]*d,r[7]=t[7]*d,r[8]=t[8]*g,r[9]=t[9]*g,r[10]=t[10]*g,r[11]=t[11]*g,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},A.N=function(r,t,a){var s=t[0],d=t[1],g=t[2],_=t[3],v=t[4],T=t[5],M=t[6],P=t[7],D=t[8],j=t[9],U=t[10],G=t[11],X=t[12],ee=t[13],oe=t[14],ye=t[15],le=a[0],N=a[1],J=a[2],de=a[3];return r[0]=le*s+N*v+J*D+de*X,r[1]=le*d+N*T+J*j+de*ee,r[2]=le*g+N*M+J*U+de*oe,r[3]=le*_+N*P+J*G+de*ye,r[4]=(le=a[4])*s+(N=a[5])*v+(J=a[6])*D+(de=a[7])*X,r[5]=le*d+N*T+J*j+de*ee,r[6]=le*g+N*M+J*U+de*oe,r[7]=le*_+N*P+J*G+de*ye,r[8]=(le=a[8])*s+(N=a[9])*v+(J=a[10])*D+(de=a[11])*X,r[9]=le*d+N*T+J*j+de*ee,r[10]=le*g+N*M+J*U+de*oe,r[11]=le*_+N*P+J*G+de*ye,r[12]=(le=a[12])*s+(N=a[13])*v+(J=a[14])*D+(de=a[15])*X,r[13]=le*d+N*T+J*j+de*ee,r[14]=le*g+N*M+J*U+de*oe,r[15]=le*_+N*P+J*G+de*ye,r},A.O=function(r,t){const a={};for(let s=0;s<t.length;s++){const d=t[s];d in r&&(a[d]=r[d])}return a},A.P=he,A.Q=ol,A.R=ba,A.S=Ff,A.T=Hs,A.U=jf,A.V=qe,A.W=dt,A.X=Mn,A.Y=Ca,A.Z=Ve,A._=u,A.a=xn,A.a$=function(r,t,a){var s=Math.sin(a),d=Math.cos(a),g=t[4],_=t[5],v=t[6],T=t[7],M=t[8],P=t[9],D=t[10],j=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=g*d+M*s,r[5]=_*d+P*s,r[6]=v*d+D*s,r[7]=T*d+j*s,r[8]=M*d-g*s,r[9]=P*d-_*s,r[10]=D*d-v*s,r[11]=j*d-T*s,r},A.a0=25,A.a1=Oc,A.a2=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(a=>{t.onloadstart=()=>{a(t)};for(const s of r){const d=window.document.createElement("source");ea(s)||(t.crossOrigin="Anonymous"),d.src=s,t.appendChild(d)}})},A.a3=Ze,A.a4=function(){return qt++},A.a5=S,A.a6=Bc,A.a7=uc,A.a8=Na,A.a9=Nd,A.aA=Hd,A.aB=zd,A.aC=Za,A.aD=Kt,A.aE=Mh,A.aF=fe,A.aG=ni,A.aH=it,A.aI=function(r){return Math.pow(2,r)},A.aJ=85.051129,A.aK=Up,A.aL=Ot,A.aM=lr,A.aN=jd,A.aO=function(r,t,a){return r[0]=t[0]*a,r[1]=t[1]*a,r[2]=t[2]*a,r},A.aP=function(r,t,a){return r[0]=t[0]+a[0],r[1]=t[1]+a[1],r[2]=t[2]+a[2],r},A.aQ=function(r){var t=new yt(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},A.aR=function(r,t,a){return r[0]=t[0]*a[0],r[1]=t[1]*a[1],r[2]=t[2]*a[2],r[3]=t[3]*a[3],r},A.aS=function(r,t,a){return r[0]=t[0]-a[0],r[1]=t[1]-a[1],r[2]=t[2]-a[2],r},A.aT=function(r,t){var a=t[0],s=t[1],d=t[2],g=a*a+s*s+d*d;return g>0&&(g=1/Math.sqrt(g)),r[0]=t[0]*g,r[1]=t[1]*g,r[2]=t[2]*g,r},A.aU=function(r,t,a){var s=t[0],d=t[1],g=t[2],_=a[0],v=a[1],T=a[2];return r[0]=d*T-g*v,r[1]=g*_-s*T,r[2]=s*v-d*_,r},A.aV=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},A.aW=Zp,A.aX=li,A.aY=function(r,t,a,s,d){var g,_=1/Math.tan(t/2);return r[0]=_/a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0?(r[10]=(d+s)*(g=1/(s-d)),r[14]=2*d*s*g):(r[10]=-1,r[14]=-2*s),r},A.aZ=function(r){var t=new yt(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},A.a_=function(r,t,a){var s=Math.sin(a),d=Math.cos(a),g=t[0],_=t[1],v=t[2],T=t[3],M=t[4],P=t[5],D=t[6],j=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=g*d+M*s,r[1]=_*d+P*s,r[2]=v*d+D*s,r[3]=T*d+j*s,r[4]=M*d-g*s,r[5]=P*d-_*s,r[6]=D*d-v*s,r[7]=j*d-T*s,r},A.aa=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,s,d,g)=>{const _=d||g;return t[s]=!_||_.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t},A.ab=function(r){return Math.log(r)/Math.LN2},A.ac=function(r){var t=r[0],a=r[1];return t*t+a*a},A.ad=function(r){return r*Math.PI/180},A.ae=wt,A.af=function(r,t){const a=[];for(const s in r)s in t||a.push(s);return a},A.ag=function(r,t){let a=0,s=0;if(r.kind==="constant")s=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:g,maxZoom:_}=r,v=d?wt(Er.interpolationFactor(d,t,g,_),0,1):0;r.kind==="camera"?s=ra.number(r.minSize,r.maxSize,v):a=v}return{uSizeT:a,uSize:s}},A.ai=function(r,{uSize:t,uSizeT:a},{lowerSize:s,upperSize:d}){return r.kind==="source"?s/Zo:r.kind==="composite"?ra.number(s/Zo,d/Zo,a):t},A.aj=function(r,t){var a=t[0],s=t[1],d=t[2],g=t[3],_=t[4],v=t[5],T=t[6],M=t[7],P=t[8],D=t[9],j=t[10],U=t[11],G=t[12],X=t[13],ee=t[14],oe=t[15],ye=a*v-s*_,le=a*T-d*_,N=a*M-g*_,J=s*T-d*v,de=s*M-g*v,Le=d*M-g*T,ot=P*X-D*G,Ue=P*ee-j*G,Xe=P*oe-U*G,ut=D*ee-j*X,at=D*oe-U*X,ht=j*oe-U*ee,Je=ye*ht-le*at+N*ut+J*Xe-de*Ue+Le*ot;return Je?(r[0]=(v*ht-T*at+M*ut)*(Je=1/Je),r[1]=(d*at-s*ht-g*ut)*Je,r[2]=(X*Le-ee*de+oe*J)*Je,r[3]=(j*de-D*Le-U*J)*Je,r[4]=(T*Xe-_*ht-M*Ue)*Je,r[5]=(a*ht-d*Xe+g*Ue)*Je,r[6]=(ee*N-G*Le-oe*le)*Je,r[7]=(P*Le-j*N+U*le)*Je,r[8]=(_*at-v*Xe+M*ot)*Je,r[9]=(s*Xe-a*at-g*ot)*Je,r[10]=(G*de-X*N+oe*ye)*Je,r[11]=(D*N-P*de-U*ye)*Je,r[12]=(v*Ue-_*ut-T*ot)*Je,r[13]=(a*ut-s*Ue+d*ot)*Je,r[14]=(X*le-G*J-ee*ye)*Je,r[15]=(P*J-D*le+j*ye)*Je,r):null},A.ak=Ki,A.al=function(r){return Math.hypot(r[0],r[1])},A.am=function(r){return r[0]=0,r[1]=0,r},A.an=function(r,t,a){return r[0]=t[0]*a,r[1]=t[1]*a,r},A.ao=Dd,A.ap=Mi,A.aq=function(r,t,a,s){const d=t.y-r.y,g=t.x-r.x,_=s.y-a.y,v=s.x-a.x,T=_*g-v*d;if(T===0)return null;const M=(v*(r.y-a.y)-_*(r.x-a.x))/T;return new he(r.x+M*g,r.y+M*d)},A.ar=jc,A.as=Tc,A.at=Qt,A.au=function(r){let t=1/0,a=1/0,s=-1/0,d=-1/0;for(const g of r)t=Math.min(t,g.x),a=Math.min(a,g.y),s=Math.max(s,g.x),d=Math.max(d,g.y);return[t,a,s,d]},A.av=In,A.aw=xt,A.ax=function(r,t,a,s,d=!1){if(!a[0]&&!a[1])return[0,0];const g=d?s==="map"?-r.bearingInRadians:0:s==="viewport"?r.bearingInRadians:0;if(g){const _=Math.sin(g),v=Math.cos(g);a=[a[0]*v-a[1]*_,a[0]*_+a[1]*v]}return[d?a[0]:xt(t,a[0],r.zoom),d?a[1]:xt(t,a[1],r.zoom)]},A.az=Pd,A.b=xo,A.b$=r=>r.type==="symbol",A.b0=function(){const r=new Float32Array(16);return Qt(r),r},A.b1=function(){const r=new Float64Array(16);return Qt(r),r},A.b2=function(){return new Float64Array(16)},A.b3=function(r,t,a){const s=new Float64Array(4);return function(d,g,_,v){var T=.5*Math.PI/180;g*=T,_*=T,v*=T;var M=Math.sin(g),P=Math.cos(g),D=Math.sin(_),j=Math.cos(_),U=Math.sin(v),G=Math.cos(v);d[0]=M*j*G-P*D*U,d[1]=P*D*G+M*j*U,d[2]=P*j*U-M*D*G,d[3]=P*j*G+M*D*U}(s,r,t-90,a),s},A.b4=function(r,t,a,s){var d,g,_,v,T,M=t[0],P=t[1],D=t[2],j=t[3],U=a[0],G=a[1],X=a[2],ee=a[3];return(g=M*U+P*G+D*X+j*ee)<0&&(g=-g,U=-U,G=-G,X=-X,ee=-ee),1-g>zt?(d=Math.acos(g),_=Math.sin(d),v=Math.sin((1-s)*d)/_,T=Math.sin(s*d)/_):(v=1-s,T=s),r[0]=v*M+T*U,r[1]=v*P+T*G,r[2]=v*D+T*X,r[3]=v*j+T*ee,r},A.b5=function(r){const t=new Float64Array(9);var a,s,d,g,_,v,T,M,P,D,j,U,G,X,ee,oe,ye,le;D=(d=(s=r)[0])*(T=d+d),j=(g=s[1])*T,G=(_=s[2])*T,X=_*(M=g+g),oe=(v=s[3])*T,ye=v*M,le=v*(P=_+_),(a=t)[0]=1-(U=g*M)-(ee=_*P),a[3]=j-le,a[6]=G+ye,a[1]=j+le,a[4]=1-D-ee,a[7]=X-oe,a[2]=G-ye,a[5]=X+oe,a[8]=1-D-U;const N=lr(-Math.asin(wt(t[2],-1,1)));let J,de;return Math.hypot(t[5],t[8])<.001?(J=0,de=-lr(Math.atan2(t[3],t[4]))):(J=lr(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),de=lr(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:J,pitch:N+90,bearing:de}},A.b6=function(r,t){return r.roll==t.roll&&r.pitch==t.pitch&&r.bearing==t.bearing},A.b7=_i,A.b8=Fa,A.b9=zc,A.bA=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let a=[];try{if(!ve(r.version,t.version))return[{command:"setStyle",args:[t]}];ve(r.center,t.center)||a.push({command:"setCenter",args:[t.center]}),ve(r.centerAltitude,t.centerAltitude)||a.push({command:"setCenterAltitude",args:[t.centerAltitude]}),ve(r.zoom,t.zoom)||a.push({command:"setZoom",args:[t.zoom]}),ve(r.bearing,t.bearing)||a.push({command:"setBearing",args:[t.bearing]}),ve(r.pitch,t.pitch)||a.push({command:"setPitch",args:[t.pitch]}),ve(r.roll,t.roll)||a.push({command:"setRoll",args:[t.roll]}),ve(r.sprite,t.sprite)||a.push({command:"setSprite",args:[t.sprite]}),ve(r.glyphs,t.glyphs)||a.push({command:"setGlyphs",args:[t.glyphs]}),ve(r.transition,t.transition)||a.push({command:"setTransition",args:[t.transition]}),ve(r.light,t.light)||a.push({command:"setLight",args:[t.light]}),ve(r.terrain,t.terrain)||a.push({command:"setTerrain",args:[t.terrain]}),ve(r.sky,t.sky)||a.push({command:"setSky",args:[t.sky]}),ve(r.projection,t.projection)||a.push({command:"setProjection",args:[t.projection]});const s={},d=[];(function(_,v,T,M){let P;for(P in v=v||{},_=_||{})Object.prototype.hasOwnProperty.call(_,P)&&(Object.prototype.hasOwnProperty.call(v,P)||Ke(P,T,M));for(P in v)Object.prototype.hasOwnProperty.call(v,P)&&(Object.prototype.hasOwnProperty.call(_,P)?ve(_[P],v[P])||(_[P].type==="geojson"&&v[P].type==="geojson"&&Re(_,v,P)?Ie(T,{command:"setGeoJSONSourceData",args:[P,v[P].data]}):He(P,v,T,M)):Ee(P,v,T))})(r.sources,t.sources,d,s);const g=[];r.layers&&r.layers.forEach(_=>{"source"in _&&s[_.source]?a.push({command:"removeLayer",args:[_.id]}):g.push(_)}),a=a.concat(d),function(_,v,T){v=v||[];const M=(_=_||[]).map(vt),P=v.map(vt),D=_.reduce(bt,{}),j=v.reduce(bt,{}),U=M.slice(),G=Object.create(null);let X,ee,oe,ye,le;for(let N=0,J=0;N<M.length;N++)X=M[N],Object.prototype.hasOwnProperty.call(j,X)?J++:(Ie(T,{command:"removeLayer",args:[X]}),U.splice(U.indexOf(X,J),1));for(let N=0,J=0;N<P.length;N++)X=P[P.length-1-N],U[U.length-1-N]!==X&&(Object.prototype.hasOwnProperty.call(D,X)?(Ie(T,{command:"removeLayer",args:[X]}),U.splice(U.lastIndexOf(X,U.length-J),1)):J++,ye=U[U.length-N],Ie(T,{command:"addLayer",args:[j[X],ye]}),U.splice(U.length-N,0,X),G[X]=!0);for(let N=0;N<P.length;N++)if(X=P[N],ee=D[X],oe=j[X],!G[X]&&!ve(ee,oe))if(ve(ee.source,oe.source)&&ve(ee["source-layer"],oe["source-layer"])&&ve(ee.type,oe.type)){for(le in nt(ee.layout,oe.layout,T,X,null,"setLayoutProperty"),nt(ee.paint,oe.paint,T,X,null,"setPaintProperty"),ve(ee.filter,oe.filter)||Ie(T,{command:"setFilter",args:[X,oe.filter]}),ve(ee.minzoom,oe.minzoom)&&ve(ee.maxzoom,oe.maxzoom)||Ie(T,{command:"setLayerZoomRange",args:[X,oe.minzoom,oe.maxzoom]}),ee)Object.prototype.hasOwnProperty.call(ee,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?nt(ee[le],oe[le],T,X,le.slice(6),"setPaintProperty"):ve(ee[le],oe[le])||Ie(T,{command:"setLayerProperty",args:[X,le,oe[le]]}));for(le in oe)Object.prototype.hasOwnProperty.call(oe,le)&&!Object.prototype.hasOwnProperty.call(ee,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?nt(ee[le],oe[le],T,X,le.slice(6),"setPaintProperty"):ve(ee[le],oe[le])||Ie(T,{command:"setLayerProperty",args:[X,le,oe[le]]}))}else Ie(T,{command:"removeLayer",args:[X]}),ye=U[U.lastIndexOf(X)+1],Ie(T,{command:"addLayer",args:[oe,ye]})}(g,t.layers,a)}catch(s){console.warn("Unable to compute style diff:",s),a=[{command:"setStyle",args:[t]}]}return a},A.bB=function(r){const t=[],a=r.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},A.bC=function r(t,a){if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(let s=0;s<t.length;s++)if(!r(t[s],a[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&a!==null){if(typeof a!="object"||Object.keys(t).length!==Object.keys(a).length)return!1;for(const s in t)if(!r(t[s],a[s]))return!1;return!0}return t===a},A.bD=kn,A.bE=Ai,A.bF=class extends ja{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},A.bG=lo,A.bH=class extends ja{constructor(r,t){super(r,t),this.current=Ys}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},A.bI=Xr,A.bJ=class extends ja{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},A.bK=class extends ja{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},A.bL=St,A.bM=function(r,t){var a=Math.sin(t),s=Math.cos(t);return r[0]=s,r[1]=a,r[2]=0,r[3]=-a,r[4]=s,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},A.bN=function(r,t,a){var s=t[0],d=t[1],g=t[2];return r[0]=s*a[0]+d*a[3]+g*a[6],r[1]=s*a[1]+d*a[4]+g*a[7],r[2]=s*a[2]+d*a[5]+g*a[8],r},A.bO=function(r,t,a,s,d,g,_){var v=1/(t-a),T=1/(s-d),M=1/(g-_);return r[0]=-2*v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*T,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*M,r[11]=0,r[12]=(t+a)*v,r[13]=(d+s)*T,r[14]=(_+g)*M,r[15]=1,r},A.bP=class extends _h{},A.bQ=Qn,A.bR=class extends Xs{},A.bS=xr,A.bT=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},A.bU=vr,A.bV=function(r,t,a){var s=t[0],d=t[1],g=t[2],_=a[3]*s+a[7]*d+a[11]*g+a[15];return r[0]=(a[0]*s+a[4]*d+a[8]*g+a[12])/(_=_||1),r[1]=(a[1]*s+a[5]*d+a[9]*g+a[13])/_,r[2]=(a[2]*s+a[6]*d+a[10]*g+a[14])/_,r},A.bW=class extends ao{},A.bX=class extends m{},A.bY=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},A.bZ=function(r,t){var a=r[0],s=r[1],d=r[2],g=r[3],_=r[4],v=r[5],T=r[6],M=r[7],P=r[8],D=r[9],j=r[10],U=r[11],G=r[12],X=r[13],ee=r[14],oe=r[15],ye=t[0],le=t[1],N=t[2],J=t[3],de=t[4],Le=t[5],ot=t[6],Ue=t[7],Xe=t[8],ut=t[9],at=t[10],ht=t[11],Je=t[12],Ct=t[13],Zt=t[14],Ut=t[15];return Math.abs(a-ye)<=zt*Math.max(1,Math.abs(a),Math.abs(ye))&&Math.abs(s-le)<=zt*Math.max(1,Math.abs(s),Math.abs(le))&&Math.abs(d-N)<=zt*Math.max(1,Math.abs(d),Math.abs(N))&&Math.abs(g-J)<=zt*Math.max(1,Math.abs(g),Math.abs(J))&&Math.abs(_-de)<=zt*Math.max(1,Math.abs(_),Math.abs(de))&&Math.abs(v-Le)<=zt*Math.max(1,Math.abs(v),Math.abs(Le))&&Math.abs(T-ot)<=zt*Math.max(1,Math.abs(T),Math.abs(ot))&&Math.abs(M-Ue)<=zt*Math.max(1,Math.abs(M),Math.abs(Ue))&&Math.abs(P-Xe)<=zt*Math.max(1,Math.abs(P),Math.abs(Xe))&&Math.abs(D-ut)<=zt*Math.max(1,Math.abs(D),Math.abs(ut))&&Math.abs(j-at)<=zt*Math.max(1,Math.abs(j),Math.abs(at))&&Math.abs(U-ht)<=zt*Math.max(1,Math.abs(U),Math.abs(ht))&&Math.abs(G-Je)<=zt*Math.max(1,Math.abs(G),Math.abs(Je))&&Math.abs(X-Ct)<=zt*Math.max(1,Math.abs(X),Math.abs(Ct))&&Math.abs(ee-Zt)<=zt*Math.max(1,Math.abs(ee),Math.abs(Zt))&&Math.abs(oe-Ut)<=zt*Math.max(1,Math.abs(oe),Math.abs(Ut))},A.b_=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},A.ba=Js,A.bb=Ua,A.bc=ui,A.bd=Te,A.be=Gn,A.bf=function(r,t,a,s,d){return ui(s,d,wt((r-t)/(a-t),0,1))},A.bg=jt,A.bh=function(){return new Float64Array(4)},A.bi=function(){return new Float64Array(3)},A.bj=function(r,t,a,s){var d=[],g=[];return d[0]=t[0]-a[0],d[1]=t[1]-a[1],d[2]=t[2]-a[2],g[0]=d[0]*Math.cos(s)-d[1]*Math.sin(s),g[1]=d[0]*Math.sin(s)+d[1]*Math.cos(s),g[2]=d[2],r[0]=g[0]+a[0],r[1]=g[1]+a[1],r[2]=g[2]+a[2],r},A.bk=function(r,t,a,s){var d=[],g=[];return d[0]=t[0]-a[0],d[1]=t[1]-a[1],d[2]=t[2]-a[2],g[0]=d[0],g[1]=d[1]*Math.cos(s)-d[2]*Math.sin(s),g[2]=d[1]*Math.sin(s)+d[2]*Math.cos(s),r[0]=g[0]+a[0],r[1]=g[1]+a[1],r[2]=g[2]+a[2],r},A.bl=function(r,t,a,s){var d=[],g=[];return d[0]=t[0]-a[0],d[1]=t[1]-a[1],d[2]=t[2]-a[2],g[0]=d[2]*Math.sin(s)+d[0]*Math.cos(s),g[1]=d[1],g[2]=d[2]*Math.cos(s)-d[0]*Math.sin(s),r[0]=g[0]+a[0],r[1]=g[1]+a[1],r[2]=g[2]+a[2],r},A.bm=function(r,t,a){var s=Math.sin(a),d=Math.cos(a),g=t[0],_=t[1],v=t[2],T=t[3],M=t[8],P=t[9],D=t[10],j=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=g*d-M*s,r[1]=_*d-P*s,r[2]=v*d-D*s,r[3]=T*d-j*s,r[8]=g*s+M*d,r[9]=_*s+P*d,r[10]=v*s+D*d,r[11]=T*s+j*d,r},A.bn=function(r,t){const a=jt(r,360),s=jt(t,360),d=s-a,g=s>a?d-360:d+360;return Math.abs(d)<Math.abs(g)?d:g},A.bo=function(r){return r[0]=0,r[1]=0,r[2]=0,r},A.bp=function(r,t,a,s){const d=Math.sqrt(r*r+t*t),g=Math.sqrt(a*a+s*s);r/=d,t/=d,a/=g,s/=g;const _=Math.acos(r*a+t*s);return-t*a+r*s>0?_:-_},A.bq=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]},A.br=Bd,A.bs=function(r,t){const a=jt(r,2*Math.PI),s=jt(t,2*Math.PI);return Math.min(Math.abs(a-s),Math.abs(a-s+2*Math.PI),Math.abs(a-s-2*Math.PI))},A.bt=function(r){return Math.hypot(r[0],r[1],r[2])},A.bu=function(){const r={},t=Z.$version;for(const a in Z.$root){const s=Z.$root[a];if(s.required){let d=null;d=a==="version"?t:s.type==="array"?[]:{},d!=null&&(r[a]=d)}}return r},A.bv=hh,A.bw=dn,A.bx=function(r){r=r.slice();const t=Object.create(null);for(let a=0;a<r.length;a++)t[r[a].id]=r[a];for(let a=0;a<r.length;a++)"ref"in r[a]&&(r[a]=be(r[a],t[r[a].ref]));return r},A.by=function(r){if(r.type==="custom")return new Cm(r);switch(r.type){case"background":return new Of(r);case"circle":return new pp(r);case"fill":return new bf(r);case"fill-extrusion":return new Iu(r);case"heatmap":return new gp(r);case"hillshade":return new yp(r);case"line":return new tn(r);case"raster":return new Bh(r);case"symbol":return new al(r)}},A.bz=Ln,A.c=Ri,A.c0=r=>r.type==="circle",A.c1=r=>r.type==="heatmap",A.c2=r=>r.type==="line",A.c3=r=>r.type==="fill",A.c4=r=>r.type==="fill-extrusion",A.c5=r=>r.type==="hillshade",A.c6=r=>r.type==="raster",A.c7=r=>r.type==="background",A.c8=r=>r.type==="custom",A.c9=ct,A.cA=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},A.cB=function(r,t,a,s,d){return u(this,void 0,void 0,function*(){if(dt())try{return yield Mn(r,t,a,s,d)}catch{}return function(g,_,v,T,M){const P=g.width,D=g.height;$a&&za||($a=new OffscreenCanvas(P,D),za=$a.getContext("2d",{willReadFrequently:!0})),$a.width=P,$a.height=D,za.drawImage(g,0,0,P,D);const j=za.getImageData(_,v,T,M);return za.clearRect(0,0,P,D),j.data}(r,t,a,s,d)})},A.cC=Fd,A.cD=re,A.cE=ze,A.cF=fo,A.cG=Md,A.cH=ko,A.cI=ro,A.ca=function(r,t,a){const s=Vi(t.x-a.x,t.y-a.y),d=Vi(r.x-a.x,r.y-a.y);var g,_;return lr(Math.atan2(s[0]*d[1]-s[1]*d[0],(g=s)[0]*(_=d)[0]+g[1]*_[1]))},A.cb=Et,A.cc=function(r,t){return Mt[t]&&(r instanceof MouseEvent||r instanceof WheelEvent)},A.cd=function(r,t){return pt[t]&&"touches"in r},A.ce=function(r){return pt[r]||Mt[r]},A.cf=function(r,t,a){var s=t[0],d=t[1];return r[0]=a[0]*s+a[4]*d+a[12],r[1]=a[1]*s+a[5]*d+a[13],r},A.cg=function(r,t){const{x:a,y:s}=jh.fromLngLat(t);return!(r<0||r>25||s<0||s>=1||a<0||a>=1)},A.ch=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},A.ci=class extends kr{},A.cj=Wp,A.cl=function(r){return r.message===hi},A.cm=zi,A.cn=function(r,t){xn.REGISTERED_PROTOCOLS[r]=t},A.co=function(r){delete xn.REGISTERED_PROTOCOLS[r]},A.cp=function(r,t){const a={};for(let d=0;d<r.length;d++){const g=t&&t[r[d].id]||Lo(r[d]);t&&(t[r[d].id]=g);let _=a[g];_||(_=a[g]=[]),_.push(r[d])}const s=[];for(const d in a)s.push(a[d]);return s},A.cq=Tt,A.cr=Fh,A.cs=Nf,A.ct=Rf,A.cu=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Ve/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],a=t.layout,s=t._unevaluatedLayout._values,d={layoutIconSize:s["icon-size"].possiblyEvaluate(new Qi(r.bucket.zoom+1),r.canonical),layoutTextSize:s["text-size"].possiblyEvaluate(new Qi(r.bucket.zoom+1),r.canonical),textMaxSize:s["text-size"].possiblyEvaluate(new Qi(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:P}=r.bucket.textSizeData;d.compositeTextSizes=[s["text-size"].possiblyEvaluate(new Qi(M),r.canonical),s["text-size"].possiblyEvaluate(new Qi(P),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:P}=r.bucket.iconSizeData;d.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new Qi(M),r.canonical),s["icon-size"].possiblyEvaluate(new Qi(P),r.canonical)]}const g=a.get("text-line-height")*In,_=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",v=a.get("text-keep-upright"),T=a.get("text-size");for(const M of r.bucket.features){const P=a.get("text-font").evaluate(M,{},r.canonical).join(","),D=T.evaluate(M,{},r.canonical),j=d.layoutTextSize.evaluate(M,{},r.canonical),U=d.layoutIconSize.evaluate(M,{},r.canonical),G={horizontal:{},vertical:void 0},X=M.text;let ee,oe=[0,0];if(X){const N=X.toString(),J=a.get("text-letter-spacing").evaluate(M,{},r.canonical)*In,de=Su(N)?J:0,Le=a.get("text-anchor").evaluate(M,{},r.canonical),ot=cl(t,M,r.canonical);if(!ot){const at=a.get("text-radial-offset").evaluate(M,{},r.canonical);oe=at?$p(Le,[at*In,qf]):a.get("text-offset").evaluate(M,{},r.canonical).map(ht=>ht*In)}let Ue=_?"center":a.get("text-justify").evaluate(M,{},r.canonical);const Xe=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(M,{},r.canonical)*In:1/0,ut=()=>{r.bucket.allowVerticalPlacement&&no(N)&&(G.vertical=Kr(X,r.glyphMap,r.glyphPositions,r.imagePositions,P,Xe,g,Le,"left",de,oe,A.ah.vertical,!0,j,D))};if(!_&&ot){const at=new Set;if(Ue==="auto")for(let Je=0;Je<ot.values.length;Je+=2)at.add(Hd(ot.values[Je]));else at.add(Ue);let ht=!1;for(const Je of at)if(!G.horizontal[Je])if(ht)G.horizontal[Je]=G.horizontal[0];else{const Ct=Kr(X,r.glyphMap,r.glyphPositions,r.imagePositions,P,Xe,g,"center",Je,de,oe,A.ah.horizontal,!1,j,D);Ct&&(G.horizontal[Je]=Ct,ht=Ct.positionedLines.length===1)}ut()}else{Ue==="auto"&&(Ue=Hd(Le));const at=Kr(X,r.glyphMap,r.glyphPositions,r.imagePositions,P,Xe,g,Le,Ue,de,oe,A.ah.horizontal,!1,j,D);at&&(G.horizontal[Ue]=at),ut(),no(N)&&_&&v&&(G.vertical=Kr(X,r.glyphMap,r.glyphPositions,r.imagePositions,P,Xe,g,Le,Ue,de,oe,A.ah.vertical,!1,j,D))}}let ye=!1;if(M.icon&&M.icon.name){const N=r.imageMap[M.icon.name];N&&(ee=kp(r.imagePositions[M.icon.name],a.get("icon-offset").evaluate(M,{},r.canonical),a.get("icon-anchor").evaluate(M,{},r.canonical)),ye=!!N.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=ye:r.bucket.sdfIcons!==ye&&Vn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(N.pixelRatio!==r.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const le=Yp(G.horizontal)||G.vertical;r.bucket.iconsInText=!!le&&le.iconsInText,(le||ee)&&Hf(r.bucket,M,G,ee,r.imageMap,d,j,U,oe,ye,r.canonical,r.subdivisionGranularity)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},A.cv=Mf,A.cw=Ru,A.cx=tl,A.cy=Pu,A.cz=Bu,A.d=ea,A.e=$t,A.f=r=>u(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),A.g=un,A.h=r=>new Promise((t,a)=>{const s=new Image;s.onload=()=>{t(s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame(()=>{s.src=bo})},s.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(r)],{type:"image/png"});s.src=r.byteLength?URL.createObjectURL(d):bo}),A.i=Fr,A.j=(r,t)=>An($t(r,{type:"json"}),t),A.k=$,A.l=Ce,A.m=An,A.n=(r,t)=>An($t(r,{type:"arrayBuffer"}),t),A.o=function(r){return new Bu(r).readFields(jl,[])},A.p=Ic,A.q=Sh,A.r=_r,A.s=Jr,A.t=wu,A.u=si,A.v=Z,A.w=Vn,A.x=wn,A.y=io,A.z=function([r,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(a),y:r*Math.sin(t)*Math.sin(a),z:r*Math.cos(a)}}}),L("worker",["./shared"],function(A){class u{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,K){for(const ue of $){this._layerConfigs[ue.id]=ue;const be=this._layers[ue.id]=A.by(ue);be._featureFilter=A.a7(be.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(const ue of K)delete this.keyCache[ue],delete this._layerConfigs[ue],delete this._layers[ue];this.familiesBySource={};const Z=A.cp(Object.values(this._layerConfigs),this.keyCache);for(const ue of Z){const be=ue.map(Re=>this._layers[Re.id]),ve=be[0];if(ve.visibility==="none")continue;const Ie=ve.source||"";let Ee=this.familiesBySource[Ie];Ee||(Ee=this.familiesBySource[Ie]={});const Ke=ve.sourceLayer||"_geojsonTileLayer";let He=Ee[Ke];He||(He=Ee[Ke]=[]),He.push(be)}}}class re{constructor($){const K={},Z=[];for(const Ie in $){const Ee=$[Ie],Ke=K[Ie]={};for(const He in Ee){const Re=Ee[+He];if(!Re||Re.bitmap.width===0||Re.bitmap.height===0)continue;const nt={x:0,y:0,w:Re.bitmap.width+2,h:Re.bitmap.height+2};Z.push(nt),Ke[He]={rect:nt,metrics:Re.metrics}}}const{w:ue,h:be}=A.p(Z),ve=new A.q({width:ue||1,height:be||1});for(const Ie in $){const Ee=$[Ie];for(const Ke in Ee){const He=Ee[+Ke];if(!He||He.bitmap.width===0||He.bitmap.height===0)continue;const Re=K[Ie][Ke].rect;A.q.copy(He.bitmap,ve,{x:0,y:0},{x:Re.x+1,y:Re.y+1},He.bitmap)}}this.image=ve,this.positions=K}}A.cq("GlyphAtlas",re);class Q{constructor($){this.tileID=new A.Y($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId,this.inFlightDependencies=[]}parse($,K,Z,ue,be){return A._(this,void 0,void 0,function*(){this.status="parsing",this.data=$,this.collisionBoxArray=new A.a5;const ve=new A.cr(Object.keys($.layers).sort()),Ie=new A.cs(this.tileID,this.promoteId);Ie.bucketLayerIDs=[];const Ee={},Ke={featureIndex:Ie,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Z,subdivisionGranularity:be},He=K.familiesBySource[this.source];for(const _t in He){const Xt=$.layers[_t];if(!Xt)continue;Xt.version===1&&A.w(`Vector tile source "${this.source}" layer "${_t}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const fn=ve.encode(_t),Ur=[];for(let Ft=0;Ft<Xt.length;Ft++){const zn=Xt.feature(Ft),Pi=Ie.getId(zn,_t);Ur.push({feature:zn,id:Pi,index:Ft,sourceLayerIndex:fn})}for(const Ft of He[_t]){const zn=Ft[0];zn.source!==this.source&&A.w(`layer.source = ${zn.source} does not equal this.source = ${this.source}`),zn.minzoom&&this.zoom<Math.floor(zn.minzoom)||zn.maxzoom&&this.zoom>=zn.maxzoom||zn.visibility!=="none"&&(ce(Ft,this.zoom,Z),(Ee[zn.id]=zn.createBucket({index:Ie.bucketLayerIDs.length,layers:Ft,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fn,sourceID:this.source})).populate(Ur,Ke,this.tileID.canonical),Ie.bucketLayerIDs.push(Ft.map(Pi=>Pi.id)))}}const Re=A.bD(Ke.glyphDependencies,_t=>Object.keys(_t).map(Number));this.inFlightDependencies.forEach(_t=>_t==null?void 0:_t.abort()),this.inFlightDependencies=[];let nt=Promise.resolve({});if(Object.keys(Re).length){const _t=new AbortController;this.inFlightDependencies.push(_t),nt=ue.sendAsync({type:"GG",data:{stacks:Re,source:this.source,tileID:this.tileID,type:"glyphs"}},_t)}const vt=Object.keys(Ke.iconDependencies);let bt=Promise.resolve({});if(vt.length){const _t=new AbortController;this.inFlightDependencies.push(_t),bt=ue.sendAsync({type:"GI",data:{icons:vt,source:this.source,tileID:this.tileID,type:"icons"}},_t)}const Ze=Object.keys(Ke.patternDependencies);let Bt=Promise.resolve({});if(Ze.length){const _t=new AbortController;this.inFlightDependencies.push(_t),Bt=ue.sendAsync({type:"GI",data:{icons:Ze,source:this.source,tileID:this.tileID,type:"patterns"}},_t)}const[At,Gt,pi]=yield Promise.all([nt,bt,Bt]),st=new re(At),Rt=new A.ct(Gt,pi);for(const _t in Ee){const Xt=Ee[_t];Xt instanceof A.a6?(ce(Xt.layers,this.zoom,Z),A.cu({bucket:Xt,glyphMap:At,glyphPositions:st.positions,imageMap:Gt,imagePositions:Rt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ke.subdivisionGranularity})):Xt.hasPattern&&(Xt instanceof A.cv||Xt instanceof A.cw||Xt instanceof A.cx)&&(ce(Xt.layers,this.zoom,Z),Xt.addFeatures(Ke,this.tileID.canonical,Rt.patternPositions))}return this.status="done",{buckets:Object.values(Ee).filter(_t=>!_t.isEmpty()),featureIndex:Ie,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:st.image,imageAtlas:Rt,glyphMap:this.returnDependencies?At:null,iconMap:this.returnDependencies?Gt:null,glyphPositions:this.returnDependencies?st.positions:null}})}}function ce(Ce,$,K){const Z=new A.C($);for(const ue of Ce)ue.recalculate(Z,K)}class ze{constructor($,K,Z){this.actor=$,this.layerIndex=K,this.availableImages=Z,this.fetching={},this.loading={},this.loaded={}}loadVectorTile($,K){return A._(this,void 0,void 0,function*(){const Z=yield A.n($.request,K);try{return{vectorTile:new A.cy.VectorTile(new A.cz(Z.data)),rawData:Z.data,cacheControl:Z.cacheControl,expires:Z.expires}}catch(ue){const be=new Uint8Array(Z.data);let ve=`Unable to parse the tile at ${$.request.url}, `;throw ve+=be[0]===31&&be[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ue.message}`,new Error(ve)}})}loadTile($){return A._(this,void 0,void 0,function*(){const K=$.uid,Z=!!($&&$.request&&$.request.collectResourceTiming)&&new A.cA($.request),ue=new Q($);this.loading[K]=ue;const be=new AbortController;ue.abort=be;try{const ve=yield this.loadVectorTile($,be);if(delete this.loading[K],!ve)return null;const Ie=ve.rawData,Ee={};ve.expires&&(Ee.expires=ve.expires),ve.cacheControl&&(Ee.cacheControl=ve.cacheControl);const Ke={};if(Z){const Re=Z.finish();Re&&(Ke.resourceTiming=JSON.parse(JSON.stringify(Re)))}ue.vectorTile=ve.vectorTile;const He=ue.parse(ve.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);this.loaded[K]=ue,this.fetching[K]={rawTileData:Ie,cacheControl:Ee,resourceTiming:Ke};try{const Re=yield He;return A.e({rawTileData:Ie.slice(0)},Re,Ee,Ke)}finally{delete this.fetching[K]}}catch(ve){throw delete this.loading[K],ue.status="done",this.loaded[K]=ue,ve}})}reloadTile($){return A._(this,void 0,void 0,function*(){const K=$.uid;if(!this.loaded||!this.loaded[K])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Z=this.loaded[K];if(Z.showCollisionBoxes=$.showCollisionBoxes,Z.status==="parsing"){const ue=yield Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);let be;if(this.fetching[K]){const{rawTileData:ve,cacheControl:Ie,resourceTiming:Ee}=this.fetching[K];delete this.fetching[K],be=A.e({rawTileData:ve.slice(0)},ue,Ie,Ee)}else be=ue;return be}if(Z.status==="done"&&Z.vectorTile)return Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity)})}abortTile($){return A._(this,void 0,void 0,function*(){const K=this.loading,Z=$.uid;K&&K[Z]&&K[Z].abort&&(K[Z].abort.abort(),delete K[Z])})}removeTile($){return A._(this,void 0,void 0,function*(){this.loaded&&this.loaded[$.uid]&&delete this.loaded[$.uid]})}}class _e{constructor(){this.loaded={}}loadTile($){return A._(this,void 0,void 0,function*(){const{uid:K,encoding:Z,rawImageData:ue,redFactor:be,greenFactor:ve,blueFactor:Ie,baseShift:Ee}=$,Ke=ue.width+2,He=ue.height+2,Re=A.b(ue)?new A.R({width:Ke,height:He},yield A.cB(ue,-1,-1,Ke,He)):ue,nt=new A.cC(K,Re,Z,be,ve,Ie,Ee);return this.loaded=this.loaded||{},this.loaded[K]=nt,nt})}removeTile($){const K=this.loaded,Z=$.uid;K&&K[Z]&&delete K[Z]}}var ie,he,je=function(){if(he)return ie;function Ce(K,Z){if(K.length!==0){$(K[0],Z);for(var ue=1;ue<K.length;ue++)$(K[ue],!Z)}}function $(K,Z){for(var ue=0,be=0,ve=0,Ie=K.length,Ee=Ie-1;ve<Ie;Ee=ve++){var Ke=(K[ve][0]-K[Ee][0])*(K[Ee][1]+K[ve][1]),He=ue+Ke;be+=Math.abs(ue)>=Math.abs(Ke)?ue-He+Ke:Ke-He+ue,ue=He}ue+be>=0!=!!Z&&K.reverse()}return he=1,ie=function K(Z,ue){var be,ve=Z&&Z.type;if(ve==="FeatureCollection")for(be=0;be<Z.features.length;be++)K(Z.features[be],ue);else if(ve==="GeometryCollection")for(be=0;be<Z.geometries.length;be++)K(Z.geometries[be],ue);else if(ve==="Feature")K(Z.geometry,ue);else if(ve==="Polygon")Ce(Z.coordinates,ue);else if(ve==="MultiPolygon")for(be=0;be<Z.coordinates.length;be++)Ce(Z.coordinates[be],ue);return Z}}(),Me=A.cD(je);const Oe=A.cy.VectorTileFeature.prototype.toGeoJSON;class Fe{constructor($){this._feature=$,this.extent=A.Z,this.type=$.type,this.properties=$.tags,"id"in $&&!isNaN($.id)&&(this.id=parseInt($.id,10))}loadGeometry(){if(this._feature.type===1){const $=[];for(const K of this._feature.geometry)$.push([new A.P(K[0],K[1])]);return $}{const $=[];for(const K of this._feature.geometry){const Z=[];for(const ue of K)Z.push(new A.P(ue[0],ue[1]));$.push(Z)}return $}}toGeoJSON($,K,Z){return Oe.call(this,$,K,Z)}}class qe{constructor($){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=A.Z,this.length=$.length,this._features=$}feature($){return new Fe(this._features[$])}}var dt,mt,zt,yt={exports:{}},St=function(){if(zt)return yt.exports;zt=1;var Ce=A.cG(),$=function(){if(mt)return dt;mt=1;var He=A.cE(),Re=A.cF().VectorTileFeature;function nt(bt,Ze){this.options=Ze||{},this.features=bt,this.length=bt.length}function vt(bt,Ze){this.id=typeof bt.id=="number"?bt.id:void 0,this.type=bt.type,this.rawGeometry=bt.type===1?[bt.geometry]:bt.geometry,this.properties=bt.tags,this.extent=Ze||4096}return dt=nt,nt.prototype.feature=function(bt){return new vt(this.features[bt],this.options.extent)},vt.prototype.loadGeometry=function(){var bt=this.rawGeometry;this.geometry=[];for(var Ze=0;Ze<bt.length;Ze++){for(var Bt=bt[Ze],At=[],Gt=0;Gt<Bt.length;Gt++)At.push(new He(Bt[Gt][0],Bt[Gt][1]));this.geometry.push(At)}return this.geometry},vt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var bt=this.geometry,Ze=1/0,Bt=-1/0,At=1/0,Gt=-1/0,pi=0;pi<bt.length;pi++)for(var st=bt[pi],Rt=0;Rt<st.length;Rt++){var _t=st[Rt];Ze=Math.min(Ze,_t.x),Bt=Math.max(Bt,_t.x),At=Math.min(At,_t.y),Gt=Math.max(Gt,_t.y)}return[Ze,At,Bt,Gt]},vt.prototype.toGeoJSON=Re.prototype.toGeoJSON,dt}();function K(He){var Re=new Ce;return function(nt,vt){for(var bt in nt.layers)vt.writeMessage(3,Z,nt.layers[bt])}(He,Re),Re.finish()}function Z(He,Re){var nt;Re.writeVarintField(15,He.version||1),Re.writeStringField(1,He.name||""),Re.writeVarintField(5,He.extent||4096);var vt={keys:[],values:[],keycache:{},valuecache:{}};for(nt=0;nt<He.length;nt++)vt.feature=He.feature(nt),Re.writeMessage(2,ue,vt);var bt=vt.keys;for(nt=0;nt<bt.length;nt++)Re.writeStringField(3,bt[nt]);var Ze=vt.values;for(nt=0;nt<Ze.length;nt++)Re.writeMessage(4,Ke,Ze[nt])}function ue(He,Re){var nt=He.feature;nt.id!==void 0&&Re.writeVarintField(1,nt.id),Re.writeMessage(2,be,He),Re.writeVarintField(3,nt.type),Re.writeMessage(4,Ee,nt)}function be(He,Re){var nt=He.feature,vt=He.keys,bt=He.values,Ze=He.keycache,Bt=He.valuecache;for(var At in nt.properties){var Gt=nt.properties[At],pi=Ze[At];if(Gt!==null){pi===void 0&&(vt.push(At),Ze[At]=pi=vt.length-1),Re.writeVarint(pi);var st=typeof Gt;st!=="string"&&st!=="boolean"&&st!=="number"&&(Gt=JSON.stringify(Gt));var Rt=st+":"+Gt,_t=Bt[Rt];_t===void 0&&(bt.push(Gt),Bt[Rt]=_t=bt.length-1),Re.writeVarint(_t)}}}function ve(He,Re){return(Re<<3)+(7&He)}function Ie(He){return He<<1^He>>31}function Ee(He,Re){for(var nt=He.loadGeometry(),vt=He.type,bt=0,Ze=0,Bt=nt.length,At=0;At<Bt;At++){var Gt=nt[At],pi=1;vt===1&&(pi=Gt.length),Re.writeVarint(ve(1,pi));for(var st=vt===3?Gt.length-1:Gt.length,Rt=0;Rt<st;Rt++){Rt===1&&vt!==1&&Re.writeVarint(ve(2,st-1));var _t=Gt[Rt].x-bt,Xt=Gt[Rt].y-Ze;Re.writeVarint(Ie(_t)),Re.writeVarint(Ie(Xt)),bt+=_t,Ze+=Xt}vt===3&&Re.writeVarint(ve(7,1))}}function Ke(He,Re){var nt=typeof He;nt==="string"?Re.writeStringField(1,He):nt==="boolean"?Re.writeBooleanField(7,He):nt==="number"&&(He%1!=0?Re.writeDoubleField(3,He):He<0?Re.writeSVarintField(6,He):Re.writeVarintField(5,He))}return yt.exports=K,yt.exports.fromVectorTileJs=K,yt.exports.fromGeojsonVt=function(He,Re){Re=Re||{};var nt={};for(var vt in He)nt[vt]=new $(He[vt].features,Re),nt[vt].name=vt,nt[vt].version=Re.version,nt[vt].extent=Re.extent;return K({layers:nt})},yt.exports.GeoJSONWrapper=$,yt.exports}(),Qt=A.cD(St);const Bi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ce=>Ce},Si=Math.fround||(Mi=new Float32Array(1),Ce=>(Mi[0]=+Ce,Mi[0]));var Mi;const Ui=3,Ki=5,Vi=6;class Ve{constructor($){this.options=Object.assign(Object.create(Bi),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:K,minZoom:Z,maxZoom:ue}=this.options;K&&console.time("total time");const be=`prepare ${$.length} points`;K&&console.time(be),this.points=$;const ve=[];for(let Ee=0;Ee<$.length;Ee++){const Ke=$[Ee];if(!Ke.geometry)continue;const[He,Re]=Ke.geometry.coordinates,nt=Si(ui(He)),vt=Si(Te(Re));ve.push(nt,vt,1/0,Ee,-1,1),this.options.reduce&&ve.push(0)}let Ie=this.trees[ue+1]=this._createTree(ve);K&&console.timeEnd(be);for(let Ee=ue;Ee>=Z;Ee--){const Ke=+Date.now();Ie=this.trees[Ee]=this._createTree(this._cluster(Ie,Ee)),K&&console.log("z%d: %d clusters in %dms",Ee,Ie.numItems,+Date.now()-Ke)}return K&&console.timeEnd("total time"),this}getClusters($,K){let Z=(($[0]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,$[1]));let be=$[2]===180?180:(($[2]+180)%360+360)%360-180;const ve=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)Z=-180,be=180;else if(Z>be){const Re=this.getClusters([Z,ue,180,ve],K),nt=this.getClusters([-180,ue,be,ve],K);return Re.concat(nt)}const Ie=this.trees[this._limitZoom(K)],Ee=Ie.range(ui(Z),Te(ve),ui(be),Te(ue)),Ke=Ie.data,He=[];for(const Re of Ee){const nt=this.stride*Re;He.push(Ke[nt+Ki]>1?xt(Ke,nt,this.clusterProps):this.points[Ke[nt+Ui]])}return He}getChildren($){const K=this._getOriginId($),Z=this._getOriginZoom($),ue="No cluster with the specified id.",be=this.trees[Z];if(!be)throw new Error(ue);const ve=be.data;if(K*this.stride>=ve.length)throw new Error(ue);const Ie=this.options.radius/(this.options.extent*Math.pow(2,Z-1)),Ee=be.within(ve[K*this.stride],ve[K*this.stride+1],Ie),Ke=[];for(const He of Ee){const Re=He*this.stride;ve[Re+4]===$&&Ke.push(ve[Re+Ki]>1?xt(ve,Re,this.clusterProps):this.points[ve[Re+Ui]])}if(Ke.length===0)throw new Error(ue);return Ke}getLeaves($,K,Z){const ue=[];return this._appendLeaves(ue,$,K=K||10,Z=Z||0,0),ue}getTile($,K,Z){const ue=this.trees[this._limitZoom($)],be=Math.pow(2,$),{extent:ve,radius:Ie}=this.options,Ee=Ie/ve,Ke=(Z-Ee)/be,He=(Z+1+Ee)/be,Re={features:[]};return this._addTileFeatures(ue.range((K-Ee)/be,Ke,(K+1+Ee)/be,He),ue.data,K,Z,be,Re),K===0&&this._addTileFeatures(ue.range(1-Ee/be,Ke,1,He),ue.data,be,Z,be,Re),K===be-1&&this._addTileFeatures(ue.range(0,Ke,Ee/be,He),ue.data,-1,Z,be,Re),Re.features.length?Re:null}getClusterExpansionZoom($){let K=this._getOriginZoom($)-1;for(;K<=this.options.maxZoom;){const Z=this.getChildren($);if(K++,Z.length!==1)break;$=Z[0].properties.cluster_id}return K}_appendLeaves($,K,Z,ue,be){const ve=this.getChildren(K);for(const Ie of ve){const Ee=Ie.properties;if(Ee&&Ee.cluster?be+Ee.point_count<=ue?be+=Ee.point_count:be=this._appendLeaves($,Ee.cluster_id,Z,ue,be):be<ue?be++:$.push(Ie),$.length===Z)break}return be}_createTree($){const K=new A.aC($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Z=0;Z<$.length;Z+=this.stride)K.add($[Z],$[Z+1]);return K.finish(),K.data=$,K}_addTileFeatures($,K,Z,ue,be,ve){for(const Ie of $){const Ee=Ie*this.stride,Ke=K[Ee+Ki]>1;let He,Re,nt;if(Ke)He=jt(K,Ee,this.clusterProps),Re=K[Ee],nt=K[Ee+1];else{const Ze=this.points[K[Ee+Ui]];He=Ze.properties;const[Bt,At]=Ze.geometry.coordinates;Re=ui(Bt),nt=Te(At)}const vt={type:1,geometry:[[Math.round(this.options.extent*(Re*be-Z)),Math.round(this.options.extent*(nt*be-ue))]],tags:He};let bt;bt=Ke||this.options.generateId?K[Ee+Ui]:this.points[K[Ee+Ui]].id,bt!==void 0&&(vt.id=bt),ve.features.push(vt)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,K){const{radius:Z,extent:ue,reduce:be,minPoints:ve}=this.options,Ie=Z/(ue*Math.pow(2,K)),Ee=$.data,Ke=[],He=this.stride;for(let Re=0;Re<Ee.length;Re+=He){if(Ee[Re+2]<=K)continue;Ee[Re+2]=K;const nt=Ee[Re],vt=Ee[Re+1],bt=$.within(Ee[Re],Ee[Re+1],Ie),Ze=Ee[Re+Ki];let Bt=Ze;for(const At of bt){const Gt=At*He;Ee[Gt+2]>K&&(Bt+=Ee[Gt+Ki])}if(Bt>Ze&&Bt>=ve){let At,Gt=nt*Ze,pi=vt*Ze,st=-1;const Rt=((Re/He|0)<<5)+(K+1)+this.points.length;for(const _t of bt){const Xt=_t*He;if(Ee[Xt+2]<=K)continue;Ee[Xt+2]=K;const fn=Ee[Xt+Ki];Gt+=Ee[Xt]*fn,pi+=Ee[Xt+1]*fn,Ee[Xt+4]=Rt,be&&(At||(At=this._map(Ee,Re,!0),st=this.clusterProps.length,this.clusterProps.push(At)),be(At,this._map(Ee,Xt)))}Ee[Re+4]=Rt,Ke.push(Gt/Bt,pi/Bt,1/0,Rt,-1,Bt),be&&Ke.push(st)}else{for(let At=0;At<He;At++)Ke.push(Ee[Re+At]);if(Bt>1)for(const At of bt){const Gt=At*He;if(!(Ee[Gt+2]<=K)){Ee[Gt+2]=K;for(let pi=0;pi<He;pi++)Ke.push(Ee[Gt+pi])}}}}return Ke}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,K,Z){if($[K+Ki]>1){const ve=this.clusterProps[$[K+Vi]];return Z?Object.assign({},ve):ve}const ue=this.points[$[K+Ui]].properties,be=this.options.map(ue);return Z&&be===ue?Object.assign({},be):be}}function xt(Ce,$,K){return{type:"Feature",id:Ce[$+Ui],properties:jt(Ce,$,K),geometry:{type:"Point",coordinates:[(Z=Ce[$],360*(Z-.5)),ct(Ce[$+1])]}};var Z}function jt(Ce,$,K){const Z=Ce[$+Ki],ue=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z,be=Ce[$+Vi],ve=be===-1?{}:Object.assign({},K[be]);return Object.assign(ve,{cluster:!0,cluster_id:Ce[$+Ui],point_count:Z,point_count_abbreviated:ue})}function ui(Ce){return Ce/360+.5}function Te(Ce){const $=Math.sin(Ce*Math.PI/180),K=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return K<0?0:K>1?1:K}function ct(Ce){const $=(180-360*Ce)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function Et(Ce,$,K,Z){let ue=Z;const be=$+(K-$>>1);let ve,Ie=K-$;const Ee=Ce[$],Ke=Ce[$+1],He=Ce[K],Re=Ce[K+1];for(let nt=$+3;nt<K;nt+=3){const vt=wt(Ce[nt],Ce[nt+1],Ee,Ke,He,Re);if(vt>ue)ve=nt,ue=vt;else if(vt===ue){const bt=Math.abs(nt-be);bt<Ie&&(ve=nt,Ie=bt)}}ue>Z&&(ve-$>3&&Et(Ce,$,ve,Z),Ce[ve+2]=ue,K-ve>3&&Et(Ce,ve,K,Z))}function wt(Ce,$,K,Z,ue,be){let ve=ue-K,Ie=be-Z;if(ve!==0||Ie!==0){const Ee=((Ce-K)*ve+($-Z)*Ie)/(ve*ve+Ie*Ie);Ee>1?(K=ue,Z=be):Ee>0&&(K+=ve*Ee,Z+=Ie*Ee)}return ve=Ce-K,Ie=$-Z,ve*ve+Ie*Ie}function Ot(Ce,$,K,Z){const ue={id:Ce??null,type:$,geometry:K,tags:Z,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if($==="Point"||$==="MultiPoint"||$==="LineString")$t(ue,K);else if($==="Polygon")$t(ue,K[0]);else if($==="MultiLineString")for(const be of K)$t(ue,be);else if($==="MultiPolygon")for(const be of K)$t(ue,be[0]);return ue}function $t(Ce,$){for(let K=0;K<$.length;K+=3)Ce.minX=Math.min(Ce.minX,$[K]),Ce.minY=Math.min(Ce.minY,$[K+1]),Ce.maxX=Math.max(Ce.maxX,$[K]),Ce.maxY=Math.max(Ce.maxY,$[K+1])}function qt(Ce,$,K,Z){if(!$.geometry)return;const ue=$.geometry.coordinates;if(ue&&ue.length===0)return;const be=$.geometry.type,ve=Math.pow(K.tolerance/((1<<K.maxZoom)*K.extent),2);let Ie=[],Ee=$.id;if(K.promoteId?Ee=$.properties[K.promoteId]:K.generateId&&(Ee=Z||0),be==="Point")kn(ue,Ie);else if(be==="MultiPoint")for(const Ke of ue)kn(Ke,Ie);else if(be==="LineString")Ai(ue,Ie,ve,!1);else if(be==="MultiLineString"){if(K.lineMetrics){for(const Ke of ue)Ie=[],Ai(Ke,Ie,ve,!1),Ce.push(Ot(Ee,"LineString",Ie,$.properties));return}Ln(ue,Ie,ve,!1)}else if(be==="Polygon")Ln(ue,Ie,ve,!0);else{if(be!=="MultiPolygon"){if(be==="GeometryCollection"){for(const Ke of $.geometry.geometries)qt(Ce,{id:Ee,geometry:Ke,properties:$.properties},K,Z);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ke of ue){const He=[];Ln(Ke,He,ve,!0),Ie.push(He)}}Ce.push(Ot(Ee,be,Ie,$.properties))}function kn(Ce,$){$.push(vo(Ce[0]),Vn(Ce[1]),0)}function Ai(Ce,$,K,Z){let ue,be,ve=0;for(let Ee=0;Ee<Ce.length;Ee++){const Ke=vo(Ce[Ee][0]),He=Vn(Ce[Ee][1]);$.push(Ke,He,0),Ee>0&&(ve+=Z?(ue*He-Ke*be)/2:Math.sqrt(Math.pow(Ke-ue,2)+Math.pow(He-be,2))),ue=Ke,be=He}const Ie=$.length-3;$[2]=1,Et($,0,Ie,K),$[Ie+2]=1,$.size=Math.abs(ve),$.start=0,$.end=$.size}function Ln(Ce,$,K,Z){for(let ue=0;ue<Ce.length;ue++){const be=[];Ai(Ce[ue],be,K,Z),$.push(be)}}function vo(Ce){return Ce/360+.5}function Vn(Ce){const $=Math.sin(Ce*Math.PI/180),K=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return K<0?0:K>1?1:K}function Cn(Ce,$,K,Z,ue,be,ve,Ie){if(Z/=$,be>=(K/=$)&&ve<Z)return Ce;if(ve<K||be>=Z)return null;const Ee=[];for(const Ke of Ce){const He=Ke.geometry;let Re=Ke.type;const nt=ue===0?Ke.minX:Ke.minY,vt=ue===0?Ke.maxX:Ke.maxY;if(nt>=K&&vt<Z){Ee.push(Ke);continue}if(vt<K||nt>=Z)continue;let bt=[];if(Re==="Point"||Re==="MultiPoint")Fr(He,bt,K,Z,ue);else if(Re==="LineString")Wi(He,bt,K,Z,ue,!1,Ie.lineMetrics);else if(Re==="MultiLineString")bo(He,bt,K,Z,ue,!1);else if(Re==="Polygon")bo(He,bt,K,Z,ue,!0);else if(Re==="MultiPolygon")for(const Ze of He){const Bt=[];bo(Ze,Bt,K,Z,ue,!0),Bt.length&&bt.push(Bt)}if(bt.length){if(Ie.lineMetrics&&Re==="LineString"){for(const Ze of bt)Ee.push(Ot(Ke.id,Re,Ze,Ke.tags));continue}Re!=="LineString"&&Re!=="MultiLineString"||(bt.length===1?(Re="LineString",bt=bt[0]):Re="MultiLineString"),Re!=="Point"&&Re!=="MultiPoint"||(Re=bt.length===3?"Point":"MultiPoint"),Ee.push(Ot(Ke.id,Re,bt,Ke.tags))}}return Ee.length?Ee:null}function Fr(Ce,$,K,Z,ue){for(let be=0;be<Ce.length;be+=3){const ve=Ce[be+ue];ve>=K&&ve<=Z&&Mn($,Ce[be],Ce[be+1],Ce[be+2])}}function Wi(Ce,$,K,Z,ue,be,ve){let Ie=xo(Ce);const Ee=ue===0?$a:za;let Ke,He,Re=Ce.start;for(let Bt=0;Bt<Ce.length-3;Bt+=3){const At=Ce[Bt],Gt=Ce[Bt+1],pi=Ce[Bt+2],st=Ce[Bt+3],Rt=Ce[Bt+4],_t=ue===0?At:Gt,Xt=ue===0?st:Rt;let fn=!1;ve&&(Ke=Math.sqrt(Math.pow(At-st,2)+Math.pow(Gt-Rt,2))),_t<K?Xt>K&&(He=Ee(Ie,At,Gt,st,Rt,K),ve&&(Ie.start=Re+Ke*He)):_t>Z?Xt<Z&&(He=Ee(Ie,At,Gt,st,Rt,Z),ve&&(Ie.start=Re+Ke*He)):Mn(Ie,At,Gt,pi),Xt<K&&_t>=K&&(He=Ee(Ie,At,Gt,st,Rt,K),fn=!0),Xt>Z&&_t<=Z&&(He=Ee(Ie,At,Gt,st,Rt,Z),fn=!0),!be&&fn&&(ve&&(Ie.end=Re+Ke*He),$.push(Ie),Ie=xo(Ce)),ve&&(Re+=Ke)}let nt=Ce.length-3;const vt=Ce[nt],bt=Ce[nt+1],Ze=ue===0?vt:bt;Ze>=K&&Ze<=Z&&Mn(Ie,vt,bt,Ce[nt+2]),nt=Ie.length-3,be&&nt>=3&&(Ie[nt]!==Ie[0]||Ie[nt+1]!==Ie[1])&&Mn(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&$.push(Ie)}function xo(Ce){const $=[];return $.size=Ce.size,$.start=Ce.start,$.end=Ce.end,$}function bo(Ce,$,K,Z,ue,be){for(const ve of Ce)Wi(ve,$,K,Z,ue,be,!1)}function Mn(Ce,$,K,Z){Ce.push($,K,Z)}function $a(Ce,$,K,Z,ue,be){const ve=(be-$)/(Z-$);return Mn(Ce,be,K+(ue-K)*ve,1),ve}function za(Ce,$,K,Z,ue,be){const ve=(be-K)/(ue-K);return Mn(Ce,$+(Z-$)*ve,be,1),ve}function Jr(Ce,$){const K=[];for(let Z=0;Z<Ce.length;Z++){const ue=Ce[Z],be=ue.type;let ve;if(be==="Point"||be==="MultiPoint"||be==="LineString")ve=lr(ue.geometry,$);else if(be==="MultiLineString"||be==="Polygon"){ve=[];for(const Ie of ue.geometry)ve.push(lr(Ie,$))}else if(be==="MultiPolygon"){ve=[];for(const Ie of ue.geometry){const Ee=[];for(const Ke of Ie)Ee.push(lr(Ke,$));ve.push(Ee)}}K.push(Ot(ue.id,be,ve,ue.tags))}return K}function lr(Ce,$){const K=[];K.size=Ce.size,Ce.start!==void 0&&(K.start=Ce.start,K.end=Ce.end);for(let Z=0;Z<Ce.length;Z+=3)K.push(Ce[Z]+$,Ce[Z+1],Ce[Z+2]);return K}function pt(Ce,$){if(Ce.transformed)return Ce;const K=1<<Ce.z,Z=Ce.x,ue=Ce.y;for(const be of Ce.features){const ve=be.geometry,Ie=be.type;if(be.geometry=[],Ie===1)for(let Ee=0;Ee<ve.length;Ee+=2)be.geometry.push(Mt(ve[Ee],ve[Ee+1],$,K,Z,ue));else for(let Ee=0;Ee<ve.length;Ee++){const Ke=[];for(let He=0;He<ve[Ee].length;He+=2)Ke.push(Mt(ve[Ee][He],ve[Ee][He+1],$,K,Z,ue));be.geometry.push(Ke)}}return Ce.transformed=!0,Ce}function Mt(Ce,$,K,Z,ue,be){return[Math.round(K*(Ce*Z-ue)),Math.round(K*($*Z-be))]}function hi(Ce,$,K,Z,ue){const be=$===ue.maxZoom?0:ue.tolerance/((1<<$)*ue.extent),ve={features:[],numPoints:0,numSimplified:0,numFeatures:Ce.length,source:null,x:K,y:Z,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ie of Ce)Ri(ve,Ie,be,ue);return ve}function Ri(Ce,$,K,Z){const ue=$.geometry,be=$.type,ve=[];if(Ce.minX=Math.min(Ce.minX,$.minX),Ce.minY=Math.min(Ce.minY,$.minY),Ce.maxX=Math.max(Ce.maxX,$.maxX),Ce.maxY=Math.max(Ce.maxY,$.maxY),be==="Point"||be==="MultiPoint")for(let Ie=0;Ie<ue.length;Ie+=3)ve.push(ue[Ie],ue[Ie+1]),Ce.numPoints++,Ce.numSimplified++;else if(be==="LineString")xn(ve,ue,Ce,K,!1,!1);else if(be==="MultiLineString"||be==="Polygon")for(let Ie=0;Ie<ue.length;Ie++)xn(ve,ue[Ie],Ce,K,be==="Polygon",Ie===0);else if(be==="MultiPolygon")for(let Ie=0;Ie<ue.length;Ie++){const Ee=ue[Ie];for(let Ke=0;Ke<Ee.length;Ke++)xn(ve,Ee[Ke],Ce,K,!0,Ke===0)}if(ve.length){let Ie=$.tags||null;if(be==="LineString"&&Z.lineMetrics){Ie={};for(const Ke in $.tags)Ie[Ke]=$.tags[Ke];Ie.mapbox_clip_start=ue.start/ue.size,Ie.mapbox_clip_end=ue.end/ue.size}const Ee={geometry:ve,type:be==="Polygon"||be==="MultiPolygon"?3:be==="LineString"||be==="MultiLineString"?2:1,tags:Ie};$.id!==null&&(Ee.id=$.id),Ce.features.push(Ee)}}function xn(Ce,$,K,Z,ue,be){const ve=Z*Z;if(Z>0&&$.size<(ue?ve:Z))return void(K.numPoints+=$.length/3);const Ie=[];for(let Ee=0;Ee<$.length;Ee+=3)(Z===0||$[Ee+2]>ve)&&(K.numSimplified++,Ie.push($[Ee],$[Ee+1])),K.numPoints++;ue&&function(Ee,Ke){let He=0;for(let Re=0,nt=Ee.length,vt=nt-2;Re<nt;vt=Re,Re+=2)He+=(Ee[Re]-Ee[vt])*(Ee[Re+1]+Ee[vt+1]);if(He>0===Ke)for(let Re=0,nt=Ee.length;Re<nt/2;Re+=2){const vt=Ee[Re],bt=Ee[Re+1];Ee[Re]=Ee[nt-2-Re],Ee[Re+1]=Ee[nt-1-Re],Ee[nt-2-Re]=vt,Ee[nt-1-Re]=bt}}(Ie,be),Ce.push(Ie)}const un={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class hn{constructor($,K){const Z=(K=this.options=function(be,ve){for(const Ie in ve)be[Ie]=ve[Ie];return be}(Object.create(un),K)).debug;if(Z&&console.time("preprocess data"),K.maxZoom<0||K.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(K.promoteId&&K.generateId)throw new Error("promoteId and generateId cannot be used together.");let ue=function(be,ve){const Ie=[];if(be.type==="FeatureCollection")for(let Ee=0;Ee<be.features.length;Ee++)qt(Ie,be.features[Ee],ve,Ee);else qt(Ie,be.type==="Feature"?be:{geometry:be},ve);return Ie}($,K);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",K.indexMaxZoom,K.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ue=function(be,ve){const Ie=ve.buffer/ve.extent;let Ee=be;const Ke=Cn(be,1,-1-Ie,Ie,0,-1,2,ve),He=Cn(be,1,1-Ie,2+Ie,0,-1,2,ve);return(Ke||He)&&(Ee=Cn(be,1,-Ie,1+Ie,0,-1,2,ve)||[],Ke&&(Ee=Jr(Ke,1).concat(Ee)),He&&(Ee=Ee.concat(Jr(He,-1)))),Ee}(ue,K),ue.length&&this.splitTile(ue,0,0,0),Z&&(ue.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile($,K,Z,ue,be,ve,Ie){const Ee=[$,K,Z,ue],Ke=this.options,He=Ke.debug;for(;Ee.length;){ue=Ee.pop(),Z=Ee.pop(),K=Ee.pop(),$=Ee.pop();const Re=1<<K,nt=zi(K,Z,ue);let vt=this.tiles[nt];if(!vt&&(He>1&&console.time("creation"),vt=this.tiles[nt]=hi($,K,Z,ue,Ke),this.tileCoords.push({z:K,x:Z,y:ue}),He)){He>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",K,Z,ue,vt.numFeatures,vt.numPoints,vt.numSimplified),console.timeEnd("creation"));const fn=`z${K}`;this.stats[fn]=(this.stats[fn]||0)+1,this.total++}if(vt.source=$,be==null){if(K===Ke.indexMaxZoom||vt.numPoints<=Ke.indexMaxPoints)continue}else{if(K===Ke.maxZoom||K===be)continue;if(be!=null){const fn=be-K;if(Z!==ve>>fn||ue!==Ie>>fn)continue}}if(vt.source=null,$.length===0)continue;He>1&&console.time("clipping");const bt=.5*Ke.buffer/Ke.extent,Ze=.5-bt,Bt=.5+bt,At=1+bt;let Gt=null,pi=null,st=null,Rt=null,_t=Cn($,Re,Z-bt,Z+Bt,0,vt.minX,vt.maxX,Ke),Xt=Cn($,Re,Z+Ze,Z+At,0,vt.minX,vt.maxX,Ke);$=null,_t&&(Gt=Cn(_t,Re,ue-bt,ue+Bt,1,vt.minY,vt.maxY,Ke),pi=Cn(_t,Re,ue+Ze,ue+At,1,vt.minY,vt.maxY,Ke),_t=null),Xt&&(st=Cn(Xt,Re,ue-bt,ue+Bt,1,vt.minY,vt.maxY,Ke),Rt=Cn(Xt,Re,ue+Ze,ue+At,1,vt.minY,vt.maxY,Ke),Xt=null),He>1&&console.timeEnd("clipping"),Ee.push(Gt||[],K+1,2*Z,2*ue),Ee.push(pi||[],K+1,2*Z,2*ue+1),Ee.push(st||[],K+1,2*Z+1,2*ue),Ee.push(Rt||[],K+1,2*Z+1,2*ue+1)}}getTile($,K,Z){$=+$,K=+K,Z=+Z;const ue=this.options,{extent:be,debug:ve}=ue;if($<0||$>24)return null;const Ie=1<<$,Ee=zi($,K=K+Ie&Ie-1,Z);if(this.tiles[Ee])return pt(this.tiles[Ee],be);ve>1&&console.log("drilling down to z%d-%d-%d",$,K,Z);let Ke,He=$,Re=K,nt=Z;for(;!Ke&&He>0;)He--,Re>>=1,nt>>=1,Ke=this.tiles[zi(He,Re,nt)];return Ke&&Ke.source?(ve>1&&(console.log("found parent tile z%d-%d-%d",He,Re,nt),console.time("drilling down")),this.splitTile(Ke.source,He,Re,nt,$,K,Z),ve>1&&console.timeEnd("drilling down"),this.tiles[Ee]?pt(this.tiles[Ee],be):null):null}}function zi(Ce,$,K){return 32*((1<<Ce)*K+$)+Ce}function dn(Ce,$){return $?Ce.properties[$]:Ce.id}function An(Ce,$){if(Ce==null)return!0;if(Ce.type==="Feature")return dn(Ce,$)!=null;if(Ce.type==="FeatureCollection"){const K=new Set;for(const Z of Ce.features){const ue=dn(Z,$);if(ue==null||K.has(ue))return!1;K.add(ue)}return!0}return!1}function ea(Ce,$){const K=new Map;if(Ce!=null)if(Ce.type==="Feature")K.set(dn(Ce,$),Ce);else for(const Z of Ce.features)K.set(dn(Z,$),Z);return K}class ta extends ze{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile($,K){return A._(this,void 0,void 0,function*(){const Z=$.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ue=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!ue)return null;const be=new qe(ue.features);let ve=Qt(be);return ve.byteOffset===0&&ve.byteLength===ve.buffer.byteLength||(ve=new Uint8Array(ve)),{vectorTile:be,rawData:ve.buffer}})}loadData($){return A._(this,void 0,void 0,function*(){var K;(K=this._pendingRequest)===null||K===void 0||K.abort();const Z=!!($&&$.request&&$.request.collectResourceTiming)&&new A.cA($.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON($,this._pendingRequest),this._geoJSONIndex=$.cluster?new Ve(function({superclusterOptions:ve,clusterProperties:Ie}){if(!Ie||!ve)return ve;const Ee={},Ke={},He={accumulated:null,zoom:0},Re={properties:null},nt=Object.keys(Ie);for(const vt of nt){const[bt,Ze]=Ie[vt],Bt=A.cH(Ze),At=A.cH(typeof bt=="string"?[bt,["accumulated"],["get",vt]]:bt);Ee[vt]=Bt.value,Ke[vt]=At.value}return ve.map=vt=>{Re.properties=vt;const bt={};for(const Ze of nt)bt[Ze]=Ee[Ze].evaluate(He,Re);return bt},ve.reduce=(vt,bt)=>{Re.properties=bt;for(const Ze of nt)He.accumulated=vt[Ze],vt[Ze]=Ke[Ze].evaluate(He,Re)},ve}($)).load((yield this._pendingData).features):(ue=yield this._pendingData,new hn(ue,$.geojsonVtOptions)),this.loaded={};const be={};if(Z){const ve=Z.finish();ve&&(be.resourceTiming={},be.resourceTiming[$.source]=JSON.parse(JSON.stringify(ve)))}return be}catch(be){if(delete this._pendingRequest,A.cl(be))return{abandoned:!0};throw be}var ue})}getData(){return A._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile($){const K=this.loaded;return K&&K[$.uid]?super.reloadTile($):this.loadTile($)}loadAndProcessGeoJSON($,K){return A._(this,void 0,void 0,function*(){let Z=yield this.loadGeoJSON($,K);if(delete this._pendingRequest,typeof Z!="object")throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(Me(Z,!0),$.filter){const ue=A.cH($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ue.result==="error")throw new Error(ue.value.map(ve=>`${ve.key}: ${ve.message}`).join(", "));Z={type:"FeatureCollection",features:Z.features.filter(ve=>ue.value.evaluate({zoom:0},ve))}}return Z})}loadGeoJSON($,K){return A._(this,void 0,void 0,function*(){const{promoteId:Z}=$;if($.request){const ue=yield A.j($.request,K);return this._dataUpdateable=An(ue.data,Z)?ea(ue.data,Z):void 0,ue.data}if(typeof $.data=="string")try{const ue=JSON.parse($.data);return this._dataUpdateable=An(ue,Z)?ea(ue,Z):void 0,ue}catch{throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`)}if(!$.dataDiff)throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${$.source}`);return function(ue,be,ve){var Ie,Ee,Ke,He;if(be.removeAll&&ue.clear(),be.remove)for(const Re of be.remove)ue.delete(Re);if(be.add)for(const Re of be.add){const nt=dn(Re,ve);nt!=null&&ue.set(nt,Re)}if(be.update)for(const Re of be.update){let nt=ue.get(Re.id);if(nt==null)continue;const vt=!Re.removeAllProperties&&(((Ie=Re.removeProperties)===null||Ie===void 0?void 0:Ie.length)>0||((Ee=Re.addOrUpdateProperties)===null||Ee===void 0?void 0:Ee.length)>0);if((Re.newGeometry||Re.removeAllProperties||vt)&&(nt=Object.assign({},nt),ue.set(Re.id,nt),vt&&(nt.properties=Object.assign({},nt.properties))),Re.newGeometry&&(nt.geometry=Re.newGeometry),Re.removeAllProperties)nt.properties={};else if(((Ke=Re.removeProperties)===null||Ke===void 0?void 0:Ke.length)>0)for(const bt of Re.removeProperties)Object.prototype.hasOwnProperty.call(nt.properties,bt)&&delete nt.properties[bt];if(((He=Re.addOrUpdateProperties)===null||He===void 0?void 0:He.length)>0)for(const{key:bt,value:Ze}of Re.addOrUpdateProperties)nt.properties[bt]=Ze}}(this._dataUpdateable,$.dataDiff,Z),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource($){return A._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom($){return this._geoJSONIndex.getClusterExpansionZoom($.clusterId)}getClusterChildren($){return this._geoJSONIndex.getChildren($.clusterId)}getClusterLeaves($){return this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset)}}class Nr{constructor($){this.self=$,this.actor=new A.H($),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(K,Z)=>{if(this.externalWorkerSourceTypes[K])throw new Error(`Worker source with name "${K}" already registered.`);this.externalWorkerSourceTypes[K]=Z},this.self.addProtocol=A.cn,this.self.removeProtocol=A.co,this.self.registerRTLTextPlugin=K=>{A.cI.setMethods(K)},this.actor.registerMessageHandler("LDT",(K,Z)=>this._getDEMWorkerSource(K,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RDT",(K,Z)=>A._(this,void 0,void 0,function*(){this._getDEMWorkerSource(K,Z.source).removeTile(Z)})),this.actor.registerMessageHandler("GCEZ",(K,Z)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(K,Z.type,Z.source).getClusterExpansionZoom(Z)})),this.actor.registerMessageHandler("GCC",(K,Z)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(K,Z.type,Z.source).getClusterChildren(Z)})),this.actor.registerMessageHandler("GCL",(K,Z)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(K,Z.type,Z.source).getClusterLeaves(Z)})),this.actor.registerMessageHandler("LD",(K,Z)=>this._getWorkerSource(K,Z.type,Z.source).loadData(Z)),this.actor.registerMessageHandler("GD",(K,Z)=>this._getWorkerSource(K,Z.type,Z.source).getData()),this.actor.registerMessageHandler("LT",(K,Z)=>this._getWorkerSource(K,Z.type,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RT",(K,Z)=>this._getWorkerSource(K,Z.type,Z.source).reloadTile(Z)),this.actor.registerMessageHandler("AT",(K,Z)=>this._getWorkerSource(K,Z.type,Z.source).abortTile(Z)),this.actor.registerMessageHandler("RMT",(K,Z)=>this._getWorkerSource(K,Z.type,Z.source).removeTile(Z)),this.actor.registerMessageHandler("RS",(K,Z)=>A._(this,void 0,void 0,function*(){if(!this.workerSources[K]||!this.workerSources[K][Z.type]||!this.workerSources[K][Z.type][Z.source])return;const ue=this.workerSources[K][Z.type][Z.source];delete this.workerSources[K][Z.type][Z.source],ue.removeSource!==void 0&&ue.removeSource(Z)})),this.actor.registerMessageHandler("RM",K=>A._(this,void 0,void 0,function*(){delete this.layerIndexes[K],delete this.availableImages[K],delete this.workerSources[K],delete this.demWorkerSources[K]})),this.actor.registerMessageHandler("SR",(K,Z)=>A._(this,void 0,void 0,function*(){this.referrer=Z})),this.actor.registerMessageHandler("SRPS",(K,Z)=>this._syncRTLPluginState(K,Z)),this.actor.registerMessageHandler("IS",(K,Z)=>A._(this,void 0,void 0,function*(){this.self.importScripts(Z)})),this.actor.registerMessageHandler("SI",(K,Z)=>this._setImages(K,Z)),this.actor.registerMessageHandler("UL",(K,Z)=>A._(this,void 0,void 0,function*(){this._getLayerIndex(K).update(Z.layers,Z.removedIds)})),this.actor.registerMessageHandler("SL",(K,Z)=>A._(this,void 0,void 0,function*(){this._getLayerIndex(K).replace(Z)}))}_setImages($,K){return A._(this,void 0,void 0,function*(){this.availableImages[$]=K;for(const Z in this.workerSources[$]){const ue=this.workerSources[$][Z];for(const be in ue)ue[be].availableImages=K}})}_syncRTLPluginState($,K){return A._(this,void 0,void 0,function*(){return yield A.cI.syncState(K,this.self.importScripts)})}_getAvailableImages($){let K=this.availableImages[$];return K||(K=[]),K}_getLayerIndex($){let K=this.layerIndexes[$];return K||(K=this.layerIndexes[$]=new u),K}_getWorkerSource($,K,Z){if(this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][K]||(this.workerSources[$][K]={}),!this.workerSources[$][K][Z]){const ue={sendAsync:(be,ve)=>(be.targetMapId=$,this.actor.sendAsync(be,ve))};switch(K){case"vector":this.workerSources[$][K][Z]=new ze(ue,this._getLayerIndex($),this._getAvailableImages($));break;case"geojson":this.workerSources[$][K][Z]=new ta(ue,this._getLayerIndex($),this._getAvailableImages($));break;default:this.workerSources[$][K][Z]=new this.externalWorkerSourceTypes[K](ue,this._getLayerIndex($),this._getAvailableImages($))}}return this.workerSources[$][K][Z]}_getDEMWorkerSource($,K){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][K]||(this.demWorkerSources[$][K]=new _e),this.demWorkerSources[$][K]}}return A.i(self)&&(self.worker=new Nr(self)),Nr}),L("index",["exports","./shared"],function(A,u){var re="5.3.0";function Q(){var f=new u.A(4);return u.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let ce,ze;const _e={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,n){const l=requestAnimationFrame(m=>{h(),e(m)}),{unsubscribe:h}=u.s(f.signal,"abort",()=>{h(),cancelAnimationFrame(l),n(u.c())},!1)},frameAsync(f){return new Promise((e,n)=>{this.frame(f,e,n)})},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,n.drawImage(f,0,0,f.width,f.height),n},resolveURL:f=>(ce||(ce=document.createElement("a")),ce.href=f,ce.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ze==null&&(ze=matchMedia("(prefers-reduced-motion: reduce)")),ze.matches)}};class ie{static testProp(e){if(!ie.docStyle)return e[0];for(let n=0;n<e.length;n++)if(e[n]in ie.docStyle)return e[n];return e[0]}static create(e,n,l){const h=window.document.createElement(e);return n!==void 0&&(h.className=n),l&&l.appendChild(h),h}static createNS(e,n){return window.document.createElementNS(e,n)}static disableDrag(){ie.docStyle&&ie.selectProp&&(ie.userSelect=ie.docStyle[ie.selectProp],ie.docStyle[ie.selectProp]="none")}static enableDrag(){ie.docStyle&&ie.selectProp&&(ie.docStyle[ie.selectProp]=ie.userSelect)}static setTransform(e,n){e.style[ie.transformProp]=n}static addEventListener(e,n,l,h={}){e.addEventListener(n,l,"passive"in h?h:h.capture)}static removeEventListener(e,n,l,h={}){e.removeEventListener(n,l,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ie.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ie.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ie.suppressClickInternal,!0)},0)}static getScale(e){const n=e.getBoundingClientRect();return{x:n.width/e.offsetWidth||1,y:n.height/e.offsetHeight||1,boundingClientRect:n}}static getPoint(e,n,l){const h=n.boundingClientRect;return new u.P((l.clientX-h.left)/n.x-e.clientLeft,(l.clientY-h.top)/n.y-e.clientTop)}static mousePos(e,n){const l=ie.getScale(e);return ie.getPoint(e,l,n)}static touchPos(e,n){const l=[],h=ie.getScale(e);for(let m=0;m<n.length;m++)l.push(ie.getPoint(e,h,n[m]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=n.querySelectorAll("script");for(const h of l)h.remove();return ie.clean(n),n.innerHTML}static isPossiblyDangerous(e,n){const l=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const n=e.children;for(const l of n)ie.removeAttributes(l),ie.clean(l)}static removeAttributes(e){for(const{name:n,value:l}of e.attributes)ie.isPossiblyDangerous(n,l)&&e.removeAttribute(n)}}ie.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ie.selectProp=ie.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ie.transformProp=ie.testProp(["transform","WebkitTransform"]);const he={supported:!1,testSupport:function(f){!Oe&&Me&&(Fe?qe(f):je=f)}};let je,Me,Oe=!1,Fe=!1;function qe(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Me),f.isContextLost())return;he.supported=!0}catch{}f.deleteTexture(e),Oe=!0}var dt;typeof document<"u"&&(Me=document.createElement("img"),Me.onload=()=>{je&&qe(je),je=null,Fe=!0},Me.onerror=()=>{Oe=!0,je=null},Me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,n,l,h;f.resetRequestQueue=()=>{e=[],n=0,l=0,h={}},f.addThrottleControl=S=>{const z=l++;return h[z]=S,z},f.removeThrottleControl=S=>{delete h[S],y()},f.getImage=(S,z,k=!0)=>new Promise((O,B)=>{he.supported&&(S.headers||(S.headers={}),S.headers.accept="image/webp,*/*"),u.e(S,{type:"image"}),e.push({abortController:z,requestParameters:S,supportImageRefresh:k,state:"queued",onError:q=>{B(q)},onSuccess:q=>{O(q)}}),y()});const m=S=>u._(this,void 0,void 0,function*(){S.state="running";const{requestParameters:z,supportImageRefresh:k,onError:O,onSuccess:B,abortController:q}=S,Y=k===!1&&!u.i(self)&&!u.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce((ae,se)=>ae&&se==="accept",!0));n++;const ne=Y?w(z,q):u.m(z,q);try{const ae=yield ne;delete S.abortController,S.state="completed",ae.data instanceof HTMLImageElement||u.b(ae.data)?B(ae):ae.data&&B({data:yield(te=ae.data,typeof createImageBitmap=="function"?u.f(te):u.h(te)),cacheControl:ae.cacheControl,expires:ae.expires})}catch(ae){delete S.abortController,O(ae)}finally{n--,y()}var te}),y=()=>{const S=(()=>{for(const z of Object.keys(h))if(h[z]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=n;z<S&&e.length>0;z++){const k=e.shift();k.abortController.signal.aborted?z--:m(k)}},w=(S,z)=>new Promise((k,O)=>{const B=new Image,q=S.url,Y=S.credentials;Y&&Y==="include"?B.crossOrigin="use-credentials":(Y&&Y==="same-origin"||!u.d(q))&&(B.crossOrigin="anonymous"),z.signal.addEventListener("abort",()=>{B.src="",O(u.c())}),B.fetchPriority="high",B.onload=()=>{B.onerror=B.onload=null,k({data:B})},B.onerror=()=>{B.onerror=B.onload=null,z.signal.aborted||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},B.src=q})}(dt||(dt={})),dt.resetRequestQueue();class mt{constructor(e){this._transformRequestFn=e}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function zt(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const n=[];for(const{id:l,url:h}of f){const m=`${l}${h}`;n.indexOf(m)===-1&&(n.push(m),e.push({id:l,url:h}))}}return e}function yt(f,e,n){try{const l=new URL(f);return l.pathname+=`${e}${n}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class St{constructor(e,n,l,h){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(n,h)}update(e,n,l){const{width:h,height:m}=e,y=!(this.size&&this.size[0]===h&&this.size[1]===m||l),{context:w}=this,{gl:S}=w;if(this.useMipmap=!!(n&&n.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!n||n.premultiply!==!1)),y)this.size=[h,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||u.b(e)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,e):S.texImage2D(S.TEXTURE_2D,0,this.format,h,m,0,this.format,S.UNSIGNED_BYTE,e.data);else{const{x:z,y:k}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||u.b(e)?S.texSubImage2D(S.TEXTURE_2D,0,z,k,S.RGBA,S.UNSIGNED_BYTE,e):S.texSubImage2D(S.TEXTURE_2D,0,z,k,h,m,S.RGBA,S.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(e,n,l){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),l!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,l||e),this.filter=e),n!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Qt(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class Bi extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:n,promiseResolve:l}of this.requestors)l(this._getImagesForIds(n));this.requestors=[]}}getImage(e){const n=this.images[e];if(n&&!n.data&&n.spriteData){const l=n.spriteData;n.data=new u.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),n.spriteData=null}return n}addImage(e,n){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,n)&&(this.images[e]=n)}_validate(e,n){let l=!0;const h=n.data||n.spriteData;return this._validateStretch(n.stretchX,h&&h.width)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(n.stretchY,h&&h.height)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(n.content,n)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,n){if(!e)return!0;let l=0;for(const h of e){if(h[0]<l||h[1]<h[0]||n<h[1])return!1;l=h[1]}return!0}_validateContent(e,n){if(!e)return!0;if(e.length!==4)return!1;const l=n.spriteData,h=l&&l.width||n.data.width,m=l&&l.height||n.data.height;return!(e[0]<0||h<e[0]||e[1]<0||m<e[1]||e[2]<0||h<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,n,l=!0){const h=this.getImage(e);if(l&&(h.data.width!==n.data.width||h.data.height!==n.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=h.version+1,this.images[e]=n,this.updatedImages[e]=!0}removeImage(e){const n=this.images[e];delete this.images[e],delete this.patterns[e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((n,l)=>{let h=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(h=!1);this.isLoaded()||h?n(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:n})})}_getImagesForIds(e){const n={};for(const l of e){let h=this.getImage(l);h||(this.fire(new u.l("styleimagemissing",{id:l})),h=this.getImage(l)),h?n[l]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:u.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:e,height:n}=this.atlasImage;return{width:e,height:n}}getPattern(e){const n=this.patterns[e],l=this.getImage(e);if(!l)return null;if(n&&n.position.version===l.version)return n.position;if(n)n.position.version=l.version;else{const h={w:l.data.width+2,h:l.data.height+2,x:0,y:0},m=new u.I(h,l);this.patterns[e]={bin:h,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new St(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:n,h:l}=u.p(e),h=this.atlasImage;h.resize({width:n||1,height:l||1});for(const m in this.patterns){const{bin:y}=this.patterns[m],w=y.x+1,S=y.y+1,z=this.getImage(m).data,k=z.width,O=z.height;u.R.copy(z,h,{x:0,y:0},{x:w,y:S},{width:k,height:O}),u.R.copy(z,h,{x:0,y:O-1},{x:w,y:S-1},{width:k,height:1}),u.R.copy(z,h,{x:0,y:0},{x:w,y:S+O},{width:k,height:1}),u.R.copy(z,h,{x:k-1,y:0},{x:w-1,y:S},{width:1,height:O}),u.R.copy(z,h,{x:0,y:0},{x:w+k,y:S},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const l=this.getImage(n);l||u.w(`Image with ID: "${n}" was not found`),Qt(l)&&this.updateImage(n,l)}}}const Si=1e20;function Mi(f,e,n,l,h,m,y,w,S){for(let z=e;z<e+l;z++)Ui(f,n*m+z,m,h,y,w,S);for(let z=n;z<n+h;z++)Ui(f,z*m+e,1,l,y,w,S)}function Ui(f,e,n,l,h,m,y){m[0]=0,y[0]=-1e20,y[1]=Si,h[0]=f[e];for(let w=1,S=0,z=0;w<l;w++){h[w]=f[e+w*n];const k=w*w;do{const O=m[S];z=(h[w]-h[O]+k-O*O)/(w-O)/2}while(z<=y[S]&&--S>-1);S++,m[S]=w,y[S]=z,y[S+1]=Si}for(let w=0,S=0;w<l;w++){for(;y[S+1]<w;)S++;const z=m[S],k=w-z;f[e+w*n]=h[z]+k*k}}class Ki{constructor(e,n){this.requestManager=e,this.localIdeographFontFamily=n,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return u._(this,void 0,void 0,function*(){const n=[];for(const m in e)for(const y of e[m])n.push(this._getAndCacheGlyphsPromise(m,y));const l=yield Promise.all(n),h={};for(const{stack:m,id:y,glyph:w}of l)h[m]||(h[m]={}),h[m][y]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return h})}_getAndCacheGlyphsPromise(e,n){return u._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=l.glyphs[n];if(h!==void 0)return{stack:e,id:n,glyph:h};if(h=this._tinySDF(l,e,n),h)return l.glyphs[n]=h,{stack:e,id:n,glyph:h};const m=Math.floor(n/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[m])return{stack:e,id:n,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[m]){const w=Ki.loadGlyphRange(e,m,this.url,this.requestManager);l.requests[m]=w}const y=yield l.requests[m];for(const w in y)this._doesCharSupportLocalGlyph(+w)||(l.glyphs[+w]=y[+w]);return l.ranges[m]=!0,{stack:e,id:n,glyph:y[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||u.u["CJK Unified Ideographs"](e)||u.u["Hangul Syllables"](e)||u.u.Hiragana(e)||u.u.Katakana(e)||u.u["CJK Symbols and Punctuation"](e)||u.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,n,l){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let m=e.tinySDF;if(!m){let w="400";/bold/i.test(n)?w="900":/medium/i.test(n)?w="500":/light/i.test(n)&&(w="200"),m=e.tinySDF=new Ki.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:w})}const y=m.draw(String.fromCharCode(l));return{id:l,bitmap:new u.q({width:y.width||60,height:y.height||60},y.data),metrics:{width:y.glyphWidth/2||24,height:y.glyphHeight/2||24,left:y.glyphLeft/2+.5||0,top:y.glyphTop/2-27.5||-8,advance:y.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ki.loadGlyphRange=function(f,e,n,l){return u._(this,void 0,void 0,function*(){const h=256*e,m=h+255,y=l.transformRequest(n.replace("{fontstack}",f).replace("{range}",`${h}-${m}`),"Glyphs"),w=yield u.n(y,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${m}`);const S={};for(const z of u.o(w.data))S[z.id]=z;return S})},Ki.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:n=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=n;const w=this.size=f+4*e,S=this._createCanvas(w),z=this.ctx=S.getContext("2d",{willReadFrequently:!0});z.font=`${y} ${m} ${f}px ${h}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(f),y=Math.ceil(n),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),S=Math.min(this.size-this.buffer,y+Math.ceil(l)),z=w+2*this.buffer,k=S+2*this.buffer,O=Math.max(z*k,0),B=new Uint8ClampedArray(O),q={data:B,width:z,height:k,glyphWidth:w,glyphHeight:S,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(w===0||S===0)return q;const{ctx:Y,buffer:ne,gridInner:te,gridOuter:ae}=this;Y.clearRect(ne,ne,w,S),Y.fillText(f,ne,ne+y);const se=Y.getImageData(ne,ne,w,S);ae.fill(Si,0,O),te.fill(0,0,O);for(let fe=0;fe<S;fe++)for(let pe=0;pe<w;pe++){const ge=se.data[4*(fe*w+pe)+3]/255;if(ge===0)continue;const we=(fe+ne)*z+pe+ne;if(ge===1)ae[we]=0,te[we]=Si;else{const xe=.5-ge;ae[we]=xe>0?xe*xe:0,te[we]=xe<0?xe*xe:0}}Mi(ae,0,0,z,k,z,this.f,this.v,this.z),Mi(te,ne,ne,w,S,z,this.f,this.v,this.z);for(let fe=0;fe<O;fe++){const pe=Math.sqrt(ae[fe])-Math.sqrt(te[fe]);B[fe]=Math.round(255-255*(pe/this.radius+this.cutoff))}return q}};class Vi{constructor(){this.specification=u.v.light.position}possiblyEvaluate(e,n){return u.z(e.expression.evaluate(n))}interpolate(e,n,l){return{x:u.B.number(e.x,n.x,l),y:u.B.number(e.y,n.y,l),z:u.B.number(e.z,n.z,l)}}}let Ve;class xt extends u.E{constructor(e){super(),Ve=Ve||new u.r({anchor:new u.D(u.v.light.anchor),position:new Vi,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(Ve),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(u.t,e,n))for(const l in e){const h=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,l){return(!l||l.validate!==!1)&&u.x(this,e.call(u.y,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:u.v}))}}const jt=new u.r({"sky-color":new u.D(u.v.sky["sky-color"]),"horizon-color":new u.D(u.v.sky["horizon-color"]),"fog-color":new u.D(u.v.sky["fog-color"]),"fog-ground-blend":new u.D(u.v.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.v.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.v.sky["atmosphere-blend"])});class ui extends u.E{constructor(e){super(),this._transitionable=new u.T(jt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.C(0))}setSky(e,n={}){if(!this._validate(u.F,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const h=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,l={}){return(l==null?void 0:l.validate)!==!1&&u.x(this,e.call(u.y,u.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Te{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,n){const l=e.join(",")+String(n);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,n)),this.dashEntry[l]}getDashRanges(e,n,l){const h=[];let m=e.length%2==1?-e[e.length-1]*l:0,y=e[0]*l,w=!0;h.push({left:m,right:y,isDash:w,zeroLength:e[0]===0});let S=e[0];for(let z=1;z<e.length;z++){w=!w;const k=e[z];m=S*l,S+=k,y=S*l,h.push({left:m,right:y,isDash:w,zeroLength:k===0})}return h}addRoundDash(e,n,l){const h=n/2;for(let m=-l;m<=l;m++){const y=this.width*(this.nextRow+l+m);let w=0,S=e[w];for(let z=0;z<this.width;z++){z/S.right>1&&(S=e[++w]);const k=Math.abs(z-S.left),O=Math.abs(z-S.right),B=Math.min(k,O);let q;const Y=m/l*(h+1);if(S.isDash){const ne=h-Math.abs(Y);q=Math.sqrt(B*B+ne*ne)}else q=h-Math.sqrt(B*B+Y*Y);this.data[y+z]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(e){for(let w=e.length-1;w>=0;--w){const S=e[w],z=e[w+1];S.zeroLength?e.splice(w,1):z&&z.isDash===S.isDash&&(z.left=S.left,e.splice(w,1))}const n=e[0],l=e[e.length-1];n.isDash===l.isDash&&(n.left=l.left-this.width,l.right=n.right+this.width);const h=this.width*this.nextRow;let m=0,y=e[m];for(let w=0;w<this.width;w++){w/y.right>1&&(y=e[++m]);const S=Math.abs(w-y.left),z=Math.abs(w-y.right),k=Math.min(S,z);this.data[h+w]=Math.max(0,Math.min(255,(y.isDash?k:-k)+128))}}addDash(e,n){const l=n?7:0,h=2*l+1;if(this.nextRow+h>this.height)return u.w("LineAtlas out of space"),null;let m=0;for(let w=0;w<e.length;w++)m+=e[w];if(m!==0){const w=this.width/m,S=this.getDashRanges(e,this.width,w);n?this.addRoundDash(S,w,l):this.addRegularDash(S)}const y={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:m};return this.nextRow+=h,this.dirty=!0,y}bind(e){const n=e.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}const ct="maplibre_preloaded_worker_pool";class Et{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Et.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ct]}numActive(){return Object.keys(this.active).length}}const wt=Math.floor(_e.hardwareConcurrency/2);let Ot,$t;function qt(){return Ot||(Ot=new Et),Ot}Et.workerCount=u.G(globalThis)?Math.max(Math.min(wt,3),1):1;class kn{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;const l=this.workerPool.acquire(n);for(let h=0;h<l.length;h++){const m=new u.H(l[h],n);m.name=`Worker ${h}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n){const l=[];for(const h of this.actors)l.push(h.sendAsync({type:e,data:n}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,n){for(const l of this.actors)l.registerMessageHandler(e,n)}}function Ai(){return $t||($t=new kn(qt(),u.J),$t.registerMessageHandler("GR",(f,e,n)=>u.m(e,n))),$t}function Ln(f,e){const n=u.K();return u.L(n,n,[1,1,0]),u.M(n,n,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?u.N(n,n,f.calculatePosMatrix(e.toUnwrapped())):n}function vo(f,e,n,l,h,m,y){var w;const S=function(B,q,Y){if(B)for(const ne of B){const te=q[ne];if(te&&te.source===Y&&te.type==="fill-extrusion")return!0}else for(const ne in q){const te=q[ne];if(te.source===Y&&te.type==="fill-extrusion")return!0}return!1}((w=h==null?void 0:h.layers)!==null&&w!==void 0?w:null,e,f.id),z=m.maxPitchScaleFactor(),k=f.tilesIn(l,z,S);k.sort(Vn);const O=[];for(const B of k)O.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(e,n,f._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,h,m,z,Ln(f.transform,B.tileID),y?(q,Y)=>y(B.tileID,q,Y):void 0)});return function(B,q){for(const Y in B)for(const ne of B[Y])Cn(ne,q);return B}(function(B){const q={},Y={};for(const ne of B){const te=ne.queryResults,ae=ne.wrappedTileID,se=Y[ae]=Y[ae]||{};for(const fe in te){const pe=te[fe],ge=se[fe]=se[fe]||{},we=q[fe]=q[fe]||[];for(const xe of pe)ge[xe.featureIndex]||(ge[xe.featureIndex]=!0,we.push(xe))}}return q}(O),f)}function Vn(f,e){const n=f.tileID,l=e.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}function Cn(f,e){const n=f.feature,l=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=l}function Fr(f,e,n){return u._(this,void 0,void 0,function*(){let l=f;if(f.url?l=(yield u.j(e.transformRequest(f.url,"Source"),n)).data:yield _e.frameAsync(n),!l)return null;const h=u.O(u.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(h.vectorLayerIds=l.vector_layers.map(m=>m.id)),h})}class Wi{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof u.Q?new u.Q(e.lng,e.lat):u.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof u.Q?new u.Q(e.lng,e.lat):u.Q.convert(e),this}extend(e){const n=this._sw,l=this._ne;let h,m;if(e instanceof u.Q)h=e,m=e;else{if(!(e instanceof Wi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Wi.convert(e)):this.extend(u.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(u.Q.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return n||l?(n.lng=Math.min(h.lng,n.lng),n.lat=Math.min(h.lat,n.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new u.Q(h.lng,h.lat),this._ne=new u.Q(m.lng,m.lat)),this}getCenter(){return new u.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.Q(this.getWest(),this.getNorth())}getSouthEast(){return new u.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:l}=u.Q.convert(e);let h=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(e){return e instanceof Wi?e:e&&new Wi(e)}static fromLngLat(e,n=0){const l=360*n/40075017,h=l/Math.cos(Math.PI/180*e.lat);return new Wi(new u.Q(e.lng-h,e.lat-l),new u.Q(e.lng+h,e.lat+l))}adjustAntiMeridian(){const e=new u.Q(this._sw.lng,this._sw.lat),n=new u.Q(this._ne.lng,this._ne.lat);return new Wi(e,e.lng>n.lng?new u.Q(n.lng+360,n.lat):n)}}class xo{constructor(e,n,l){this.bounds=Wi.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),l=Math.floor(u.U(this.bounds.getWest())*n),h=Math.floor(u.S(this.bounds.getNorth())*n),m=Math.ceil(u.U(this.bounds.getEast())*n),y=Math.ceil(u.S(this.bounds.getSouth())*n);return e.x>=l&&e.x<m&&e.y>=h&&e.y<y}}class bo extends u.E{constructor(e,n,l,h){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.O(n,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Fr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(u.e(this,e),e.bounds&&(this.tileBounds=new xo(e.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new u.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(e){return u._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(n,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,y)=>{e.reloadPromise={resolve:m,reject:y}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:h,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,n){if(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Mn extends u.E{constructor(e,n,l,h){super(),this.id=e,this.dispatcher=l,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},n),u.e(this,u.O(n,["url","scheme","tileSize"]))}load(){return u._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Fr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(u.e(this,n),n.bounds&&(this.tileBounds=new xo(n.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(n){this._tileJSONRequest=null,this.fire(new u.k(n))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return u.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return u._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield dt.getImage(this.map._requestManager.transformRequest(n,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const h=this.map.painter.context,m=h.gl,y=l.data;e.texture=this.map.painter.getTileTexture(y.width),e.texture?e.texture.update(y,{useMipmap:!0}):(e.texture=new St(h,y,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class $a extends Mn{constructor(e,n,l,h){super(e,n,l,h),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return u._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const h=yield dt.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){const m=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const y=u.b(m)&&u.V()?m:yield this.readImageNow(m),w={type:this.type,uid:e.uid,source:this.id,rawImageData:y,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const S=yield e.actor.sendAsync({type:"LDT",data:w});e.dem=S,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.W()){const n=e.width+2,l=e.height+2;try{return new u.R({width:n,height:l},yield u.X(e,-1,-1,n,l))}catch{}}return _e.getImageData(e,1)})}_getNeighboringTiles(e){const n=e.canonical,l=Math.pow(2,n.z),h=(n.x-1+l)%l,m=n.x===0?e.wrap-1:e.wrap,y=(n.x+1+l)%l,w=n.x+1===l?e.wrap+1:e.wrap,S={};return S[new u.Y(e.overscaledZ,m,n.z,h,n.y).key]={backfilled:!1},S[new u.Y(e.overscaledZ,w,n.z,y,n.y).key]={backfilled:!1},n.y>0&&(S[new u.Y(e.overscaledZ,m,n.z,h,n.y-1).key]={backfilled:!1},S[new u.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},S[new u.Y(e.overscaledZ,w,n.z,y,n.y-1).key]={backfilled:!1}),n.y+1<l&&(S[new u.Y(e.overscaledZ,m,n.z,h,n.y+1).key]={backfilled:!1},S[new u.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},S[new u.Y(e.overscaledZ,w,n.z,y,n.y+1).key]={backfilled:!1}),S}unloadTile(e){return u._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class za extends u.E{constructor(e,n,l,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(h),this._data=n.data,this._options=u.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:u.Z,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:u.Z,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(u.Z/this.tileSize)}load(){return u._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return u._(this,void 0,void 0,function*(){const e=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(n=>n.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return u._(this,void 0,void 0,function*(){const e=new Wi,n=yield this.getData();let l;switch(n.type){case"FeatureCollection":l=n.features.map(h=>this.getCoordinatesFromGeometry(h.geometry)).flat(1/0);break;case"Feature":l=this.getCoordinatesFromGeometry(n.geometry);break;default:l=this.getCoordinatesFromGeometry(n)}if(l.length==0)return e;for(let h=0;h<l.length-1;h+=2)e.extend([l[h],l[h+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,n,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:n,offset:l}})}_updateWorkerData(e){return u._(this,void 0,void 0,function*(){const n=u.e({type:this.type},this.workerOptions);e?n.dataDiff=e:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(_e.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new u.l("dataabort",{dataType:"source"}));let h=null;l.resourceTiming&&l.resourceTiming[this.id]&&(h=l.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&u.e(m,{resourceTiming:h}),this.fire(new u.l("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new u.l("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new u.l("dataabort",{dataType:"source"}));this.fire(new u.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return u._(this,void 0,void 0,function*(){const n=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const h=yield this.actor.sendAsync({type:n,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,n==="RT")})}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Jr extends u.E{constructor(e,n,l,h){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=n}load(e){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const n=yield dt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new u.k(n))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const n=e.map(u.$.fromLngLat);var l;return this.tileID=function(h){let m=1/0,y=1/0,w=-1/0,S=-1/0;for(const B of h)m=Math.min(m,B.x),y=Math.min(y,B.y),w=Math.max(w,B.x),S=Math.max(S,B.y);const z=Math.max(w-m,S-y),k=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),O=Math.pow(2,k);return new u.a1(k,Math.floor((m+w)/2*O),Math.floor((y+S)/2*O))}(n),this.terrainTileRanges=this._getOverlappingTileRanges(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(h=>this.tileID.getTilePoint(h)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,n=e.gl;this.texture||(this.texture=new St(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let l=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return u._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let n=1/0,l=1/0,h=-1/0,m=-1/0;for(const w of e)n=Math.min(n,w.x),l=Math.min(l,w.y),h=Math.max(h,w.x),m=Math.max(m,w.y);const y={};for(let w=0;w<=u.a0;w++){const S=Math.pow(2,w),z=Math.floor(n*S),k=Math.floor(l*S),O=Math.floor(h*S),B=Math.floor(m*S);y[w]={minTileX:z,minTileY:k,maxTileX:O,maxTileY:B}}return y}}class lr extends Jr{constructor(e,n,l,h){super(e,n,l,h),this.roundZoom=!0,this.type="video",this.options=n}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{const n=yield u.a2(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new u.k(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new u.k(new u.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new St(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let l=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class pt extends Jr{constructor(e,n,l,h){super(e,n,l,h),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(y=>typeof y!="number"))||this.fire(new u.k(new u.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.k(new u.a3(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new u.k(new u.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new u.k(new u.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.k(new u.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return u._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,l=n.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new St(n,this.canvas,l.RGBA,{premultiply:!0});let h=!1;for(const m in this.tiles){const y=this.tiles[m];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,h=!0)}h&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Mt={},hi=f=>{switch(f){case"geojson":return za;case"image":return Jr;case"raster":return Mn;case"raster-dem":return $a;case"vector":return bo;case"video":return lr;case"canvas":return pt}return Mt[f]},Ri="RTLPluginLoaded";class xn extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ai()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return u._(this,arguments,void 0,function*(n,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=_e.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return u._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.l(Ri))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let un=null;function hn(){return un||(un=new xn),un}class zi{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=u.a4(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const n=e+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const y={};if(!m)return y;for(const w of h){const S=w.layerIds.map(z=>m.getLayer(z)).filter(Boolean);if(S.length!==0){w.layers=S,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(z=>S.filter(k=>k.id===z)[0]));for(const z of S)y[z.id]=w}}return y}(e.buckets,n==null?void 0:n.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof u.a6){if(this.hasSymbolBuckets=!0,!l)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof u.a6&&m.hasRTLText){this.hasRTLText=!0,hn().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new u.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new St(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new St(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,l,h,m,y,w,S,z,k,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:m,scale:y,tileSize:this.tileSize,pixelPosMatrix:k,transform:S,params:w,queryPadding:this.queryPadding*z,getElevation:O},e,n,l):{}}querySourceFeatures(e,n){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),m=n&&n.sourceLayer?n.sourceLayer:"",y=h._geojsonTileLayer||h[m];if(!y)return;const w=u.a7(n&&n.filter),{z:S,x:z,y:k}=this.tileID.canonical,O={z:S,x:z,y:k};for(let B=0;B<y.length;B++){const q=y.feature(B);if(w.needGeometry){const te=u.a8(q,!0);if(!w.filter(new u.C(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!w.filter(new u.C(this.tileID.overscaledZ),q))continue;const Y=l.getId(q,m),ne=new u.a9(q,S,z,k,Y);ne.tile=O,e.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const l=u.aa(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(n)if(this.expirationTime<n)h=!0;else{const m=this.expirationTime-n;m?this.expirationTime=l+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!n.style.hasLayer(h))continue;const m=this.buckets[h],y=m.layers[0].sourceLayer||"_geojsonTileLayer",w=l[y],S=e[y];if(!w||!S||Object.keys(S).length===0)continue;m.update(S,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=n&&n.style&&n.style.getLayer(h);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_e.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=_e.now()+e}setDependencies(e,n){const l={};for(const h of n)l[h]=!0;this.dependencies[e]=l}hasDependency(e,n){for(const l of e){const h=this.dependencies[l];if(h){for(const m of n)if(h[m])return!0}}return!1}}class dn{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,l){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:n,timeout:void 0};if(l!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},l)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const l=e.wrapped().key,h=n===void 0?0:this.data[l].indexOf(n),m=this.data[l][h];return this.data[l].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(m.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const l in this.data)for(const h of this.data[l])e(h.value)||n.push(h);for(const l of n)this.remove(l.value.tileID,l)}}class An{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,l){const h=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},u.e(this.stateChanges[e][h],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const m in this.state[e][h])l[m]||(this.deletedStates[e][h][m]=null)}else for(const m in l)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,n,l){if(this.deletedStates[e]===null)return;const h=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&n!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][l]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(l in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][l]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,n){const l=String(n),h=u.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][n];if(m===null)return{};for(const y in m)delete h[y]}return h}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const y in this.stateChanges[h])this.state[h][y]||(this.state[h][y]={}),u.e(this.state[h][y],this.stateChanges[h][y]),m[y]=this.state[h][y];l[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const y in this.state[h])m[y]={},this.state[h][y]={};else for(const y in this.deletedStates[h]){if(this.deletedStates[h][y]===null)this.state[h][y]={};else for(const w of Object.keys(this.deletedStates[h][y]))delete this.state[h][y][w];m[y]=this.state[h][y]}l[h]=l[h]||{},u.e(l[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in e)e[h].setFeatureState(l,n)}}function ea(f,e,n){const l=e.intersectsFrustum(f);if(!n)return l;const h=e.intersectsPlane(n);return l===0||h===0?0:l===2&&h===2?2:1}function ta(f,e,n,l,h){let m=f;const y=Math.atan(e/n),w=Math.hypot(e,n);return m=f+u.ab(l/w/Math.max(.5,Math.cos(u.ad(h/2)))),m+=1*u.ab(Math.cos(y))/2,m+=u.ae(f-m,-0,0),m}function Nr(f,e){const n=(e.roundZoom?Math.round:Math.floor)(f.zoom+u.ab(f.tileSize/e.tileSize));return Math.max(0,n)}function Ce(f,e){const n=f.getCameraFrustum(),l=f.getClippingPlane(),h=f.screenPointToMercatorCoordinate(f.getCameraPoint()),m=u.$.fromLngLat(f.center,f.elevation);h.z=m.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const y=f.getCoveringTilesDetailsProvider(),w=y.allowVariableZoom(f,e),S=Nr(f,e),z=e.minzoom||0,k=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,O=Math.min(Math.max(0,S),k),B=Math.pow(2,O),q=[B*h.x,B*h.y,0],Y=[B*m.x,B*m.y,0],ne=Math.hypot(m.x-h.x,m.y-h.y),te=Math.abs(m.z-h.z),ae=Math.hypot(ne,te),se=ge=>({zoom:0,x:0,y:0,wrap:ge,fullyVisible:!1}),fe=[],pe=[];if(f.renderWorldCopies&&y.allowWorldCopies())for(let ge=1;ge<=3;ge++)fe.push(se(-ge)),fe.push(se(ge));for(fe.push(se(0));fe.length>0;){const ge=fe.pop(),we=ge.x,xe=ge.y;let Be=ge.fullyVisible;const ke={x:we,y:xe,z:ge.zoom},We=y.getTileAABB(ke,ge.wrap,f.elevation,e);if(!Be){const ft=ea(n,We,l);if(ft===0)continue;Be=ft===2}const Qe=y.distanceToTile2d(h.x,h.y,ke,We);let Ye=S;w&&(Ye=(e.calculateTileZoom||ta)(f.zoom+u.ab(f.tileSize/e.tileSize),Qe,te,ae,f.fov)),Ye=(e.roundZoom?Math.round:Math.floor)(Ye),Ye=Math.max(0,Ye);const gt=Math.min(Ye,k);if(ge.wrap=y.getWrap(m,ke,ge.wrap),ge.zoom>=gt){if(ge.zoom<z)continue;const ft=O-ge.zoom,it=q[0]-.5-(we<<ft),Pt=q[1]-.5-(xe<<ft),Jt=e.reparseOverscaled?Math.max(ge.zoom,Ye):ge.zoom;pe.push({tileID:new u.Y(ge.zoom===k?Jt:ge.zoom,ge.wrap,ge.zoom,we,xe),distanceSq:u.ac([Y[0]-.5-we,Y[1]-.5-xe]),tileDistanceToCamera:Math.sqrt(it*it+Pt*Pt)})}else for(let ft=0;ft<4;ft++)fe.push({zoom:ge.zoom+1,x:(we<<1)+ft%2,y:(xe<<1)+(ft>>1),wrap:ge.wrap,fullyVisible:Be})}return pe.sort((ge,we)=>ge.distanceSq-we.distanceSq).map(ge=>ge.tileID)}class $ extends u.E{constructor(e,n,l){super(),this.id=e,this.dispatcher=l,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,m,y,w)=>{const S=new(hi(m.type))(h,m,y,w);if(S.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${S.id}`);return S})(e,n,l,this),this._tiles={},this._cache=new dn(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new An,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,l){return u._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,l)}catch(h){e.state="errored",h.status!==404?this._source.fire(new u.k(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new u.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const l=this._tiles[n];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(K).map(e=>e.key)}getRenderableIds(e){const n=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&n.push(this._tiles[l]);return e?n.sort((l,h)=>{const m=l.tileID,y=h.tileID,w=new u.P(m.canonical.x,m.canonical.y)._rotate(-this.transform.bearingInRadians),S=new u.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians);return m.overscaledZ-y.overscaledZ||S.y-w.y||S.x-w.x}).map(l=>l.tileID.key):n.map(l=>l.tileID).sort(K).map(l=>l.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)(e||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(e,n){return u._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=n),yield this._loadTile(l,e,n))})}_tileLoaded(e,n,l){e.timeAdded=_e.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new u.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const n=this.getRenderableIds();for(let h=0;h<n.length;h++){const m=n[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const y=this.getTileByID(m);l(e,y),l(y,e)}}function l(h,m){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let y=m.tileID.canonical.x-h.tileID.canonical.x;const w=m.tileID.canonical.y-h.tileID.canonical.y,S=Math.pow(2,h.tileID.canonical.z),z=m.tileID.key;y===0&&w===0||Math.abs(w)>1||(Math.abs(y)>1&&(Math.abs(y+S)===1?y+=S:Math.abs(y-S)===1&&(y-=S)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,y,w),h.neighboringTiles&&h.neighboringTiles[z]&&(h.neighboringTiles[z].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,l,h){for(const m in this._tiles){let y=this._tiles[m];if(h[m]||!y.hasData()||y.tileID.overscaledZ<=n||y.tileID.overscaledZ>l)continue;let w=y.tileID;for(;y&&y.tileID.overscaledZ>n+1;){const z=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[z.key],y&&y.hasData()&&(w=z)}let S=w;for(;S.overscaledZ>n;)if(S=S.scaledTo(S.overscaledZ-1),e[S.key]||e[S.canonical.key]){h[w.key]=w;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=n?l:null}for(let l=e.overscaledZ-1;l>=n;l--){const h=e.scaledTo(l),m=this._getLoadedTile(h);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const n=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(n*l*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(m)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const l={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+n),l[m.tileID.key]=m}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(e,n,l,h,m,y){const w={},S={},z=Object.keys(e),k=_e.now();for(const O of z){const B=e[O],q=this._tiles[O];if(!q||q.fadeEndTime!==0&&q.fadeEndTime<=k)continue;const Y=this.findLoadedParent(B,n),ne=this.findLoadedSibling(B),te=Y||ne||null;te&&(this._addTile(te.tileID),w[te.tileID.key]=te.tileID),S[O]=B}this._retainLoadedChildren(S,h,l,e);for(const O in w)e[O]||(this._coveredTiles[O]=!0,e[O]=w[O]);if(y){const O={},B={};for(const q of m)this._tiles[q.key].hasData()?O[q.key]=q:B[q.key]=q;for(const q in B){const Y=B[q].children(this._source.maxzoom);this._tiles[Y[0].key]&&this._tiles[Y[1].key]&&this._tiles[Y[2].key]&&this._tiles[Y[3].key]&&(O[Y[0].key]=e[Y[0].key]=Y[0],O[Y[1].key]=e[Y[1].key]=Y[1],O[Y[2].key]=e[Y[2].key]=Y[2],O[Y[3].key]=e[Y[3].key]=Y[3],delete B[q])}for(const q in B){const Y=B[q],ne=this.findLoadedParent(Y,this._source.minzoom),te=this.findLoadedSibling(Y),ae=ne||te||null;if(ae){O[ae.tileID.key]=e[ae.tileID.key]=ae.tileID;for(const se in O)O[se].isChildOf(ae.tileID)&&delete O[se]}}for(const q in this._tiles)O[q]||(this._coveredTiles[q]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new u.Y(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(l=Ce(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(k=>this._source.hasTile(k)))):l=[];const h=Nr(e,this._source),m=Math.max(h-$.maxOverzooming,this._source.minzoom),y=Math.max(h+$.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const O of l)if(O.canonical.z>this._source.minzoom){const B=O.scaledTo(O.canonical.z-1);k[B.key]=B;const q=O.scaledTo(Math.max(this._source.minzoom,Math.min(O.canonical.z,5)));k[q.key]=q}l=l.concat(Object.values(k))}const w=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new u.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=this._updateRetainedTiles(l,h);Z(this._source.type)&&this._updateCoveredAndRetainedTiles(S,m,y,h,l,n);for(const k in S)this._tiles[k].clearFadeHold();const z=u.af(this._tiles,S);for(const k of z){const O=this._tiles[k];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,n){var l;const h={},m={},y=Math.max(n-$.maxOverzooming,this._source.minzoom),w=Math.max(n+$.maxUnderzooming,this._source.minzoom),S={};for(const z of e){const k=this._addTile(z);h[z.key]=z,k.hasData()||n<this._source.maxzoom&&(S[z.key]=z)}this._retainLoadedChildren(S,n,w,h);for(const z of e){let k=this._tiles[z.key];if(k.hasData())continue;if(n+1>this._source.maxzoom){const B=z.children(this._source.maxzoom)[0],q=this.getTile(B);if(q&&q.hasData()){h[B.key]=B;continue}}else{const B=z.children(this._source.maxzoom);if(h[B[0].key]&&h[B[1].key]&&h[B[2].key]&&h[B[3].key])continue}let O=k.wasRequested();for(let B=z.overscaledZ-1;B>=y;--B){const q=z.scaledTo(B);if(m[q.key])break;if(m[q.key]=!0,k=this.getTile(q),!k&&O&&(k=this._addTile(q)),k){const Y=k.hasData();if((Y||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||O)&&(h[q.key]=q),O=k.wasRequested(),Y)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let l,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}n.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(m),l)break;h=m}for(const m of n)this._loadedParentTiles[m]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const n=this._tiles[e].tileID,l=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=l}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const l=n;return n||(n=new zi(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,l||this._source.fire(new u.l("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=n.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(e){const n=e.sourceDataType;e.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&n==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,l){const h=[],m=this.transform;if(!m)return h;const y=l?m.getCameraQueryGeometry(e):e,w=e.map(Y=>m.screenPointToMercatorCoordinate(Y,this.terrain)),S=y.map(Y=>m.screenPointToMercatorCoordinate(Y,this.terrain)),z=this.getIds();let k=1/0,O=1/0,B=-1/0,q=-1/0;for(const Y of S)k=Math.min(k,Y.x),O=Math.min(O,Y.y),B=Math.max(B,Y.x),q=Math.max(q,Y.y);for(let Y=0;Y<z.length;Y++){const ne=this._tiles[z[Y]];if(ne.holdingForFade())continue;const te=ne.tileID,ae=Math.pow(2,m.zoom-ne.tileID.overscaledZ),se=n*ne.queryPadding*u.Z/ne.tileSize/ae,fe=[te.getTilePoint(new u.$(k,O)),te.getTilePoint(new u.$(B,q))];if(fe[0].x-se<u.Z&&fe[0].y-se<u.Z&&fe[1].x+se>=0&&fe[1].y+se>=0){const pe=w.map(we=>te.getTilePoint(we)),ge=S.map(we=>te.getTilePoint(we));h.push({tile:ne,tileID:te,queryGeometry:pe,cameraQueryGeometry:ge,scale:ae})}}return h}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(Z(this._source.type)){const e=_e.now();for(const n in this._tiles)if(this._tiles[n].fadeEndTime>=e)return!0}return!1}setFeatureState(e,n,l){this._state.updateState(e=e||"_geojsonTileLayer",n,l)}removeFeatureState(e,n,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,l)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,l){const h=this._tiles[e];h&&h.setDependencies(n,l)}reloadTilesForDependencies(e,n){for(const l in this._tiles)this._tiles[l].hasDependency(e,n)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,n))}}function K(f,e){const n=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-n||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function Z(f){return f==="raster"||f==="image"||f==="video"}$.maxOverzooming=10,$.maxUnderzooming=3;class ue{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=u.ae(e,0,1);let n=1,l=this._distances[n];const h=e*this.paddedLength+this.padding;for(;l<h&&n<this._distances.length;)l=this._distances[++n];const m=n-1,y=this._distances[m],w=l-y,S=w>0?(h-y)/w:0;return this.points[m].mult(1-S).add(this.points[n].mult(S))}}function be(f,e){let n=!0;return f==="always"||f!=="never"&&e!=="never"||(n=!1),n}class ve{constructor(e,n,l){const h=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(n/l);for(let y=0;y<this.xCellCount*this.yCellCount;y++)h.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,l,h,m){this._forEachCell(n,l,h,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(m)}insertCircle(e,n,l,h){this._forEachCell(n-h,l-h,n+h,l+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(l),this.circles.push(h)}_insertBoxCell(e,n,l,h,m,y){this.boxCells[m].push(y)}_insertCircleCell(e,n,l,h,m,y){this.circleCells[m].push(y)}_query(e,n,l,h,m,y,w){if(l<0||e>this.width||h<0||n>this.height)return[];const S=[];if(e<=0&&n<=0&&this.width<=l&&this.height<=h){if(m)return[{key:null,x1:e,y1:n,x2:l,y2:h}];for(let z=0;z<this.boxKeys.length;z++)S.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const k=this.circles[3*z],O=this.circles[3*z+1],B=this.circles[3*z+2];S.push({key:this.circleKeys[z],x1:k-B,y1:O-B,x2:k+B,y2:O+B})}}else this._forEachCell(e,n,l,h,this._queryCell,S,{hitTest:m,overlapMode:y,seenUids:{box:{},circle:{}}},w);return S}query(e,n,l,h){return this._query(e,n,l,h,!1,null)}hitTest(e,n,l,h,m,y){return this._query(e,n,l,h,!0,m,y).length>0}hitTestCircle(e,n,l,h,m){const y=e-l,w=e+l,S=n-l,z=n+l;if(w<0||y>this.width||z<0||S>this.height)return!1;const k=[];return this._forEachCell(y,S,w,z,this._queryCellCircle,k,{hitTest:!0,overlapMode:h,circle:{x:e,y:n,radius:l},seenUids:{box:{},circle:{}}},m),k.length>0}_queryCell(e,n,l,h,m,y,w,S){const{seenUids:z,hitTest:k,overlapMode:O}=w,B=this.boxCells[m];if(B!==null){const Y=this.bboxes;for(const ne of B)if(!z.box[ne]){z.box[ne]=!0;const te=4*ne,ae=this.boxKeys[ne];if(e<=Y[te+2]&&n<=Y[te+3]&&l>=Y[te+0]&&h>=Y[te+1]&&(!S||S(ae))&&(!k||!be(O,ae.overlapMode))&&(y.push({key:ae,x1:Y[te],y1:Y[te+1],x2:Y[te+2],y2:Y[te+3]}),k))return!0}}const q=this.circleCells[m];if(q!==null){const Y=this.circles;for(const ne of q)if(!z.circle[ne]){z.circle[ne]=!0;const te=3*ne,ae=this.circleKeys[ne];if(this._circleAndRectCollide(Y[te],Y[te+1],Y[te+2],e,n,l,h)&&(!S||S(ae))&&(!k||!be(O,ae.overlapMode))){const se=Y[te],fe=Y[te+1],pe=Y[te+2];if(y.push({key:ae,x1:se-pe,y1:fe-pe,x2:se+pe,y2:fe+pe}),k)return!0}}}return!1}_queryCellCircle(e,n,l,h,m,y,w,S){const{circle:z,seenUids:k,overlapMode:O}=w,B=this.boxCells[m];if(B!==null){const Y=this.bboxes;for(const ne of B)if(!k.box[ne]){k.box[ne]=!0;const te=4*ne,ae=this.boxKeys[ne];if(this._circleAndRectCollide(z.x,z.y,z.radius,Y[te+0],Y[te+1],Y[te+2],Y[te+3])&&(!S||S(ae))&&!be(O,ae.overlapMode))return y.push(!0),!0}}const q=this.circleCells[m];if(q!==null){const Y=this.circles;for(const ne of q)if(!k.circle[ne]){k.circle[ne]=!0;const te=3*ne,ae=this.circleKeys[ne];if(this._circlesCollide(Y[te],Y[te+1],Y[te+2],z.x,z.y,z.radius)&&(!S||S(ae))&&!be(O,ae.overlapMode))return y.push(!0),!0}}}_forEachCell(e,n,l,h,m,y,w,S){const z=this._convertToXCellCoord(e),k=this._convertToYCellCoord(n),O=this._convertToXCellCoord(l),B=this._convertToYCellCoord(h);for(let q=z;q<=O;q++)for(let Y=k;Y<=B;Y++)if(m.call(this,e,n,l,h,this.xCellCount*Y+q,y,w,S))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,l,h,m,y){const w=h-e,S=m-n,z=l+y;return z*z>w*w+S*S}_circleAndRectCollide(e,n,l,h,m,y,w){const S=(y-h)/2,z=Math.abs(e-(h+S));if(z>S+l)return!1;const k=(w-m)/2,O=Math.abs(n-(m+k));if(O>k+l)return!1;if(z<=S||O<=k)return!0;const B=z-S,q=O-k;return B*B+q*q<=l*l}}function Ie(f,e,n){const l=u.K();if(!f){const{vecSouth:O,vecEast:B}=Ke(e),q=Q();q[0]=B[0],q[1]=B[1],q[2]=O[0],q[3]=O[1],h=q,(k=(y=(m=q)[0])*(z=m[3])-(S=m[2])*(w=m[1]))&&(h[0]=z*(k=1/k),h[1]=-w*k,h[2]=-S*k,h[3]=y*k),l[0]=q[0],l[1]=q[1],l[4]=q[2],l[5]=q[3]}var h,m,y,w,S,z,k;return u.M(l,l,[1/n,1/n,1]),l}function Ee(f,e,n,l){if(f){const h=u.K();if(!e){const{vecSouth:m,vecEast:y}=Ke(n);h[0]=y[0],h[1]=y[1],h[4]=m[0],h[5]=m[1]}return u.M(h,h,[l,l,1]),h}return n.pixelsToClipSpaceMatrix}function Ke(f){const e=Math.cos(f.rollInRadians),n=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),h=Math.cos(f.bearingInRadians),m=Math.sin(f.bearingInRadians),y=u.ak();y[0]=-h*l*n-m*e,y[1]=-m*l*n+h*e;const w=u.al(y);w<1e-9?u.am(y):u.an(y,y,1/w);const S=u.ak();S[0]=h*l*e-m*n,S[1]=m*l*e+h*n;const z=u.al(S);return z<1e-9?u.am(S):u.an(S,S,1/z),{vecEast:S,vecSouth:y}}function He(f,e,n,l){let h;l?(h=[f,e,l(f,e),1],u.ap(h,h,n)):(h=[f,e,0,1],zn(h,h,n));const m=h[3];return{point:new u.P(h[0]/m,h[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function Re(f,e){return .5+f/e*.5}function nt(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function vt(f,e,n,l,h,m,y,w,S,z,k,O,B){const q=n?f.textSizeData:f.iconSizeData,Y=u.ag(q,e.transform.zoom),ne=[256/e.width*2+1,256/e.height*2+1],te=n?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;te.clear();const ae=f.lineVertexArray,se=n?f.text.placedSymbolArray:f.icon.placedSymbolArray,fe=e.transform.width/e.transform.height;let pe=!1;for(let ge=0;ge<se.length;ge++){const we=se.get(ge);if(we.hidden||we.writingMode===u.ah.vertical&&!pe){Ft(we.numGlyphs,te);continue}pe=!1;const xe=new u.P(we.anchorX,we.anchorY),Be={getElevation:B,pitchedLabelPlaneMatrix:l,lineVertexArray:ae,pitchWithMap:m,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:xe,unwrappedTileID:S,width:z,height:k,translation:O},ke=Rt(we.anchorX,we.anchorY,Be);if(!nt(ke.point,ne)){Ft(we.numGlyphs,te);continue}const We=Re(e.transform.cameraToCenterDistance,ke.signedDistanceFromCamera),Qe=u.ai(q,Y,we),Ye=m?Qe*e.transform.getPitchedTextCorrection(we.anchorX,we.anchorY,S)/We:Qe*We,gt=Bt({projectionContext:Be,pitchedLabelPlaneMatrixInverse:h,symbol:we,fontSize:Ye,flip:!1,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:te,aspectRatio:fe,rotateToLine:w});pe=gt.useVertical,(gt.notEnoughRoom||pe||gt.needsFlipping&&Bt({projectionContext:Be,pitchedLabelPlaneMatrixInverse:h,symbol:we,fontSize:Ye,flip:!0,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:te,aspectRatio:fe,rotateToLine:w}).notEnoughRoom)&&Ft(we.numGlyphs,te)}n?f.text.dynamicLayoutVertexBuffer.updateData(te):f.icon.dynamicLayoutVertexBuffer.updateData(te)}function bt(f,e,n,l,h,m,y,w){const S=m.glyphStartIndex+m.numGlyphs,z=m.lineStartIndex,k=m.lineStartIndex+m.lineLength,O=e.getoffsetX(m.glyphStartIndex),B=e.getoffsetX(S-1),q=fn(f*O,n,l,h,m.segment,z,k,w,y);if(!q)return null;const Y=fn(f*B,n,l,h,m.segment,z,k,w,y);return Y?w.projectionCache.anyProjectionOccluded?null:{first:q,last:Y}:null}function Ze(f,e,n,l){return f===u.ah.horizontal&&Math.abs(n.y-e.y)>Math.abs(n.x-e.x)*l?{useVertical:!0}:(f===u.ah.vertical?e.y<n.y:e.x>n.x)?{needsFlipping:!0}:null}function Bt(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:n,symbol:l,fontSize:h,flip:m,keepUpright:y,glyphOffsetArray:w,dynamicLayoutVertexArray:S,aspectRatio:z,rotateToLine:k}=f,O=h/24,B=l.lineOffsetX*O,q=l.lineOffsetY*O;let Y;if(l.numGlyphs>1){const ne=l.glyphStartIndex+l.numGlyphs,te=l.lineStartIndex,ae=l.lineStartIndex+l.lineLength,se=bt(O,w,B,q,m,l,k,e);if(!se)return{notEnoughRoom:!0};const fe=st(se.first.point.x,se.first.point.y,e,n),pe=st(se.last.point.x,se.last.point.y,e,n);if(y&&!m){const ge=Ze(l.writingMode,fe,pe,z);if(ge)return ge}Y=[se.first];for(let ge=l.glyphStartIndex+1;ge<ne-1;ge++)Y.push(fn(O*w.getoffsetX(ge),B,q,m,l.segment,te,ae,e,k));Y.push(se.last)}else{if(y&&!m){const te=pi(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ae=l.lineStartIndex+l.segment+1,se=new u.P(e.lineVertexArray.getx(ae),e.lineVertexArray.gety(ae)),fe=pi(se.x,se.y,e),pe=fe.signedDistanceFromCamera>0?fe.point:At(e.tileAnchorPoint,se,te,1,e),ge=st(te.x,te.y,e,n),we=st(pe.x,pe.y,e,n),xe=Ze(l.writingMode,ge,we,z);if(xe)return xe}const ne=fn(O*w.getoffsetX(l.glyphStartIndex),B,q,m,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,k);if(!ne||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Y=[ne]}for(const ne of Y)u.ao(S,ne.point,ne.angle);return{}}function At(f,e,n,l,h){const m=f.add(f.sub(e)._unit()),y=pi(m.x,m.y,h).point,w=n.sub(y);return n.add(w._mult(l/w.mag()))}function Gt(f,e,n){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const h=new u.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),m=pi(h.x,h.y,e);if(m.signedDistanceFromCamera>0)return l.projections[f]=m.point,l.anyProjectionOccluded=l.anyProjectionOccluded||m.isOccluded,m.point;const y=f-n.direction;return At(n.distanceFromAnchor===0?e.tileAnchorPoint:new u.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),h,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,e)}function pi(f,e,n){const l=f+n.translation[0],h=e+n.translation[1];let m;return n.pitchWithMap?(m=He(l,h,n.pitchedLabelPlaneMatrix,n.getElevation),m.isOccluded=!1):(m=n.transform.projectTileCoordinates(l,h,n.unwrappedTileID,n.getElevation),m.point.x=(.5*m.point.x+.5)*n.width,m.point.y=(.5*-m.point.y+.5)*n.height),m}function st(f,e,n,l){if(n.pitchWithMap){const h=[f,e,0,1];return u.ap(h,h,l),n.transform.projectTileCoordinates(h[0]/h[3],h[1]/h[3],n.unwrappedTileID,n.getElevation).point}return{x:f/n.width*2-1,y:e/n.height*2-1}}function Rt(f,e,n){return n.transform.projectTileCoordinates(f,e,n.unwrappedTileID,n.getElevation)}function _t(f,e,n){return f._unit()._perp()._mult(e*n)}function Xt(f,e,n,l,h,m,y,w,S){if(w.projectionCache.offsets[f])return w.projectionCache.offsets[f];const z=n.add(e);if(f+S.direction<l||f+S.direction>=h)return w.projectionCache.offsets[f]=z,z;const k=Gt(f+S.direction,w,S),O=_t(k.sub(n),y,S.direction),B=n.add(O),q=k.add(O);return w.projectionCache.offsets[f]=u.aq(m,z,B,q)||z,w.projectionCache.offsets[f]}function fn(f,e,n,l,h,m,y,w,S){const z=l?f-e:f+e;let k=z>0?1:-1,O=0;l&&(k*=-1,O=Math.PI),k<0&&(O+=Math.PI);let B,q=k>0?m+h:m+h+1;w.projectionCache.cachedAnchorPoint?B=w.projectionCache.cachedAnchorPoint:(B=pi(w.tileAnchorPoint.x,w.tileAnchorPoint.y,w).point,w.projectionCache.cachedAnchorPoint=B);let Y,ne,te=B,ae=B,se=0,fe=0;const pe=Math.abs(z),ge=[];let we;for(;se+fe<=pe;){if(q+=k,q<m||q>=y)return null;se+=fe,ae=te,ne=Y;const ke={absOffsetX:pe,direction:k,distanceFromAnchor:se,previousVertex:ae};if(te=Gt(q,w,ke),n===0)ge.push(ae),we=te.sub(ae);else{let We;const Qe=te.sub(ae);We=Qe.mag()===0?_t(Gt(q+k,w,ke).sub(te),n,k):_t(Qe,n,k),ne||(ne=ae.add(We)),Y=Xt(q,We,te,m,y,ne,n,w,ke),ge.push(ne),we=Y.sub(ne)}fe=we.mag()}const xe=we._mult((pe-se)/fe)._add(ne||ae),Be=O+Math.atan2(te.y-ae.y,te.x-ae.x);return ge.push(xe),{point:xe,angle:S?Be:0,path:ge}}const Ur=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ft(f,e){for(let n=0;n<f;n++){const l=e.length;e.resize(l+4),e.float32.set(Ur,3*l)}}function zn(f,e,n){const l=e[0],h=e[1];return f[0]=n[0]*l+n[4]*h+n[12],f[1]=n[1]*l+n[5]*h+n[13],f[3]=n[3]*l+n[7]*h+n[15],f}const Pi=100;class Zn{constructor(e,n=new ve(e.width+200,e.height+200,25),l=new ve(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Pi,this.screenBottomBoundary=e.height+Pi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,n,l,h,m,y,w,S,z,k,O,B){const q=this.projectAndGetPerspectiveRatio(e.anchorPointX+S[0],e.anchorPointY+S[1],m,k,B),Y=l*q.perspectiveRatio;let ne;if(y||w)ne=this._projectCollisionBox(e,Y,h,m,y,w,S,q,k,O,B);else{const we=q.x+(O?O.x*Y:0),xe=q.y+(O?O.y*Y:0);ne={allPointsOccluded:!1,box:[we+e.x1*Y,xe+e.y1*Y,we+e.x2*Y,xe+e.y2*Y]}}const[te,ae,se,fe]=ne.box,pe=y?ne.allPointsOccluded:q.isOccluded;let ge=pe;return ge||(ge=q.perspectiveRatio<this.perspectiveRatioCutoff),ge||(ge=!this.isInsideGrid(te,ae,se,fe)),ge||n!=="always"&&this.grid.hitTest(te,ae,se,fe,n,z)?{box:[te,ae,se,fe],placeable:!1,offscreen:!1,occluded:pe}:{box:[te,ae,se,fe],placeable:!0,offscreen:this.isOffscreen(te,ae,se,fe),occluded:pe}}placeCollisionCircles(e,n,l,h,m,y,w,S,z,k,O,B,q,Y){const ne=[],te=new u.P(n.anchorX,n.anchorY),ae=this.getPerspectiveRatio(te.x,te.y,y,Y),se=(z?m*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,y)/ae:m*ae)/u.av,fe={getElevation:Y,pitchedLabelPlaneMatrix:w,lineVertexArray:l,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:te,unwrappedTileID:y,width:this.transform.width,height:this.transform.height,translation:q},pe=bt(se,h,n.lineOffsetX*se,n.lineOffsetY*se,!1,n,!1,fe);let ge=!1,we=!1,xe=!0;if(pe){const Be=.5*O*ae+B,ke=new u.P(-100,-100),We=new u.P(this.screenRightBoundary,this.screenBottomBoundary),Qe=new ue,Ye=pe.first,gt=pe.last;let ft=[];for(let Jt=Ye.path.length-1;Jt>=1;Jt--)ft.push(Ye.path[Jt]);for(let Jt=1;Jt<gt.path.length;Jt++)ft.push(gt.path[Jt]);const it=2.5*Be;if(z){const Jt=this.projectPathToScreenSpace(ft,fe);ft=Jt.some(yi=>yi.signedDistanceFromCamera<=0)?[]:Jt.map(yi=>yi.point)}let Pt=[];if(ft.length>0){const Jt=ft[0].clone(),yi=ft[0].clone();for(let ni=1;ni<ft.length;ni++)Jt.x=Math.min(Jt.x,ft[ni].x),Jt.y=Math.min(Jt.y,ft[ni].y),yi.x=Math.max(yi.x,ft[ni].x),yi.y=Math.max(yi.y,ft[ni].y);Pt=Jt.x>=ke.x&&yi.x<=We.x&&Jt.y>=ke.y&&yi.y<=We.y?[ft]:yi.x<ke.x||Jt.x>We.x||yi.y<ke.y||Jt.y>We.y?[]:u.ar([ft],ke.x,ke.y,We.x,We.y)}for(const Jt of Pt){Qe.reset(Jt,.25*Be);let yi=0;yi=Qe.length<=.5*Be?1:Math.ceil(Qe.paddedLength/it)+1;for(let ni=0;ni<yi;ni++){const Oi=ni/Math.max(yi-1,1),qi=Qe.lerp(Oi),Ji=qi.x+Pi,Ii=qi.y+Pi;ne.push(Ji,Ii,Be,0);const ji=Ji-Be,Rn=Ii-Be,Wn=Ji+Be,nr=Ii+Be;if(xe=xe&&this.isOffscreen(ji,Rn,Wn,nr),we=we||this.isInsideGrid(ji,Rn,Wn,nr),e!=="always"&&this.grid.hitTestCircle(Ji,Ii,Be,e,k)&&(ge=!0,!S))return{circles:[],offscreen:!1,collisionDetected:ge}}}}return{circles:!S&&ge||!we||ae<this.perspectiveRatioCutoff?[]:ne,offscreen:xe,collisionDetected:ge}}projectPathToScreenSpace(e,n){const l=function(h,m){const y=u.K();return u.aj(y,m.pitchedLabelPlaneMatrix),h.map(w=>{const S=He(w.x,w.y,y,m.getElevation),z=m.transform.projectTileCoordinates(S.point.x,S.point.y,m.unwrappedTileID,m.getElevation);return z.point.x=(.5*z.point.x+.5)*m.width,z.point.y=(.5*-z.point.y+.5)*m.height,z})}(e,n);return function(h){let m=0,y=0,w=0,S=0;for(let z=0;z<h.length;z++)h[z].isOccluded?(w=z+1,S=0):(S++,S>y&&(y=S,m=w));return h.slice(m,m+y)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let l=1/0,h=1/0,m=-1/0,y=-1/0;for(const k of e){const O=new u.P(k.x+Pi,k.y+Pi);l=Math.min(l,O.x),h=Math.min(h,O.y),m=Math.max(m,O.x),y=Math.max(y,O.y),n.push(O)}const w=this.grid.query(l,h,m,y).concat(this.ignoredGrid.query(l,h,m,y)),S={},z={};for(const k of w){const O=k.key;if(S[O.bucketInstanceId]===void 0&&(S[O.bucketInstanceId]={}),S[O.bucketInstanceId][O.featureIndex])continue;const B=[new u.P(k.x1,k.y1),new u.P(k.x2,k.y1),new u.P(k.x2,k.y2),new u.P(k.x1,k.y2)];u.as(n,B)&&(S[O.bucketInstanceId][O.featureIndex]=!0,z[O.bucketInstanceId]===void 0&&(z[O.bucketInstanceId]=[]),z[O.bucketInstanceId].push(O.featureIndex))}return z}insertCollisionBox(e,n,l,h,m,y){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:y,overlapMode:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,l,h,m,y){const w=l?this.ignoredGrid:this.grid,S={bucketInstanceId:h,featureIndex:m,collisionGroupID:y,overlapMode:n};for(let z=0;z<e.length;z+=4)w.insertCircle(S,e[z],e[z+1],e[z+2])}projectAndGetPerspectiveRatio(e,n,l,h,m){if(m){let y;h?(y=[e,n,h(e,n),1],u.ap(y,y,m)):(y=[e,n,0,1],zn(y,y,m));const w=y[3];return{x:(y[0]/w+1)/2*this.transform.width+Pi,y:(-y[1]/w+1)/2*this.transform.height+Pi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w*.5,isOccluded:!1,signedDistanceFromCamera:w}}{const y=this.transform.projectTileCoordinates(e,n,l,h);return{x:(y.point.x+1)/2*this.transform.width+Pi,y:(1-y.point.y)/2*this.transform.height+Pi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5,isOccluded:y.isOccluded,signedDistanceFromCamera:y.signedDistanceFromCamera}}}getPerspectiveRatio(e,n,l,h){const m=this.transform.projectTileCoordinates(e,n,l,h);return .5+this.transform.cameraToCenterDistance/m.signedDistanceFromCamera*.5}isOffscreen(e,n,l,h){return l<Pi||e>=this.screenRightBoundary||h<Pi||n>this.screenBottomBoundary}isInsideGrid(e,n,l,h){return l>=0&&e<this.gridRightBoundary&&h>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const e=u.at([]);return u.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,l,h,m,y,w,S,z,k,O){let B=1,q=0,Y=0,ne=1;const te=e.anchorPointX+w[0],ae=e.anchorPointY+w[1];if(y&&!m){const ft=this.projectAndGetPerspectiveRatio(te+1,ae,h,z,O),it=ft.x-S.x,Pt=Math.atan((ft.y-S.y)/it)+(it<0?Math.PI:0),Jt=Math.sin(Pt),yi=Math.cos(Pt);B=yi,q=Jt,Y=-Jt,ne=yi}else if(!y&&m){const ft=Ke(this.transform);B=ft.vecEast[0],q=ft.vecEast[1],Y=ft.vecSouth[0],ne=ft.vecSouth[1]}let se=S.x,fe=S.y,pe=n;m&&(se=te,fe=ae,pe=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),pe*=this.transform.getPitchedTextCorrection(te,ae,h),k||(pe*=u.ae(.5+S.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(se+=B*k.x*pe+Y*k.y*pe,fe+=q*k.x*pe+ne*k.y*pe);const ge=e.x1*pe,we=e.x2*pe,xe=(ge+we)/2,Be=e.y1*pe,ke=e.y2*pe,We=(Be+ke)/2,Qe=[{offsetX:ge,offsetY:Be},{offsetX:xe,offsetY:Be},{offsetX:we,offsetY:Be},{offsetX:we,offsetY:We},{offsetX:we,offsetY:ke},{offsetX:xe,offsetY:ke},{offsetX:ge,offsetY:ke},{offsetX:ge,offsetY:We}];let Ye=[];for(const{offsetX:ft,offsetY:it}of Qe)Ye.push(new u.P(se+B*ft+Y*it,fe+q*ft+ne*it));let gt=!1;if(m){const ft=Ye.map(it=>this.projectAndGetPerspectiveRatio(it.x,it.y,h,z,O));gt=ft.some(it=>!it.isOccluded),Ye=ft.map(it=>new u.P(it.x,it.y))}else gt=!0;return{box:u.au(Ye),allPointsOccluded:!gt}}}class Ts{constructor(e,n,l,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):h&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class wo{constructor(e,n,l,h,m){this.text=new Ts(e?e.text:null,n,l,m),this.icon=new Ts(e?e.icon:null,n,h,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Xn{constructor(e,n,l){this.text=e,this.icon=n,this.skipFade=l}}class Fi{constructor(e,n,l,h,m){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=h,this.tileID=m}}class ef{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:l=>l.collisionGroupID===n}}return this.collisionGroups[e]}}function Ss(f,e,n,l,h){const{horizontalAlign:m,verticalAlign:y}=u.aB(f);return new u.P(-(m-.5)*e+l[0]*h,-(y-.5)*n+l[1]*h)}class Xc{constructor(e,n,l,h,m){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new Zn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new ef(h),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const n=this.terrain;return n?(l,h)=>n.getElevation(e,l,h):null}getBucketParts(e,n,l,h){const m=l.getBucket(n),y=l.latestFeatureIndex;if(!m||!y||n.id!==m.layerIds[0])return;const w=l.collisionBoxArray,S=m.layers[0].layout,z=m.layers[0].paint,k=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),O=l.tileSize/u.Z,B=l.tileID.toUnwrapped(),q=S.get("text-rotation-alignment")==="map",Y=u.aw(l,1,this.transform.zoom),ne=u.ax(this.collisionIndex.transform,l,z.get("text-translate"),z.get("text-translate-anchor")),te=u.ax(this.collisionIndex.transform,l,z.get("icon-translate"),z.get("icon-translate-anchor")),ae=Ie(q,this.transform,Y);this.retainedQueryData[m.bucketInstanceId]=new Fi(m.bucketInstanceId,y,m.sourceLayerIndex,m.index,l.tileID);const se={bucket:m,layout:S,translationText:ne,translationIcon:te,unwrappedTileID:B,pitchedLabelPlaneMatrix:ae,scale:k,textPixelRatio:O,holdingForFade:l.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:u.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(h)for(const fe of m.sortKeyRanges){const{sortKey:pe,symbolInstanceStart:ge,symbolInstanceEnd:we}=fe;e.push({sortKey:pe,symbolInstanceStart:ge,symbolInstanceEnd:we,parameters:se})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:se})}attemptAnchorPlacement(e,n,l,h,m,y,w,S,z,k,O,B,q,Y,ne,te,ae,se,fe,pe){const ge=u.ay[e.textAnchor],we=[e.textOffset0,e.textOffset1],xe=Ss(ge,l,h,we,m),Be=this.collisionIndex.placeCollisionBox(n,B,S,z,k,w,y,te,O.predicate,fe,xe,pe);if((!se||this.collisionIndex.placeCollisionBox(se,B,S,z,k,w,y,ae,O.predicate,fe,xe,pe).placeable)&&Be.placeable){let ke;if(this.prevPlacement&&this.prevPlacement.variableOffsets[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID].text&&(ke=this.prevPlacement.variableOffsets[q.crossTileID].anchor),q.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[q.crossTileID]={textOffset:we,width:l,height:h,anchor:ge,textBoxScale:m,prevAnchor:ke},this.markUsedJustification(Y,ge,q,ne),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,ne,q),this.placedOrientations[q.crossTileID]=ne),{shift:xe,placedGlyphBoxes:Be}}}placeLayerBucketPart(e,n,l){const{bucket:h,layout:m,translationText:y,translationIcon:w,unwrappedTileID:S,pitchedLabelPlaneMatrix:z,textPixelRatio:k,holdingForFade:O,collisionBoxArray:B,partiallyEvaluatedTextSize:q,collisionGroup:Y}=e.parameters,ne=m.get("text-optional"),te=m.get("icon-optional"),ae=u.az(m,"text-overlap","text-allow-overlap"),se=ae==="always",fe=u.az(m,"icon-overlap","icon-allow-overlap"),pe=fe==="always",ge=m.get("text-rotation-alignment")==="map",we=m.get("text-pitch-alignment")==="map",xe=m.get("icon-text-fit")!=="none",Be=m.get("symbol-z-order")==="viewport-y",ke=se&&(pe||!h.hasIconData()||te),We=pe&&(se||!h.hasTextData()||ne);!h.collisionArrays&&B&&h.deserializeCollisionBoxes(B);const Qe=this.retainedQueryData[h.bucketInstanceId].tileID,Ye=this._getTerrainElevationFunc(Qe),gt=this.transform.getFastPathSimpleProjectionMatrix(Qe),ft=(it,Pt,Jt)=>{var yi,ni;if(n[it.crossTileID])return;if(O)return void(this.placements[it.crossTileID]=new Xn(!1,!1,!1));let Oi=!1,qi=!1,Ji=!0,Ii=null,ji={box:null,placeable:!1,offscreen:null,occluded:!1},Rn={placeable:!1},Wn=null,nr=null,Mr=null,oo=0,Oa=0,ps=0;Pt.textFeatureIndex?oo=Pt.textFeatureIndex:it.useRuntimeCollisionCircles&&(oo=it.featureIndex),Pt.verticalTextFeatureIndex&&(Oa=Pt.verticalTextFeatureIndex);const so=Pt.textBox;if(so){const Xr=Tn=>{let en=u.ah.horizontal;if(h.allowVerticalPlacement&&!Tn&&this.prevPlacement){const jn=this.prevPlacement.placedOrientations[it.crossTileID];jn&&(this.placedOrientations[it.crossTileID]=jn,en=jn,this.markUsedOrientation(h,en,it))}return en},lo=(Tn,en)=>{if(h.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&Pt.verticalTextBox){for(const jn of h.writingModes)if(jn===u.ah.vertical?(ji=en(),Rn=ji):ji=Tn(),ji&&ji.placeable)break}else ji=Tn()},Ys=it.textAnchorOffsetStartIndex,Ks=it.textAnchorOffsetEndIndex;if(Ks===Ys){const Tn=(en,jn)=>{const Di=this.collisionIndex.placeCollisionBox(en,ae,k,Qe,S,we,ge,y,Y.predicate,Ye,void 0,gt);return Di&&Di.placeable&&(this.markUsedOrientation(h,jn,it),this.placedOrientations[it.crossTileID]=jn),Di};lo(()=>Tn(so,u.ah.horizontal),()=>{const en=Pt.verticalTextBox;return h.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&en?Tn(en,u.ah.vertical):{box:null,offscreen:null}}),Xr(ji&&ji.placeable)}else{let Tn=u.ay[(ni=(yi=this.prevPlacement)===null||yi===void 0?void 0:yi.variableOffsets[it.crossTileID])===null||ni===void 0?void 0:ni.anchor];const en=(Di,Fo,yh)=>{const co=Di.x2-Di.x1,hd=Di.y2-Di.y1,vh=it.textBoxScale,xh=xe&&fe==="never"?Fo:null;let ca=null,xa=ae==="never"?1:2,Na="never";Tn&&xa++;for(let Ws=0;Ws<xa;Ws++){for(let Rl=Ys;Rl<Ks;Rl++){const wc=h.textAnchorOffsets.get(Rl);if(Tn&&wc.textAnchor!==Tn)continue;const Tc=this.attemptAnchorPlacement(wc,Di,co,hd,vh,ge,we,k,Qe,S,Y,Na,it,h,yh,y,w,xh,Ye);if(Tc&&(ca=Tc.placedGlyphBoxes,ca&&ca.placeable))return Oi=!0,Ii=Tc.shift,ca}Tn?Tn=null:Na=ae}return l&&!ca&&(ca={box:this.collisionIndex.placeCollisionBox(so,"always",k,Qe,S,we,ge,y,Y.predicate,Ye,void 0,gt).box,offscreen:!1,placeable:!1,occluded:!1}),ca};lo(()=>en(so,Pt.iconBox,u.ah.horizontal),()=>{const Di=Pt.verticalTextBox;return h.allowVerticalPlacement&&(!ji||!ji.placeable)&&it.numVerticalGlyphVertices>0&&Di?en(Di,Pt.verticalIconBox,u.ah.vertical):{box:null,occluded:!0,offscreen:null}}),ji&&(Oi=ji.placeable,Ji=ji.offscreen);const jn=Xr(ji&&ji.placeable);if(!Oi&&this.prevPlacement){const Di=this.prevPlacement.variableOffsets[it.crossTileID];Di&&(this.variableOffsets[it.crossTileID]=Di,this.markUsedJustification(h,Di.anchor,it,jn))}}}if(Wn=ji,Oi=Wn&&Wn.placeable,Ji=Wn&&Wn.offscreen,it.useRuntimeCollisionCircles){const Xr=h.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex),lo=u.ai(h.textSizeData,q,Xr),Ys=m.get("text-padding");nr=this.collisionIndex.placeCollisionCircles(ae,Xr,h.lineVertexArray,h.glyphOffsetArray,lo,S,z,l,we,Y.predicate,it.collisionCircleDiameter,Ys,y,Ye),nr.circles.length&&nr.collisionDetected&&!l&&u.w("Collisions detected, but collision boxes are not shown"),Oi=se||nr.circles.length>0&&!nr.collisionDetected,Ji=Ji&&nr.offscreen}if(Pt.iconFeatureIndex&&(ps=Pt.iconFeatureIndex),Pt.iconBox){const Xr=lo=>this.collisionIndex.placeCollisionBox(lo,fe,k,Qe,S,we,ge,w,Y.predicate,Ye,xe&&Ii?Ii:void 0,gt);Rn&&Rn.placeable&&Pt.verticalIconBox?(Mr=Xr(Pt.verticalIconBox),qi=Mr.placeable):(Mr=Xr(Pt.iconBox),qi=Mr.placeable),Ji=Ji&&Mr.offscreen}const ms=ne||it.numHorizontalGlyphVertices===0&&it.numVerticalGlyphVertices===0,ja=te||it.numIconVertices===0;ms||ja?ja?ms||(qi=qi&&Oi):Oi=qi&&Oi:qi=Oi=qi&&Oi;const Fa=qi&&Mr.placeable;if(Oi&&Wn.placeable&&this.collisionIndex.insertCollisionBox(Wn.box,ae,m.get("text-ignore-placement"),h.bucketInstanceId,Rn&&Rn.placeable&&Oa?Oa:oo,Y.ID),Fa&&this.collisionIndex.insertCollisionBox(Mr.box,fe,m.get("icon-ignore-placement"),h.bucketInstanceId,ps,Y.ID),nr&&Oi&&this.collisionIndex.insertCollisionCircles(nr.circles,ae,m.get("text-ignore-placement"),h.bucketInstanceId,oo,Y.ID),l&&this.storeCollisionData(h.bucketInstanceId,Jt,Pt,Wn,Mr,nr),it.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[it.crossTileID]=new Xn((Oi||ke)&&!(Wn!=null&&Wn.occluded),(qi||We)&&!(Mr!=null&&Mr.occluded),Ji||h.justReloaded),n[it.crossTileID]=!0};if(Be){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const it=h.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Pt=it.length-1;Pt>=0;--Pt){const Jt=it[Pt];ft(h.symbolInstances.get(Jt),h.collisionArrays[Jt],Jt)}}else for(let it=e.symbolInstanceStart;it<e.symbolInstanceEnd;it++)ft(h.symbolInstances.get(it),h.collisionArrays[it],it);h.justReloaded=!1}storeCollisionData(e,n,l,h,m,y){if(l.textBox||l.iconBox){let w,S;this.collisionBoxArrays.has(e)?w=this.collisionBoxArrays.get(e):(w=new Map,this.collisionBoxArrays.set(e,w)),w.has(n)?S=w.get(n):(S={text:null,icon:null},w.set(n,S)),l.textBox&&(S.text=h.box),l.iconBox&&(S.icon=m.box)}if(y){let w=this.collisionCircleArrays[e];w===void 0&&(w=this.collisionCircleArrays[e]=[]);for(let S=0;S<y.circles.length;S+=4)w.push(y.circles[S+0]-Pi),w.push(y.circles[S+1]-Pi),w.push(y.circles[S+2]),w.push(y.collisionDetected?1:0)}}markUsedJustification(e,n,l,h){let m;m=h===u.ah.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[u.aA(n)];const y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const w of y)w>=0&&(e.text.placedSymbolArray.get(w).crossTileID=m>=0&&w!==m?0:l.crossTileID)}markUsedOrientation(e,n,l){const h=n===u.ah.horizontal||n===u.ah.horizontalOnly?n:0,m=n===u.ah.vertical?n:0,y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const w of y)e.text.placedSymbolArray.get(w).placedOrientation=h;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let l=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const h=n?n.symbolFadeChange(e):1,m=n?n.opacities:{},y=n?n.variableOffsets:{},w=n?n.placedOrientations:{};for(const S in this.placements){const z=this.placements[S],k=m[S];k?(this.opacities[S]=new wo(k,h,z.text,z.icon),l=l||z.text!==k.text.placed||z.icon!==k.icon.placed):(this.opacities[S]=new wo(null,h,z.text,z.icon,z.skipFade),l=l||z.text||z.icon)}for(const S in m){const z=m[S];if(!this.opacities[S]){const k=new wo(z,h,!1,!1);k.isHidden()||(this.opacities[S]=k,l=l||z.text.placed||z.icon.placed)}}for(const S in y)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=y[S]);for(const S in w)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=w[S]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){const l={};for(const h of n){const m=h.getBucket(e);m&&h.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,h.tileID,l,h.collisionBoxArray)}}updateBucketOpacities(e,n,l,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],y=m.layout,w=new wo(null,0,!1,!1,!0),S=y.get("text-allow-overlap"),z=y.get("icon-allow-overlap"),k=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),O=y.get("text-rotation-alignment")==="map",B=y.get("text-pitch-alignment")==="map",q=y.get("icon-text-fit")!=="none",Y=new wo(null,0,S&&(z||!e.hasIconData()||y.get("icon-optional")),z&&(S||!e.hasTextData()||y.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);const ne=(ae,se,fe)=>{for(let pe=0;pe<se/4;pe++)ae.opacityVertexArray.emplaceBack(fe);ae.hasVisibleVertices=ae.hasVisibleVertices||fe!==Xl},te=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ae=0;ae<e.symbolInstances.length;ae++){const se=e.symbolInstances.get(ae),{numHorizontalGlyphVertices:fe,numVerticalGlyphVertices:pe,crossTileID:ge}=se;let we=this.opacities[ge];l[ge]?we=w:we||(we=Y,this.opacities[ge]=we),l[ge]=!0;const xe=se.numIconVertices>0,Be=this.placedOrientations[se.crossTileID],ke=Be===u.ah.vertical,We=Be===u.ah.horizontal||Be===u.ah.horizontalOnly;if(fe>0||pe>0){const Ye=Kc(we.text);ne(e.text,fe,ke?Xl:Ye),ne(e.text,pe,We?Xl:Ye);const gt=we.text.isHidden();[se.rightJustifiedTextSymbolIndex,se.centerJustifiedTextSymbolIndex,se.leftJustifiedTextSymbolIndex].forEach(Pt=>{Pt>=0&&(e.text.placedSymbolArray.get(Pt).hidden=gt||ke?1:0)}),se.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(se.verticalPlacedTextSymbolIndex).hidden=gt||We?1:0);const ft=this.variableOffsets[se.crossTileID];ft&&this.markUsedJustification(e,ft.anchor,se,Be);const it=this.placedOrientations[se.crossTileID];it&&(this.markUsedJustification(e,"left",se,it),this.markUsedOrientation(e,it,se))}if(xe){const Ye=Kc(we.icon),gt=!(q&&se.verticalPlacedIconSymbolIndex&&ke);se.placedIconSymbolIndex>=0&&(ne(e.icon,se.numIconVertices,gt?Ye:Xl),e.icon.placedSymbolArray.get(se.placedIconSymbolIndex).hidden=we.icon.isHidden()),se.verticalPlacedIconSymbolIndex>=0&&(ne(e.icon,se.numVerticalIconVertices,gt?Xl:Ye),e.icon.placedSymbolArray.get(se.verticalPlacedIconSymbolIndex).hidden=we.icon.isHidden())}const Qe=te&&te.has(ae)?te.get(ae):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ye=e.collisionArrays[ae];if(Ye){let gt=new u.P(0,0);if(Ye.textBox||Ye.verticalTextBox){let ft=!0;if(k){const it=this.variableOffsets[ge];it?(gt=Ss(it.anchor,it.width,it.height,it.textOffset,it.textBoxScale),O&&gt._rotate(B?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ft=!1}if(Ye.textBox||Ye.verticalTextBox){let it;Ye.textBox&&(it=ke),Ye.verticalTextBox&&(it=We),Ho(e.textCollisionBox.collisionVertexArray,we.text.placed,!ft||it,Qe.text,gt.x,gt.y)}}if(Ye.iconBox||Ye.verticalIconBox){const ft=!!(!We&&Ye.verticalIconBox);let it;Ye.iconBox&&(it=ft),Ye.verticalIconBox&&(it=!ft),Ho(e.iconCollisionBox.collisionVertexArray,we.icon.placed,it,Qe.icon,q?gt.x:0,q?gt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){const l=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Ho(f,e,n,l,h,m){l&&l.length!==0||(l=[0,0,0,0]);const y=l[0]-Pi,w=l[1]-Pi,S=l[2]-Pi,z=l[3]-Pi;f.emplaceBack(e?1:0,n?1:0,h||0,m||0,y,w),f.emplaceBack(e?1:0,n?1:0,h||0,m||0,S,w),f.emplaceBack(e?1:0,n?1:0,h||0,m||0,S,z),f.emplaceBack(e?1:0,n?1:0,h||0,m||0,y,z)}const To=Math.pow(2,25),$l=Math.pow(2,24),Xa=Math.pow(2,17),Yc=Math.pow(2,16),Es=Math.pow(2,9),Cs=Math.pow(2,8),$u=Math.pow(2,1);function Kc(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,n=Math.floor(127*f.opacity);return n*To+e*$l+n*Xa+e*Yc+n*Es+e*Cs+n*$u+e}const Xl=0;class Xu{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,n,l,h,m){const y=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(y,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort((w,S)=>w.sortKey-S.sortKey));this._currentPartIndex<y.length;)if(n.placeLayerBucketPart(y[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,m())return!0;return!1}}class ia{constructor(e,n,l,h,m,y,w,S){this.placement=new Xc(e,n,y,w,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,n,l){const h=_e.now(),m=()=>!this._forceFullPlacement&&_e.now()-h>2;for(;this._currentPlacementIndex>=0;){const y=n[e[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=w)&&(!y.maxzoom||y.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Xu(y)),this._inProgressLayer.continuePlacement(l[y.source],this.placement,this._showCollisionBoxes,y,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const $o=512/u.Z/2;class Yu{constructor(e,n,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const h=new Map;for(let m=0;m<n.length;m++){const y=n.get(m),w=y.key,S=h.get(w);S?S.push(y):h.set(w,[y])}for(const[m,y]of h){const w={positions:y.map(S=>({x:Math.floor(S.anchorX*$o),y:Math.floor(S.anchorY*$o)})),crossTileIDs:y.map(S=>S.crossTileID)};if(w.positions.length>128){const S=new u.aC(w.positions.length,16,Uint16Array);for(const{x:z,y:k}of w.positions)S.add(z,k);S.finish(),delete w.positions,w.index=S}this._symbolsByKey[m]=w}}getScaledCoordinates(e,n){const{x:l,y:h,z:m}=this.tileID.canonical,{x:y,y:w,z:S}=n.canonical,z=$o/Math.pow(2,S-m),k=(w*u.Z+e.anchorY)*z,O=h*u.Z*$o;return{x:Math.floor((y*u.Z+e.anchorX)*z-l*u.Z*$o),y:Math.floor(k-O)}}findMatches(e,n,l){const h=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let m=0;m<e.length;m++){const y=e.get(m);if(y.crossTileID)continue;const w=this._symbolsByKey[y.key];if(!w)continue;const S=this.getScaledCoordinates(y,n);if(w.index){const z=w.index.range(S.x-h,S.y-h,S.x+h,S.y+h).sort();for(const k of z){const O=w.crossTileIDs[k];if(!l[O]){l[O]=!0,y.crossTileID=O;break}}}else if(w.positions)for(let z=0;z<w.positions.length;z++){const k=w.positions[z],O=w.crossTileIDs[z];if(Math.abs(k.x-S.x)<=h&&Math.abs(k.y-S.y)<=h&&!l[O]){l[O]=!0,y.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Yl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const n=Math.round((e-this.lng)/360);if(n!==0)for(const l in this.indexes){const h=this.indexes[l],m={};for(const y in h){const w=h[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+n),m[w.tileID.key]=w}this.indexes[l]=m}this.lng=e}addBucket(e,n,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<n.symbolInstances.length;m++)n.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const h=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const y=this.indexes[m];if(Number(m)>e.overscaledZ)for(const w in y){const S=y[w];S.tileID.isChildOf(e)&&S.findMatches(n.symbolInstances,e,h)}else{const w=y[e.scaledTo(Number(m)).key];w&&w.findMatches(n.symbolInstances,e,h)}}for(let m=0;m<n.symbolInstances.length;m++){const y=n.symbolInstances.get(m);y.crossTileID||(y.crossTileID=l.generate(),h[y.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Yu(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(const l of n.getCrossTileIDsLists())for(const h of l)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let n=!1;for(const l in this.indexes){const h=this.indexes[l];for(const m in h)e[h[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,h[m]),delete h[m],n=!0)}return n}}class Ms{constructor(){this.layerIndexes={},this.crossTileIDs=new Yl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,l){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new Wc);let m=!1;const y={};h.handleWrapJump(l);for(const w of n){const S=w.getBucket(e);S&&e.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(w.tileID,S,this.crossTileIDs)&&(m=!0),y[S.bucketInstanceId]=!0)}return h.removeStaleBuckets(y)&&(m=!0),m}pruneUnusedLayers(e){const n={};e.forEach(l=>{n[l]=!0});for(const l in this.layerIndexes)n[l]||delete this.layerIndexes[l]}}var Kl="void main() {fragColor=vec4(1.0);}";const Bn={prelude:ri(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ri("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ri("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ri(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ri(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ri(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ri(Kl,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ri(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ri(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ri("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ri("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ri("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ri(Kl,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ri(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ri(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ri(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ri(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ri(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ri(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ri(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ri(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ri(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ri(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ri(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ri(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ri(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ri(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ri(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ri(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ri("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ri("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ri("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ri("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ri(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ri("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ri(f,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),h=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=m?m.concat(h):h,w={};return{fragmentSource:f=f.replace(n,(S,z,k,O,B)=>(w[B]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
in ${k} ${O} ${B};
#else
uniform ${k} ${O} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${k} ${O} ${B} = u_${B};
#endif
`)),vertexSource:e=e.replace(n,(S,z,k,O,B)=>{const q=O==="float"?"vec2":"vec4",Y=B.match(/color/)?"color":q;return w[B]?z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${k} ${q} a_${B};
out ${k} ${O} ${B};
#else
uniform ${k} ${O} u_${B};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${k} ${O} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${Y}(a_${B}, u_${B}_t);
#else
    ${k} ${O} ${B} = u_${B};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${k} ${q} a_${B};
#else
uniform ${k} ${O} u_${B};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${k} ${O} ${B} = a_${B};
#else
    ${k} ${O} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${k} ${O} ${B} = unpack_mix_${Y}(a_${B}, u_${B}_t);
#else
    ${k} ${O} ${B} = u_${B};
#endif
`}),staticAttributes:l,staticUniforms:y}}class Xo{constructor(e,n,l){this.vertexBuffer=e,this.indexBuffer=n,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ya=u.aD([{name:"a_pos",type:"Int16",components:2}]);const Vr="#define PROJECTION_MERCATOR",As="mercator";class _i{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return As}get shaderDefine(){return Vr}get shaderPreludeCode(){return Bn.projectionMercator}get vertexShaderPreludeCode(){return Bn.projectionMercator.vertexSource}get subdivisionGranularity(){return u.aE.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,n,l,h,m){if(this._cachedMesh)return this._cachedMesh;const y=new u.aF;y.emplaceBack(0,0),y.emplaceBack(u.Z,0),y.emplaceBack(0,u.Z),y.emplaceBack(u.Z,u.Z);const w=e.createVertexBuffer(y,Ya.members),S=u.aG.simpleSegment(0,0,4,2),z=new u.aH;z.emplaceBack(1,0,2),z.emplaceBack(1,2,3);const k=e.createIndexBuffer(z);return this._cachedMesh=new Xo(w,k,S),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function fr(f,e){const n=u.ae(e.lat,-85.051129,u.aJ);return new u.P(u.U(e.lng)*f,u.S(n)*f)}function Wl(f,e){return new u.$(e.x/f,e.y/f).toLngLat()}function zs(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(u.ad(90-f.pitch)),Math.tan(u.ad(89.25-f.pitch)))}function Tr(f,e){const n=f.canonical,l=e/u.aI(n.z),h=n.x+Math.pow(2,n.z)*f.wrap,m=u.at(new Float64Array(16));return u.L(m,m,[h*l,n.y*l,0]),u.M(m,m,[l/u.Z,l/u.Z,1]),m}function ir(f,e,n,l,h){const m=u.$.fromLngLat(f,e),y=h*u.aK(1,f.lat),w=y*Math.cos(u.ad(n)),S=Math.sqrt(y*y-w*w),z=S*Math.sin(u.ad(-l)),k=S*Math.cos(u.ad(-l));return new u.$(m.x+z,m.y+k,m.z+w)}class pn{constructor(e=0,n=0,l=0,h=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=l,this.right=h}interpolate(e,n,l){return n.top!=null&&e.top!=null&&(this.top=u.B.number(e.top,n.top,l)),n.bottom!=null&&e.bottom!=null&&(this.bottom=u.B.number(e.bottom,n.bottom,l)),n.left!=null&&e.left!=null&&(this.left=u.B.number(e.left,n.left,l)),n.right!=null&&e.right!=null&&(this.right=u.B.number(e.right,n.right,l)),this}getCenter(e,n){const l=u.ae((this.left+e-this.right)/2,0,e),h=u.ae((this.top+n-this.bottom)/2,0,n);return new u.P(l,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new pn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Qc(f,e){if(!f.renderWorldCopies||f.lngRange)return;const n=e.lng-f.center.lng;e.lng+=n>180?-360:n<-180?360:0}function cr(f){return Math.max(0,Math.floor(f))}class Sr{constructor(e,n,l,h,m,y){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=h??0,this._maxPitch=m??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new u.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=cr(this._zoom),this._scale=u.aI(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new pn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,n,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=cr(this._zoom),this._scale=u.aI(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new pn(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const n=u.aL(e,-180,180)*Math.PI/180;var l,h,m,y,w,S,z,k,O;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=Q(),l=this._rotationMatrix,m=-this._bearingInRadians,y=(h=this._rotationMatrix)[0],w=h[1],S=h[2],z=h[3],k=Math.sin(m),O=Math.cos(m),l[0]=y*O+S*k,l[1]=w*O+z*k,l[2]=y*-k+S*O,l[3]=w*-k+z*O)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const n=u.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const n=e/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return u.aM(this._fovInRadians)}setFov(e){e=u.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=u.ad(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const n=this.getConstrained(this._center,e).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=u.aI(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,n){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,l){this._unmodified=!1,this._edgeInsets.interpolate(e,n,l),this._constrain(),this._calcMatrices()}resize(e,n,l=!0){this._width=e,this._height=n,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Wi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,u.aJ])}getConstrained(e,n){return this._callbacks.getConstrained(e,n)}getCameraQueryGeometry(e,n){if(n.length===1)return[n[0],e];{let l=e.x,h=e.y,m=e.x,y=e.y;for(const w of n)l=Math.min(l,w.x),h=Math.min(h,w.y),m=Math.max(m,w.x),y=Math.max(y,w.y);return[new u.P(l,h),new u.P(m,h),new u.P(m,y),new u.P(l,y),new u.P(l,h)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:n,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=u.at(new Float64Array(16));u.M(e,e,[this._width/2,-this._height/2,1]),u.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=u.at(new Float64Array(16)),u.M(e,e,[1,-1,1]),u.L(e,e,[-1,-1,0]),u.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,n,l,h){const m=l!==void 0?l:this.bearing,y=h=h!==void 0?h:this.pitch,w=u.$.fromLngLat(e,n),S=-Math.cos(u.ad(y)),z=Math.sin(u.ad(y)),k=z*Math.sin(u.ad(m)),O=-z*Math.cos(u.ad(m));let B=this.elevation;const q=n-B;let Y;S*q>=0||Math.abs(S)<.1?(Y=1e4,B=n+Y*S):Y=-q/S;let ne,te,ae=u.aN(1,w.y),se=0;do{if(se+=1,se>10)break;te=Y/ae,ne=new u.$(w.x+k*te,w.y+O*te),ae=1/ne.meterInMercatorCoordinateUnits()}while(Math.abs(Y-te*ae)>1e-12);return{center:ne.toLngLat(),elevation:B,zoom:u.ab(this.height/2/Math.tan(this.fovInRadians/2)/te/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const n=u.aK(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/n,h=u.$.fromLngLat(this.center,this.elevation),m=ir(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const y=this.calculateCenterFromCameraLngLatAlt(m.toLngLat(),u.aN(m.z,h.y),this.bearing,this.pitch);this._elevation=y.elevation,this._center=y.center,this.setZoom(y.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=u.aK(1,this.center.lat)*this.worldSize;return ir(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const n=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/n,e.canonical.y/n,1/n/u.Z,1/n/u.Z]}}class Gn{constructor(e,n){this.min=e,this.max=n,this.center=u.aO([],u.aP([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],l=u.aQ(this.min),h=u.aQ(this.max);for(let m=0;m<n.length;m++)l[m]=n[m]?this.min[m]:this.center[m],h[m]=n[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Gn(l,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let n=!0;for(let l=0;l<e.planes.length;l++){const h=this.intersectsPlane(e.planes[l]);if(h===0)return 0;h===1&&(n=!1)}return n?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let n=e[3],l=e[3];for(let h=0;h<3;h++)e[h]>0?(n+=e[h]*this.min[h],l+=e[h]*this.max[h]):(l+=e[h]*this.min[h],n+=e[h]*this.max[h]);return n>=0?2:l<0?0:1}}class Rs{distanceToTile2d(e,n,l,h){const m=h.distanceX([e,n]),y=h.distanceY([e,n]);return Math.hypot(m,y)}getWrap(e,n,l){return l}getTileAABB(e,n,l,h){var m,y;let w=l,S=l;if(h.terrain){const k=new u.Y(e.z,n,e.z,e.x,e.y),O=h.terrain.getMinMaxElevation(k);w=(m=O.minElevation)!==null&&m!==void 0?m:l,S=(y=O.maxElevation)!==null&&y!==void 0?y:l}const z=1<<e.z;return new Gn([n+e.x/z,e.y/z,w],[n+(e.x+1)/z,(e.y+1)/z,S])}allowVariableZoom(e,n){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,h=u.ae(78.5-l/2,0,60);return!!n.terrain||e.pitch>h}allowWorldCopies(){return!0}recalculateCache(){}}class na{constructor(e,n,l){this.points=e,this.planes=n,this.aabb=l}static fromInvProjectionMatrix(e,n=1,l=0){const h=Math.pow(2,l),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(z=>{const k=1/(z=u.ap([],z,e))[3]/n*h;return u.aR(z,z,[k,k,1/z[3],k])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(z=>{const k=u.aS([],m[z[0]],m[z[1]]),O=u.aS([],m[z[2]],m[z[1]]),B=u.aT([],u.aU([],k,O)),q=-u.aV(B,m[z[1]]);return B.concat(q)}),w=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],S=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const z of m)for(let k=0;k<3;k++)w[k]=Math.min(w[k],z[k]),S[k]=Math.max(S[k],z[k]);return new na(m,y,new Gn(w,S))}}class rn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,l=!0){this._helper.resize(e,n,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,n){}constructor(e,n,l,h,m){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Sr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(y,w)=>this.getConstrained(y,w)},e,n,l,h,m),this._coveringTilesDetailsProvider=new Rs}clone(){const e=new rn;return e.apply(this),e}apply(e,n,l){this._helper.apply(e,n,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const n=[new u.aW(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new u.P(0,0)),h=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,0)),m=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,this._helper._height)),y=this.screenPointToMercatorCoordinate(new u.P(0,this._helper._height)),w=Math.floor(Math.min(l.x,h.x,m.x,y.x)),S=Math.floor(Math.max(l.x,h.x,m.x,y.x)),z=1;for(let k=w-z;k<=S+z;k++)k!==0&&n.push(new u.aW(k,e))}return n}getCameraFrustum(){return na.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const n=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,n){const l=u.aK(this.elevation,this.center.lat),h=this.screenPointToMercatorCoordinateAtZ(n,l),m=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),y=u.$.fromLngLat(e),w=new u.$(y.x-(h.x-m.x),y.y-(h.y-m.y));this.setCenter(w==null?void 0:w.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,n){return n?this.coordinatePoint(u.$.fromLngLat(e),n.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(u.$.fromLngLat(e))}screenPointToLocation(e,n){var l;return(l=this.screenPointToMercatorCoordinate(e,n))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,n){if(n){const l=n.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,n){const l=n||0,h=[e.x,e.y,0,1],m=[e.x,e.y,1,1];u.ap(h,h,this._pixelMatrixInverse),u.ap(m,m,this._pixelMatrixInverse);const y=h[3],w=m[3],S=h[1]/y,z=m[1]/w,k=h[2]/y,O=m[2]/w,B=k===O?0:(l-k)/(O-k);return new u.$(u.B.number(h[0]/y,m[0]/w,B)/this.worldSize,u.B.number(S,z,B)/this.worldSize,l)}coordinatePoint(e,n=0,l=this._pixelMatrix){const h=[e.x*this.worldSize,e.y*this.worldSize,n,1];return u.ap(h,h,l),new u.P(h[0]/h[3],h[1]/h[3])}getBounds(){const e=Math.max(0,this._helper._height/2-zs(this));return new Wi().extend(this.screenPointToLocation(new u.P(0,e))).extend(this.screenPointToLocation(new u.P(this._helper._width,e))).extend(this.screenPointToLocation(new u.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new u.P(0,this._helper._height)))}isPointOnMapSurface(e,n){return n?n.pointCoordinate(e)!=null:e.y>this.height/2-zs(this)}calculatePosMatrix(e,n=!1,l){var h;const m=(h=e.key)!==null&&h!==void 0?h:u.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),y=n?this._alignedPosMatrixCache:this._posMatrixCache;if(y.has(m)){const z=y.get(m);return l?z.f32:z.f64}const w=Tr(e,this.worldSize);u.N(w,n?this._alignedProjMatrix:this._viewProjMatrix,w);const S={f64:w,f32:new Float32Array(w)};return y.set(m,S),l?S.f32:S.f64}calculateFogMatrix(e){const n=e.key,l=this._fogMatrixCacheF32;if(l.has(n))return l.get(n);const h=Tr(e,this.worldSize);return u.N(h,this._fogMatrix,h),l.set(n,new Float32Array(h)),l.get(n)}getConstrained(e,n){n=u.ae(+n,this.minZoom,this.maxZoom);const l={center:new u.Q(e.lng,e.lat),zoom:n};let h=this._helper._lngRange;this._helper._renderWorldCopies||h!==null||(h=[-179.9999999999,180-1e-10]);const m=this.tileSize*u.aI(l.zoom);let y=0,w=m,S=0,z=m,k=0,O=0;const{x:B,y:q}=this.size;if(this._helper._latRange){const fe=this._helper._latRange;y=u.S(fe[1])*m,w=u.S(fe[0])*m,w-y<q&&(k=q/(w-y))}h&&(S=u.aL(u.U(h[0])*m,0,m),z=u.aL(u.U(h[1])*m,0,m),z<S&&(z+=m),z-S<B&&(O=B/(z-S)));const{x:Y,y:ne}=fr(m,e);let te,ae;const se=Math.max(O||0,k||0);if(se){const fe=new u.P(O?(z+S)/2:Y,k?(w+y)/2:ne);return l.center=Wl(m,fe).wrap(),l.zoom+=u.ab(se),l}if(this._helper._latRange){const fe=q/2;ne-fe<y&&(ae=y+fe),ne+fe>w&&(ae=w-fe)}if(h){const fe=(S+z)/2;let pe=Y;this._helper._renderWorldCopies&&(pe=u.aL(Y,fe-m/2,fe+m/2));const ge=B/2;pe-ge<S&&(te=S+ge),pe+ge>z&&(te=z-ge)}if(te!==void 0||ae!==void 0){const fe=new u.P(te??Y,ae??ne);l.center=Wl(m,fe).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,n,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,h)}_calculateNearFarZIfNeeded(e,n,l){if(!this._helper.autoCalculateNearFarZ)return;const h=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),m=e-h*this._helper._pixelPerMeter/Math.cos(n),y=h<0?m:e,w=Math.PI/2+this.pitchInRadians,S=u.ad(this.fov)*(Math.abs(Math.cos(u.ad(this.roll)))*this.height+Math.abs(Math.sin(u.ad(this.roll)))*this.width)/this.height*(.5+l.y/this.height),z=Math.sin(S)*y/Math.sin(u.ae(Math.PI-w-S,.01,Math.PI-.01)),k=zs(this),O=Math.atan(k/this._helper.cameraToCenterDistance),B=u.ad(.75),q=O>B?2*O*(.5+l.y/(2*k)):B,Y=Math.sin(q)*y/Math.sin(u.ae(Math.PI-w-q,.01,Math.PI-.01)),ne=Math.min(z,Y);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*ne+y),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,n=fr(this.worldSize,this.center),l=n.x,h=n.y;this._helper._pixelPerMeter=u.aK(1,this.center.lat)*this.worldSize;const m=u.ad(Math.min(this.pitch,89.25)),y=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(m));let w;this._calculateNearFarZIfNeeded(y,m,e),w=new Float64Array(16),u.aY(w,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),u.aj(this._invProjMatrix,w),w[8]=2*-e.x/this._helper._width,w[9]=2*e.y/this._helper._height,this._projectionMatrix=u.aZ(w),u.M(w,w,[1,-1,1]),u.L(w,w,[0,0,-this._helper.cameraToCenterDistance]),u.a_(w,w,-this.rollInRadians),u.a$(w,w,this.pitchInRadians),u.a_(w,w,-this.bearingInRadians),u.L(w,w,[-l,-h,0]),this._mercatorMatrix=u.M([],w,[this.worldSize,this.worldSize,this.worldSize]),u.M(w,w,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=u.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,w),u.L(w,w,[0,0,-this.elevation]),this._viewProjMatrix=w,this._invViewProjMatrix=u.aj([],w);const S=[0,0,-1,1];u.ap(S,S,this._invViewProjMatrix),this._cameraPosition=[S[0]/S[3],S[1]/S[3],S[2]/S[3]],this._fogMatrix=new Float64Array(16),u.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,y,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,u.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),u.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),u.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),u.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),u.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),u.L(this._fogMatrix,this._fogMatrix,[-l,-h,0]),u.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),u.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=u.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,w);const z=this._helper._width%2/2,k=this._helper._height%2/2,O=Math.cos(this.bearingInRadians),B=Math.sin(-this.bearingInRadians),q=l-Math.round(l)+O*z+B*k,Y=h-Math.round(h)+O*k+B*z,ne=new Float64Array(w);if(u.L(ne,ne,[q>.5?q-1:q,Y>.5?Y-1:Y,0]),this._alignedProjMatrix=ne,w=u.aj(new Float64Array(16),this._pixelMatrix),!w)throw new Error("failed to invert matrix");this._pixelMatrixInverse=w,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new u.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return u.ap(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=u.aK(1,this.center.lat)*this.worldSize;return ir(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,n){const l=u.$.fromLngLat(e),h=[l.x*this.worldSize,l.y*this.worldSize,n,1];return u.ap(h,h,this._viewProjMatrix),h[2]/h[3]}getProjectionData(e){const{overscaledTileID:n,aligned:l,applyTerrainMatrix:h}=e,m=this._helper.getMercatorTileCoordinates(n),y=n?this.calculatePosMatrix(n,l,!0):null;let w;return w=n&&n.terrainRttPosMatrix32f&&h?n.terrainRttPosMatrix32f:y||u.b0(),{mainMatrix:w,tileMercatorCoords:m,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,n,l){return 1}transformLightDirection(e){return u.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,n,l,h){const m=this.calculatePosMatrix(l);let y;h?(y=[e,n,h(e,n),1],u.ap(y,y,m)):(y=[e,n,0,1],zn(y,y,m));const w=y[3];return{point:new u.P(y[0]/w,y[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}populateCache(e){for(const n of e)this.calculatePosMatrix(n)}getMatrixForModel(e,n){const l=u.$.fromLngLat(e,n),h=l.meterInMercatorCoordinateUnits(),m=u.b1();return u.L(m,m,[l.x,l.y,l.z]),u.a_(m,m,Math.PI),u.a$(m,m,Math.PI/2),u.M(m,m,[-h,h,h]),m}getProjectionDataForCustomLayer(e=!0){const n=new u.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:e}),h=Tr(n,this.worldSize);u.N(h,this._viewProjMatrix,h),l.tileMercatorCoords=[0,0,1,1];const m=[u.Z,u.Z,this.worldSize/this._helper.pixelsPerMeter],y=u.b2();return u.M(y,h,m),l.fallbackMatrix=y,l.mainMatrix=y,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Yo(){u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function So(f){if(f.useSlerp)if(f.k<1){const e=u.b3(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),n=u.b3(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);u.b4(l,e,n,f.k);const h=u.b5(l);f.tr.setRoll(h.roll),f.tr.setPitch(h.pitch),f.tr.setBearing(h.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(u.B.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(u.B.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(u.B.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function Eo(f,e,n,l,h){const m=h.padding,y=fr(h.worldSize,n.getNorthWest()),w=fr(h.worldSize,n.getNorthEast()),S=fr(h.worldSize,n.getSouthEast()),z=fr(h.worldSize,n.getSouthWest()),k=u.ad(-l),O=y.rotate(k),B=w.rotate(k),q=S.rotate(k),Y=z.rotate(k),ne=new u.P(Math.max(O.x,B.x,Y.x,q.x),Math.max(O.y,B.y,Y.y,q.y)),te=new u.P(Math.min(O.x,B.x,Y.x,q.x),Math.min(O.y,B.y,Y.y,q.y)),ae=ne.sub(te),se=(h.width-(m.left+m.right+e.left+e.right))/ae.x,fe=(h.height-(m.top+m.bottom+e.top+e.bottom))/ae.y;if(fe<0||se<0)return void Yo();const pe=Math.min(u.ab(h.scale*Math.min(se,fe)),f.maxZoom),ge=u.P.convert(f.offset),we=new u.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(u.ad(l)),xe=ge.add(we).mult(h.scale/u.aI(pe));return{center:Wl(h.worldSize,y.add(S).div(2).sub(xe)),zoom:pe,bearing:l}}class On{get useGlobeControls(){return!1}handlePanInertia(e,n){return{easingOffset:e,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(e,n){e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta),e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta)}handleMapControlsPan(e,n,l){e.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,n,l,h,m){return Eo(e,n,l,h,m)}handleJumpToCenterZoom(e,n){e.zoom!==(n.zoom!==void 0?+n.zoom:e.zoom)&&e.setZoom(+n.zoom),n.center!==void 0&&e.setCenter(u.Q.convert(n.center))}handleEaseTo(e,n){const l=e.zoom,h=e.padding,m={roll:e.roll,pitch:e.pitch,bearing:e.bearing},y={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},w=n.zoom!==void 0,S=!e.isPaddingEqual(n.padding);let z=!1;const k=w?+n.zoom:e.zoom;let O=e.centerPoint.add(n.offsetAsPoint);const B=e.screenPointToLocation(O),{center:q,zoom:Y}=e.getConstrained(u.Q.convert(n.center||B),k??l);Qc(e,q);const ne=fr(e.worldSize,B),te=fr(e.worldSize,q).sub(ne),ae=u.aI(Y-l);return z=Y!==l,{easeFunc:se=>{if(z&&e.setZoom(u.B.number(l,Y,se)),u.b6(m,y)||So({startEulerAngles:m,endEulerAngles:y,tr:e,k:se,useSlerp:m.roll!=y.roll}),S&&(e.interpolatePadding(h,n.padding,se),O=e.centerPoint.add(n.offsetAsPoint)),n.around)e.setLocationAtPoint(n.around,n.aroundPoint);else{const fe=u.aI(e.zoom-l),pe=Y>l?Math.min(2,ae):Math.max(.5,ae),ge=Math.pow(pe,1-se),we=Wl(e.worldSize,ne.add(te.mult(se*ge)).mult(fe));e.setLocationAtPoint(e.renderWorldCopies?we.wrap():we,O)}},isZooming:z,elevationCenter:q}}handleFlyTo(e,n){const l=n.zoom!==void 0,h=e.zoom,m=e.getConstrained(u.Q.convert(n.center||n.locationAtOffset),l?+n.zoom:h),y=m.center,w=m.zoom;Qc(e,y);const S=fr(e.worldSize,n.locationAtOffset),z=fr(e.worldSize,y).sub(S),k=z.mag(),O=u.aI(w-h);let B;if(n.minZoom!==void 0){const q=Math.min(+n.minZoom,h,w),Y=e.getConstrained(y,q).zoom;B=u.aI(Y-h)}return{easeFunc:(q,Y,ne,te)=>{e.setZoom(q===1?w:h+u.ab(Y));const ae=q===1?y:Wl(e.worldSize,S.add(z.mult(ne)).mult(Y));e.setLocationAtPoint(e.renderWorldCopies?ae.wrap():ae,te)},scaleOfZoom:O,targetCenter:y,scaleOfMinZoom:B,pixelPathLength:k}}}class Zi{constructor(e,n,l){this.blendFunction=e,this.blendColor=n,this.mask=l}}Zi.Replace=[1,0],Zi.disabled=new Zi(Zi.Replace,u.b7.transparent,[!1,!1,!1,!1]),Zi.unblended=new Zi(Zi.Replace,u.b7.transparent,[!0,!0,!0,!0]),Zi.alphaBlended=new Zi([1,771],u.b7.transparent,[!0,!0,!0,!0]);const Zr=2305;class oi{constructor(e,n,l){this.enable=e,this.mode=n,this.frontFace=l}}oi.disabled=new oi(!1,1029,Zr),oi.backCCW=new oi(!0,1029,Zr),oi.frontCCW=new oi(!0,1028,Zr);class ii{constructor(e,n,l){this.func=e,this.mask=n,this.range=l}}ii.ReadOnly=!1,ii.ReadWrite=!0,ii.disabled=new ii(519,ii.ReadOnly,[0,1]);const Co=7680;class mi{constructor(e,n,l,h,m,y){this.test=e,this.ref=n,this.mask=l,this.fail=h,this.depthFail=m,this.pass=y}}mi.disabled=new mi({func:519,mask:0},0,0,Co,Co,Co);const Mo=new WeakMap;function Gr(f){var e;if(Mo.has(f))return Mo.get(f);{const n=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Mo.set(f,n),n}}class pl{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const n=e.context,l=n.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const h=new u.aF;h.emplaceBack(-1,-1),h.emplaceBack(2,-1),h.emplaceBack(-1,2);const m=new u.aH;m.emplaceBack(0,1,2),this._fullscreenTriangle=new Xo(n.createVertexBuffer(h,Ya.members),n.createIndexBuffer(m),u.aG.simpleSegment(0,0,h.length,m.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(l.TEXTURE1);const y=l.createTexture();l.bindTexture(l.TEXTURE_2D,y),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(y),Gr(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,n){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,n),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,n=e.gl;e.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,n){const l=this._cachedRenderContext.context,h=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:u.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,h.TRIANGLES,ii.disabled,mi.disabled,Zi.unblended,oi.disabled,((m,y)=>({u_input:m,u_output_expected:y}))(e,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Gr(h)){h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.readBuffer(h.COLOR_ATTACHMENT0),h.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null);const m=h.fenceSync(h.SYNC_GPU_COMMANDS_COMPLETE,0);h.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:m}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Gr(e)){const n=e.clientWaitSync(this._readbackQueue.sync,0,0);if(n===e.WAIT_FAILED)return u.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=pl._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let n=0;return n+=e[0]/256,n+=e[1]/65536,n+=e[2]/16777216,e[3]<127&&(n=-n),n/128}}const ur=u.Z/128;function Ka(f,e){const n=f.granularity!==void 0?Math.max(f.granularity,1):1,l=n+(f.generateBorders?2:0),h=n+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),m=l+1,y=h+1,w=f.generateBorders?-1:0,S=f.generateBorders||f.extendToNorthPole?-1:0,z=n+(f.generateBorders?1:0),k=n+(f.generateBorders||f.extendToSouthPole?1:0),O=m*y,B=l*h*6,q=m*y>65536;if(q&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Y=q||e==="32bit",ne=new Int16Array(2*O);let te=0;for(let fe=S;fe<=k;fe++)for(let pe=w;pe<=z;pe++){let ge=pe/n*u.Z;pe===-1&&(ge=-64),pe===n+1&&(ge=u.Z+ur);let we=fe/n*u.Z;fe===-1&&(we=f.extendToNorthPole?u.b9:-64),fe===n+1&&(we=f.extendToSouthPole?u.ba:u.Z+ur),ne[te++]=ge,ne[te++]=we}const ae=Y?new Uint32Array(B):new Uint16Array(B);let se=0;for(let fe=0;fe<h;fe++)for(let pe=0;pe<l;pe++){const ge=pe+1+fe*m,we=pe+(fe+1)*m,xe=pe+1+(fe+1)*m;ae[se++]=pe+fe*m,ae[se++]=we,ae[se++]=ge,ae[se++]=ge,ae[se++]=we,ae[se++]=xe}return{vertices:ne.buffer.slice(0),indices:ae.buffer.slice(0),uses32bitIndices:Y}}const Ko=new u.aE({fill:new u.bb(128,2),line:new u.bb(512,0),tile:new u.bb(128,32),stencil:new u.bb(128,1),circle:3});class Ao{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Bn.projectionGlobe}get vertexShaderPreludeCode(){return Bn.projectionMercator.vertexSource}get subdivisionGranularity(){return Ko}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new pl(e));const n=u.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,h=this._errorMeasurement.updateErrorLoop(n,l),m=_e.now();h!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=h,this._errorMeasurementLastChangeTime=m);const y=Math.min(Math.max((m-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=u.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,u.bd(y))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,n,l,h,m){const y=(m==="stencil"?Ko.stencil:Ko.tile).getGranularityForZoomLevel(n.z);return this._getMesh(e,{granularity:y,generateBorders:l,extendToNorthPole:n.y===0&&h,extendToSouthPole:n.y===(1<<n.z)-1&&h})}_getMesh(e,n){const l=this._getMeshKey(n);if(l in this._tileMeshCache)return this._tileMeshCache[l];const h=function(m,y){const w=Ka(y,"16bit"),S=u.aF.deserialize({arrayBuffer:w.vertices,length:w.vertices.byteLength/2/2}),z=u.aH.deserialize({arrayBuffer:w.indices,length:w.indices.byteLength/2/3});return new Xo(m.createVertexBuffer(S,Ya.members),m.createIndexBuffer(z),u.aG.simpleSegment(0,0,S.length,z.length))}(e,n);return this._tileMeshCache[l]=h,h}recalculate(e){}hasTransition(){const e=_e.now();let n=!1;return n=n||(e-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Jc=new u.r({type:new u.D(u.v.projection.type)});class Wo extends u.E{constructor(e){super(),this._transitionable=new u.T(Jc),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.C(0)),this._mercatorProjection=new _i,this._verticalPerspectiveProjection=new Ao}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof u.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,n,l,h,m){return this.currentProjection.getMeshFromTileID(e,n,l,h,m)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function eu(f){const e=Ql(f.worldSize,f.center.lat);return 2*Math.PI*e}function Ra(f,e,n,l,h){const m=1/(1<<h),y=e/u.Z*m+l*m,w=u.bg((f/u.Z*m+n*m)*Math.PI*2+Math.PI,2*Math.PI),S=2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI,z=Math.cos(S),k=new Float64Array(3);return k[0]=Math.sin(w)*z,k[1]=Math.sin(S),k[2]=Math.cos(w)*z,k}function Yn(f){return function(e,n){const l=Math.cos(n),h=new Float64Array(3);return h[0]=Math.sin(e)*l,h[1]=Math.sin(n),h[2]=Math.cos(e)*l,h}(f.lng*Math.PI/180,f.lat*Math.PI/180)}function Ql(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Kh(f){const e=Math.asin(f[1])/Math.PI*180,n=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(n>1e-6){const l=f[0]/n,h=Math.acos(f[2]/n),m=(l>0?h:-h)/Math.PI*180;return new u.Q(u.aL(m,-180,180),e)}return new u.Q(0,e)}function Er(f){return Math.cos(f*Math.PI/180)}function Kn(f,e){const n=Er(f),l=Er(e);return u.ab(l/n)}function ra(f,e){const n=f.rotate(e.bearingInRadians),l=e.zoom+Kn(e.center.lat,0),h=u.bc(1/Er(e.center.lat),1/Er(Math.min(Math.abs(e.center.lat),60)),u.bf(l,7,3,0,1)),m=360/eu({worldSize:e.worldSize,center:{lat:e.center.lat}});return new u.Q(e.center.lng-n.x*m*h,u.ae(e.center.lat+n.y*m,-85.051129,u.aJ))}function ml(f){const e=.5*f,n=Math.sin(e),l=Math.cos(e);return Math.log(n+l)-Math.log(l-n)}function Ku(f,e,n,l){const h=f.lat+n*l;if(Math.abs(n)>1){const m=(Math.sign(f.lat+n)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,y=Math.abs(f.lat+n)*Math.PI/180,w=ml(m+l*(y-m)),S=ml(m),z=ml(y);return new u.Q(f.lng+e*((w-S)/(z-S)),h)}return new u.Q(f.lng+e*l,h)}class Wh{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,n,l,h){const m=`${e.z}_${e.x}_${e.y}`,y=this._cache.get(m);if(y)return y;const w=this._cachePrevious.get(m);if(w)return this._cache.set(m,w),w;const S=this._aabbFactory(e,n,l,h);return this._cache.set(m,S),this._hadAnyChanges=!0,S}}function zo(f,e,n){const l=f-e;return l<0?-l:Math.max(0,l-n)}function Wu(f,e,n,l,h){const m=f-n;let y;return y=m<0?Math.min(-m,1+m-h):m>1?Math.min(Math.max(m-h,0),1-m):0,Math.max(y,zo(e,l,h))}class Qh{constructor(){this._aabbCache=new Wh(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,n,l,h){const m=1<<l.z,y=1/m,w=l.x/m,S=l.y/m;let z=2;return z=Math.min(z,Wu(e,n,w,S,y)),z=Math.min(z,Wu(e,n,w+.5,-S-y,y)),z=Math.min(z,Wu(e,n,w+.5,2-S-y,y)),z}getWrap(e,n,l){const h=1<<n.z,m=1/h,y=n.x/h,w=zo(e.x,y,m),S=zo(e.x,y-1,m),z=zo(e.x,y+1,m),k=Math.min(w,S,z);return k===z?1:k===S?-1:0}allowVariableZoom(e,n){return Nr(e,n)>4}allowWorldCopies(){return!1}getTileAABB(e,n,l,h){return this._aabbCache.getTileAABB(e,n,l,h)}_computeTileAABB(e,n,l,h){if(e.z<=0)return new Gn([-1,-1,-1],[1,1,1]);if(e.z===1)return new Gn([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const m=[Ra(0,0,e.x,e.y,e.z),Ra(u.Z,0,e.x,e.y,e.z),Ra(u.Z,u.Z,e.x,e.y,e.z),Ra(0,u.Z,e.x,e.y,e.z)],y=[1,1,1],w=[-1,-1,-1];for(const S of m)for(let z=0;z<3;z++)y[z]=Math.min(y[z],S[z]),w[z]=Math.max(w[z],S[z]);if(e.y===0||e.y===(1<<e.z)-1){const S=[0,e.y===0?1:-1,0];for(let z=0;z<3;z++)y[z]=Math.min(y[z],S[z]),w[z]=Math.max(w[z],S[z])}return new Gn(y,w)}}}class tu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n){this._helper.resize(e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=u.bh(),this._projectionMatrix=u.b1(),this._globeViewProjMatrix32f=u.b0(),this._globeViewProjMatrixNoCorrection=u.b1(),this._globeViewProjMatrixNoCorrectionInverted=u.b1(),this._globeProjMatrixInverted=u.b1(),this._cameraPosition=u.bi(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Sr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._coveringTilesDetailsProvider=new Qh}clone(){const e=new tu;return e.apply(this),e}apply(e,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=u.bi();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:n,applyGlobeMatrix:l}=e,h=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:h,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const n=this.pitchInRadians,l=this.cameraToCenterDistance/e,h=Math.sin(n)*l,m=Math.cos(n)*l+1,y=1/Math.sqrt(h*h+m*m)*1;let w=-h,S=m;const z=Math.sqrt(w*w+S*S);w/=z,S/=z;const k=[0,w,S];return u.bj(k,k,[0,0,0],-this.bearingInRadians),u.bk(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),u.bl(k,k,[0,0,0],this.center.lng*Math.PI/180),u.aO(k,k,.25),[...k,.25*-y]}isLocationOccluded(e){return!this.isSurfacePointVisible(Yn(e))}transformLightDirection(e){const n=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,h=Math.cos(l),m=[Math.sin(n)*h,Math.sin(l),Math.cos(n)*h],y=[m[2],0,-m[0]],w=[0,0,0];u.aU(w,y,m),u.aT(y,y),u.aT(w,w);const S=[0,0,0];return u.aT(S,[y[0]*e[0]+w[0]*e[1]+m[0]*e[2],y[1]*e[0]+w[1]*e[1]+m[1]*e[2],y[2]*e[0]+w[2]*e[1]+m[2]*e[2]]),S}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,n,l){const h=function(w,S,z){const k=1/(1<<z.z);return new u.$(w/u.Z*k+z.x*k,S/u.Z*k+z.y*k)}(e,n,l.canonical),m=(y=h.y,[u.bg(h.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI]);var y;return this.getCircleRadiusCorrection()/Math.cos(m[1])}projectTileCoordinates(e,n,l,h){const m=l.canonical,y=Ra(e,n,m.x,m.y,m.z),w=1+(h?h(e,n):0)/u.br,S=[y[0]*w,y[1]*w,y[2]*w,1];u.ap(S,S,this._globeViewProjMatrixNoCorrection);const z=this._cachedClippingPlane,k=z[0]*y[0]+z[1]*y[1]+z[2]*y[2]+z[3]<0;return{point:new u.P(S[0]/S[3],S[1]/S[3]),signedDistanceFromCamera:S[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Ql(this.worldSize,this.center.lat),n=u.b2(),l=u.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),u.aY(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const h=this.centerOffset;n[8]=2*-h.x/this._helper._width,n[9]=2*h.y/this._helper._height,this._projectionMatrix=u.aZ(n),this._globeProjMatrixInverted=u.b2(),u.aj(this._globeProjMatrixInverted,n),u.L(n,n,[0,0,-this.cameraToCenterDistance]),u.a_(n,n,this.rollInRadians),u.a$(n,n,-this.pitchInRadians),u.a_(n,n,this.bearingInRadians),u.L(n,n,[0,0,-e]);const m=u.bi();m[0]=e,m[1]=e,m[2]=e,u.a$(l,n,this.center.lat*Math.PI/180),u.bm(l,l,-this.center.lng*Math.PI/180),u.M(l,l,m),this._globeViewProjMatrixNoCorrection=l,u.a$(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),u.bm(n,n,-this.center.lng*Math.PI/180),u.M(n,n,m),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=u.b2(),u.aj(this._globeViewProjMatrixNoCorrectionInverted,l);const y=u.bi();this._cameraPosition=u.bi(),this._cameraPosition[2]=this.cameraToCenterDistance/e,u.bj(this._cameraPosition,this._cameraPosition,y,-this.rollInRadians),u.bk(this._cameraPosition,this._cameraPosition,y,this.pitchInRadians),u.bj(this._cameraPosition,this._cameraPosition,y,-this.bearingInRadians),u.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),u.bk(this._cameraPosition,this._cameraPosition,y,-this.center.lat*Math.PI/180),u.bl(this._cameraPosition,this._cameraPosition,y,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const w=u.aZ(this._globeViewProjMatrixNoCorrectionInverted);u.M(w,w,[1,1,-1]),this._cachedFrustum=na.fromInvProjectionMatrix(w)}calculateFogMatrix(e){u.w("calculateFogMatrix is not supported on globe projection.");const n=u.b2();return u.at(n),n}getVisibleUnwrappedCoordinates(e){return[new u.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&u.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Yn(e);u.aO(l,l,1+n/u.br);const h=u.bh();return u.ap(h,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),h[2]/h[3]}populateCache(e){}getBounds(){const e=.5*this.width,n=.5*this.height,l=[new u.P(0,0),new u.P(e,0),new u.P(this.width,0),new u.P(this.width,n),new u.P(this.width,this.height),new u.P(e,this.height),new u.P(0,this.height),new u.P(0,n)],h=[];for(const O of l)h.push(this.unprojectScreenPoint(O));let m=0,y=0,w=0,S=0;const z=this.center;for(const O of h){const B=u.bn(z.lng,O.lng),q=u.bn(z.lat,O.lat);B<y&&(y=B),B>m&&(m=B),q<S&&(S=q),q>w&&(w=q)}const k=[z.lng+y,z.lat+S,z.lng+m,z.lat+w];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new Wi(k)}getConstrained(e,n){const l=u.ae(e.lat,-85.051129,u.aJ),h=u.ae(+n,this.minZoom+Kn(0,l),this.maxZoom);return{center:new u.Q(e.lng,l),zoom:h}}calculateCenterFromCameraLngLatAlt(e,n,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,h)}setLocationAtPoint(e,n){const l=Yn(this.unprojectScreenPoint(n)),h=Yn(e),m=u.bi();u.bo(m);const y=u.bi();u.bl(y,l,m,-this.center.lng*Math.PI/180),u.bk(y,y,m,this.center.lat*Math.PI/180);const w=h[0]*h[0]+h[2]*h[2],S=y[0]*y[0];if(w<S)return;const z=Math.sqrt(w-S),k=-z,O=u.bp(h[0],h[2],y[0],z),B=u.bp(h[0],h[2],y[0],k),q=u.bi();u.bl(q,h,m,-O);const Y=u.bp(q[1],q[2],y[1],y[2]),ne=u.bi();u.bl(ne,h,m,-B);const te=u.bp(ne[1],ne[2],y[1],y[2]),ae=.5*Math.PI,se=Y>=-ae&&Y<=ae,fe=te>=-ae&&te<=ae;let pe,ge;if(se&&fe){const ke=this.center.lng*Math.PI/180,We=this.center.lat*Math.PI/180;u.bs(O,ke)+u.bs(Y,We)<u.bs(B,ke)+u.bs(te,We)?(pe=O,ge=Y):(pe=B,ge=te)}else if(se)pe=O,ge=Y;else{if(!fe)return;pe=B,ge=te}const we=pe/Math.PI*180,xe=ge/Math.PI*180,Be=this.center.lat;this.setCenter(new u.Q(we,u.ae(xe,-90,90))),this.setZoom(this.zoom+Kn(Be,this.center.lat))}locationToScreenPoint(e,n){const l=Yn(e);if(n){const h=n.getElevationForLngLatZoom(e,this._helper._tileZoom);u.aO(l,l,1+h/u.br)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const n=u.bh();return u.ap(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new u.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,n){if(n){const l=n.pointCoordinate(e);if(l)return l}return u.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,n){var l;return(l=this.screenPointToMercatorCoordinate(e,n))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,n){const l=this._cameraPosition,h=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,h)}getRayDirectionFromPixel(e){const n=u.bh();n[0]=e.x/this.width*2-1,n[1]=-1*(e.y/this.height*2-1),n[2]=1,n[3]=1,u.ap(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const l=u.bi();l[0]=n[0]-this._cameraPosition[0],l[1]=n[1]-this._cameraPosition[1],l[2]=n[2]-this._cameraPosition[2];const h=u.bi();return u.aT(h,l),h}isSurfacePointVisible(e){const n=this._cachedClippingPlane;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const n=u.bh();return u.ap(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(e,n){const l=u.aV(e,n),h=u.bi(),m=u.bi();u.aO(m,n,l),u.aS(h,e,m);const y=1-u.aV(h,h);if(y<0)return null;const w=u.aV(e,e)-1,S=-l+(l<0?1:-1)*Math.sqrt(y),z=w/S,k=S;return{tMin:Math.min(z,k),tMax:Math.max(z,k)}}unprojectScreenPoint(e){const n=this._cameraPosition,l=this.getRayDirectionFromPixel(e),h=this.rayPlanetIntersection(n,l);if(h){const z=u.bi();u.aP(z,n,[l[0]*h.tMin,l[1]*h.tMin,l[2]*h.tMin]);const k=u.bi();return u.aT(k,z),Kh(k)}const m=this._cachedClippingPlane[0]*l[0]+this._cachedClippingPlane[1]*l[1]+this._cachedClippingPlane[2]*l[2],y=-u.bq(this._cachedClippingPlane,n)/m,w=u.bi();if(y>0)u.aP(w,n,[l[0]*y,l[1]*y,l[2]*y]);else{const z=u.bi();u.aP(z,n,[2*l[0],2*l[1],2*l[2]]);const k=u.bq(this._cachedClippingPlane,z);u.aS(w,z,[this._cachedClippingPlane[0]*k,this._cachedClippingPlane[1]*k,this._cachedClippingPlane[2]*k])}const S=u.bi();return u.aT(S,w),Kh(S)}getMatrixForModel(e,n){const l=u.Q.convert(e),h=1/u.br,m=u.b1();return u.bm(m,m,l.lng/180*Math.PI),u.a$(m,m,-l.lat/180*Math.PI),u.L(m,m,[0,0,1+n/u.br]),u.a$(m,m,.5*Math.PI),u.M(m,m,[h,h,h]),m}getProjectionDataForCustomLayer(e=!0){const n=this.getProjectionData({overscaledTileID:new u.Y(0,0,0,0,0),applyGlobeMatrix:e});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(e){}}class iu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,l=!0){this._helper.resize(e,n,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,n){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Sr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._globeness=1,this._mercatorTransform=new rn,this._verticalPerspectiveTransform=new tu}clone(){const e=new iu;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const n=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:n.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return u.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return u.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,n,l){const h=this._mercatorTransform.getPitchedTextCorrection(e,n,l),m=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,n,l);return u.bc(h,m,this._globeness)}projectTileCoordinates(e,n,l,h){return this.currentTransform.projectTileCoordinates(e,n,l,h)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){return this.currentTransform.lngLatToCameraDepth(e,n)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,n){return this.currentTransform.getConstrained(e,n)}calculateCenterFromCameraLngLatAlt(e,n,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,h)}setLocationAtPoint(e,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,n){return this.currentTransform.locationToScreenPoint(e,n)}screenPointToMercatorCoordinate(e,n){return this.currentTransform.screenPointToMercatorCoordinate(e,n)}screenPointToLocation(e,n){return this.currentTransform.screenPointToLocation(e,n)}isPointOnMapSurface(e,n){return this.currentTransform.isPointOnMapSurface(e,n)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,n){return this.currentTransform.getMatrixForModel(e,n)}getProjectionDataForCustomLayer(e=!0){const n=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return n;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=n.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Pa{get useGlobeControls(){return!0}handlePanInertia(e,n){const l=ra(e,n);return Math.abs(l.lng-n.center.lng)>180&&(l.lng=n.center.lng+179.5*Math.sign(l.lng-n.center.lng)),{easingCenter:l,easingOffset:new u.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,n){const l=e.around,h=n.screenPointToLocation(l);e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta);const m=n.zoom;e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta);const y=n.zoom-m;if(y===0)return;const w=u.bn(n.center.lng,h.lng),S=w/(Math.abs(w/180)+1),z=u.bn(n.center.lat,h.lat),k=n.getRayDirectionFromPixel(l),O=n.cameraPosition,B=-1*u.aV(O,k),q=u.bi();u.aP(q,O,[k[0]*B,k[1]*B,k[2]*B]);const Y=u.bt(q)-1,ne=Math.exp(.5*-Math.max(Y-.3,0)),te=Ql(n.worldSize,n.center.lat)/Math.min(n.width,n.height),ae=u.bf(te,.9,.5,1,.25),se=(1-u.aI(-y))*Math.min(ne,ae),fe=n.center.lat,pe=n.zoom,ge=new u.Q(n.center.lng+S*se,u.ae(n.center.lat+z*se,-85.051129,u.aJ));n.setLocationAtPoint(h,l);const we=n.center,xe=u.bf(Math.abs(w),45,85,0,1),Be=u.bf(te,.75,.35,0,1),ke=Math.pow(Math.max(xe,Be),.25),We=u.bn(we.lng,ge.lng),Qe=u.bn(we.lat,ge.lat);n.setCenter(new u.Q(we.lng+We*ke,we.lat+Qe*ke).wrap()),n.setZoom(pe+Kn(fe,n.center.lat))}handleMapControlsPan(e,n,l){if(!e.panDelta)return;const h=n.center.lat,m=n.zoom;n.setCenter(ra(e.panDelta,n).wrap()),n.setZoom(m+Kn(h,n.center.lat))}cameraForBoxAndBearing(e,n,l,h,m){const y=Eo(e,n,l,h,m),w=n.left/m.width*2-1,S=(m.width-n.right)/m.width*2-1,z=n.top/m.height*-2+1,k=(m.height-n.bottom)/m.height*-2+1,O=u.bn(l.getWest(),l.getEast())<0,B=O?l.getEast():l.getWest(),q=O?l.getWest():l.getEast(),Y=Math.max(l.getNorth(),l.getSouth()),ne=Math.min(l.getNorth(),l.getSouth()),te=B+.5*u.bn(B,q),ae=Y+.5*u.bn(Y,ne),se=m.clone();se.setCenter(y.center),se.setBearing(y.bearing),se.setPitch(0),se.setRoll(0),se.setZoom(y.zoom);const fe=se.modelViewProjectionMatrix,pe=[Yn(l.getNorthWest()),Yn(l.getNorthEast()),Yn(l.getSouthWest()),Yn(l.getSouthEast()),Yn(new u.Q(q,ae)),Yn(new u.Q(B,ae)),Yn(new u.Q(te,Y)),Yn(new u.Q(te,ne))],ge=Yn(y.center);let we=Number.POSITIVE_INFINITY;for(const xe of pe)w<0&&(we=Pa.getLesserNonNegativeNonNull(we,Pa.solveVectorScale(xe,ge,fe,"x",w))),S>0&&(we=Pa.getLesserNonNegativeNonNull(we,Pa.solveVectorScale(xe,ge,fe,"x",S))),z>0&&(we=Pa.getLesserNonNegativeNonNull(we,Pa.solveVectorScale(xe,ge,fe,"y",z))),k<0&&(we=Pa.getLesserNonNegativeNonNull(we,Pa.solveVectorScale(xe,ge,fe,"y",k)));if(Number.isFinite(we)&&we!==0)return y.zoom=se.zoom+u.ab(we),y;Yo()}handleJumpToCenterZoom(e,n){const l=e.center.lat,h=e.getConstrained(n.center?u.Q.convert(n.center):e.center,e.zoom).center;e.setCenter(h.wrap());const m=n.zoom!==void 0?+n.zoom:e.zoom+Kn(l,h.lat);e.zoom!==m&&e.setZoom(m)}handleEaseTo(e,n){const l=e.zoom,h=e.center,m=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},w={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},S=n.zoom!==void 0,z=!e.isPaddingEqual(n.padding);let k=!1;const O=n.center?u.Q.convert(n.center):h,B=e.getConstrained(O,l).center;Qc(e,B);const q=e.clone();q.setCenter(B),q.setZoom(S?+n.zoom:l+Kn(h.lat,O.lat)),q.setBearing(n.bearing);const Y=new u.P(u.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),u.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));q.setLocationAtPoint(B,Y);const ne=(n.offset&&n.offsetAsPoint.mag())>0?q.center:B,te=S?+n.zoom:l+Kn(h.lat,ne.lat),ae=l+Kn(h.lat,0),se=te+Kn(ne.lat,0),fe=u.bn(h.lng,ne.lng),pe=u.bn(h.lat,ne.lat),ge=u.aI(se-ae);return k=te!==l,{easeFunc:we=>{if(u.b6(y,w)||So({startEulerAngles:y,endEulerAngles:w,tr:e,k:we,useSlerp:y.roll!=w.roll}),z&&e.interpolatePadding(m,n.padding,we),n.around)u.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(n.around,n.aroundPoint);else{const xe=se>ae?Math.min(2,ge):Math.max(.5,ge),Be=Math.pow(xe,1-we),ke=Ku(h,fe,pe,we*Be);e.setCenter(ke.wrap())}if(k){const xe=u.B.number(ae,se,we)+Kn(0,e.center.lat);e.setZoom(xe)}},isZooming:k,elevationCenter:ne}}handleFlyTo(e,n){const l=n.zoom!==void 0,h=e.center,m=e.zoom,y=e.padding,w=!e.isPaddingEqual(n.padding),S=e.getConstrained(u.Q.convert(n.center||n.locationAtOffset),m).center,z=l?+n.zoom:e.zoom+Kn(e.center.lat,S.lat),k=e.clone();k.setCenter(S),k.setZoom(z),k.setBearing(n.bearing);const O=new u.P(u.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),u.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));k.setLocationAtPoint(S,O);const B=k.center;Qc(e,B);const q=function(pe,ge,we){const xe=Yn(ge),Be=Yn(we),ke=u.aV(xe,Be),We=Math.acos(ke),Qe=eu(pe);return We/(2*Math.PI)*Qe}(e,h,B),Y=m+Kn(h.lat,0),ne=z+Kn(B.lat,0),te=u.aI(ne-Y);let ae;if(typeof n.minZoom=="number"){const pe=+n.minZoom+Kn(B.lat,0),ge=Math.min(pe,Y,ne)+Kn(0,B.lat),we=e.getConstrained(B,ge).zoom+Kn(B.lat,0);ae=u.aI(we-Y)}const se=u.bn(h.lng,B.lng),fe=u.bn(h.lat,B.lat);return{easeFunc:(pe,ge,we,xe)=>{const Be=Ku(h,se,fe,we);w&&e.interpolatePadding(y,n.padding,pe);const ke=pe===1?B:Be;e.setCenter(ke.wrap());const We=Y+u.ab(ge);e.setZoom(pe===1?z:We+Kn(0,ke.lat))},scaleOfZoom:te,targetCenter:B,scaleOfMinZoom:ae,pixelPathLength:q}}static solveVectorScale(e,n,l,h,m){const y=h==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],w=[l[3],l[7],l[11],l[15]],S=e[0]*y[0]+e[1]*y[1]+e[2]*y[2],z=e[0]*w[0]+e[1]*w[1]+e[2]*w[2],k=n[0]*y[0]+n[1]*y[1]+n[2]*y[2],O=n[0]*w[0]+n[1]*w[1]+n[2]*w[2];return k+m*z===S+m*O||w[3]*(S-k)+y[3]*(O-z)+S*O==k*z?null:(k+y[3]-m*O-m*w[3])/(k-S-m*O+m*z)}static getLesserNonNegativeNonNull(e,n){return n!==null&&n>=0&&n<e?n:e}}class Jh{constructor(e){this._globe=e,this._mercatorCameraHelper=new On,this._verticalPerspectiveCameraHelper=new Pa}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,n){return this.currentHelper.handlePanInertia(e,n)}handleMapControlsRollPitchBearingZoom(e,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,n)}handleMapControlsPan(e,n,l){this.currentHelper.handleMapControlsPan(e,n,l)}cameraForBoxAndBearing(e,n,l,h,m){return this.currentHelper.cameraForBoxAndBearing(e,n,l,h,m)}handleJumpToCenterZoom(e,n){this.currentHelper.handleJumpToCenterZoom(e,n)}handleEaseTo(e,n){return this.currentHelper.handleEaseTo(e,n)}handleFlyTo(e,n){return this.currentHelper.handleFlyTo(e,n)}}const Ro=(f,e)=>u.x(f,e&&e.filter(n=>n.identifier!=="source.canvas")),Qu=u.bu();class gl extends u.E{constructor(e,n={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const h=this.sourceCaches[l].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new kn(qt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,h)=>this.getGlyphs(l,h)),this.dispatcher.registerMessageHandler("GI",(l,h)=>this.getImages(l,h)),this.imageManager=new Bi,this.imageManager.setEventedParent(this),this.glyphManager=new Ki(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new Te(256,512),this.crossTileSymbolIndex=new Ms,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.bv,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",u.bw()),hn().on(Ri,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const h=this.sourceCaches[l.sourceId];if(!h)return;const m=h.getSource();if(m&&m.vectorLayerIds)for(const y in this._layers){const w=this._layers[y];w.source===m.id&&this._validateLayer(w)}})}loadURL(e,n={},l){this.fire(new u.l("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;const h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;u.j(h,this._loadStyleRequest).then(y=>{this._loadStyleRequest=null,this._load(y.data,n,l)}).catch(y=>{this._loadStyleRequest=null,y&&!m.signal.aborted&&this.fire(new u.k(y))})}loadJSON(e,n={},l){this.fire(new u.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,_e.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(e,n,l)}).catch(()=>{})}loadEmpty(){this.fire(new u.l("dataloading",{dataType:"style"})),this._load(Qu,{validate:!1})}_load(e,n,l){var h,m;const y=n.transformStyle?n.transformStyle(l,e):e;if(!n.validate||!Ro(this,u.y(y))){this._loaded=!0,this.stylesheet=y;for(const w in y.sources)this.addSource(w,y.sources[w],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new xt(this.stylesheet.light),this._setProjectionInternal(((h=this.stylesheet.projection)===null||h===void 0?void 0:h.type)||"mercator"),this.sky=new ui(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new u.l("data",{dataType:"style"})),this.fire(new u.l("style.load"))}}_createLayers(){const e=u.bx(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(n=>n.id),this._layers={},this._serializedLayers=null;for(const n of e){const l=u.by(n);l.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=l}}_loadSprite(e,n=!1,l=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,y,w,S){return u._(this,void 0,void 0,function*(){const z=zt(m),k=w>1?"@2x":"",O={},B={};for(const{id:q,url:Y}of z){const ne=y.transformRequest(yt(Y,k,".json"),"SpriteJSON");O[q]=u.j(ne,S);const te=y.transformRequest(yt(Y,k,".png"),"SpriteImage");B[q]=dt.getImage(te,S)}return yield Promise.all([...Object.values(O),...Object.values(B)]),function(q,Y){return u._(this,void 0,void 0,function*(){const ne={};for(const te in q){ne[te]={};const ae=_e.getImageCanvasContext((yield Y[te]).data),se=(yield q[te]).data;for(const fe in se){const{width:pe,height:ge,x:we,y:xe,sdf:Be,pixelRatio:ke,stretchX:We,stretchY:Qe,content:Ye,textFitWidth:gt,textFitHeight:ft}=se[fe];ne[te][fe]={data:null,pixelRatio:ke,sdf:Be,stretchX:We,stretchY:Qe,content:Ye,textFitWidth:gt,textFitHeight:ft,spriteData:{width:pe,height:ge,x:we,y:xe,context:ae}}}}return ne})}(O,B)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const y in m){this._spritesImagesIds[y]=[];const w=this._spritesImagesIds[y]?this._spritesImagesIds[y].filter(S=>!(S in m)):[];for(const S of w)this.imageManager.removeImage(S),this._changedImages[S]=!0;for(const S in m[y]){const z=y==="default"?S:`${y}:${S}`;this._spritesImagesIds[y].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,m[y][S],!1):this.imageManager.addImage(z,m[y][S]),n&&(this._changedImages[z]=!0)}}}).catch(m=>{this._spriteRequest=null,h=m,this.fire(new u.k(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"})),l&&l(h)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const l=e.sourceLayer;if(!l)return;const h=n.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(l)===-1)&&this.fire(new u.k(new Error(`Source layer "${l}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,n=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(n?u.bz(l):l);const h=[];for(const m of e)if(l[m]){const y=n?u.bz(l[m]):l[m];h.push(y)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const n=Object.keys(this._layers);for(const l of n){const h=this._layers[l];h.type!=="custom"&&(e[l]=h.serialize())}return e}hasTransitions(){var e,n,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(n){const h=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(h.length||m.length)&&this._updateWorkerLayers(h,m);for(const y in this._updatedSources){const w=this._updatedSources[y];if(w==="reload")this._reloadSource(y);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(y)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const y in this._updatedPaintProps)this._layers[y].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const h in this.sourceCaches){const m=this.sourceCaches[h];l[h]=m.used,m.used=!1}for(const h of this._order){const m=this._layers[h];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const h in l){const m=this.sourceCaches[h];!!l[h]!=!!m.used&&m.fire(new u.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,n&&this.fire(new u.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,n={}){var l;this._checkLoaded();const h=this.serialize();if(e=n.transformStyle?n.transformStyle(h,e):e,((l=n.validate)===null||l===void 0||l)&&Ro(this,u.y(e)))return!1;(e=u.bz(e)).layers=u.bx(e.layers);const m=u.bA(h,e),y=this._getOperationsToPerform(m);if(y.unimplemented.length>0)throw new Error(`Unimplemented: ${y.unimplemented.join(", ")}.`);if(y.operations.length===0)return!1;for(const w of y.operations)w();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const n=[],l=[];for(const h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":n.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":n.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,h.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setSky":n.push(()=>this.setSky.apply(this,h.args));break;case"setProjection":this.setProjection.apply(this,h.args);break;case"setTransition":n.push(()=>{});break;default:l.push(h.command)}return{operations:n,unimplemented:l}}addImage(e,n){if(this.getImage(e))return this.fire(new u.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,n){this.imageManager.updateImage(e,n)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new u.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(u.y.source,`sources.${e}`,n,null,l))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const h=this.sourceCaches[e]=new $(e,n,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new u.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new u.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,n){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(n),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n,l={}){this._checkLoaded();const h=e.id;if(this.getLayer(h))return void this.fire(new u.k(new Error(`Layer "${h}" already exists on this map.`)));let m;if(e.type==="custom"){if(Ro(this,u.bB(e)))return;m=u.by(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=u.bz(e),e=u.e(e,{source:h})),this._validate(u.y.layer,`layers.${h}`,e,{arrayIndex:-1},l))return;m=u.by(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:h}})}const y=n?this._order.indexOf(n):this._order.length;if(n&&y===-1)this.fire(new u.k(new Error(`Cannot add layer "${h}" before non-existing layer "${n}".`)));else{if(this._order.splice(y,0,h),this._layerOrderChanged=!0,this._layers[h]=m,this._removedLayers[h]&&m.source&&m.type!=="custom"){const w=this._removedLayers[h];delete this._removedLayers[h],w.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new u.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const l=this._order.indexOf(e);this._order.splice(l,1);const h=n?this._order.indexOf(n):this._order.length;n&&h===-1?this.fire(new u.k(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new u.k(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,l){this._checkLoaded();const h=this.getLayer(e);h?h.minzoom===n&&h.maxzoom===l||(n!=null&&(h.minzoom=n),l!=null&&(h.maxzoom=l),this._updateLayer(h)):this.fire(new u.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,l={}){this._checkLoaded();const h=this.getLayer(e);if(h){if(!u.bC(h.filter,n))return n==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(u.y.filter,`layers.${h.id}.filter`,n,null,l)||(h.filter=u.bz(n),this._updateLayer(h)))}else this.fire(new u.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return u.bz(this.getLayer(e).filter)}setLayoutProperty(e,n,l,h={}){this._checkLoaded();const m=this.getLayer(e);m?u.bC(m.getLayoutProperty(n),l)||(m.setLayoutProperty(n,l,h),this._updateLayer(m)):this.fire(new u.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){const l=this.getLayer(e);if(l)return l.getLayoutProperty(n);this.fire(new u.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,l,h={}){this._checkLoaded();const m=this.getLayer(e);m?u.bC(m.getPaintProperty(n),l)||(m.setPaintProperty(n,l,h)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new u.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,n){return this.getLayer(e).getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();const l=e.source,h=e.sourceLayer,m=this.sourceCaches[l];if(m===void 0)return void this.fire(new u.k(new Error(`The source '${l}' does not exist in the map's style.`)));const y=m.getSource().type;y==="geojson"&&h?this.fire(new u.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):y!=="vector"||h?(e.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),m.setFeatureState(h,e.id,n)):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const l=e.source,h=this.sourceCaches[l];if(h===void 0)return void this.fire(new u.k(new Error(`The source '${l}' does not exist in the map's style.`)));const m=h.getSource().type,y=m==="vector"?e.sourceLayer:void 0;m!=="vector"||y?n&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new u.k(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(y,e.id,n):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,l=e.sourceLayer,h=this.sourceCaches[n];if(h!==void 0)return h.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),h.getFeatureState(l,e.id)):void this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.k(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=u.bD(this.sourceCaches,m=>m.serialize()),n=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,h=this.stylesheet;return u.bE({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,projection:h.projection,sources:e,layers:n,terrain:l},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const n=y=>this._layers[y].type==="fill-extrusion",l={},h=[];for(let y=this._order.length-1;y>=0;y--){const w=this._order[y];if(n(w)){l[w]=y;for(const S of e){const z=S[w];if(z)for(const k of z)h.push(k)}}}h.sort((y,w)=>w.intersectionZ-y.intersectionZ);const m=[];for(let y=this._order.length-1;y>=0;y--){const w=this._order[y];if(n(w))for(let S=h.length-1;S>=0;S--){const z=h[S].feature;if(l[z.layer.id]<y)break;m.push(z),h.pop()}else for(const S of e){const z=S[w];if(z)for(const k of z)m.push(k.feature)}}return m}queryRenderedFeatures(e,n,l){n&&n.filter&&this._validate(u.y.filter,"queryRenderedFeatures.filter",n.filter,null,n);const h={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new u.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const z of n.layers){const k=this._layers[z];if(!k)return this.fire(new u.k(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];h[k.source]=!0}}const m=[];n.availableImages=this._availableImages;const y=this._serializedAllLayers(),w=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,S=Object.assign(Object.assign({},n),{layers:w});for(const z in this.sourceCaches)n.layers&&!h[z]||m.push(vo(this.sourceCaches[z],this._layers,y,e,S,l,this.map.terrain?(k,O,B)=>this.map.terrain.getElevation(k,O,B):void 0));return this.placement&&m.push(function(z,k,O,B,q,Y,ne){const te={},ae=Y.queryRenderedSymbols(B),se=[];for(const fe of Object.keys(ae).map(Number))se.push(ne[fe]);se.sort(Vn);for(const fe of se){const pe=fe.featureIndex.lookupSymbolFeatures(ae[fe.bucketInstanceId],k,fe.bucketIndex,fe.sourceLayerIndex,q.filter,q.layers,q.availableImages,z);for(const ge in pe){const we=te[ge]=te[ge]||[],xe=pe[ge];xe.sort((Be,ke)=>{const We=fe.featureSortOrder;if(We){const Qe=We.indexOf(Be.featureIndex);return We.indexOf(ke.featureIndex)-Qe}return ke.featureIndex-Be.featureIndex});for(const Be of xe)we.push(Be)}}return function(fe,pe,ge){for(const we in fe)for(const xe of fe[we])Cn(xe,ge[pe[we].source]);return fe}(te,z,O)}(this._layers,y,this.sourceCaches,e,S,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,n){n&&n.filter&&this._validate(u.y.filter,"querySourceFeatures.filter",n.filter,null,n);const l=this.sourceCaches[e];return l?function(h,m){const y=h.getRenderableIds().map(z=>h.getTileByID(z)),w=[],S={};for(let z=0;z<y.length;z++){const k=y[z],O=k.tileID.canonical.key;S[O]||(S[O]=!0,k.querySourceFeatures(w,m))}return w}(l,n):[]}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const l=this.light.getLight();let h=!1;for(const y in e)if(!u.bC(e[y],l[y])){h=!0;break}if(!h)return;const m={now:_e.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(m)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,n={}){this._checkLoaded();const l=this.getSky();let h=!1;if(!e&&!l)return;if(e&&!l)h=!0;else if(!e&&l)h=!0;else for(const y in e)if(!u.bC(e[y],l[y])){h=!0;break}if(!h)return;const m={now:_e.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(m)}_setProjectionInternal(e){const n=function(l){if(Array.isArray(l)){const h=new Wo({type:l});return{projection:h,transform:new iu,cameraHelper:new Jh(h)}}switch(l){case"mercator":return{projection:new _i,transform:new rn,cameraHelper:new On};case"globe":{const h=new Wo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:h,transform:new iu,cameraHelper:new Jh(h)}}case"vertical-perspective":return{projection:new Ao,transform:new tu,cameraHelper:new Pa};default:return u.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new _i,transform:new rn,cameraHelper:new On}}}(e);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,n,l,h,m={}){return(!m||m.validate!==!1)&&Ro(this,e.call(u.y,u.e({key:n,style:this.serialize(),value:l,styleSpec:u.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),hn().off(Ri,this._rtlPluginLoaded);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const l=this.sourceCaches[n];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const n in this.sourceCaches)this.sourceCaches[n].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,n,l,h,m=!1){let y=!1,w=!1;const S={};for(const z of this._order){const k=this._layers[z];if(k.type!=="symbol")continue;if(!S[k.source]){const B=this.sourceCaches[k.source];S[k.source]=B.getRenderableIds(!0).map(q=>B.getTileByID(q)).sort((q,Y)=>Y.tileID.overscaledZ-q.tileID.overscaledZ||(q.tileID.isLessThan(Y.tileID)?-1:1))}const O=this.crossTileSymbolIndex.addLayer(k,S[k.source],e.center.lng);y=y||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(_e.now(),e.zoom))&&(this.pauseablePlacement=new ia(e,this.map.terrain,this._order,m,n,l,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(_e.now()),w=!0),y&&this.pauseablePlacement.placement.setStale()),w||y)for(const z of this._order){const k=this._layers[z];k.type==="symbol"&&this.placement.updateLayerOpacities(k,S[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(_e.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return u._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[n.source];return h&&h.setDependencies(n.tileID.key,n.type,n.icons),l})}getGlyphs(e,n){return u._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(n.stacks),h=this.sourceCaches[n.source];return h&&h.setDependencies(n.tileID.key,n.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,n={}){this._checkLoaded(),e&&this._validate(u.y.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n,l={},h){this._checkLoaded();const m=[{id:e,url:n}],y=[...zt(this.stylesheet.sprite),...m];this._validate(u.y.sprite,"sprite",y,null,l)||(this.stylesheet.sprite=y,this._loadSprite(m,!0,h))}removeSprite(e){this._checkLoaded();const n=zt(this.stylesheet.sprite);if(n.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;n.splice(n.findIndex(l=>l.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}else this.fire(new u.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return zt(this.stylesheet.sprite)}setSprite(e,n={},l){this._checkLoaded(),e&&this._validate(u.y.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Ju=u.aD([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class nu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,n,l,h,m,y,w,S,z){this.context=e;let k=this.boundPaintVertexBuffers.length!==h.length;for(let O=0;!k&&O<h.length;O++)this.boundPaintVertexBuffers[O]!==h[O]&&(k=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==l||k||this.boundIndexBuffer!==m||this.boundVertexOffset!==y||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==S||this.boundDynamicVertexBuffer3!==z?this.freshBind(n,l,h,m,y,w,S,z):(e.bindVertexArray.set(this.vao),w&&w.bind(),m&&m.dynamicDraw&&m.bind(),S&&S.bind(),z&&z.bind())}freshBind(e,n,l,h,m,y,w,S){const z=e.numAttributes,k=this.context,O=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=h,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=S,n.enableAttributes(O,e);for(const B of l)B.enableAttributes(O,e);y&&y.enableAttributes(O,e),w&&w.enableAttributes(O,e),S&&S.enableAttributes(O,e),n.bind(),n.setVertexAttribPointers(O,e,m);for(const B of l)B.bind(),B.setVertexAttribPointers(O,e,m);y&&(y.bind(),y.setVertexAttribPointers(O,e,m)),h&&h.bind(),w&&(w.bind(),w.setVertexAttribPointers(O,e,m)),S&&(S.bind(),S.setVertexAttribPointers(O,e,m)),k.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Wa=(f,e,n,l,h)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:n?n.properties.get("fog-color"):u.b7.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?0:n?n.calculateFogBlendOpacity(l):0,u_horizon_color:n?n.properties.get("horizon-color"):u.b7.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:h?1:0}),tf={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function _l(f){const e=[];for(let n=0;n<f.length;n++){if(f[n]===null)continue;const l=f[n].split(" ");e.push(l.pop())}return e}class Jl{constructor(e,n,l,h,m,y,w,S){const z=e.gl;this.program=z.createProgram();const k=_l(n.staticAttributes),O=l?l.getBinderAttributes():[],B=k.concat(O),q=Bn.prelude.staticUniforms?_l(Bn.prelude.staticUniforms):[],Y=w.staticUniforms?_l(w.staticUniforms):[],ne=n.staticUniforms?_l(n.staticUniforms):[],te=l?l.getBinderUniforms():[],ae=q.concat(Y).concat(ne).concat(te),se=[];for(const ke of ae)se.indexOf(ke)<0&&se.push(ke);const fe=l?l.defines():[];Gr(z)&&fe.unshift("#version 300 es"),m&&fe.push("#define OVERDRAW_INSPECTOR;"),y&&fe.push("#define TERRAIN3D;"),S&&fe.push(S);let pe=fe.concat(Bn.prelude.fragmentSource,w.fragmentSource,n.fragmentSource).join(`
`),ge=fe.concat(Bn.prelude.vertexSource,w.vertexSource,n.vertexSource).join(`
`);Gr(z)||(pe=function(ke){return ke.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(pe),ge=function(ke){return ke.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ge));const we=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(we,pe),z.compileShader(we),!z.getShaderParameter(we,z.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${z.getShaderInfoLog(we)}`);z.attachShader(this.program,we);const xe=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(xe,ge),z.compileShader(xe),!z.getShaderParameter(xe,z.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${z.getShaderInfoLog(xe)}`);z.attachShader(this.program,xe),this.attributes={};const Be={};this.numAttributes=B.length;for(let ke=0;ke<this.numAttributes;ke++)B[ke]&&(z.bindAttribLocation(this.program,ke,B[ke]),this.attributes[B[ke]]=ke);if(z.linkProgram(this.program),!z.getProgramParameter(this.program,z.LINK_STATUS))throw new Error(`Program failed to link: ${z.getProgramInfoLog(this.program)}`);z.deleteShader(xe),z.deleteShader(we);for(let ke=0;ke<se.length;ke++){const We=se[ke];if(We&&!Be[We]){const Qe=z.getUniformLocation(this.program,We);Qe&&(Be[We]=Qe)}}this.fixedUniforms=h(e,Be),this.terrainUniforms=((ke,We)=>({u_depth:new u.bF(ke,We.u_depth),u_terrain:new u.bF(ke,We.u_terrain),u_terrain_dim:new u.b8(ke,We.u_terrain_dim),u_terrain_matrix:new u.bH(ke,We.u_terrain_matrix),u_terrain_unpack:new u.bI(ke,We.u_terrain_unpack),u_terrain_exaggeration:new u.b8(ke,We.u_terrain_exaggeration)}))(e,Be),this.projectionUniforms=((ke,We)=>({u_projection_matrix:new u.bH(ke,We.u_projection_matrix),u_projection_tile_mercator_coords:new u.bI(ke,We.u_projection_tile_mercator_coords),u_projection_clipping_plane:new u.bI(ke,We.u_projection_clipping_plane),u_projection_transition:new u.b8(ke,We.u_projection_transition),u_projection_fallback_matrix:new u.bH(ke,We.u_projection_fallback_matrix)}))(e,Be),this.binderUniforms=l?l.getUniforms(e,Be):[]}draw(e,n,l,h,m,y,w,S,z,k,O,B,q,Y,ne,te,ae,se,fe){const pe=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(h),e.setColorMode(m),e.setCullFace(y),S){e.activeTexture.set(pe.TEXTURE2),pe.bindTexture(pe.TEXTURE_2D,S.depthTexture),e.activeTexture.set(pe.TEXTURE3),pe.bindTexture(pe.TEXTURE_2D,S.texture);for(const we in this.terrainUniforms)this.terrainUniforms[we].set(S[we])}if(z)for(const we in z)this.projectionUniforms[tf[we]].set(z[we]);if(w)for(const we in this.fixedUniforms)this.fixedUniforms[we].set(w[we]);te&&te.setUniforms(e,this.binderUniforms,Y,{zoom:ne});let ge=0;switch(n){case pe.LINES:ge=2;break;case pe.TRIANGLES:ge=3;break;case pe.LINE_STRIP:ge=1}for(const we of q.get()){const xe=we.vaos||(we.vaos={});(xe[k]||(xe[k]=new nu)).bind(e,this,O,te?te.getPaintVertexBuffers():[],B,we.vertexOffset,ae,se,fe),pe.drawElements(n,we.primitiveLength*ge,pe.UNSIGNED_SHORT,we.primitiveOffset*ge*2)}}}function yl(f,e,n){const l=1/u.aw(n,1,e.transform.tileZoom),h=Math.pow(2,n.tileID.overscaledZ),m=n.tileSize*Math.pow(2,e.transform.tileZoom)/h,y=m*(n.tileID.canonical.x+n.tileID.wrap*h),w=m*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[y>>16,w>>16],u_pixel_coord_lower:[65535&y,65535&w]}}const ed=(f,e,n,l)=>{const h=f.style.light,m=h.properties.get("position"),y=[m.x,m.y,m.z],w=u.bL();h.properties.get("anchor")==="viewport"&&u.bM(w,f.transform.bearingInRadians),u.bN(y,y,w);const S=f.transform.transformLightDirection(y),z=h.properties.get("color");return{u_lightpos:y,u_lightpos_globe:S,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[z.r,z.g,z.b],u_vertical_gradient:+e,u_opacity:n,u_fill_translate:l}},ru=(f,e,n,l,h,m,y)=>u.e(ed(f,e,n,l),yl(m,f,y),{u_height_factor:-Math.pow(2,h.overscaledZ)/y.tileSize/8}),td=(f,e,n,l)=>u.e(yl(e,f,n),{u_fill_translate:l}),vl=(f,e)=>({u_world:f,u_fill_translate:e}),eh=(f,e,n,l,h)=>u.e(td(f,e,n,h),{u_world:l}),xl=(f,e,n,l,h)=>{const m=f.transform;let y,w,S=0;if(n.paint.get("circle-pitch-alignment")==="map"){const z=u.aw(e,1,m.zoom);y=!0,w=[z,z],S=z/(u.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*h}else y=!1,w=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+y,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:w,u_globe_extrude_scale:S,u_translate:l}},nf=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),th=f=>({u_viewport_size:[f.width,f.height]}),ec=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),au=(f,e,n,l)=>{const h=u.aw(f,1,e)/(u.Z*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:u.aw(f,1,e),u_intensity:n,u_globe_extrude_scale:h}},ou=(f,e,n,l)=>{const h=u.K();u.bO(h,0,f.width,f.height,0,0,1);const m=f.context.gl;return{u_matrix:h,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:n,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},ih=(f,e,n)=>{const l=n.paint.get("hillshade-shadow-color"),h=n.paint.get("hillshade-highlight-color"),m=n.paint.get("hillshade-accent-color");let y=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);return n.paint.get("hillshade-illumination-anchor")==="viewport"&&(y+=f.transform.bearingInRadians),{u_image:0,u_latrange:Is(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),y],u_shadow:l,u_highlight:h,u_accent:m}},Ps=(f,e)=>{const n=e.stride,l=u.K();return u.bO(l,0,u.Z,-8192,0,0,1),u.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[n,n],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function Is(f,e){const n=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new u.$(0,l/n).toLngLat().lat,new u.$(0,(l+1)/n).toLngLat().lat]}const su=(f,e,n,l)=>{const h=f.transform;return{u_translation:wl(f,e,n),u_ratio:l/u.aw(e,1,h.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},id=(f,e,n,l,h)=>u.e(su(f,e,n,l),{u_image:0,u_image_height:h}),bl=(f,e,n,l,h)=>{const m=f.transform,y=Po(e,m);return{u_translation:wl(f,e,n),u_texsize:e.imageAtlasTexture.size,u_ratio:l/u.aw(e,1,m.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[y,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},nd=(f,e,n,l,h,m)=>{const y=f.lineAtlas,w=Po(e,f.transform),S=n.layout.get("line-cap")==="round",z=y.getDash(h.from,S),k=y.getDash(h.to,S),O=z.width*m.fromScale,B=k.width*m.toScale;return u.e(su(f,e,n,l),{u_patternscale_a:[w/O,-z.height/2],u_patternscale_b:[w/B,-k.height/2],u_sdfgamma:y.width/(256*Math.min(O,B)*f.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:k.y,u_mix:m.t})};function Po(f,e){return 1/u.aw(f,1,e.tileZoom)}function wl(f,e,n){return u.ax(f.transform,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const rf=(f,e,n,l,h)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(y=l.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(m=l.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:tc(l.paint.get("raster-hue-rotate")),u_coords_top:[h[0].x,h[0].y,h[1].x,h[1].y],u_coords_bottom:[h[3].x,h[3].y,h[2].x,h[2].y]};var m,y};function tc(f){f*=Math.PI/180;const e=Math.sin(f),n=Math.cos(f);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const lu=(f,e,n,l,h,m,y,w,S,z,k,O,B)=>{const q=y.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:q.width/q.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_label_plane_matrix:w,u_coord_matrix:S,u_is_text:+k,u_pitch_with_map:+l,u_is_along_line:h,u_is_variable_anchor:m,u_texsize:O,u_texture:0,u_translation:z,u_pitched_scale:B}},cu=(f,e,n,l,h,m,y,w,S,z,k,O,B,q)=>{const Y=y.transform;return u.e(lu(f,e,n,l,h,m,y,w,S,z,k,O,q),{u_gamma_scale:l?Math.cos(Y.pitch*Math.PI/180)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:1})},ic=(f,e,n,l,h,m,y,w,S,z,k,O,B)=>u.e(cu(f,e,n,l,h,m,y,w,S,z,!0,k,0,B),{u_texsize_icon:O,u_texture_icon:1}),uu=(f,e)=>({u_opacity:f,u_color:e}),nc=(f,e,n,l,h)=>u.e(function(m,y,w,S){const z=w.imageManager.getPattern(m.from.toString()),k=w.imageManager.getPattern(m.to.toString()),{width:O,height:B}=w.imageManager.getPixelSize(),q=Math.pow(2,S.tileID.overscaledZ),Y=S.tileSize*Math.pow(2,w.transform.tileZoom)/q,ne=Y*(S.tileID.canonical.x+S.tileID.wrap*q),te=Y*S.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[O,B],u_mix:y.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:y.fromScale,u_scale_b:y.toScale,u_tile_units_to_pixels:1/u.aw(S,1,w.transform.tileZoom),u_pixel_coord_upper:[ne>>16,te>>16],u_pixel_coord_lower:[65535&ne,65535&te]}}(n,h,e,l),{u_opacity:f}),Ia=(f,e)=>{},hu={fillExtrusion:(f,e)=>({u_lightpos:new u.bJ(f,e.u_lightpos),u_lightpos_globe:new u.bJ(f,e.u_lightpos_globe),u_lightintensity:new u.b8(f,e.u_lightintensity),u_lightcolor:new u.bJ(f,e.u_lightcolor),u_vertical_gradient:new u.b8(f,e.u_vertical_gradient),u_opacity:new u.b8(f,e.u_opacity),u_fill_translate:new u.bK(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new u.bJ(f,e.u_lightpos),u_lightpos_globe:new u.bJ(f,e.u_lightpos_globe),u_lightintensity:new u.b8(f,e.u_lightintensity),u_lightcolor:new u.bJ(f,e.u_lightcolor),u_vertical_gradient:new u.b8(f,e.u_vertical_gradient),u_height_factor:new u.b8(f,e.u_height_factor),u_opacity:new u.b8(f,e.u_opacity),u_fill_translate:new u.bK(f,e.u_fill_translate),u_image:new u.bF(f,e.u_image),u_texsize:new u.bK(f,e.u_texsize),u_pixel_coord_upper:new u.bK(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bK(f,e.u_pixel_coord_lower),u_scale:new u.bJ(f,e.u_scale),u_fade:new u.b8(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new u.bK(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new u.bF(f,e.u_image),u_texsize:new u.bK(f,e.u_texsize),u_pixel_coord_upper:new u.bK(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bK(f,e.u_pixel_coord_lower),u_scale:new u.bJ(f,e.u_scale),u_fade:new u.b8(f,e.u_fade),u_fill_translate:new u.bK(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new u.bK(f,e.u_world),u_fill_translate:new u.bK(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new u.bK(f,e.u_world),u_image:new u.bF(f,e.u_image),u_texsize:new u.bK(f,e.u_texsize),u_pixel_coord_upper:new u.bK(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bK(f,e.u_pixel_coord_lower),u_scale:new u.bJ(f,e.u_scale),u_fade:new u.b8(f,e.u_fade),u_fill_translate:new u.bK(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new u.b8(f,e.u_camera_to_center_distance),u_scale_with_map:new u.bF(f,e.u_scale_with_map),u_pitch_with_map:new u.bF(f,e.u_pitch_with_map),u_extrude_scale:new u.bK(f,e.u_extrude_scale),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new u.b8(f,e.u_globe_extrude_scale),u_translate:new u.bK(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new u.bK(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new u.bK(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new u.bG(f,e.u_color),u_overlay:new u.bF(f,e.u_overlay),u_overlay_scale:new u.b8(f,e.u_overlay_scale)}),depth:Ia,clippingMask:Ia,heatmap:(f,e)=>({u_extrude_scale:new u.b8(f,e.u_extrude_scale),u_intensity:new u.b8(f,e.u_intensity),u_globe_extrude_scale:new u.b8(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new u.bH(f,e.u_matrix),u_world:new u.bK(f,e.u_world),u_image:new u.bF(f,e.u_image),u_color_ramp:new u.bF(f,e.u_color_ramp),u_opacity:new u.b8(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new u.bF(f,e.u_image),u_latrange:new u.bK(f,e.u_latrange),u_light:new u.bK(f,e.u_light),u_shadow:new u.bG(f,e.u_shadow),u_highlight:new u.bG(f,e.u_highlight),u_accent:new u.bG(f,e.u_accent)}),hillshadePrepare:(f,e)=>({u_matrix:new u.bH(f,e.u_matrix),u_image:new u.bF(f,e.u_image),u_dimension:new u.bK(f,e.u_dimension),u_zoom:new u.b8(f,e.u_zoom),u_unpack:new u.bI(f,e.u_unpack)}),line:(f,e)=>({u_translation:new u.bK(f,e.u_translation),u_ratio:new u.b8(f,e.u_ratio),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new u.bK(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new u.bK(f,e.u_translation),u_ratio:new u.b8(f,e.u_ratio),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new u.bK(f,e.u_units_to_pixels),u_image:new u.bF(f,e.u_image),u_image_height:new u.b8(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new u.bK(f,e.u_translation),u_texsize:new u.bK(f,e.u_texsize),u_ratio:new u.b8(f,e.u_ratio),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_image:new u.bF(f,e.u_image),u_units_to_pixels:new u.bK(f,e.u_units_to_pixels),u_scale:new u.bJ(f,e.u_scale),u_fade:new u.b8(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new u.bK(f,e.u_translation),u_ratio:new u.b8(f,e.u_ratio),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new u.bK(f,e.u_units_to_pixels),u_patternscale_a:new u.bK(f,e.u_patternscale_a),u_patternscale_b:new u.bK(f,e.u_patternscale_b),u_sdfgamma:new u.b8(f,e.u_sdfgamma),u_image:new u.bF(f,e.u_image),u_tex_y_a:new u.b8(f,e.u_tex_y_a),u_tex_y_b:new u.b8(f,e.u_tex_y_b),u_mix:new u.b8(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new u.bK(f,e.u_tl_parent),u_scale_parent:new u.b8(f,e.u_scale_parent),u_buffer_scale:new u.b8(f,e.u_buffer_scale),u_fade_t:new u.b8(f,e.u_fade_t),u_opacity:new u.b8(f,e.u_opacity),u_image0:new u.bF(f,e.u_image0),u_image1:new u.bF(f,e.u_image1),u_brightness_low:new u.b8(f,e.u_brightness_low),u_brightness_high:new u.b8(f,e.u_brightness_high),u_saturation_factor:new u.b8(f,e.u_saturation_factor),u_contrast_factor:new u.b8(f,e.u_contrast_factor),u_spin_weights:new u.bJ(f,e.u_spin_weights),u_coords_top:new u.bI(f,e.u_coords_top),u_coords_bottom:new u.bI(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new u.bF(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bF(f,e.u_is_size_feature_constant),u_size_t:new u.b8(f,e.u_size_t),u_size:new u.b8(f,e.u_size),u_camera_to_center_distance:new u.b8(f,e.u_camera_to_center_distance),u_pitch:new u.b8(f,e.u_pitch),u_rotate_symbol:new u.bF(f,e.u_rotate_symbol),u_aspect_ratio:new u.b8(f,e.u_aspect_ratio),u_fade_change:new u.b8(f,e.u_fade_change),u_label_plane_matrix:new u.bH(f,e.u_label_plane_matrix),u_coord_matrix:new u.bH(f,e.u_coord_matrix),u_is_text:new u.bF(f,e.u_is_text),u_pitch_with_map:new u.bF(f,e.u_pitch_with_map),u_is_along_line:new u.bF(f,e.u_is_along_line),u_is_variable_anchor:new u.bF(f,e.u_is_variable_anchor),u_texsize:new u.bK(f,e.u_texsize),u_texture:new u.bF(f,e.u_texture),u_translation:new u.bK(f,e.u_translation),u_pitched_scale:new u.b8(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new u.bF(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bF(f,e.u_is_size_feature_constant),u_size_t:new u.b8(f,e.u_size_t),u_size:new u.b8(f,e.u_size),u_camera_to_center_distance:new u.b8(f,e.u_camera_to_center_distance),u_pitch:new u.b8(f,e.u_pitch),u_rotate_symbol:new u.bF(f,e.u_rotate_symbol),u_aspect_ratio:new u.b8(f,e.u_aspect_ratio),u_fade_change:new u.b8(f,e.u_fade_change),u_label_plane_matrix:new u.bH(f,e.u_label_plane_matrix),u_coord_matrix:new u.bH(f,e.u_coord_matrix),u_is_text:new u.bF(f,e.u_is_text),u_pitch_with_map:new u.bF(f,e.u_pitch_with_map),u_is_along_line:new u.bF(f,e.u_is_along_line),u_is_variable_anchor:new u.bF(f,e.u_is_variable_anchor),u_texsize:new u.bK(f,e.u_texsize),u_texture:new u.bF(f,e.u_texture),u_gamma_scale:new u.b8(f,e.u_gamma_scale),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_is_halo:new u.bF(f,e.u_is_halo),u_translation:new u.bK(f,e.u_translation),u_pitched_scale:new u.b8(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new u.bF(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bF(f,e.u_is_size_feature_constant),u_size_t:new u.b8(f,e.u_size_t),u_size:new u.b8(f,e.u_size),u_camera_to_center_distance:new u.b8(f,e.u_camera_to_center_distance),u_pitch:new u.b8(f,e.u_pitch),u_rotate_symbol:new u.bF(f,e.u_rotate_symbol),u_aspect_ratio:new u.b8(f,e.u_aspect_ratio),u_fade_change:new u.b8(f,e.u_fade_change),u_label_plane_matrix:new u.bH(f,e.u_label_plane_matrix),u_coord_matrix:new u.bH(f,e.u_coord_matrix),u_is_text:new u.bF(f,e.u_is_text),u_pitch_with_map:new u.bF(f,e.u_pitch_with_map),u_is_along_line:new u.bF(f,e.u_is_along_line),u_is_variable_anchor:new u.bF(f,e.u_is_variable_anchor),u_texsize:new u.bK(f,e.u_texsize),u_texsize_icon:new u.bK(f,e.u_texsize_icon),u_texture:new u.bF(f,e.u_texture),u_texture_icon:new u.bF(f,e.u_texture_icon),u_gamma_scale:new u.b8(f,e.u_gamma_scale),u_device_pixel_ratio:new u.b8(f,e.u_device_pixel_ratio),u_is_halo:new u.bF(f,e.u_is_halo),u_translation:new u.bK(f,e.u_translation),u_pitched_scale:new u.b8(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new u.b8(f,e.u_opacity),u_color:new u.bG(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new u.b8(f,e.u_opacity),u_image:new u.bF(f,e.u_image),u_pattern_tl_a:new u.bK(f,e.u_pattern_tl_a),u_pattern_br_a:new u.bK(f,e.u_pattern_br_a),u_pattern_tl_b:new u.bK(f,e.u_pattern_tl_b),u_pattern_br_b:new u.bK(f,e.u_pattern_br_b),u_texsize:new u.bK(f,e.u_texsize),u_mix:new u.b8(f,e.u_mix),u_pattern_size_a:new u.bK(f,e.u_pattern_size_a),u_pattern_size_b:new u.bK(f,e.u_pattern_size_b),u_scale_a:new u.b8(f,e.u_scale_a),u_scale_b:new u.b8(f,e.u_scale_b),u_pixel_coord_upper:new u.bK(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bK(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new u.b8(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new u.bF(f,e.u_texture),u_ele_delta:new u.b8(f,e.u_ele_delta),u_fog_matrix:new u.bH(f,e.u_fog_matrix),u_fog_color:new u.bG(f,e.u_fog_color),u_fog_ground_blend:new u.b8(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.b8(f,e.u_fog_ground_blend_opacity),u_horizon_color:new u.bG(f,e.u_horizon_color),u_horizon_fog_blend:new u.b8(f,e.u_horizon_fog_blend),u_is_globe_mode:new u.b8(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new u.b8(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new u.bF(f,e.u_texture),u_terrain_coords_id:new u.b8(f,e.u_terrain_coords_id),u_ele_delta:new u.b8(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new u.b8(f,e.u_input),u_output_expected:new u.b8(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new u.bJ(f,e.u_sun_pos),u_atmosphere_blend:new u.b8(f,e.u_atmosphere_blend),u_globe_position:new u.bJ(f,e.u_globe_position),u_globe_radius:new u.b8(f,e.u_globe_radius),u_inv_proj_matrix:new u.bH(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new u.bG(f,e.u_sky_color),u_horizon_color:new u.bG(f,e.u_horizon_color),u_horizon:new u.bK(f,e.u_horizon),u_horizon_normal:new u.bK(f,e.u_horizon_normal),u_sky_horizon_blend:new u.b8(f,e.u_sky_horizon_blend),u_sky_blend:new u.b8(f,e.u_sky_blend)})};class nh{constructor(e,n,l){this.context=e;const h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const rh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class rd{constructor(e,n,l,h){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=h,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let l=0;l<this.attributes.length;l++){const h=n.attributes[this.attributes[l].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,n,l){for(let h=0;h<this.attributes.length;h++){const m=this.attributes[h],y=n.attributes[m.name];y!==void 0&&e.vertexAttribPointer(y,m.components,e[rh[m.type]],!1,this.itemSize,m.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ei{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ds extends Ei{getDefault(){return u.b7.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Rr extends Ei{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class rc extends Ei{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class ad extends Ei{getDefault(){return[!0,!0,!0,!0]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class od extends Ei{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class sd extends Ei{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class ah extends Ei{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class oh extends Ei{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class ld extends Ei{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class Io extends Ei{getDefault(){return[0,1]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Tl extends Ei{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class Qo extends Ei{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class ac extends Ei{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class Jo extends Ei{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class fa extends Ei{getDefault(){return u.b7.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class pr extends Ei{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class du extends Ei{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class sh extends Ei{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Do extends Ei{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class es extends Ei{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class oc extends Ei{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class sc extends Ei{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class lc extends Ei{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class fu extends Ei{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class cd extends Ei{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ks extends Ei{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ls extends Ei{getDefault(){return null}set(e){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class pu extends Ei{getDefault(){return null}set(e){var n;if(e===this.current&&!this.dirty)return;const l=this.gl;Gr(l)?l.bindVertexArray(e):(n=l.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class aa extends Ei{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class xi extends Ei{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Pr extends Ei{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class qr extends Ei{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class Bs extends qr{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Os extends qr{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class mu extends qr{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const cc="Framebuffer is not complete";class gu{constructor(e,n,l,h,m){this.context=e,this.width=n,this.height=l;const y=e.gl,w=this.framebuffer=y.createFramebuffer();if(this.colorAttachment=new Bs(e,w),h)this.depthAttachment=m?new mu(e,w):new Os(e,w);else if(m)throw new Error("Stencil cannot be set without depth");if(y.checkFramebufferStatus(y.FRAMEBUFFER)!==y.FRAMEBUFFER_COMPLETE)throw new Error(cc)}destroy(){const e=this.context.gl,n=this.colorAttachment.get();if(n&&e.deleteTexture(n),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class Sl{constructor(e){var n,l;if(this.gl=e,this.clearColor=new Ds(this),this.clearDepth=new Rr(this),this.clearStencil=new rc(this),this.colorMask=new ad(this),this.depthMask=new od(this),this.stencilMask=new sd(this),this.stencilFunc=new ah(this),this.stencilOp=new oh(this),this.stencilTest=new ld(this),this.depthRange=new Io(this),this.depthTest=new Tl(this),this.depthFunc=new Qo(this),this.blend=new ac(this),this.blendFunc=new Jo(this),this.blendColor=new fa(this),this.blendEquation=new pr(this),this.cullFace=new du(this),this.cullFaceSide=new sh(this),this.frontFace=new Do(this),this.program=new es(this),this.activeTexture=new oc(this),this.viewport=new sc(this),this.bindFramebuffer=new lc(this),this.bindRenderbuffer=new fu(this),this.bindTexture=new cd(this),this.bindVertexBuffer=new ks(this),this.bindElementBuffer=new Ls(this),this.bindVertexArray=new pu(this),this.pixelStoreUnpack=new aa(this),this.pixelStoreUnpackPremultiplyAlpha=new xi(this),this.pixelStoreUnpackFlipY=new Pr(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Gr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=e.RGBA16F)!==null&&n!==void 0?n:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:h==null?void 0:h.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n){return new nh(this,e,n)}createVertexBuffer(e,n,l){return new rd(this,e,n,l)}createRenderbuffer(e,n,l){const h=this.gl,m=h.createRenderbuffer();return this.bindRenderbuffer.set(m),h.renderbufferStorage(h.RENDERBUFFER,e,n,l),this.bindRenderbuffer.set(null),m}createFramebuffer(e,n,l,h){return new gu(this,e,n,l,h)}clear({color:e,depth:n,stencil:l}){const h=this.gl;let m=0;e&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),h.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){u.bC(e.blendFunction,Zi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Gr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var n;return Gr(this.gl)?this.gl.deleteVertexArray(e):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let js;function ts(f,e,n,l,h){const m=f.context,y=f.transform,w=m.gl,S=f.useProgram("collisionBox"),z=[];let k=0,O=0;for(let ae=0;ae<l.length;ae++){const se=l[ae],fe=e.getTile(se).getBucket(n);if(!fe)continue;const pe=h?fe.textCollisionBox:fe.iconCollisionBox,ge=fe.collisionCircleArray;ge.length>0&&(z.push({circleArray:ge,circleOffset:O,coord:se}),k+=ge.length/4,O=k),pe&&S.draw(m,w.LINES,ii.disabled,mi.disabled,f.colorModeForRenderPass(),oi.disabled,nf(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(se),y.getProjectionData({overscaledTileID:se,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,null,f.transform.zoom,null,null,pe.collisionVertexBuffer)}if(!h||!z.length)return;const B=f.useProgram("collisionCircle"),q=new u.bP;q.resize(4*k),q._trim();let Y=0;for(const ae of z)for(let se=0;se<ae.circleArray.length/4;se++){const fe=4*se,pe=ae.circleArray[fe+0],ge=ae.circleArray[fe+1],we=ae.circleArray[fe+2],xe=ae.circleArray[fe+3];q.emplace(Y++,pe,ge,we,xe,0),q.emplace(Y++,pe,ge,we,xe,1),q.emplace(Y++,pe,ge,we,xe,2),q.emplace(Y++,pe,ge,we,xe,3)}(!js||js.length<2*k)&&(js=function(ae){const se=2*ae,fe=new u.bR;fe.resize(se),fe._trim();for(let pe=0;pe<se;pe++){const ge=6*pe;fe.uint16[ge+0]=4*pe+0,fe.uint16[ge+1]=4*pe+1,fe.uint16[ge+2]=4*pe+2,fe.uint16[ge+3]=4*pe+2,fe.uint16[ge+4]=4*pe+3,fe.uint16[ge+5]=4*pe+0}return fe}(k));const ne=m.createIndexBuffer(js,!0),te=m.createVertexBuffer(q,u.bQ.members,!0);for(const ae of z){const se=th(f.transform);B.draw(m,w.TRIANGLES,ii.disabled,mi.disabled,f.colorModeForRenderPass(),oi.disabled,se,f.style.map.terrain&&f.style.map.terrain.getTerrainData(ae.coord),null,n.id,te,ne,u.aG.simpleSegment(0,2*ae.circleOffset,ae.circleArray.length,ae.circleArray.length/2),null,f.transform.zoom,null,null,null)}te.destroy(),ne.destroy()}const ko=u.at(new Float32Array(16));function lh(f,e,n,l,h,m){const{horizontalAlign:y,verticalAlign:w}=u.aB(f);return new u.P((-(y-.5)*e/h+l[0])*m,(-(w-.5)*n/h+l[1])*m)}function Ir(f,e,n,l,h,m){const y=e.tileAnchorPoint.add(new u.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let w=l.mult(m);n||(w=w.rotate(-h));const S=y.add(w);return He(S.x,S.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(n){const w=pi(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),S=Math.atan(w.y/w.x)+(w.x<0?Math.PI:0);return f.add(l.rotate(S))}return f.add(l)}function _u(f,e,n,l,h,m,y,w,S,z,k,O){const B=f.text.placedSymbolArray,q=f.text.dynamicLayoutVertexArray,Y=f.icon.dynamicLayoutVertexArray,ne={};q.clear();for(let te=0;te<B.length;te++){const ae=B.get(te),se=ae.hidden||!ae.crossTileID||f.allowVerticalPlacement&&!ae.placedOrientation?null:l[ae.crossTileID];if(se){const fe=new u.P(ae.anchorX,ae.anchorY),pe={getElevation:O,width:h.width,height:h.height,pitchedLabelPlaneMatrix:m,pitchWithMap:n,transform:h,tileAnchorPoint:fe,translation:z,unwrappedTileID:k},ge=n?Rt(fe.x,fe.y,pe):pi(fe.x,fe.y,pe),we=Re(h.cameraToCenterDistance,ge.signedDistanceFromCamera);let xe=u.ai(f.textSizeData,w,ae)*we/u.av;n&&(xe*=f.tilePixelRatio/y);const{width:Be,height:ke,anchor:We,textOffset:Qe,textBoxScale:Ye}=se,gt=lh(We,Be,ke,Qe,Ye,xe),ft=h.getPitchedTextCorrection(fe.x+z[0],fe.y+z[1],k),it=Ir(ge.point,pe,e,gt,-h.bearingInRadians,ft),Pt=f.allowVerticalPlacement&&ae.placedOrientation===u.ah.vertical?Math.PI/2:0;for(let Jt=0;Jt<ae.numGlyphs;Jt++)u.ao(q,it,Pt);S&&ae.associatedIconIndex>=0&&(ne[ae.associatedIconIndex]={shiftedAnchor:it,angle:Pt})}else Ft(ae.numGlyphs,q)}if(S){Y.clear();const te=f.icon.placedSymbolArray;for(let ae=0;ae<te.length;ae++){const se=te.get(ae);if(se.hidden)Ft(se.numGlyphs,Y);else{const fe=ne[ae];if(fe)for(let pe=0;pe<se.numGlyphs;pe++)u.ao(Y,fe.shiftedAnchor,fe.angle);else Ft(se.numGlyphs,Y)}}f.icon.dynamicLayoutVertexBuffer.updateData(Y)}f.text.dynamicLayoutVertexBuffer.updateData(q)}function pa(f,e,n){return n.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function El(f,e,n,l,h,m,y,w,S,z,k,O,B){const q=f.context,Y=q.gl,ne=f.transform,te=w==="map",ae=S==="map",se=w!=="viewport"&&n.layout.get("symbol-placement")!=="point",fe=te&&!ae&&!se,pe=!n.layout.get("symbol-sort-key").isConstant();let ge=!1;const we=f.getDepthModeForSublayer(0,ii.ReadOnly),xe=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Be=[],ke=ne.getCircleRadiusCorrection();for(const We of l){const Qe=e.getTile(We),Ye=Qe.getBucket(n);if(!Ye)continue;const gt=h?Ye.text:Ye.icon;if(!gt||!gt.segments.get().length||!gt.hasVisibleVertices)continue;const ft=gt.programConfigurations.get(n.id),it=h||Ye.sdfIcons,Pt=h?Ye.textSizeData:Ye.iconSizeData,Jt=ae||ne.pitch!==0,yi=f.useProgram(pa(it,h,Ye),ft),ni=u.ag(Pt,ne.zoom),Oi=f.style.map.terrain&&f.style.map.terrain.getTerrainData(We);let qi,Ji,Ii,ji,Rn=[0,0],Wn=null;if(h)Ji=Qe.glyphAtlasTexture,Ii=Y.LINEAR,qi=Qe.glyphAtlasTexture.size,Ye.iconsInText&&(Rn=Qe.imageAtlasTexture.size,Wn=Qe.imageAtlasTexture,ji=Jt||f.options.rotating||f.options.zooming||Pt.kind==="composite"||Pt.kind==="camera"?Y.LINEAR:Y.NEAREST);else{const Tn=n.layout.get("icon-size").constantOr(0)!==1||Ye.iconsNeedLinear;Ji=Qe.imageAtlasTexture,Ii=it||f.options.rotating||f.options.zooming||Tn||Jt?Y.LINEAR:Y.NEAREST,qi=Qe.imageAtlasTexture.size}const nr=u.aw(Qe,1,f.transform.zoom),Mr=Ie(te,f.transform,nr),oo=u.K();u.aj(oo,Mr);const Oa=Ee(ae,te,f.transform,nr),ps=u.ax(ne,Qe,m,y),so=ne.getProjectionData({overscaledTileID:We,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),ms=xe&&Ye.hasTextData(),ja=n.layout.get("icon-text-fit")!=="none"&&ms&&Ye.hasIconData();if(se){const Tn=f.style.map.terrain?(jn,Di)=>f.style.map.terrain.getElevation(We,jn,Di):null,en=n.layout.get("text-rotation-alignment")==="map";vt(Ye,f,h,Mr,oo,ae,z,en,We.toUnwrapped(),ne.width,ne.height,ps,Tn)}const Fa=h&&xe||ja,Xr=se||Fa?ko:ae?Mr:f.transform.clipSpaceToPixelsMatrix,lo=it&&n.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ys;Ys=it?Ye.iconsInText?ic(Pt.kind,ni,fe,ae,se,Fa,f,Xr,Oa,ps,qi,Rn,ke):cu(Pt.kind,ni,fe,ae,se,Fa,f,Xr,Oa,ps,h,qi,0,ke):lu(Pt.kind,ni,fe,ae,se,Fa,f,Xr,Oa,ps,h,qi,ke);const Ks={program:yi,buffers:gt,uniformValues:Ys,projectionData:so,atlasTexture:Ji,atlasTextureIcon:Wn,atlasInterpolation:Ii,atlasInterpolationIcon:ji,isSDF:it,hasHalo:lo};if(pe&&Ye.canOverlap){ge=!0;const Tn=gt.segments.get();for(const en of Tn)Be.push({segments:new u.aG([en]),sortKey:en.sortKey,state:Ks,terrainData:Oi})}else Be.push({segments:gt.segments,sortKey:0,state:Ks,terrainData:Oi})}ge&&Be.sort((We,Qe)=>We.sortKey-Qe.sortKey);for(const We of Be){const Qe=We.state;if(q.activeTexture.set(Y.TEXTURE0),Qe.atlasTexture.bind(Qe.atlasInterpolation,Y.CLAMP_TO_EDGE),Qe.atlasTextureIcon&&(q.activeTexture.set(Y.TEXTURE1),Qe.atlasTextureIcon&&Qe.atlasTextureIcon.bind(Qe.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),Qe.isSDF){const Ye=Qe.uniformValues;Qe.hasHalo&&(Ye.u_is_halo=1,Fs(Qe.buffers,We.segments,n,f,Qe.program,we,k,O,Ye,Qe.projectionData,We.terrainData)),Ye.u_is_halo=0}Fs(Qe.buffers,We.segments,n,f,Qe.program,we,k,O,Qe.uniformValues,Qe.projectionData,We.terrainData)}}function Fs(f,e,n,l,h,m,y,w,S,z,k){const O=l.context;h.draw(O,O.gl.TRIANGLES,m,y,w,oi.backCCW,S,k,z,n.id,f.layoutVertexBuffer,f.indexBuffer,e,n.paint,l.transform.zoom,f.programConfigurations.get(n.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function Ns(f,e,n,l,h){const m=f.context,y=m.gl,w=mi.disabled,S=new Zi([y.ONE,y.ONE],u.b7.transparent,[!0,!0,!0,!0]),z=e.getBucket(n);if(!z)return;const k=l.key;let O=n.heatmapFbos.get(k);O||(O=yu(m,e.tileSize,e.tileSize),n.heatmapFbos.set(k,O)),m.bindFramebuffer.set(O.framebuffer),m.viewport.set([0,0,e.tileSize,e.tileSize]),m.clear({color:u.b7.transparent});const B=z.programConfigurations.get(n.id),q=f.useProgram("heatmap",B,!h),Y=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ne=f.style.map.terrain.getTerrainData(l);q.draw(m,y.TRIANGLES,ii.disabled,w,S,oi.disabled,au(e,f.transform.zoom,n.paint.get("heatmap-intensity"),1),ne,Y,n.id,z.layoutVertexBuffer,z.indexBuffer,z.segments,n.paint,f.transform.zoom,B)}function uc(f,e,n,l,h){const m=f.context,y=m.gl,w=f.transform;m.setColorMode(f.colorModeForRenderPass());const S=is(m,e),z=n.key,k=e.heatmapFbos.get(z);if(!k)return;m.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,k.colorAttachment.get()),m.activeTexture.set(y.TEXTURE1),S.bind(y.LINEAR,y.CLAMP_TO_EDGE);const O=w.getProjectionData({overscaledTileID:n,applyTerrainMatrix:h,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(m,y.TRIANGLES,ii.disabled,mi.disabled,f.colorModeForRenderPass(),oi.disabled,ou(f,e,0,1),null,O,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,w.zoom),k.destroy(),e.heatmapFbos.delete(z)}function yu(f,e,n){var l,h;const m=f.gl,y=m.createTexture();m.bindTexture(m.TEXTURE_2D,y),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const w=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:m.UNSIGNED_BYTE,S=(h=f.RGBA16F)!==null&&h!==void 0?h:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,S,e,n,0,m.RGBA,w,null);const z=f.createFramebuffer(e,n,!1,!1);return z.colorAttachment.set(y),z}function is(f,e){return e.colorRampTexture||(e.colorRampTexture=new St(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function Qa(f,e,n,l,h){if(!n||!l||!l.imageAtlas)return;const m=l.imageAtlas.patternPositions;let y=m[n.to.toString()],w=m[n.from.toString()];if(!y&&w&&(y=w),!w&&y&&(w=y),!y||!w){const S=h.getPaintProperty(e);y=m[S],w=m[S]}y&&w&&f.setConstantPatternPositions(y,w)}function Us(f,e,n,l,h,m,y,w){const S=f.context.gl,z="fill-pattern",k=n.paint.get(z),O=k&&k.constantOr(1),B=n.getCrossfadeParameters();let q,Y,ne,te,ae;const se=f.transform,fe=n.paint.get("fill-translate"),pe=n.paint.get("fill-translate-anchor");y?(Y=O&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=S.LINES):(Y=O?"fillPattern":"fill",q=S.TRIANGLES);const ge=k.constantOr(null);for(const we of l){const xe=e.getTile(we);if(O&&!xe.patternsLoaded())continue;const Be=xe.getBucket(n);if(!Be)continue;const ke=Be.programConfigurations.get(n.id),We=f.useProgram(Y,ke),Qe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(we);O&&(f.context.activeTexture.set(S.TEXTURE0),xe.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),ke.updatePaintBuffers(B)),Qa(ke,z,ge,xe,n);const Ye=se.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!w,applyTerrainMatrix:!0}),gt=u.ax(se,xe,fe,pe);if(y){te=Be.indexBuffer2,ae=Be.segments2;const it=[S.drawingBufferWidth,S.drawingBufferHeight];ne=Y==="fillOutlinePattern"&&O?eh(f,B,xe,it,gt):vl(it,gt)}else te=Be.indexBuffer,ae=Be.segments,ne=O?td(f,B,xe,gt):{u_fill_translate:gt};let ft;if(f.renderPass==="translucent"&&w){const[it]=f.getStencilConfigForOverlapAndUpdateStencilID(l);ft=it[we.overscaledZ]}else ft=f.stencilModeForClipping(we);We.draw(f.context,q,h,ft,m,oi.backCCW,ne,Qe,Ye,n.id,Be.layoutVertexBuffer,te,ae,n.paint,f.transform.zoom,ke)}}function Vs(f,e,n,l,h,m,y,w){const S=f.context,z=S.gl,k="fill-extrusion-pattern",O=n.paint.get(k),B=O.constantOr(1),q=n.getCrossfadeParameters(),Y=n.paint.get("fill-extrusion-opacity"),ne=O.constantOr(null),te=f.transform;for(const ae of l){const se=e.getTile(ae),fe=se.getBucket(n);if(!fe)continue;const pe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ae),ge=fe.programConfigurations.get(n.id),we=f.useProgram(B?"fillExtrusionPattern":"fillExtrusion",ge);B&&(f.context.activeTexture.set(z.TEXTURE0),se.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),ge.updatePaintBuffers(q));const xe=te.getProjectionData({overscaledTileID:ae,applyGlobeMatrix:!w,applyTerrainMatrix:!0});Qa(ge,k,ne,se,n);const Be=u.ax(te,se,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),ke=n.paint.get("fill-extrusion-vertical-gradient"),We=B?ru(f,ke,Y,Be,ae,q,se):ed(f,ke,Y,Be);we.draw(S,S.gl.TRIANGLES,h,m,y,oi.backCCW,We,pe,xe,n.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,n.paint,f.transform.zoom,ge,f.style.map.terrain&&fe.centroidVertexBuffer)}}function Dr(f,e,n,l,h,m,y,w,S){var z;const k=f.style.projection,O=f.context,B=f.transform,q=O.gl,Y=f.useProgram("hillshade"),ne=!f.options.moving;for(const te of l){const ae=e.getTile(te),se=ae.fbo;if(!se)continue;const fe=k.getMeshFromTileID(O,te.canonical,w,!0,"raster"),pe=(z=f.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(te);O.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,se.colorAttachment.get());const ge=B.getProjectionData({overscaledTileID:te,aligned:ne,applyGlobeMatrix:!S,applyTerrainMatrix:!0});Y.draw(O,q.TRIANGLES,m,h[te.overscaledZ],y,oi.backCCW,ih(f,ae,n),pe,ge,n.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}const mr=[new u.P(0,0),new u.P(u.Z,0),new u.P(u.Z,u.Z),new u.P(0,u.Z)];function ma(f,e,n,l,h,m,y,w,S=!1,z=!1){const k=l[l.length-1].overscaledZ,O=f.context,B=O.gl,q=f.useProgram("raster"),Y=f.transform,ne=f.style.projection,te=f.colorModeForRenderPass(),ae=!f.options.moving;for(const se of l){const fe=f.getDepthModeForSublayer(se.overscaledZ-k,n.paint.get("raster-opacity")===1?ii.ReadWrite:ii.ReadOnly,B.LESS),pe=e.getTile(se);pe.registerFadeDuration(n.paint.get("raster-fade-duration"));const ge=e.findLoadedParent(se,0),we=e.findLoadedSibling(se),xe=Lo(pe,ge||we||null,e,n,f.transform,f.style.map.terrain);let Be,ke;const We=n.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;O.activeTexture.set(B.TEXTURE0),pe.texture.bind(We,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(B.TEXTURE1),ge?(ge.texture.bind(We,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),Be=Math.pow(2,ge.tileID.overscaledZ-pe.tileID.overscaledZ),ke=[pe.tileID.canonical.x*Be%1,pe.tileID.canonical.y*Be%1]):pe.texture.bind(We,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),pe.texture.useMipmap&&O.extTextureFilterAnisotropic&&f.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const Qe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(se),Ye=Y.getProjectionData({overscaledTileID:se,aligned:ae,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),gt=rf(ke||[0,0],Be||1,xe,n,w),ft=ne.getMeshFromTileID(O,se.canonical,m,y,"raster");q.draw(O,B.TRIANGLES,fe,h?h[se.overscaledZ]:mi.disabled,te,S?oi.frontCCW:oi.backCCW,gt,Qe,Ye,n.id,ft.vertexBuffer,ft.indexBuffer,ft.segments)}}function Lo(f,e,n,l,h,m){const y=l.paint.get("raster-fade-duration");if(!m&&y>0){const w=_e.now(),S=(w-f.timeAdded)/y,z=e?(w-e.timeAdded)/y:-1,k=n.getSource(),O=Nr(h,{tileSize:k.tileSize,roundZoom:k.roundZoom}),B=!e||Math.abs(e.tileID.overscaledZ-O)>Math.abs(f.tileID.overscaledZ-O),q=B&&f.refreshedUponExpiration?1:u.ae(B?S:1-z,0,1);return f.refreshedUponExpiration&&S>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}const Ja=new u.b7(1,0,0,1),Gi=new u.b7(0,1,0,1),ns=new u.b7(0,0,1,1),Hr=new u.b7(1,0,1,1),hc=new u.b7(0,1,1,1);function hr(f,e,n,l){di(f,0,e+n/2,f.transform.width,n,l)}function bn(f,e,n,l){di(f,e-n/2,0,n,f.transform.height,l)}function di(f,e,n,l,h,m){const y=f.context,w=y.gl;w.enable(w.SCISSOR_TEST),w.scissor(e*f.pixelRatio,n*f.pixelRatio,l*f.pixelRatio,h*f.pixelRatio),y.clear({color:m}),w.disable(w.SCISSOR_TEST)}function Da(f,e,n){const l=f.context,h=l.gl,m=f.useProgram("debug"),y=ii.disabled,w=mi.disabled,S=f.colorModeForRenderPass(),z="$debug",k=f.style.map.terrain&&f.style.map.terrain.getTerrainData(n);l.activeTexture.set(h.TEXTURE0);const O=e.getTileByID(n.key).latestRawTileData,B=Math.floor((O&&O.byteLength||0)/1024),q=e.getTile(n).tileSize,Y=512/Math.min(q,512)*(n.overscaledZ/f.transform.zoom)*.5;let ne=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(ne+=` => ${n.overscaledZ}`),function(ae,se){ae.initDebugOverlayCanvas();const fe=ae.debugOverlayCanvas,pe=ae.context.gl,ge=ae.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,fe.width,fe.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(se,5,5),ge.strokeText(se,5,5),ae.debugOverlayTexture.update(fe),ae.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(f,`${ne} ${B}kB`);const te=f.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(l,h.TRIANGLES,y,w,Zi.alphaBlended,oi.disabled,ec(u.b7.transparent,Y),null,te,z,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),m.draw(l,h.LINE_STRIP,y,w,S,oi.disabled,ec(u.b7.red),k,te,z,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function oa(f,e,n,l){const{isRenderingGlobe:h}=l,m=f.context,y=m.gl,w=f.transform,S=f.colorModeForRenderPass(),z=f.getDepthModeFor3D(),k=f.useProgram("terrain");m.bindFramebuffer.set(null),m.viewport.set([0,0,f.width,f.height]);for(const O of n){const B=e.getTerrainMesh(O.tileID),q=f.renderToTexture.getTexture(O),Y=e.getTerrainData(O.tileID);m.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,q.texture);const ne=e.getMeshFrameDelta(w.zoom),te=w.calculateFogMatrix(O.tileID.toUnwrapped()),ae=Wa(ne,te,f.style.sky,w.pitch,h),se=w.getProjectionData({overscaledTileID:O.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(m,y.TRIANGLES,z,mi.disabled,S,oi.backCCW,ae,Y,se,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}}function dc(f,e){if(!e.mesh){const n=new u.aF;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const l=new u.aH;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new Xo(f.createVertexBuffer(n,Ya.members),f.createIndexBuffer(l),u.aG.simpleSegment(0,0,n.length,l.length))}return e.mesh}class rs{constructor(e,n){this.context=new Sl(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.at(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=$.maxUnderzooming+$.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ms}resize(e,n,l){if(this.width=Math.floor(e*l),this.height=Math.floor(n*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const e=this.context,n=new u.aF;n.emplaceBack(0,0),n.emplaceBack(u.Z,0),n.emplaceBack(0,u.Z),n.emplaceBack(u.Z,u.Z),this.tileExtentBuffer=e.createVertexBuffer(n,Ya.members),this.tileExtentSegments=u.aG.simpleSegment(0,0,4,2);const l=new u.aF;l.emplaceBack(0,0),l.emplaceBack(u.Z,0),l.emplaceBack(0,u.Z),l.emplaceBack(u.Z,u.Z),this.debugBuffer=e.createVertexBuffer(l,Ya.members),this.debugSegments=u.aG.simpleSegment(0,0,4,5);const h=new u.bW;h.emplaceBack(0,0,0,0),h.emplaceBack(u.Z,0,u.Z,0),h.emplaceBack(0,u.Z,0,u.Z),h.emplaceBack(u.Z,u.Z,u.Z,u.Z),this.rasterBoundsBuffer=e.createVertexBuffer(h,Ju.members),this.rasterBoundsSegments=u.aG.simpleSegment(0,0,4,2);const m=new u.aF;m.emplaceBack(0,0),m.emplaceBack(u.Z,0),m.emplaceBack(0,u.Z),m.emplaceBack(u.Z,u.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(m,Ya.members),this.rasterBoundsSegmentsPosOnly=u.aG.simpleSegment(0,0,4,5);const y=new u.aF;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(y,Ya.members),this.viewportSegments=u.aG.simpleSegment(0,0,4,2);const w=new u.bX;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(w);const S=new u.aH;S.emplaceBack(1,0,2),S.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(S);const z=this.context.gl;this.stencilClearMode=new mi({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.tileExtentMesh=new Xo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=u.K();u.bO(l,0,this.width,this.height,0,0,1),u.M(l,l,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const h={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,n.TRIANGLES,ii.disabled,this.stencilClearMode,Zi.disabled,oi.disabled,null,null,h,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!n||!n.length)return;this.currentStencilSource=e.source,this.nextStencilID+n.length>256&&this.clearStencil();const h=this.context;h.setColorMode(Zi.disabled),h.setDepthMode(ii.disabled);const m={};for(const y of n)m[y.key]=this.nextStencilID++;this._renderTileMasks(m,n,l,!0),this._renderTileMasks(m,n,l,!1),this._tileClippingMaskIDs=m}_renderTileMasks(e,n,l,h){const m=this.context,y=m.gl,w=this.style.projection,S=this.transform,z=this.useProgram("clippingMask");for(const k of n){const O=e[k.key],B=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),q=w.getMeshFromTileID(this.context,k.canonical,h,!0,"stencil"),Y=S.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!0,applyTerrainMatrix:!0});z.draw(m,y.TRIANGLES,ii.disabled,new mi({func:y.ALWAYS,mask:0},O,255,y.KEEP,y.KEEP,y.REPLACE),Zi.disabled,l?oi.disabled:oi.backCCW,null,B,Y,"$clipping",q.vertexBuffer,q.indexBuffer,q.segments)}}_renderTilesDepthBuffer(){const e=this.context,n=e.gl,l=this.style.projection,h=this.transform,m=this.useProgram("depth"),y=this.getDepthModeFor3D(),w=Ce(h,{tileSize:h.tileSize});for(const S of w){const z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S),k=l.getMeshFromTileID(this.context,S.canonical,!0,!0,"raster"),O=h.getProjectionData({overscaledTileID:S,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(e,n.TRIANGLES,y,mi.disabled,Zi.disabled,oi.backCCW,null,z,O,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new mi({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){const n=this.context.gl;return new mi({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const n=this.context.gl,l=e.sort((y,w)=>w.overscaledZ-y.overscaledZ),h=l[l.length-1].overscaledZ,m=l[0].overscaledZ-h+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const y={};for(let w=0;w<m;w++)y[w+h]=new mi({func:n.GEQUAL,mask:255},w+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=m,[y,l]}return[{[h]:mi.disabled},l]}stencilConfigForOverlapTwoPass(e){const n=this.context.gl,l=e.sort((y,w)=>w.overscaledZ-y.overscaledZ),h=l[l.length-1].overscaledZ,m=l[0].overscaledZ-h+1;if(this.clearStencil(),m>1){const y={},w={};for(let S=0;S<m;S++)y[S+h]=new mi({func:n.GREATER,mask:255},m+1+S,255,n.KEEP,n.KEEP,n.REPLACE),w[S+h]=new mi({func:n.GREATER,mask:255},1+S,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*m+1,[y,w,l]}return this.nextStencilID=3,[{[h]:new mi({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[h]:new mi({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Zi([e.CONSTANT_COLOR,e.ONE],new u.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Zi.unblended:Zi.alphaBlended}getDepthModeForSublayer(e,n,l){if(!this.opaquePassEnabledForLayer())return ii.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new ii(l||this.context.gl.LEQUAL,n,[h,h])}getDepthModeFor3D(){return new ii(this.context.gl.LEQUAL,ii.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){var l,h;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(_e.now()),this.imageManager.beginFrame();const m=this.style._order,y=this.style.sourceCaches,w={},S={},z={},k={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const B in y){const q=y[B];q.used&&q.prepare(this.context),w[B]=q.getVisibleCoordinates(!1),S[B]=w[B].slice().reverse(),z[B]=q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<m.length;B++)if(this.style._layers[m[B]].is3D()){this.opaquePassCutoff=B;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const B of m){const q=this.style._layers[B];if(!q.hasOffscreenPass()||q.isHidden(this.transform.zoom))continue;const Y=S[q.source];(q.type==="custom"||Y.length)&&this.renderLayer(this,y[q.source],q,Y,k)}if((h=this.style.projection)===null||h===void 0||h.updateGPUdependent({context:this.context,useProgram:B=>this.useProgram(B)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?u.b7.black:u.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(B,q){const Y=B.context,ne=Y.gl,te=((we,xe,Be)=>{const ke=Math.cos(xe.rollInRadians),We=Math.sin(xe.rollInRadians),Qe=zs(xe),Ye=xe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:we.properties.get("sky-color"),u_horizon_color:we.properties.get("horizon-color"),u_horizon:[(xe.width/2-Qe*We)*Be,(xe.height/2+Qe*ke)*Be],u_horizon_normal:[-We,ke],u_sky_horizon_blend:we.properties.get("sky-horizon-blend")*xe.height/2*Be,u_sky_blend:Ye}})(q,B.style.map.transform,B.pixelRatio),ae=new ii(ne.LEQUAL,ii.ReadWrite,[0,1]),se=mi.disabled,fe=B.colorModeForRenderPass(),pe=B.useProgram("sky"),ge=dc(Y,q);pe.draw(Y,ne.TRIANGLES,ae,se,fe,oi.disabled,te,null,void 0,"sky",ge.vertexBuffer,ge.indexBuffer,ge.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[m[this.currentLayer]],q=y[B.source],Y=w[B.source];this._renderTileClippingMasks(B,Y,!1),this.renderLayer(this,q,B,Y,k)}this.renderPass="translucent";let O=!1;for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const B=this.style._layers[m[this.currentLayer]],q=y[B.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(B,k))continue;this.opaquePassEnabledForLayer()||O||(O=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Y=(B.type==="symbol"?z:S)[B.source];this._renderTileClippingMasks(B,w[B.source],!1),this.renderLayer(this,q,B,Y,k)}if(k.isRenderingGlobe&&function(B,q,Y){const ne=B.context,te=ne.gl,ae=B.useProgram("atmosphere"),se=new ii(te.LEQUAL,ii.ReadOnly,[0,1]),fe=B.transform,pe=function(Ye,gt){const ft=Ye.properties.get("position"),it=[-ft.x,-ft.y,-ft.z],Pt=u.at(new Float64Array(16));return Ye.properties.get("anchor")==="map"&&(u.a_(Pt,Pt,gt.rollInRadians),u.a$(Pt,Pt,-gt.pitchInRadians),u.a_(Pt,Pt,gt.bearingInRadians),u.a$(Pt,Pt,gt.center.lat*Math.PI/180),u.bm(Pt,Pt,-gt.center.lng*Math.PI/180)),u.bV(it,it,Pt),it}(Y,B.transform),ge=fe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),we=q.properties.get("atmosphere-blend")*ge.projectionTransition;if(we===0)return;const xe=Ql(fe.worldSize,fe.center.lat),Be=fe.inverseProjectionMatrix,ke=new Float64Array(4);ke[3]=1,u.ap(ke,ke,fe.modelViewProjectionMatrix),ke[0]/=ke[3],ke[1]/=ke[3],ke[2]/=ke[3],ke[3]=1,u.ap(ke,ke,Be),ke[0]/=ke[3],ke[1]/=ke[3],ke[2]/=ke[3],ke[3]=1;const We=((Ye,gt,ft,it,Pt)=>({u_sun_pos:Ye,u_atmosphere_blend:gt,u_globe_position:ft,u_globe_radius:it,u_inv_proj_matrix:Pt}))(pe,we,[ke[0],ke[1],ke[2]],xe,Be),Qe=dc(ne,q);ae.draw(ne,te.TRIANGLES,se,mi.disabled,Zi.alphaBlended,oi.disabled,We,null,null,"atmosphere",Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const B=function(q,Y){let ne=null;const te=Object.values(q._layers).flatMap(pe=>pe.source&&!pe.isHidden(Y)?[q.sourceCaches[pe.source]]:[]),ae=te.filter(pe=>pe.getSource().type==="vector"),se=te.filter(pe=>pe.getSource().type!=="vector"),fe=pe=>{(!ne||ne.getSource().maxzoom<pe.getSource().maxzoom)&&(ne=pe)};return ae.forEach(pe=>fe(pe)),ne||se.forEach(pe=>fe(pe)),ne}(this.style,this.transform.zoom);B&&function(q,Y,ne){for(let te=0;te<ne.length;te++)Da(q,Y,ne[te])}(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){const q=B.transform.padding;hr(B,B.transform.height-(q.top||0),3,Ja),hr(B,q.bottom||0,3,Gi),bn(B,q.left||0,3,ns),bn(B,B.transform.width-(q.right||0),3,Hr);const Y=B.transform.centerPoint;(function(ne,te,ae,se){di(ne,te-1,ae-10,2,20,se),di(ne,te-10,ae-1,20,2,se)})(B,Y.x,B.transform.height-Y.y,hc)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=e?!u.bY(n,l):!u.bZ(n,l)),h||(h=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),h&&(u.b_(n,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,y){const w=m.context,S=w.gl,z=m.transform,k=Zi.unblended,O=new ii(S.LEQUAL,ii.ReadWrite,[0,1]),B=y.sourceCache.getRenderableTiles(),q=m.useProgram("terrainDepth");w.bindFramebuffer.set(y.getFramebuffer("depth").framebuffer),w.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),w.clear({color:u.b7.transparent,depth:1});for(const Y of B){const ne=y.getTerrainMesh(Y.tileID),te=y.getTerrainData(Y.tileID),ae=z.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),se={u_ele_delta:y.getMeshFrameDelta(z.zoom)};q.draw(w,S.TRIANGLES,O,mi.disabled,k,oi.backCCW,se,te,ae,"terrain",ne.vertexBuffer,ne.indexBuffer,ne.segments)}w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,y){const w=m.context,S=w.gl,z=m.transform,k=Zi.unblended,O=new ii(S.LEQUAL,ii.ReadWrite,[0,1]),B=y.getCoordsTexture(),q=y.sourceCache.getRenderableTiles(),Y=m.useProgram("terrainCoords");w.bindFramebuffer.set(y.getFramebuffer("coords").framebuffer),w.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),w.clear({color:u.b7.transparent,depth:1}),y.coordsIndex=[];for(const ne of q){const te=y.getTerrainMesh(ne.tileID),ae=y.getTerrainData(ne.tileID);w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,B.texture);const se={u_terrain_coords_id:(255-y.coordsIndex.length)/255,u_texture:0,u_ele_delta:y.getMeshFrameDelta(z.zoom)},fe=z.getProjectionData({overscaledTileID:ne.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Y.draw(w,S.TRIANGLES,O,mi.disabled,k,oi.backCCW,se,ae,fe,"terrain",te.vertexBuffer,te.indexBuffer,te.segments),y.coordsIndex.push(ne.tileID.key)}w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,n,l,h,m){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(h||[]).length)&&(this.id=l.id,u.b$(l)?function(y,w,S,z,k,O){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:B}=O,q=mi.disabled,Y=y.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ne,te,ae,se,fe,pe,ge,we,xe){const Be=te.transform,ke=te.style.map.terrain,We=fe==="map",Qe=pe==="map";for(const Ye of ne){const gt=se.getTile(Ye),ft=gt.getBucket(ae);if(!ft||!ft.text||!ft.text.segments.get().length)continue;const it=u.ag(ft.textSizeData,Be.zoom),Pt=u.aw(gt,1,te.transform.zoom),Jt=Ie(We,te.transform,Pt),yi=ae.layout.get("icon-text-fit")!=="none"&&ft.hasIconData();if(it){const ni=Math.pow(2,Be.zoom-gt.tileID.overscaledZ),Oi=ke?(qi,Ji)=>ke.getElevation(Ye,qi,Ji):null;_u(ft,We,Qe,xe,Be,Jt,ni,it,yi,u.ax(Be,gt,ge,we),Ye.toUnwrapped(),Oi)}}}(z,y,S,w,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),k),S.paint.get("icon-opacity").constantOr(1)!==0&&El(y,w,S,z,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),q,Y,B),S.paint.get("text-opacity").constantOr(1)!==0&&El(y,w,S,z,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),q,Y,B),w.map.showCollisionBoxes&&(ts(y,w,S,z,!0),ts(y,w,S,z,!1))}(e,n,l,h,this.style.placement.variableOffsets,m):u.c0(l)?function(y,w,S,z,k){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:O}=k,B=S.paint.get("circle-opacity"),q=S.paint.get("circle-stroke-width"),Y=S.paint.get("circle-stroke-opacity"),ne=!S.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(q.constantOr(1)===0||Y.constantOr(1)===0))return;const te=y.context,ae=te.gl,se=y.transform,fe=y.getDepthModeForSublayer(0,ii.ReadOnly),pe=mi.disabled,ge=y.colorModeForRenderPass(),we=[],xe=se.getCircleRadiusCorrection();for(let Be=0;Be<z.length;Be++){const ke=z[Be],We=w.getTile(ke),Qe=We.getBucket(S);if(!Qe)continue;const Ye=S.paint.get("circle-translate"),gt=S.paint.get("circle-translate-anchor"),ft=u.ax(se,We,Ye,gt),it=Qe.programConfigurations.get(S.id),Pt=y.useProgram("circle",it),Jt=Qe.layoutVertexBuffer,yi=Qe.indexBuffer,ni=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ke),Oi={programConfiguration:it,program:Pt,layoutVertexBuffer:Jt,indexBuffer:yi,uniformValues:xl(y,We,S,ft,xe),terrainData:ni,projectionData:se.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!O,applyTerrainMatrix:!0})};if(ne){const qi=Qe.segments.get();for(const Ji of qi)we.push({segments:new u.aG([Ji]),sortKey:Ji.sortKey,state:Oi})}else we.push({segments:Qe.segments,sortKey:0,state:Oi})}ne&&we.sort((Be,ke)=>Be.sortKey-ke.sortKey);for(const Be of we){const{programConfiguration:ke,program:We,layoutVertexBuffer:Qe,indexBuffer:Ye,uniformValues:gt,terrainData:ft,projectionData:it}=Be.state;We.draw(te,ae.TRIANGLES,fe,pe,ge,oi.backCCW,gt,ft,it,S.id,Qe,Ye,Be.segments,S.paint,y.transform.zoom,ke)}}(e,n,l,h,m):u.c1(l)?function(y,w,S,z,k){if(S.paint.get("heatmap-opacity")===0)return;const O=y.context,{isRenderingToTexture:B,isRenderingGlobe:q}=k;if(y.style.map.terrain){for(const Y of z){const ne=w.getTile(Y);w.hasRenderableParent(Y)||(y.renderPass==="offscreen"?Ns(y,ne,S,Y,q):y.renderPass==="translucent"&&uc(y,S,Y,B,q))}O.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(Y,ne,te,ae){const se=Y.context,fe=se.gl,pe=Y.transform,ge=mi.disabled,we=new Zi([fe.ONE,fe.ONE],u.b7.transparent,[!0,!0,!0,!0]);(function(xe,Be,ke){const We=xe.gl;xe.activeTexture.set(We.TEXTURE1),xe.viewport.set([0,0,Be.width/4,Be.height/4]);let Qe=ke.heatmapFbos.get(u.bS);Qe?(We.bindTexture(We.TEXTURE_2D,Qe.colorAttachment.get()),xe.bindFramebuffer.set(Qe.framebuffer)):(Qe=yu(xe,Be.width/4,Be.height/4),ke.heatmapFbos.set(u.bS,Qe))})(se,Y,te),se.clear({color:u.b7.transparent});for(let xe=0;xe<ae.length;xe++){const Be=ae[xe];if(ne.hasRenderableParent(Be))continue;const ke=ne.getTile(Be),We=ke.getBucket(te);if(!We)continue;const Qe=We.programConfigurations.get(te.id),Ye=Y.useProgram("heatmap",Qe),gt=pe.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ft=pe.getCircleRadiusCorrection();Ye.draw(se,fe.TRIANGLES,ii.disabled,ge,we,oi.backCCW,au(ke,pe.zoom,te.paint.get("heatmap-intensity"),ft),null,gt,te.id,We.layoutVertexBuffer,We.indexBuffer,We.segments,te.paint,pe.zoom,Qe)}se.viewport.set([0,0,Y.width,Y.height])}(y,w,S,z):y.renderPass==="translucent"&&function(Y,ne){const te=Y.context,ae=te.gl;te.setColorMode(Y.colorModeForRenderPass());const se=ne.heatmapFbos.get(u.bS);se&&(te.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,se.colorAttachment.get()),te.activeTexture.set(ae.TEXTURE1),is(te,ne).bind(ae.LINEAR,ae.CLAMP_TO_EDGE),Y.useProgram("heatmapTexture").draw(te,ae.TRIANGLES,ii.disabled,mi.disabled,Y.colorModeForRenderPass(),oi.disabled,ou(Y,ne,0,1),null,null,ne.id,Y.viewportBuffer,Y.quadTriangleIndexBuffer,Y.viewportSegments,ne.paint,Y.transform.zoom))}(y,S)}(e,n,l,h,m):u.c2(l)?function(y,w,S,z,k){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:O}=k,B=S.paint.get("line-opacity"),q=S.paint.get("line-width");if(B.constantOr(1)===0||q.constantOr(1)===0)return;const Y=y.getDepthModeForSublayer(0,ii.ReadOnly),ne=y.colorModeForRenderPass(),te=S.paint.get("line-dasharray"),ae=S.paint.get("line-pattern"),se=ae.constantOr(1),fe=S.paint.get("line-gradient"),pe=S.getCrossfadeParameters(),ge=se?"linePattern":te?"lineSDF":fe?"lineGradient":"line",we=y.context,xe=we.gl,Be=y.transform;let ke=!0;for(const We of z){const Qe=w.getTile(We);if(se&&!Qe.patternsLoaded())continue;const Ye=Qe.getBucket(S);if(!Ye)continue;const gt=Ye.programConfigurations.get(S.id),ft=y.context.program.get(),it=y.useProgram(ge,gt),Pt=ke||it.program!==ft,Jt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(We),yi=ae.constantOr(null);if(yi&&Qe.imageAtlas){const Ii=Qe.imageAtlas,ji=Ii.patternPositions[yi.to.toString()],Rn=Ii.patternPositions[yi.from.toString()];ji&&Rn&&gt.setConstantPatternPositions(ji,Rn)}const ni=Be.getProjectionData({overscaledTileID:We,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),Oi=Be.getPixelScale(),qi=se?bl(y,Qe,S,Oi,pe):te?nd(y,Qe,S,Oi,te,pe):fe?id(y,Qe,S,Oi,Ye.lineClipsArray.length):su(y,Qe,S,Oi);if(se)we.activeTexture.set(xe.TEXTURE0),Qe.imageAtlasTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),gt.updatePaintBuffers(pe);else if(te&&(Pt||y.lineAtlas.dirty))we.activeTexture.set(xe.TEXTURE0),y.lineAtlas.bind(we);else if(fe){const Ii=Ye.gradients[S.id];let ji=Ii.texture;if(S.gradientVersion!==Ii.version){let Rn=256;if(S.stepInterpolant){const Wn=w.getSource().maxzoom,nr=We.canonical.z===Wn?Math.ceil(1<<y.transform.maxZoom-We.canonical.z):1;Rn=u.ae(u.bT(Ye.maxLineLength/u.Z*1024*nr),256,we.maxTextureSize)}Ii.gradient=u.bU({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:Rn,image:Ii.gradient||void 0,clips:Ye.lineClipsArray}),Ii.texture?Ii.texture.update(Ii.gradient):Ii.texture=new St(we,Ii.gradient,xe.RGBA),Ii.version=S.gradientVersion,ji=Ii.texture}we.activeTexture.set(xe.TEXTURE0),ji.bind(S.stepInterpolant?xe.NEAREST:xe.LINEAR,xe.CLAMP_TO_EDGE)}let Ji;if(O){const[Ii]=y.getStencilConfigForOverlapAndUpdateStencilID(z);Ji=Ii[We.overscaledZ]}else Ji=y.stencilModeForClipping(We);it.draw(we,xe.TRIANGLES,Y,Ji,ne,oi.disabled,qi,Jt,ni,S.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,S.paint,y.transform.zoom,gt,Ye.layoutVertexBuffer2),ke=!1}}(e,n,l,h,m):u.c3(l)?function(y,w,S,z,k){const O=S.paint.get("fill-color"),B=S.paint.get("fill-opacity");if(B.constantOr(1)===0)return;const{isRenderingToTexture:q}=k,Y=y.colorModeForRenderPass(),ne=S.paint.get("fill-pattern"),te=y.opaquePassEnabledForLayer()&&!ne.constantOr(1)&&O.constantOr(u.b7.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===te){const ae=y.getDepthModeForSublayer(1,y.renderPass==="opaque"?ii.ReadWrite:ii.ReadOnly);Us(y,w,S,z,ae,Y,!1,q)}if(y.renderPass==="translucent"&&S.paint.get("fill-antialias")){const ae=y.getDepthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,ii.ReadOnly);Us(y,w,S,z,ae,Y,!0,q)}}(e,n,l,h,m):u.c4(l)?function(y,w,S,z,k){const O=S.paint.get("fill-extrusion-opacity");if(O===0)return;const{isRenderingToTexture:B}=k;if(y.renderPass==="translucent"){const q=new ii(y.context.gl.LEQUAL,ii.ReadWrite,y.depthRangeFor3D);if(O!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))Vs(y,w,S,z,q,mi.disabled,Zi.disabled,B),Vs(y,w,S,z,q,y.stencilModeFor3D(),y.colorModeForRenderPass(),B);else{const Y=y.colorModeForRenderPass();Vs(y,w,S,z,q,mi.disabled,Y,B)}}}(e,n,l,h,m):u.c5(l)?function(y,w,S,z,k){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const{isRenderingToTexture:O}=k,B=y.context,q=y.style.projection.useSubdivision,Y=y.getDepthModeForSublayer(0,ii.ReadOnly),ne=y.colorModeForRenderPass();if(y.renderPass==="offscreen")(function(te,ae,se,fe,pe,ge,we){const xe=te.context,Be=xe.gl;for(const ke of se){const We=ae.getTile(ke),Qe=We.dem;if(!Qe||!Qe.data||!We.needsHillshadePrepare)continue;const Ye=Qe.dim,gt=Qe.stride,ft=Qe.getPixels();if(xe.activeTexture.set(Be.TEXTURE1),xe.pixelStoreUnpackPremultiplyAlpha.set(!1),We.demTexture=We.demTexture||te.getTileTexture(gt),We.demTexture){const Pt=We.demTexture;Pt.update(ft,{premultiply:!1}),Pt.bind(Be.NEAREST,Be.CLAMP_TO_EDGE)}else We.demTexture=new St(xe,ft,Be.RGBA,{premultiply:!1}),We.demTexture.bind(Be.NEAREST,Be.CLAMP_TO_EDGE);xe.activeTexture.set(Be.TEXTURE0);let it=We.fbo;if(!it){const Pt=new St(xe,{width:Ye,height:Ye,data:null},Be.RGBA);Pt.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),it=We.fbo=xe.createFramebuffer(Ye,Ye,!0,!1),it.colorAttachment.set(Pt.texture)}xe.bindFramebuffer.set(it.framebuffer),xe.viewport.set([0,0,Ye,Ye]),te.useProgram("hillshadePrepare").draw(xe,Be.TRIANGLES,pe,ge,we,oi.disabled,Ps(We.tileID,Qe),null,null,fe.id,te.rasterBoundsBuffer,te.quadTriangleIndexBuffer,te.rasterBoundsSegments),We.needsHillshadePrepare=!1}})(y,w,z,S,Y,mi.disabled,ne),B.viewport.set([0,0,y.width,y.height]);else if(y.renderPass==="translucent")if(q){const[te,ae,se]=y.stencilConfigForOverlapTwoPass(z);Dr(y,w,S,se,te,Y,ne,!1,O),Dr(y,w,S,se,ae,Y,ne,!0,O)}else{const[te,ae]=y.getStencilConfigForOverlapAndUpdateStencilID(z);Dr(y,w,S,ae,te,Y,ne,!1,O)}}(e,n,l,h,m):u.c6(l)?function(y,w,S,z,k){if(y.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!z.length)return;const{isRenderingToTexture:O}=k,B=w.getSource(),q=y.style.projection.useSubdivision;if(B instanceof Jr)ma(y,w,S,z,null,!1,!1,B.tileCoords,B.flippedWindingOrder,O);else if(q){const[Y,ne,te]=y.stencilConfigForOverlapTwoPass(z);ma(y,w,S,te,Y,!1,!0,mr,!1,O),ma(y,w,S,te,ne,!0,!0,mr,!1,O)}else{const[Y,ne]=y.getStencilConfigForOverlapAndUpdateStencilID(z);ma(y,w,S,ne,Y,!1,!0,mr,!1,O)}}(e,n,l,h,m):u.c7(l)?function(y,w,S,z,k){const O=S.paint.get("background-color"),B=S.paint.get("background-opacity");if(B===0)return;const{isRenderingToTexture:q}=k,Y=y.context,ne=Y.gl,te=y.style.projection,ae=y.transform,se=ae.tileSize,fe=S.paint.get("background-pattern");if(y.isPatternMissing(fe))return;const pe=!fe&&O.a===1&&B===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==pe)return;const ge=mi.disabled,we=y.getDepthModeForSublayer(0,pe==="opaque"?ii.ReadWrite:ii.ReadOnly),xe=y.colorModeForRenderPass(),Be=y.useProgram(fe?"backgroundPattern":"background"),ke=z||Ce(ae,{tileSize:se,terrain:y.style.map.terrain});fe&&(Y.activeTexture.set(ne.TEXTURE0),y.imageManager.bind(y.context));const We=S.getCrossfadeParameters();for(const Qe of ke){const Ye=ae.getProjectionData({overscaledTileID:Qe,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),gt=fe?nc(B,y,fe,{tileID:Qe,tileSize:se},We):uu(B,O),ft=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Qe),it=te.getMeshFromTileID(Y,Qe.canonical,!1,!0,"raster");Be.draw(Y,ne.TRIANGLES,we,ge,xe,oi.backCCW,gt,ft,Ye,S.id,it.vertexBuffer,it.indexBuffer,it.segments)}}(e,0,l,h,m):u.c8(l)&&function(y,w,S,z){const{isRenderingGlobe:k}=z,O=y.context,B=S.implementation,q=y.style.projection,Y=y.transform,ne=Y.getProjectionDataForCustomLayer(k),te={farZ:Y.farZ,nearZ:Y.nearZ,fov:Y.fov*Math.PI/180,modelViewProjectionMatrix:Y.modelViewProjectionMatrix,projectionMatrix:Y.projectionMatrix,shaderData:{variantName:q.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${q.shaderPreludeCode.vertexSource}`,define:q.shaderDefine},defaultProjectionData:ne},ae=B.renderingMode?B.renderingMode:"2d";if(y.renderPass==="offscreen"){const se=B.prerender;se&&(y.setCustomLayerDefaults(),O.setColorMode(y.colorModeForRenderPass()),se.call(B,O.gl,te),O.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),O.setColorMode(y.colorModeForRenderPass()),O.setStencilMode(mi.disabled);const se=ae==="3d"?y.getDepthModeFor3D():y.getDepthModeForSublayer(0,ii.ReadOnly);O.setDepthMode(se),B.render(O.gl,te),O.setDirty(),y.setBaseState(),O.bindFramebuffer.set(null)}}(e,0,l,m))}saveTileTexture(e){const n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const n=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!n||!l}useProgram(e,n,l=!1){this.cache=this.cache||{};const h=!!this.style.map.terrain,m=this.style.projection,y=e+(n?n.cacheKey:"")+`/${l?As:m.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(h?"/terrain":"");return this.cache[y]||(this.cache[y]=new Jl(this.context,Bn[e],n,hu[e],this._showOverdrawInspector,h,l?Bn.projectionMercator:m.shaderPreludeCode,l?Vr:m.shaderDefine)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new St(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:n}=this.context.gl;return this.width!==e||this.height!==n}}function vu(f,e){let n,l=!1,h=null,m=null;const y=()=>{h=null,l&&(f.apply(m,n),h=setTimeout(y,e),l=!1)};return(...w)=>(l=!0,m=this,n=w,h||y(),h)}class xu{constructor(e){this._getCurrentHash=()=>{const n=window.location.hash.replace("#","");if(this._hashName){let l;return n.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(l=h)}),(l&&l[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{const n=this._getCurrentHash();if(!this._isValidHash(n))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:l,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{const n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{const n=this._getCurrentHash();if(n.length===0)return;const l=n.join("/");let h=l;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${l}`);let m=window.location.hash.replace(h,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let y=window.location.href.replace(/(#.+)?$/,m);y=y.replace("&&","&"),window.history.replaceState(window.history.state,null,y)},this._updateHash=vu(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const n=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,h=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,h),y=Math.round(n.lng*m)/m,w=Math.round(n.lat*m)/m,S=this._map.getBearing(),z=this._map.getPitch();let k="";if(k+=e?`/${y}/${w}/${l}`:`${l}/${w}/${y}`,(S||z)&&(k+="/"+Math.round(10*S)/10),z&&(k+=`/${Math.round(z)}`),this._hashName){const O=this._hashName;let B=!1;const q=window.location.hash.slice(1).split("&").map(Y=>{const ne=Y.split("=")[0];return ne===O?(B=!0,`${ne}=${k}`):Y}).filter(Y=>Y);return B||q.push(`${O}=${k}`),`#${q.join("&")}`}return`#${k}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new u.Q(+e[2],+e[1])}catch{return!1}const n=+e[0],l=+(e[3]||0),h=+(e[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&l>=-180&&l<=180&&h>=this._map.getMinPitch()&&h<=this._map.getMaxPitch()}}const eo={linearity:.3,easing:u.c9(0,0,.3,1)},ka=u.e({deceleration:2500,maxSpeed:1400},eo),ch=u.e({deceleration:20,maxSpeed:1400},eo),Cl=u.e({deceleration:1e3,maxSpeed:360},eo),bu=u.e({deceleration:1e3,maxSpeed:90},eo),as=u.e({deceleration:1e3,maxSpeed:360},eo);class to{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:_e.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=_e.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)n.zoom+=m.zoomDelta||0,n.bearing+=m.bearingDelta||0,n.pitch+=m.pitchDelta||0,n.roll+=m.rollDelta||0,m.panDelta&&n.pan._add(m.panDelta),m.around&&(n.around=m.around),m.pinchAround&&(n.pinchAround=m.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(n.pan.mag()){const m=$r(n.pan.mag(),l,u.e({},ka,e||{})),y=n.pan.mult(m.amount/n.pan.mag()),w=this._map.cameraHelper.handlePanInertia(y,this._map.transform);h.center=w.easingCenter,h.offset=w.easingOffset,sa(h,m)}if(n.zoom){const m=$r(n.zoom,l,ch);h.zoom=this._map.transform.zoom+m.amount,sa(h,m)}if(n.bearing){const m=$r(n.bearing,l,Cl);h.bearing=this._map.transform.bearing+u.ae(m.amount,-179,179),sa(h,m)}if(n.pitch){const m=$r(n.pitch,l,bu);h.pitch=this._map.transform.pitch+m.amount,sa(h,m)}if(n.roll){const m=$r(n.roll,l,as);h.roll=this._map.transform.roll+u.ae(m.amount,-179,179),sa(h,m)}if(h.zoom||h.bearing){const m=n.pinchAround===void 0?n.around:n.pinchAround;h.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),u.e(h,{noMoveStart:!0})}}function sa(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function $r(f,e,n){const{maxSpeed:l,linearity:h,deceleration:m}=n,y=u.ae(f*h/(e/1e3),-l,l),w=Math.abs(y)/(m*h);return{easing:n.easing,duration:1e3*w,amount:y*(w/2)}}class dr extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l,h={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const m=ie.mousePos(n.getCanvas(),l),y=n.unproject(m);super(e,u.e({point:m,lngLat:y,originalEvent:l},h)),this._defaultPrevented=!1,this.target=n}}class os extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l){const h=e==="touchend"?l.changedTouches:l.touches,m=ie.touchPos(n.getCanvasContainer(),h),y=m.map(S=>n.unproject(S)),w=m.reduce((S,z,k,O)=>S.add(z.div(O.length)),new u.P(0,0));super(e,{points:m,point:w,lngLats:y,lngLat:n.unproject(w),originalEvent:l}),this._defaultPrevented=!1}}class Cr extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class la{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Cr(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new dr(e.type,this._map,e))}mouseup(e){this._map.fire(new dr(e.type,this._map,e))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new dr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new dr(e.type,this._map,e))}mouseover(e){this._map.fire(new dr(e.type,this._map,e))}mouseout(e){this._map.fire(new dr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new os(e.type,this._map,e))}touchmove(e){this._map.fire(new os(e.type,this._map,e))}touchend(e){this._map.fire(new os(e.type,this._map,e))}touchcancel(e){this._map.fire(new os(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ss{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new dr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new dr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new dr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ni{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(u.P.convert(e),this._map.terrain)}}class io{constructor(e,n){this._map=e,this._tr=new Ni(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&(ie.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;const l=n;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=l,this._box||(this._box=ie.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(h.x,l.x),y=Math.max(h.x,l.x),w=Math.min(h.y,l.y),S=Math.max(h.y,l.y);ie.setTransform(this._box,`translate(${m}px,${w}px)`),this._box.style.width=y-m+"px",this._box.style.height=S-w+"px"}mouseupWindow(e,n){if(!this._active||e.button!==0)return;const l=this._startPos,h=n;if(this.reset(),ie.suppressClick(),l.x!==h.x||l.y!==h.y)return this._map.fire(new u.l("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(l,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ie.remove(this._box),this._box=null),ie.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new u.l(e,{originalEvent:n}))}}function wu(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const n={};for(let l=0;l<f.length;l++)n[f[l].identifier]=e[l];return n}class af{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(h){const m=new u.P(0,0);for(const y of h)m._add(y);return m.div(h.length)}(n),this.touches=wu(l,n)))}touchmove(e,n,l){if(this.aborted||!this.centroid)return;const h=wu(l,n);for(const m in this.touches){const y=h[m];(!y||y.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,n,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class uh{constructor(e){this.singleTap=new af(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,n,l){this.singleTap.touchstart(e,n,l)}touchmove(e,n,l){this.singleTap.touchmove(e,n,l)}touchend(e,n,l){const h=this.singleTap.touchend(e,n,l);if(h){const m=e.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(h)<30;if(m&&y||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class of{constructor(e){this._tr=new Ni(e),this._zoomIn=new uh({numTouches:1,numTaps:2}),this._zoomOut=new uh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,l){this._zoomIn.touchstart(e,n,l),this._zoomOut.touchstart(e,n,l)}touchmove(e,n,l){this._zoomIn.touchmove(e,n,l),this._zoomOut.touchmove(e,n,l)}touchend(e,n,l){const h=this._zoomIn.touchend(e,n,l),m=this._zoomOut.touchend(e,n,l),y=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:y.zoom+1,around:y.unproject(h)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:y.zoom-1,around:y.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const n=this._moveFunction(...e);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(e,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,n){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const h=Array.isArray(n)?n[0]:n;return!this._moved&&h.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(l,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ie.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Zs={0:1,2:2};class gr{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const n=ie.mouseButton(e);this._eventButton=n}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(n,l){const h=Zs[l];return n.buttons===void 0||(n.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return ie.mouseButton(e)===this._eventButton}}class Tt{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Tu{constructor(e=new gr({checkCorrectEvent:()=>!0}),n=new Tt){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(e,n,l){return e instanceof MouseEvent?n(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}const La=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class Gs{constructor(e,n){this._clickTolerance=e.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,n,l){return this._calculateTransform(e,n,l)}touchmove(e,n,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,n,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,n,l){this._calculateTransform(e,n,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,l){l.length>0&&(this._active=!0);const h=wu(l,n),m=new u.P(0,0),y=new u.P(0,0);let w=0;for(const z in h){const k=h[z],O=this._touches[z];O&&(m._add(k),y._add(k.sub(O)),w++,h[z]=k)}if(this._touches=h,this._shouldBePrevented(w)||!y.mag())return;const S=y.div(w);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(w),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qs{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,n,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,l){if(!this._firstTwoTouches)return;e.preventDefault();const[h,m]=this._firstTwoTouches,y=Bo(l,n,h),w=Bo(l,n,m);if(!y||!w)return;const S=this._aroundCenter?null:y.add(w).div(2);return this._move([y,w],S,e)}touchend(e,n,l){if(!this._firstTwoTouches)return;const[h,m]=this._firstTwoTouches,y=Bo(l,n,h),w=Bo(l,n,m);y&&w||(this._active&&ie.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Bo(f,e,n){for(let l=0;l<f.length;l++)if(f[l].identifier===n)return e[l]}function hh(f,e){return Math.log(f/e)/Math.LN2}class si extends qs{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(hh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:hh(this._distance,l),pinchAround:n}}}function no(f,e){return 180*f.angleWith(e)/Math.PI}class Su extends qs{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n,l){const h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:no(this._vector,h),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const n=25/(Math.PI*this._minDiameter)*360,l=no(e,this._startVector);return Math.abs(l)<n}}function ls(f){return Math.abs(f.y)>Math.abs(f.x)}class dh extends qs{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,n,l){super.touchstart(e,n,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,ls(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,m,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,n,l){if(this._valid!==void 0)return this._valid;const h=e.mag()>=2,m=n.mag()>=2;if(!h&&!m)return;if(!h||!m)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const y=e.y>0==n.y>0;return ls(e)&&ls(n)&&y}}const fc={panStep:100,bearingStep:15,pitchStep:10};class Eu{constructor(e){this._tr=new Ni(e);const n=fc;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,l=0,h=0,m=0,y=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),y=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(l=0,h=0),{cameraAnimation:w=>{const S=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:Ml,zoom:n?Math.round(S.zoom)+n*(e.shiftKey?2:1):S.zoom,bearing:S.bearing+l*this._bearingStep,pitch:S.pitch+h*this._pitchStep,offset:[-m*this._panStep,-y*this._panStep],center:S.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ml(f){return f*(2-f)}const pc=4.000244140625;class fh{constructor(e,n){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Ni(e),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=_e.now(),h=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,n!==0&&n%pc==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=ie.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(u.Q.convert(l.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const w=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=w),typeof this._targetZoom=="number"&&(this._targetZoom+=w)}if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>pc?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&S!==0&&(S=1/S);const z=typeof this._targetZoom!="number"?e.scale:u.aI(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,u.ab(z*S))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,h=this._easing;let m,y=!1;if(this._type==="wheel"&&l&&h){const w=_e.now()-this._lastWheelEventTime,S=Math.min((w+5)/200,1),z=h(S);m=u.B.number(l,n,z),S<1?this._frameId||(this._frameId=!0):y=!0}else m=n,y=!0;return this._active=!0,y&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=m,{noInertia:!0,needsRenderFrame:!y,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=u.cb;if(this._prevEase){const l=this._prevEase,h=(_e.now()-l.start)/l.duration,m=l.easing(h+.01)-l.easing(h),y=.27/Math.sqrt(m*m+1e-4)*.01,w=Math.sqrt(.0729-y*y);n=u.c9(y,w,.25,1)}return this._prevEase={start:_e.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Al{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ud{constructor(e){this._tr=new Ni(e),this.reset()}reset(){this._active=!1}dblclick(e,n){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mc{constructor(){this._tap=new uh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,n,l){if(!this._swipePoint)if(this._tapTime){const h=n[0],m=e.timeStamp-this._tapTime<500,y=this._tapPoint.dist(h)<30;m&&y?l.length>0&&(this._swipePoint=h,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,n,l)}touchmove(e,n,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const h=n[0],m=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,n,l)}touchend(e,n,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const h=this._tap.touchend(e,n,l);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ro{constructor(e,n,l){this._el=e,this._mousePan=n,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Qi{constructor(e,n,l,h){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=n,this._mousePitch=l,this._mouseRoll=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ga{constructor(e,n,l,h){this._el=e,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class zl{constructor(e,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ie.create("div","maplibregl-cooperative-gesture-screen",e);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=n,this._container.appendChild(h);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=l,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ie.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new u.l("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Hs=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class Oo extends u.l{}function Ba(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class gc{constructor(e,n){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,m)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const y=h.type==="renderFrame"?void 0:h,w={needsRenderFrame:!1},S={},z={};for(const{handlerName:B,handler:q,allowed:Y}of this._handlers){if(!q.isEnabled())continue;let ne;if(this._blockedByActive(z,Y,B))q.reset();else if(q[m||h.type]){if(u.cc(h,m||h.type)){const te=ie.mousePos(this._map.getCanvas(),h);ne=q[m||h.type](h,te)}else if(u.cd(h,m||h.type)){const te=this._getMapTouches(h.touches),ae=ie.touchPos(this._map.getCanvas(),te);ne=q[m||h.type](h,ae,te)}else u.ce(m||h.type)||(ne=q[m||h.type](h));this.mergeHandlerResult(w,S,ne,B,y),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()}(ne||q.isActive())&&(z[B]=q)}const k={};for(const B in this._previousActiveHandlers)z[B]||(k[B]=y);this._previousActiveHandlers=z,(Object.keys(k).length||Ba(w))&&(this._changes.push([w,S,k]),this._triggerRenderFrame()),(Object.keys(z).length||Ba(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:O}=w;O&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],O(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new to(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,m,y]of this._listeners)ie.addEventListener(h,m,h===document?this.handleWindowEvent:this.handleEvent,y)}destroy(){for(const[e,n,l]of this._listeners)ie.removeEventListener(e,n,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const n=this._map,l=n.getCanvasContainer();this._add("mapEvent",new la(n,e));const h=n.boxZoom=new io(n,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();const m=n.cooperativeGestures=new zl(n,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const y=new of(n),w=new ud(n);n.doubleClickZoom=new Al(w,y),this._add("tapZoom",y),this._add("clickZoom",w),e.interactive&&e.doubleClickZoom&&n.doubleClickZoom.enable();const S=new mc;this._add("tapDragZoom",S);const z=n.touchPitch=new dh(n);this._add("touchPitch",z),e.interactive&&e.touchPitch&&n.touchPitch.enable(e.touchPitch);const k=()=>n.project(n.getCenter()),O=function({enable:pe,clickTolerance:ge,aroundCenter:we=!0,minPixelCenterThreshold:xe=100,rotateDegreesPerPixelMoved:Be=.8},ke){const We=new gr({checkCorrectEvent:Qe=>ie.mouseButton(Qe)===0&&Qe.ctrlKey||ie.mouseButton(Qe)===2&&!Qe.ctrlKey});return new wn({clickTolerance:ge,move:(Qe,Ye)=>{const gt=ke();if(we&&Math.abs(gt.y-Qe.y)>xe)return{bearingDelta:u.ca(new u.P(Qe.x,Ye.y),Ye,gt)};let ft=(Ye.x-Qe.x)*Be;return we&&Ye.y<gt.y&&(ft=-ft),{bearingDelta:ft}},moveStateManager:We,enable:pe,assignEvents:La})}(e,k),B=function({enable:pe,clickTolerance:ge,pitchDegreesPerPixelMoved:we=-.5}){const xe=new gr({checkCorrectEvent:Be=>ie.mouseButton(Be)===0&&Be.ctrlKey||ie.mouseButton(Be)===2});return new wn({clickTolerance:ge,move:(Be,ke)=>({pitchDelta:(ke.y-Be.y)*we}),moveStateManager:xe,enable:pe,assignEvents:La})}(e),q=function({enable:pe,clickTolerance:ge,rollDegreesPerPixelMoved:we=.3},xe){const Be=new gr({checkCorrectEvent:ke=>ie.mouseButton(ke)===2&&ke.ctrlKey});return new wn({clickTolerance:ge,move:(ke,We)=>{const Qe=xe();let Ye=(We.x-ke.x)*we;return We.y<Qe.y&&(Ye=-Ye),{rollDelta:Ye}},moveStateManager:Be,enable:pe,assignEvents:La})}(e,k);n.dragRotate=new Qi(e,O,B,q),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",B,["mouseRotate","mouseRoll"]),this._add("mouseRoll",q,["mousePitch"]),e.interactive&&e.dragRotate&&n.dragRotate.enable();const Y=function({enable:pe,clickTolerance:ge}){const we=new gr({checkCorrectEvent:xe=>ie.mouseButton(xe)===0&&!xe.ctrlKey});return new wn({clickTolerance:ge,move:(xe,Be)=>({around:Be,panDelta:Be.sub(xe)}),activateOnStart:!0,moveStateManager:we,enable:pe,assignEvents:La})}(e),ne=new Gs(e,n);n.dragPan=new ro(l,Y,ne),this._add("mousePan",Y),this._add("touchPan",ne,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&n.dragPan.enable(e.dragPan);const te=new Su,ae=new si;n.touchZoomRotate=new ga(l,ae,te,S),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&n.touchZoomRotate.enable(e.touchZoomRotate);const se=n.scrollZoom=new fh(n,()=>this._triggerRenderFrame());this._add("scrollZoom",se,["mousePan"]),e.interactive&&e.scrollZoom&&n.scrollZoom.enable(e.scrollZoom);const fe=n.keyboard=new Eu(n);this._add("keyboard",fe),e.interactive&&e.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new ss(n))}_add(e,n,l){this._handlers.push({handlerName:e,handler:n,allowed:l}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hs(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,n,l){for(const h in e)if(h!==l&&(!n||n.indexOf(h)<0))return!0;return!1}_getMapTouches(e){const n=[];for(const l of e)this._el.contains(l.target)&&n.push(l);return n}mergeHandlerResult(e,n,l,h,m){if(!l)return;u.e(e,l);const y={handlerName:h,originalEvent:l.originalEvent||m};l.zoomDelta!==void 0&&(n.zoom=y),l.panDelta!==void 0&&(n.drag=y),l.rollDelta!==void 0&&(n.roll=y),l.pitchDelta!==void 0&&(n.pitch=y),l.bearingDelta!==void 0&&(n.rotate=y)}_applyChanges(){const e={},n={},l={};for(const[h,m,y]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new u.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.rollDelta&&(e.rollDelta=(e.rollDelta||0)+h.rollDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),u.e(n,m),u.e(l,y);this._updateMapTransform(e,n,l),this._changes=[]}_updateMapTransform(e,n,l){const h=this._map,m=h._getTransformForUpdate(),y=h.terrain;if(!(Ba(e)||y&&this._terrainMovement))return this._fireEvents(n,l,!0);h._stop(!0);let{panDelta:w,zoomDelta:S,bearingDelta:z,pitchDelta:k,rollDelta:O,around:B,pinchAround:q}=e;q!==void 0&&(B=q),B=B||h.transform.centerPoint,y&&!m.isPointOnMapSurface(B)&&(B=m.centerPoint);const Y={panDelta:w,zoomDelta:S,rollDelta:O,pitchDelta:k,bearingDelta:z,around:B};this._map.cameraHelper.useGlobeControls&&!m.isPointOnMapSurface(B)&&(B=m.centerPoint);const ne=B.distSqr(m.centerPoint)<.01?m.center:m.screenPointToLocation(w?B.sub(w):B);y?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Y,m),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?m.setCenter(m.screenPointToLocation(m.centerPoint.sub(w))):this._map.cameraHelper.handleMapControlsPan(Y,m,ne):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Y,m,ne))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Y,m),this._map.cameraHelper.handleMapControlsPan(Y,m,ne)),h._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,l,!0)}_fireEvents(e,n,l){const h=Hs(this._eventsInProgress),m=Hs(e),y={};for(const O in e){const{originalEvent:B}=e[O];this._eventsInProgress[O]||(y[`${O}start`]=B),this._eventsInProgress[O]=e[O]}!h&&m&&this._fireEvent("movestart",m.originalEvent);for(const O in y)this._fireEvent(O,y[O]);m&&this._fireEvent("move",m.originalEvent);for(const O in e){const{originalEvent:B}=e[O];this._fireEvent(O,B)}const w={};let S;for(const O in this._eventsInProgress){const{handlerName:B,originalEvent:q}=this._eventsInProgress[O];this._handlersById[B].isActive()||(delete this._eventsInProgress[O],S=n[B]||q,w[`${O}end`]=S)}for(const O in w)this._fireEvent(O,w[O]);const z=Hs(this._eventsInProgress),k=(h||m)&&!z;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const O=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&O.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(O)}if(l&&k){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=q=>q!==0&&-this._bearingSnap<q&&q<this._bearingSnap;!O||!O.essential&&_e.prefersReducedMotion?(this._map.fire(new u.l("moveend",{originalEvent:S})),B(this._map.getBearing())&&this._map.resetNorth()):(B(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:S})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new u.l(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Oo("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class _a extends u.E{constructor(e,n,l){super(),this._renderFrameCallback=()=>{const h=Math.min((_e.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,n){e.apply(this.transform),this.transform=e,this.cameraHelper=n}getCenter(){return new u.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,n){return this.jumpTo({elevation:e},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,n,l){return e=u.P.convert(e).mult(-1),this.panTo(this.transform.center,u.e({offset:e},n),l)}panTo(e,n,l){return this.easeTo(u.e({center:e},n),l)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,l){return this.easeTo(u.e({zoom:e},n),l)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,n){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new u.l("movestart",n)).fire(new u.l("move",n)).fire(new u.l("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,l){return this.easeTo(u.e({bearing:e},n),l)}resetNorth(e,n){return this.rotateTo(0,u.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(u.e({bearing:0,pitch:0,roll:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}getRoll(){return this.transform.roll}setRoll(e,n){return this.jumpTo({roll:e},n),this}cameraForBounds(e,n){e=Wi.convert(e).adjustAntiMeridian();const l=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,n)}_cameraForBoxAndBearing(e,n,l,h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=u.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const z=h.padding;h.padding={top:z,bottom:z,right:z,left:z}}const y=u.e(m,h.padding);h.padding=y;const w=this.transform,S=new Wi(e,n);return this.cameraHelper.cameraForBoxAndBearing(h,y,S,l,w)}fitBounds(e,n,l){return this._fitInternal(this.cameraForBounds(e,n),n,l)}fitScreenCoordinates(e,n,l,h,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(u.P.convert(e)),this.transform.screenPointToLocation(u.P.convert(n)),l,h),h,m)}_fitInternal(e,n,l){return e?(delete(n=u.e(e,n)).padding,n.linear?this.easeTo(n,l):this.flyTo(n,l)):this}jumpTo(e,n){this.stop();const l=this._getTransformForUpdate();let h=!1,m=!1,y=!1;const w=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const S=l.zoom!==w;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(h=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(m=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(y=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new u.l("movestart",n)).fire(new u.l("move",n)),S&&this.fire(new u.l("zoomstart",n)).fire(new u.l("zoom",n)).fire(new u.l("zoomend",n)),h&&this.fire(new u.l("rotatestart",n)).fire(new u.l("rotate",n)).fire(new u.l("rotateend",n)),m&&this.fire(new u.l("pitchstart",n)).fire(new u.l("pitch",n)).fire(new u.l("pitchend",n)),y&&this.fire(new u.l("rollstart",n)).fire(new u.l("roll",n)).fire(new u.l("rollend",n)),this.fire(new u.l("moveend",n))}calculateCameraOptionsFromTo(e,n,l,h=0){const m=u.$.fromLngLat(e,n),y=u.$.fromLngLat(l,h),w=y.x-m.x,S=y.y-m.y,z=y.z-m.z,k=Math.hypot(w,S,z);if(k===0)throw new Error("Can't calculate camera options with same From and To");const O=Math.hypot(w,S),B=u.ab(this.transform.cameraToCenterDistance/k/this.transform.tileSize),q=180*Math.atan2(w,-S)/Math.PI;let Y=180*Math.acos(O/k)/Math.PI;return Y=z<0?90-Y:90+Y,{center:y.toLngLat(),elevation:h,zoom:B,pitch:Y,bearing:q}}calculateCameraOptionsFromCameraLngLatAltRotation(e,n,l,h,m){const y=this.transform.calculateCenterFromCameraLngLatAlt(e,n,l,h);return{center:y.center,elevation:y.elevation,zoom:y.zoom,bearing:l,pitch:h,roll:m}}easeTo(e,n){this._stop(!1,e.easeId),((e=u.e({offset:[0,0],duration:500,easing:u.cb},e)).animate===!1||!e.essential&&_e.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),h=this.getBearing(),m=l.pitch,y=l.roll,w="bearing"in e?this._normalizeBearing(e.bearing,h):h,S="pitch"in e?+e.pitch:m,z="roll"in e?this._normalizeBearing(e.roll,y):y,k="padding"in e?e.padding:l.padding,O=u.P.convert(e.offset);let B,q;e.around&&(B=u.Q.convert(e.around),q=l.locationToScreenPoint(B));const Y={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ne=this.cameraHelper.handleEaseTo(l,{bearing:w,pitch:S,roll:z,padding:k,around:B,aroundPoint:q,offsetAsPoint:O,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||h!==w,this._pitching=this._pitching||S!==m,this._rolling=this._rolling||z!==y,this._padding=!l.isPaddingEqual(k),this._zooming=this._zooming||ne.isZooming,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,Y),this.terrain&&this._prepareElevation(ne.elevationCenter),this._ease(te=>{ne.easeFunc(te),this.terrain&&!e.freezeElevation&&this._updateElevation(te),this._applyUpdatedTransform(l),this._fireMoveEvents(n)},te=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,te)},e),this}_prepareEase(e,n,l={}){this._moving=!0,n||l.moving||this.fire(new u.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new u.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new u.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new u.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new u.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(n-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.setElevation(u.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const n=e.getCameraLngLat(),l=e.getCameraAltitude(),h=this.terrain?this.terrain.getElevationForLngLatZoom(n,e.zoom):0;if(l<h){const m=this.calculateCameraOptionsFromTo(n,h,e.center,e.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(e){const n=[];if(n.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&n.push(h=>this.transformCameraUpdate(h)),!n.length)return;const l=e.clone();for(const h of n){const m=l.clone(),{center:y,zoom:w,roll:S,pitch:z,bearing:k,elevation:O}=h(m);y&&m.setCenter(y),O!==void 0&&m.setElevation(O),w!==void 0&&m.setZoom(w),S!==void 0&&m.setRoll(S),z!==void 0&&m.setPitch(z),k!==void 0&&m.setBearing(k),l.apply(m)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new u.l("move",e)),this._zooming&&this.fire(new u.l("zoom",e)),this._rotating&&this.fire(new u.l("rotate",e)),this._pitching&&this.fire(new u.l("pitch",e)),this._rolling&&this.fire(new u.l("roll",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const l=this._zooming,h=this._rotating,m=this._pitching,y=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new u.l("zoomend",e)),h&&this.fire(new u.l("rotateend",e)),m&&this.fire(new u.l("pitchend",e)),y&&this.fire(new u.l("rollend",e)),this.fire(new u.l("moveend",e))}flyTo(e,n){if(!e.essential&&_e.prefersReducedMotion){const Ye=u.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ye,n)}this.stop(),e=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.cb},e);const l=this._getTransformForUpdate(),h=l.bearing,m=l.pitch,y=l.roll,w=l.padding,S="bearing"in e?this._normalizeBearing(e.bearing,h):h,z="pitch"in e?+e.pitch:m,k="roll"in e?this._normalizeBearing(e.roll,y):y,O="padding"in e?e.padding:l.padding,B=u.P.convert(e.offset);let q=l.centerPoint.add(B);const Y=l.screenPointToLocation(q),ne=this.cameraHelper.handleFlyTo(l,{bearing:S,pitch:z,roll:k,padding:O,locationAtOffset:Y,offsetAsPoint:B,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let te=e.curve;const ae=Math.max(l.width,l.height),se=ae/ne.scaleOfZoom,fe=ne.pixelPathLength;typeof ne.scaleOfMinZoom=="number"&&(te=Math.sqrt(ae/ne.scaleOfMinZoom/fe*2));const pe=te*te;function ge(Ye){const gt=(se*se-ae*ae+(Ye?-1:1)*pe*pe*fe*fe)/(2*(Ye?se:ae)*pe*fe);return Math.log(Math.sqrt(gt*gt+1)-gt)}function we(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function xe(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}const Be=ge(!1);let ke=function(Ye){return xe(Be)/xe(Be+te*Ye)},We=function(Ye){return ae*((xe(Be)*(we(gt=Be+te*Ye)/xe(gt))-we(Be))/pe)/fe;var gt},Qe=(ge(!0)-Be)/te;if(Math.abs(fe)<2e-6||!isFinite(Qe)){if(Math.abs(ae-se)<1e-6)return this.easeTo(e,n);const Ye=se<ae?-1:1;Qe=Math.abs(Math.log(se/ae))/te,We=()=>0,ke=gt=>Math.exp(Ye*te*gt)}return e.duration="duration"in e?+e.duration:1e3*Qe/("screenSpeed"in e?+e.screenSpeed/te:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=h!==S,this._pitching=z!==m,this._rolling=k!==y,this._padding=!l.isPaddingEqual(O),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(ne.targetCenter),this._ease(Ye=>{const gt=Ye*Qe,ft=1/ke(gt),it=We(gt);this._rotating&&l.setBearing(u.B.number(h,S,Ye)),this._pitching&&l.setPitch(u.B.number(m,z,Ye)),this._rolling&&l.setRoll(u.B.number(y,k,Ye)),this._padding&&(l.interpolatePadding(w,O,Ye),q=l.centerPoint.add(B)),ne.easeFunc(Ye,ft,it,q),this.terrain&&!e.freezeElevation&&this._updateElevation(Ye),this._applyUpdatedTransform(l),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,n)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,n,l){l.animate===!1||l.duration===0?(e(1),n()):(this._easeStart=_e.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=u.aL(e,-180,180);const l=Math.abs(e-n);return Math.abs(e-360-n)<l&&(e-=360),Math.abs(e+360-n)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(u.Q.convert(e),this.transform.tileZoom):null}}const $s={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Dt{constructor(e=$s){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ie.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ie.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ie.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ie.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,n){const l=this._map._getUIString(`AttributionControl.${n}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const n=this._map.style.sourceCaches;for(const h in n){const m=n[h];if(m.used||m.usedForTerrain){const y=m.getSource();y.attribution&&e.indexOf(y.attribution)<0&&e.push(y.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,m)=>h.length-m.length),e=e.filter((h,m)=>{for(let y=m+1;y<e.length;y++)if(e[y].indexOf(h)>=0)return!1;return!0});const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=ie.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Nt{constructor(e={}){this._updateCompact=()=>{const n=this._container.children;if(n.length){const l=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ie.create("div","maplibregl-ctrl");const n=ie.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ie.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class _c{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){const n=this._currentlyRunning,l=n?this._queue.concat(n):this._queue;for(const h of l)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const n=this._currentlyRunning=this._queue;this._queue=[];for(const l of n)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Cu=u.aD([{name:"a_pos3d",type:"Int16",components:3}]);class cs extends u.E{constructor(e){super(),this._lastTilesetChange=_e.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];const l={};for(const h of Ce(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.terrainRttPosMatrix32f=new Float64Array(16),u.bO(h.terrainRttPosMatrix32f,0,u.Z,u.Z,0,0,1),this._tiles[h.key]=new zi(h,this.tileSize),this._lastTilesetChange=_e.now());for(const h in this._tiles)l[h]||delete this._tiles[h]}freeRtt(e){for(const n in this._tiles){const l=this._tiles[n];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,n){return n?this._getTerrainCoordsForTileRanges(e,n):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const n={};for(const l of this._renderableTilesKeys){const h=this._tiles[l].tileID,m=e.clone(),y=u.b2();if(h.canonical.equals(e.canonical))u.bO(y,0,u.Z,u.Z,0,0,1);else if(h.canonical.isChildOf(e.canonical)){const w=h.canonical.z-e.canonical.z,S=h.canonical.x-(h.canonical.x>>w<<w),z=h.canonical.y-(h.canonical.y>>w<<w),k=u.Z>>w;u.bO(y,0,k,k,0,0,1),u.L(y,y,[-S*k,-z*k,0])}else{if(!e.canonical.isChildOf(h.canonical))continue;{const w=e.canonical.z-h.canonical.z,S=e.canonical.x-(e.canonical.x>>w<<w),z=e.canonical.y-(e.canonical.y>>w<<w),k=u.Z>>w;u.bO(y,0,u.Z,u.Z,0,0,1),u.L(y,y,[S*k,z*k,0]),u.M(y,y,[1/2**w,1/2**w,0])}}m.terrainRttPosMatrix32f=new Float32Array(y),n[l]=m}return n}_getTerrainCoordsForTileRanges(e,n){const l={};for(const h of this._renderableTilesKeys){const m=this._tiles[h].tileID;if(!this._isWithinTileRanges(m,n))continue;const y=e.clone(),w=u.b2();if(m.canonical.z===e.canonical.z){const S=e.canonical.x-m.canonical.x,z=e.canonical.y-m.canonical.y;u.bO(w,0,u.Z,u.Z,0,0,1),u.L(w,w,[S*u.Z,z*u.Z,0])}else if(m.canonical.z>e.canonical.z){const S=m.canonical.z-e.canonical.z,z=m.canonical.x-(m.canonical.x>>S<<S),k=m.canonical.y-(m.canonical.y>>S<<S),O=e.canonical.x-(m.canonical.x>>S),B=e.canonical.y-(m.canonical.y>>S),q=u.Z>>S;u.bO(w,0,q,q,0,0,1),u.L(w,w,[-z*q+O*u.Z,-k*q+B*u.Z,0])}else{const S=e.canonical.z-m.canonical.z,z=e.canonical.x-(e.canonical.x>>S<<S),k=e.canonical.y-(e.canonical.y>>S<<S),O=(e.canonical.x>>S)-m.canonical.x,B=(e.canonical.y>>S)-m.canonical.y,q=u.Z<<S;u.bO(w,0,q,q,0,0,1),u.L(w,w,[z*u.Z+O*q,k*u.Z+B*q,0])}y.terrainRttPosMatrix32f=new Float32Array(w),l[h]=y}return l}getSourceTile(e,n){const l=this.sourceCache._source;let h=e.overscaledZ-this.deltaZoom;if(h>l.maxzoom&&(h=l.maxzoom),h<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&n)for(;h>=l.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(h--).key);return m}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,n){return n[e.canonical.z]&&e.canonical.x>=n[e.canonical.z].minTileX&&e.canonical.x<=n[e.canonical.z].maxTileX&&e.canonical.y>=n[e.canonical.z].minTileY&&e.canonical.y<=n[e.canonical.z].maxTileY}}class _r{constructor(e,n,l){this._meshCache={},this.painter=e,this.sourceCache=new cs(n),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,l,h=u.Z){var m;if(!(n>=0&&n<h&&l>=0&&l<h))return 0;const y=this.getTerrainData(e),w=(m=y.tile)===null||m===void 0?void 0:m.dem;if(!w)return 0;const S=u.cf([],[n/h*u.Z,l/h*u.Z],y.u_terrain_matrix),z=[S[0]*w.dim,S[1]*w.dim],k=Math.floor(z[0]),O=Math.floor(z[1]),B=z[0]-k,q=z[1]-O;return w.get(k,O)*(1-B)*(1-q)+w.get(k+1,O)*B*(1-q)+w.get(k,O+1)*(1-B)*q+w.get(k+1,O+1)*B*q}getElevationForLngLatZoom(e,n){if(!u.cg(n,e.wrap()))return 0;const{tileID:l,mercatorX:h,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(l,h%u.Z,m%u.Z,u.Z)}getElevation(e,n,l,h=u.Z){return this.getDEMElevation(e,n,l,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const h=this.painter.context,m=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new St(h,m,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new St(h,new u.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.at([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const h=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new St(h,n.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),n.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const l=n&&n+n.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const h=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?m=e.canonical.z-h:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const y=e.canonical.x-(e.canonical.x>>m<<m),w=e.canonical.y-(e.canonical.y>>m<<m),S=u.ch(new Float64Array(16),[1/(u.Z<<m),1/(u.Z<<m),0]);u.L(S,S,[y*u.Z,w*u.Z,0]),this._demMatrixCache[e.key]={matrix:S,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){const n=this.painter,l=n.width/devicePixelRatio,h=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new St(n.context,{width:l,height:h,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new St(n.context,{width:l,height:h,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(l,h,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,l,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,y=0;m<this._coordsTextureSize;m++)for(let w=0;w<this._coordsTextureSize;w++,y+=4)n[y+0]=255&w,n[y+1]=255&m,n[y+2]=w>>8<<4|m>>8,n[y+3]=0;const l=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),h=new St(e,l,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),l=this.painter.context,h=l.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),y=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),w=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(m,w-y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,n),l.bindFramebuffer.set(null);const S=n[0]+(n[2]>>4<<8),z=n[1]+((15&n[2])<<8),k=this.coordsIndex[255-n[3]],O=k&&this.sourceCache.getTileByID(k);if(!O)return null;const B=this._coordsTextureSize,q=(1<<O.tileID.canonical.z)*B;return new u.$((O.tileID.canonical.x*B+S)/q+O.tileID.wrap,(O.tileID.canonical.y*B+z)/q,this.getElevation(O.tileID,S,z,B))}depthAtPoint(e){const n=new Uint8Array(4),l=this.painter.context,h=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,n),l.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(e){var n;const l=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,h=l&&e.canonical.y===0,m=l&&e.canonical.y===(1<<e.canonical.z)-1,y=`m_${h?"n":""}_${m?"s":""}`;if(this._meshCache[y])return this._meshCache[y];const w=this.painter.context,S=new u.ci,z=new u.aH,k=this.meshSize,O=u.Z/k,B=k*k;for(let xe=0;xe<=k;xe++)for(let Be=0;Be<=k;Be++)S.emplaceBack(Be*O,xe*O,0);for(let xe=0;xe<B;xe+=k+1)for(let Be=0;Be<k;Be++)z.emplaceBack(Be+xe,k+Be+xe+1,k+Be+xe+2),z.emplaceBack(Be+xe,k+Be+xe+2,Be+xe+1);const q=S.length,Y=q+(k+1),ne=(k+1)*k,te=h?u.b9:0,ae=h?0:1,se=m?u.ba:u.Z,fe=m?0:1;for(let xe=0;xe<=k;xe++)S.emplaceBack(xe*O,te,ae);for(let xe=0;xe<=k;xe++)S.emplaceBack(xe*O,se,fe);for(let xe=0;xe<k;xe++)z.emplaceBack(ne+xe,Y+xe,Y+xe+1),z.emplaceBack(ne+xe,Y+xe+1,ne+xe+1),z.emplaceBack(0+xe,q+xe+1,q+xe),z.emplaceBack(0+xe,0+xe+1,q+xe+1);const pe=S.length,ge=pe+2*(k+1);for(const xe of[0,1])for(let Be=0;Be<=k;Be++)for(const ke of[0,1])S.emplaceBack(xe*u.Z,Be*O,ke);for(let xe=0;xe<2*k;xe+=2)z.emplaceBack(pe+xe,pe+xe+1,pe+xe+3),z.emplaceBack(pe+xe,pe+xe+3,pe+xe+2),z.emplaceBack(ge+xe,ge+xe+3,ge+xe+1),z.emplaceBack(ge+xe,ge+xe+2,ge+xe+3);const we=new Xo(w.createVertexBuffer(S,Cu.members),w.createIndexBuffer(z),u.aG.simpleSegment(0,0,S.length,z.length));return this._meshCache[y]=we,we}getMeshFrameDelta(e){return 2*Math.PI*u.br/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,n){var l;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,n);return(l=this.getMinMaxElevation(h).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const n=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return n&&n.dem&&(l.minElevation=n.dem.min*this.exaggeration,l.maxElevation=n.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,n){const l=u.$.fromLngLat(e.wrap()),h=(1<<n)*u.Z,m=l.x*h,y=l.y*h,w=Math.floor(m/u.Z),S=Math.floor(y/u.Z);return{tileID:new u.Y(n,0,n,w,S),mercatorX:m,mercatorY:y}}}class ph{constructor(e,n,l){this._context=e,this._size=n,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new St(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(l.texture),{id:e,fbo:n,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>e.id!==n),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const yr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class mh{constructor(e,n){this.painter=e,this.terrain=n,this.pool=new ph(e.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(n)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const h=e.sourceCaches[l].getVisibleCoordinates(),m=e.sourceCaches[l].getSource(),y=m instanceof Jr?m.terrainTileRanges:null;for(const w of h){const S=this.terrain.sourceCache.getTerrainCoords(w,y);for(const z in S)this._coordsAscending[l][z]||(this._coordsAscending[l][z]=[]),this._coordsAscending[l][z].push(S[z])}}this._coordsAscendingStr={};for(const l of e._order){const h=e._layers[l],m=h.source;if(yr[h.type]&&!this._coordsAscendingStr[m]){this._coordsAscendingStr[m]={};for(const y in this._coordsAscending[m])this._coordsAscendingStr[m][y]=this._coordsAscending[m][y].map(w=>w.key).sort().join()}}for(const l of this._renderableTiles)for(const h in this._coordsAscendingStr){const m=this._coordsAscendingStr[h][l.tileID.key];m&&m!==l.rttCoords[h]&&(l.rtt=[])}}renderLayer(e,n){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),h=e.type,m=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(yr[h]&&(this._prevType&&yr[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(e.id),!y))return!0;if(yr[this._prevType]||yr[h]&&y){this._prevType=h;const w=this._stacks.length-1,S=this._stacks[w]||[];for(const z of this._renderableTiles){if(this.pool.isFull()&&(oa(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(z),z.rtt[w]){const O=this.pool.getObjectForId(z.rtt[w].id);if(O.stamp===z.rtt[w].stamp){this.pool.useObject(O);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),z.rtt[w]={id:k.id,stamp:k.stamp},m.context.bindFramebuffer.set(k.fbo.framebuffer),m.context.clear({color:u.b7.transparent,stencil:0}),m.currentStencilSource=void 0;for(let O=0;O<S.length;O++){const B=m.style._layers[S[O]],q=B.source?this._coordsAscending[B.source][z.tileID.key]:[z.tileID];m.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),m._renderTileClippingMasks(B,q,!0),m.renderLayer(m,m.style.sourceCaches[B.source],B,q,l),B.source&&(z.rttCoords[B.source]=this._coordsAscendingStr[B.source][z.tileID.key])}}return oa(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),yr[h]}return!1}}const ya={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Vt=re,Kt={hash:!1,interactive:!0,bearingSnap:7,attributionControl:$s,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},qn={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class us{constructor(e,n,l=!1){this.mousedown=m=>{this.startMove(m,ie.mousePos(this.element,m)),ie.addEventListener(window,"mousemove",this.mousemove),ie.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=m=>{this.move(m,ie.mousePos(this.element,m))},this.mouseup=m=>{this._rotatePitchHanlder.dragEnd(m),this.offTemp()},this.touchstart=m=>{m.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ie.touchPos(this.element,m.targetTouches)[0],this.startMove(m,this._startPos),ie.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.addEventListener(window,"touchend",this.touchend))},this.touchmove=m=>{m.targetTouches.length!==1?this.reset():(this._lastPos=ie.touchPos(this.element,m.targetTouches)[0],this.move(m,this._lastPos))},this.touchend=m=>{m.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const h=new Tu;this._rotatePitchHanlder=new wn({clickTolerance:3,move:(m,y)=>{const w=n.getBoundingClientRect(),S=new u.P((w.bottom-w.top)/2,(w.right-w.left)/2);return{bearingDelta:u.ca(new u.P(m.x,y.y),y,S),pitchDelta:l?-.5*(y.y-m.y):void 0}},moveStateManager:h,enable:!0,assignEvents:()=>{}}),this.map=e,ie.addEventListener(n,"mousedown",this.mousedown),ie.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),ie.addEventListener(n,"touchcancel",this.reset)}startMove(e,n){this._rotatePitchHanlder.dragStart(e,n),ie.disableDrag()}move(e,n){const l=this.map,{bearingDelta:h,pitchDelta:m}=this._rotatePitchHanlder.dragMove(e,n)||{};h&&l.setBearing(l.getBearing()+h),m&&l.setPitch(l.getPitch()+m)}off(){const e=this.element;ie.removeEventListener(e,"mousedown",this.mousedown),ie.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ie.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.removeEventListener(window,"touchend",this.touchend),ie.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ie.enableDrag(),ie.removeEventListener(window,"mousemove",this.mousemove),ie.removeEventListener(window,"mouseup",this.mouseup),ie.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.removeEventListener(window,"touchend",this.touchend)}}let kr;function ao(f,e,n){const l=new u.Q(f.lng,f.lat);if(f=new u.Q(f.lng,f.lat),e){const h=new u.Q(f.lng-360,f.lat),m=new u.Q(f.lng+360,f.lat),y=n.locationToScreenPoint(f).distSqr(e);n.locationToScreenPoint(h).distSqr(e)<y?f=h:n.locationToScreenPoint(m).distSqr(e)<y&&(f=m)}for(;Math.abs(f.lng-n.center.lng)>180;){const h=n.locationToScreenPoint(f);if(h.x>=0&&h.y>=0&&h.x<=n.width&&h.y<=n.height)break;f.lng>n.center.lng?f.lng-=360:f.lng+=360}return f.lng!==l.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(f))?f:l}const hs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ds(f,e,n){const l=f.classList;for(const h in hs)l.remove(`maplibregl-${n}-anchor-${h}`);l.add(`maplibregl-${n}-anchor-${e}`)}class va extends u.E{constructor(e){if(super(),this._onKeyPress=n=>{const l=n.code,h=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=n=>{const l=n.originalEvent.target,h=this._element;this._popup&&(l===h||h.contains(l))&&this.togglePopup()},this._update=n=>{var l;if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((n==null?void 0:n.type)==="terrain"||(n==null?void 0:n.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?ao(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),ie.setTransform(this._element,`${hs[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${m}`),_e.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.l("dragstart"))),this.fire(new u.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.l("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=u.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ie.create("div");const n=ie.createNS("http://www.w3.org/2000/svg","svg"),l=41,h=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${l}px`),n.setAttributeNS(null,"width",`${h}px`),n.setAttributeNS(null,"viewBox",`0 0 ${h} ${l}`);const m=ie.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const y=ie.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");const w=ie.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const S=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ae of S){const se=ie.createNS("http://www.w3.org/2000/svg","ellipse");se.setAttributeNS(null,"opacity","0.04"),se.setAttributeNS(null,"cx","10.5"),se.setAttributeNS(null,"cy","5.80029008"),se.setAttributeNS(null,"rx",ae.rx),se.setAttributeNS(null,"ry",ae.ry),w.appendChild(se)}const z=ie.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const k=ie.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(k);const O=ie.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const B=ie.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(B);const q=ie.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");const Y=ie.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ne=ie.createNS("http://www.w3.org/2000/svg","circle");ne.setAttributeNS(null,"fill","#000000"),ne.setAttributeNS(null,"opacity","0.25"),ne.setAttributeNS(null,"cx","5.5"),ne.setAttributeNS(null,"cy","5.5"),ne.setAttributeNS(null,"r","5.4999962");const te=ie.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#FFFFFF"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962"),Y.appendChild(ne),Y.appendChild(te),y.appendChild(w),y.appendChild(z),y.appendChild(O),y.appendChild(q),y.appendChild(Y),n.appendChild(y),n.setAttributeNS(null,"height",l*this._scale+"px"),n.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(n),this._offset=u.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),ds(this._element,this._anchor,"marker"),e&&e.className)for(const n of e.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ie.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=u.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var n,l;if(!(!((n=this._map)===null||n===void 0)&&n.terrain)){const O=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==O&&(this._element.style.opacity=O))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const h=this._map,m=h.terrain.depthAtPoint(this._pos),y=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,y)-m<.006)return void(this._element.style.opacity=this._opacity);const w=-this._offset.y/h.transform.pixelsPerMeter,S=Math.sin(h.getPitch()*Math.PI/180)*w,z=h.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),k=h.transform.lngLatToCameraDepth(this._lngLat,y+S)-z>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&k&&this._popup.remove(),this._element.style.opacity=k?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=u.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,n){return(this._opacity===void 0||e===void 0&&n===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}const gh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let an=0,jo=!1;const yc={maxWidth:100,unit:"metric"};function vc(f,e,n){const l=n&&n.maxWidth||100,h=f._container.clientHeight/2,m=f._container.clientWidth/2,y=f.unproject([m-l/2,h]),w=f.unproject([m+l/2,h]),S=Math.round(f.project(w).x-f.project(y).x),z=Math.min(l,S,f._container.clientWidth),k=y.distanceTo(w);if(n&&n.unit==="imperial"){const O=3.2808*k;O>5280?fs(e,z,O/5280,f._getUIString("ScaleControl.Miles")):fs(e,z,O,f._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?fs(e,z,k/1852,f._getUIString("ScaleControl.NauticalMiles")):k>=1e3?fs(e,z,k/1e3,f._getUIString("ScaleControl.Kilometers")):fs(e,z,k,f._getUIString("ScaleControl.Meters"))}function fs(f,e,n,l){const h=function(m){const y=Math.pow(10,`${Math.floor(m)}`.length-1);let w=m/y;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(S){const z=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*z)/z}(w),y*w}(n);f.style.width=e*(h/n)+"px",f.innerHTML=`${h}&nbsp;${l}`}const _h={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},xc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Xs(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,f),"top-left":new u.P(e,e),"top-right":new u.P(-e,e),bottom:new u.P(0,-f),"bottom-left":new u.P(e,-e),"bottom-right":new u.P(-e,-e),left:new u.P(f,0),right:new u.P(-f,0)}}if(f instanceof u.P||Array.isArray(f)){const e=u.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:u.P.convert(f.center||[0,0]),top:u.P.convert(f.top||[0,0]),"top-left":u.P.convert(f["top-left"]||[0,0]),"top-right":u.P.convert(f["top-right"]||[0,0]),bottom:u.P.convert(f.bottom||[0,0]),"bottom-left":u.P.convert(f["bottom-left"]||[0,0]),"bottom-right":u.P.convert(f["bottom-right"]||[0,0]),left:u.P.convert(f.left||[0,0]),right:u.P.convert(f.right||[0,0])}}return Xs(new u.P(0,0))}const bc=re;A.AJAXError=u.cm,A.Event=u.l,A.Evented=u.E,A.LngLat=u.Q,A.MercatorCoordinate=u.$,A.Point=u.P,A.addProtocol=u.cn,A.config=u.a,A.removeProtocol=u.co,A.AttributionControl=Dt,A.BoxZoomHandler=io,A.CanvasSource=pt,A.CooperativeGesturesHandler=zl,A.DoubleClickZoomHandler=Al,A.DragPanHandler=ro,A.DragRotateHandler=Qi,A.EdgeInsets=pn,A.FullscreenControl=class extends u.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=n==null?void 0:n.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ie.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=ie.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ie.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},A.GeoJSONSource=za,A.GeolocateControl=class extends u.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new u.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const n=new u.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,h=this._map.getBearing(),m=u.e({bearing:h},this.options.fitBoundsOptions),y=Wi.fromLngLat(n,l);this._map.fitBounds(y,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const n=new u.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&jo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=ie.create("button","maplibregl-ctrl-geolocate",this._container),ie.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ie.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new va({element:this._dotElement}),this._circleElement=ie.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new va({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.l("trackuserlocationend")),this.fire(new u.l("userlocationlostfocus")))})}},this.options=u.e({},gh,f)}onAdd(f){return this._map=f,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return u._(this,arguments,void 0,function*(e=!1){if(kr!==void 0&&!e)return kr;if(window.navigator.permissions===void 0)return kr=!!window.navigator.geolocation,kr;try{kr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{kr=!!window.navigator.geolocation}return kr})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ie.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,an=0,jo=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),n=f.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),n=f.getNorthEast(),l=e.distanceTo(n),h=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":an--,jo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.l("trackuserlocationstart")),this.fire(new u.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),an++,an>1?(f={maximumAge:6e5,timeout:0},jo=!0):(f=this.options.positionOptions,jo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},A.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ie.create("button","maplibregl-ctrl-globe",this._container),ie.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ie.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},A.Hash=xu,A.ImageSource=Jr,A.KeyboardHandler=Eu,A.LngLatBounds=Wi,A.LogoControl=Nt,A.Map=class extends _a{constructor(f){var e,n;u.cj.mark(u.ck.create);const l=Object.assign(Object.assign(Object.assign({},Kt),f),{canvasContextAttributes:Object.assign(Object.assign({},Kt.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const h=new rn,m=new On;if(l.minZoom!==void 0&&h.setMinZoom(l.minZoom),l.maxZoom!==void 0&&h.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&h.setMinPitch(l.minPitch),l.maxPitch!==void 0&&h.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&h.setRenderWorldCopies(l.renderWorldCopies),super(h,m,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new _c,this._controls=[],this._mapId=u.a4(),this._contextLost=w=>{w.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new u.l("webglcontextlost",{originalEvent:w}))},this._contextRestored=w=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.l("webglcontextrestored",{originalEvent:w}))},this._onMapScroll=w=>{if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},ya),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=dt.addThrottleControl(()=>this.isMoving()),this._requestManager=new mt(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let w=!1;const S=vu(z=>{this._trackResize&&!this._removed&&(this.resize(z),this.redraw())},50);this._resizeObserver=new ResizeObserver(z=>{w?S(z):w=!0}),this._resizeObserver.observe(this._container)}this.handlers=new gc(this,l),this._hash=l.hash&&new xu(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,u.e({},l.fitBoundsOptions,{duration:0}))));const y=typeof l.style=="string"||((n=(e=l.style)===null||e===void 0?void 0:e.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,y),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Dt(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new Nt,l.logoPosition),this.on("style.load",()=>{if(y||this._resizeTransform(),this.transform.unmodified){const w=u.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(w)}}),this.on("data",w=>{this._update(w.dataType==="style"),this.fire(new u.l(`${w.dataType}data`,w))}),this.on("dataloading",w=>{this.fire(new u.l(`${w.dataType}dataloading`,w))}),this.on("dataabort",w=>{this.fire(new u.l("sourcedataabort",w))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new u.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(n,l.firstChild):l.appendChild(n),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new u.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,n,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,n,l)}resize(f,e=!0){const[n,l]=this._containerDimensions(),h=this._getClampedPixelRatio(n,l);if(this._resizeCanvas(n,l,h),this.painter.resize(n,l,h),this.painter.overLimit()){const y=this.painter.context.gl;this._maxCanvasSize=[y.drawingBufferWidth,y.drawingBufferHeight];const w=this._getClampedPixelRatio(n,l);this._resizeCanvas(n,l,w),this.painter.resize(n,l,w)}this._resizeTransform(e);const m=!this._moving;return m&&(this.stop(),this.fire(new u.l("movestart",f)).fire(new u.l("move",f))),this.fire(new u.l("resize",f)),m&&this.fire(new u.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[n,l]=this._containerDimensions();this.transform.resize(n,l,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(n,l,f)}_getClampedPixelRatio(f,e){const{0:n,1:l}=this._maxCanvasSize,h=this.getPixelRatio(),m=f*h,y=e*h;return Math.min(m>n?n/m:1,y>l?l/y:1)*h}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(Wi.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(u.Q.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(u.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,n){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:n,delegates:{mousemove:m=>{const y=e.filter(S=>this.getLayer(S)),w=y.length!==0?this.queryRenderedFeatures(m.point,{layers:y}):[];w.length?l||(l=!0,n.call(this,new dr(f,this,m.originalEvent,{features:w}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:n,delegates:{mousemove:y=>{const w=e.filter(S=>this.getLayer(S));(w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[]).length?l=!0:l&&(l=!1,n.call(this,new dr(f,this,y.originalEvent)))},mouseout:y=>{l&&(l=!1,n.call(this,new dr(f,this,y.originalEvent)))}}}}{const l=h=>{const m=e.filter(w=>this.getLayer(w)),y=m.length!==0?this.queryRenderedFeatures(h.point,{layers:m}):[];y.length&&(h.features=y,n.call(this,h),delete h.features)};return{layers:e,listener:n,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,n){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let h=0;h<l.length;h++){const m=l[h];if(m.listener===n&&m.layers.length===e.length&&m.layers.every(y=>e.includes(y))){for(const y in m.delegates)this.off(y,m.delegates[y]);return void l.splice(h,1)}}}on(f,e,n){if(n===void 0)return super.on(f,e);const l=typeof e=="string"?[e]:e,h=this._createDelegatedListener(f,l,n);this._saveDelegatedListener(f,h);for(const m in h.delegates)this.on(m,h.delegates[m]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,n)}}}once(f,e,n){if(n===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,h=this._createDelegatedListener(f,l,n);for(const m in h.delegates){const y=h.delegates[m];h.delegates[m]=(...w)=>{this._removeDelegatedListener(f,l,n),y(...w)}}this._saveDelegatedListener(f,h);for(const m in h.delegates)this.once(m,h.delegates[m]);return this}off(f,e,n){return n===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,n),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let n;const l=f instanceof u.P||Array.isArray(f),h=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},h instanceof u.P||typeof h[0]=="number")n=[u.P.convert(h)];else{const m=u.P.convert(h[0]),y=u.P.convert(h[1]);n=[m,new u.P(y.x,m.y),y,new u.P(m.x,y.y),m]}return this.style.queryRenderedFeatures(n,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var n,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));const h=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new gl(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,h):this.style.loadJSON(f,e,h),this):((l=(n=this.style)===null||n===void 0?void 0:n.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new gl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const n=this._requestManager.transformRequest(f,"Style");u.j(n,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new u.k(l))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(n){u.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new u.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const n in this.style._layers){const l=this.style._layers[n];l.type==="hillshade"&&l.source===f.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new _r(this.painter,e,f),this.painter.renderToTexture=new mh(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{var l;n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=n.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new u.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const n=f[e]._tiles;for(const l in n){const h=n[l];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,e,n={}){const{pixelRatio:l=1,sdf:h=!1,stretchX:m,stretchY:y,content:w,textFitWidth:S,textFitHeight:z}=n;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||u.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:O,data:B}=e,q=e;return this.style.addImage(f,{data:new u.R({width:k,height:O},new Uint8Array(B)),pixelRatio:l,stretchX:m,stretchY:y,content:w,textFitWidth:S,textFitHeight:z,sdf:h,version:0,userImage:q}),q.onAdd&&q.onAdd(this,f),this}}{const{width:k,height:O,data:B}=_e.getImageData(e);this.style.addImage(f,{data:new u.R({width:k,height:O},B),pixelRatio:l,stretchX:m,stretchY:y,content:w,textFitWidth:S,textFitHeight:z,sdf:h,version:0})}}updateImage(f,e){const n=this.style.getImage(f);if(!n)return this.fire(new u.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||u.b(e)?_e.getImageData(e):e,{width:h,height:m,data:y}=l;if(h===void 0||m===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==n.data.width||m!==n.data.height)return this.fire(new u.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(e instanceof HTMLImageElement||u.b(e));return n.data.replace(y,w),this.style.updateImage(f,n),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new u.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return dt.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,n){return this.style.setLayerZoomRange(f,e,n),this._update(!0)}setFilter(f,e,n={}){return this.style.setFilter(f,e,n),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,n,l={}){return this.style.setPaintProperty(f,e,n,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,n,l={}){return this.style.setLayoutProperty(f,e,n,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,n,l=>{l||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,n=>{n||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=ie.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ie.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),l=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],l);const h=this._controlContainer=ie.create("div","maplibregl-control-container",f),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{m[y]=ie.create("div",`maplibregl-ctrl-${y} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,n){this._canvas.width=Math.floor(n*f),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!n){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new rs(n,this.transform),he.testSupport(n)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new u.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,n,l,h,m;const y=this._idleTriggered?this._fadeDuration:0,w=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let S=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,B=_e.now();this.style.zoomHistory.update(O,B);const q=new u.C(O,{now:B,fadeDuration:y,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Y=q.crossFadingFactor();Y===1&&Y===this._crossFadingFactor||(S=!0,this._crossFadingFactor=Y),this.style.update(q)}const z=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==w;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((h=this.style.projection)===null||h===void 0?void 0:h.transitionState,(m=this.style.projection)===null||m===void 0?void 0:m.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||z)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,y,this._crossSourceCollisions,z),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,showPadding:this.showPadding}),this.fire(new u.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.cj.mark(u.ck.load),this.fire(new u.l("load"))),this.style&&(this.style.hasTransitions()||S)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,u.cj.mark(u.ck.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),dt.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ie.remove(this._canvasContainer),ie.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),u.cj.clearMetrics(),this._removed=!0,this.fire(new u.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,_e.frame(this._frameRequest,f=>{u.cj.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!u.cl(e)&&!function(n){return n.message===cc}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return Vt}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},A.MapMouseEvent=dr,A.MapTouchEvent=os,A.MapWheelEvent=Cr,A.Marker=va,A.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),n=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,n)=>{const l=this._map._getUIString(`NavigationControl.${n}`);e.title=l,e.setAttribute("aria-label",l)},this.options=u.e({},qn,f),this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),ie.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),ie.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=ie.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new us(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ie.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const n=ie.create("button",f,this._container);return n.type="button",n.addEventListener("click",e),n}},A.Popup=class extends u.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&ie.remove(this._content),this._container&&(ie.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var n;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ie.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ie.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?ao(this._lngLat,this._flatPos,this._map.transform):(n=this._lngLat)===null||n===void 0?void 0:n.wrap(),this._trackPointer&&!e)return;const l=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let h=this.options.anchor;const m=Xs(this.options.offset);if(!h){const w=this._container.offsetWidth,S=this._container.offsetHeight;let z;z=l.y+m.bottom.y<S?["top"]:l.y>this._map.transform.height-S?["bottom"]:[],l.x<w/2?z.push("left"):l.x>this._map.transform.width-w/2&&z.push("right"),h=z.length===0?"bottom":z.join("-")}let y=l.add(m[h]);this.options.subpixelPositioning||(y=y.round()),ie.setTransform(this._container,`${hs[h]} translate(${y.x}px,${y.y}px)`),ds(this._container,h,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(_h),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=u.Q.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),n=document.createElement("body");let l;for(n.innerHTML=f;l=n.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ie.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=ie.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(xc);f&&f.focus()}},A.RasterDEMTileSource=$a,A.RasterTileSource=Mn,A.ScaleControl=class{constructor(f){this._onMove=()=>{vc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,vc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},yc),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ie.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},A.ScrollZoomHandler=fh,A.Style=gl,A.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ie.create("button","maplibregl-ctrl-terrain",this._container),ie.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ie.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},A.TwoFingersTouchPitchHandler=dh,A.TwoFingersTouchRotateHandler=Su,A.TwoFingersTouchZoomHandler=si,A.TwoFingersTouchZoomRotateHandler=ga,A.VectorTileSource=bo,A.VideoSource=lr,A.addSourceType=(f,e)=>u._(void 0,void 0,void 0,function*(){if(hi(f))throw new Error(`A source type called "${f}" already exists.`);((n,l)=>{Mt[n]=l})(f,e)}),A.clearPrewarmedResources=function(){const f=Ot;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(ct),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},A.createTileMesh=Ka,A.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},A.getRTLTextPluginStatus=function(){return hn().getRTLTextPluginStatus()},A.getVersion=function(){return bc},A.getWorkerCount=function(){return Et.workerCount},A.getWorkerUrl=function(){return u.a.WORKER_URL},A.importScriptInWorkers=function(f){return Ai().broadcast("IS",f)},A.prewarm=function(){qt().acquire(ct)},A.setMaxParallelImageRequests=function(f){u.a.MAX_PARALLEL_IMAGE_REQUESTS=f},A.setRTLTextPlugin=function(f,e){return hn().setRTLTextPlugin(f,e)},A.setWorkerCount=function(f){Et.workerCount=f},A.setWorkerUrl=function(f){u.a.WORKER_URL=f}});var H=I;return H})}(am)),am.exports}var Xv=$v();const Yv=Fg(Xv),Kv=()=>{const x=$c(),E=Pe.useRef(null),[I,R]=Pe.useState(null),[L,H]=Pe.useState(!1),[A,u]=Pe.useState("all"),re=[{id:"harwood-court",name:"Harwood Court",type:"hall",capacity:120,classYear:"Sophmore/Junior"},{id:"clark-i",name:"Clark I",type:"hall",capacity:85,classYear:"Junior"},{id:"sontag-hall",name:"Sontag Hall",type:"hall",capacity:65,classYear:"Senior"},{id:"mudd-blaisdell-hall",name:"Mudd-Blaisdell Hall",type:"hall",capacity:180,classYear:"Freshman/Sophmore"}];Pe.useEffect(()=>{const _e=new Yv.Map({container:E.current,style:"https://api.maptiler.com/maps/01960843-60c0-72bd-844a-3bde22239aa5/style.json?key=UHRJl9L3oK7bh3QT6De6",center:[-117.7103,34.0975],zoom:16});return _e.on("load",()=>{H(!0);const ie="Dorm map";_e.getLayer(ie)?(_e.on("click",ie,he=>{const je=he.features[0].properties.name,Me=je.toLowerCase().replace(/\s+/g,"-"),Oe=re.find(Fe=>Fe.id===Me)||{id:Me,name:je,type:"Unknown",capacity:"Unknown",classYear:"Unknown"};R(Oe)}),_e.on("mouseenter",ie,()=>{_e.getCanvas().style.cursor="pointer"}),_e.on("mouseleave",ie,()=>{_e.getCanvas().style.cursor=""})):(console.warn(`Layer "${ie}" not found. Check your MapTiler Studio layer ID.`),console.log("Available layers:"),console.log(_e.getStyle().layers.map(he=>he.id)))}),()=>_e.remove()},[]);const Q=_e=>{x(`/dorms/${_e}`)},ce=()=>{localStorage.removeItem("userId"),x("/")},ze=A==="all"?re:re.filter(_e=>_e.type===A);return F.jsxs("div",{style:Ti.page,children:[F.jsxs("header",{style:Ti.header,children:[F.jsxs("div",{style:Ti.logoContainer,children:[F.jsx("span",{style:Ti.logoIcon,children:"🏠"}),F.jsx("span",{style:Ti.logoText,children:"Housing47"})]}),F.jsxs("div",{style:Ti.navLinks,children:[F.jsx("button",{style:Ti.navLink,onClick:()=>x("/dashboard"),children:"Dashboard"}),F.jsx("button",{style:{...Ti.navLink,...Ti.activeNavLink},children:"Browse Housing"}),F.jsx("button",{onClick:()=>x("/users"),style:Ti.navLink,children:"Find Roommates"}),F.jsx("button",{onClick:ce,style:Ti.signOutButton,children:"Sign Out"})]})]}),F.jsxs("main",{style:Ti.mainContent,children:[F.jsxs("div",{style:Ti.leftSidebar,children:[F.jsxs("div",{style:Ti.sidebarHeader,children:[F.jsx("h1",{style:Ti.mapTitle,children:"Campus Housing Map"}),F.jsx("p",{style:Ti.mapSubtitle,children:"Click on a dorm to view details and select a room"})]}),F.jsxs("div",{style:Ti.filterSection,children:[F.jsx("h2",{style:Ti.filterTitle,children:"Filter Dorms"}),F.jsxs("div",{style:Ti.filterGroup,children:[F.jsx("label",{style:Ti.filterLabel,children:"Housing Type"}),F.jsxs("select",{style:Ti.filterSelect,value:A,onChange:_e=>u(_e.target.value),children:[F.jsx("option",{value:"all",children:"All Housing Types"}),F.jsx("option",{value:"hall",children:"Residence Halls"}),F.jsx("option",{value:"suite",children:"Suites"}),F.jsx("option",{value:"apartment",children:"Apartments"})]})]})]}),F.jsxs("div",{style:Ti.dormListSection,children:[F.jsxs("h2",{style:Ti.dormListTitle,children:["Available Housing (",ze.length,")"]}),L?F.jsx("div",{style:Ti.dormList,children:ze.map(_e=>F.jsxs("div",{style:{...Ti.dormListItem,...(I==null?void 0:I.id)===_e.id?Ti.selectedDorm:{}},onClick:()=>R(_e),children:[F.jsx("div",{style:Ti.dormName,children:_e.name}),F.jsxs("div",{style:Ti.dormDetails,children:[F.jsx("span",{children:_e.type==="hall"?"Residence Hall":_e.type==="suite"?"Suite":_e.type==="apartment"?"Apartment":_e.type}),F.jsx("span",{children:" • "}),F.jsxs("span",{children:["Capacity: ",_e.capacity]})]}),F.jsx("div",{style:Ti.dormClassYear,children:F.jsx("span",{style:Ti.classYearBadge,children:_e.classYear})})]},_e.id))}):F.jsxs("div",{style:Ti.loadingContainer,children:[F.jsx("div",{style:Ti.loadingSpinner}),F.jsx("p",{children:"Loading campus map..."})]})]}),I&&F.jsxs("div",{style:Ti.selectedDormSection,children:[F.jsx("h2",{style:Ti.selectedDormTitle,children:I.name}),F.jsxs("div",{style:Ti.selectedDormDetails,children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Type:"})," ",I.type==="hall"?"Residence Hall":I.type==="suite"?"Suite":I.type==="apartment"?"Apartment":I.type]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Capacity:"})," ",I.capacity]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Class Year:"})," ",I.classYear]})]}),F.jsx("button",{style:Ti.viewDormButton,onClick:()=>Q(I.id),children:"View Floor Plans & Select Room"})]})]}),F.jsx("div",{style:Ti.mapContainer,children:F.jsx("div",{ref:E,style:Ti.mapElement})})]}),F.jsx("footer",{style:Ti.footer,children:F.jsx("p",{children:"© 2025 Housing47. All rights reserved."})})]})},Ti={page:{minHeight:"100vh",display:"flex",flexDirection:"column",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",backgroundColor:"#F9FAFB"},header:{backgroundColor:"white",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",padding:"1rem 2rem",display:"flex",justifyContent:"space-between",alignItems:"center",zIndex:10},logoContainer:{display:"flex",alignItems:"center",gap:"0.5rem"},logoIcon:{fontSize:"1.5rem"},logoText:{fontWeight:"bold",fontSize:"1.25rem",color:"#4F46E5"},navLinks:{display:"flex",alignItems:"center",gap:"1rem"},navLink:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#4B5563",fontWeight:"500",background:"none",border:"none",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},activeNavLink:{backgroundColor:"#EEF2FF",color:"#4F46E5"},signOutButton:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#EF4444",fontWeight:"500",background:"none",border:"1px solid #EF4444",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},mainContent:{flex:1,display:"flex",flexDirection:"row",height:"calc(100vh - 137px)",overflow:"hidden"},leftSidebar:{width:"350px",backgroundColor:"white",borderRight:"1px solid #E5E7EB",padding:"1.5rem",overflowY:"auto",display:"flex",flexDirection:"column",gap:"1.5rem"},sidebarHeader:{marginBottom:"1rem"},mapTitle:{fontSize:"1.5rem",fontWeight:"bold",color:"#1F2937",margin:"0",marginBottom:"0.25rem"},mapSubtitle:{fontSize:"0.875rem",color:"#6B7280",margin:"0"},filterSection:{display:"flex",flexDirection:"column",gap:"1rem",padding:"1.5rem",backgroundColor:"#F9FAFB",borderRadius:"0.5rem"},filterTitle:{fontSize:"1rem",fontWeight:"600",color:"#374151",margin:"0 0 0.5rem 0"},filterGroup:{display:"flex",flexDirection:"column",gap:"0.5rem"},filterLabel:{fontSize:"0.875rem",fontWeight:"500",color:"#4B5563"},filterSelect:{padding:"0.5rem",borderRadius:"0.375rem",border:"1px solid #D1D5DB",fontSize:"0.875rem",color:"#1F2937",backgroundColor:"white"},dormListSection:{flex:"1",display:"flex",flexDirection:"column"},dormListTitle:{fontSize:"1rem",fontWeight:"600",color:"#374151",margin:"0 0 1rem 0"},dormList:{display:"flex",flexDirection:"column",gap:"0.5rem",overflowY:"auto"},dormListItem:{padding:"0.75rem",borderRadius:"0.375rem",backgroundColor:"white",border:"1px solid #E5E7EB",cursor:"pointer",transition:"border-color 0.2s, transform 0.1s"},selectedDorm:{borderColor:"#4F46E5",backgroundColor:"#F5F7FF"},dormName:{fontWeight:"600",color:"#1F2937",fontSize:"0.875rem"},dormDetails:{color:"#6B7280",fontSize:"0.75rem",marginTop:"0.25rem"},dormClassYear:{display:"flex",justifyContent:"flex-end",marginTop:"0.5rem"},classYearBadge:{backgroundColor:"#DBEAFE",color:"#1E40AF",fontSize:"0.75rem",fontWeight:"500",padding:"0.25rem 0.5rem",borderRadius:"9999px"},selectedDormSection:{marginTop:"1rem",padding:"1rem",backgroundColor:"#F9FAFB",borderRadius:"0.5rem",border:"1px solid #E5E7EB"},selectedDormTitle:{fontSize:"1.125rem",fontWeight:"600",color:"#1F2937",margin:"0 0 0.75rem 0"},selectedDormDetails:{fontSize:"0.875rem",color:"#4B5563",marginBottom:"1rem"},viewDormButton:{width:"100%",padding:"0.75rem",backgroundColor:"#4F46E5",color:"white",fontWeight:"500",border:"none",borderRadius:"0.375rem",cursor:"pointer",transition:"background-color 0.2s"},mapContainer:{flex:"1",position:"relative"},mapElement:{width:"100%",height:"100%"},footer:{borderTop:"1px solid #E5E7EB",padding:"1rem",textAlign:"center",color:"#6B7280",backgroundColor:"white",fontSize:"0.875rem"},loadingContainer:{display:"flex",flexDirection:"column",alignItems:"center",padding:"2rem 0",color:"#6B7280"},loadingSpinner:{width:"2rem",height:"2rem",border:"3px solid #E5E7EB",borderTopColor:"#4F46E5",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"0.5rem"}},Wv=()=>{const x=$c(),{dormId:E}=by(),[I,R]=Pe.useState(""),[L,H]=Pe.useState(null),[A,u]=Pe.useState(!1),[re,Q]=Pe.useState({x:0,y:0}),[ce,ze]=Pe.useState(!1),_e=Pe.useRef(null),[ie,he]=Pe.useState([]),[je,Me]=Pe.useState([]),[Oe,Fe]=Pe.useState(!0),[qe,dt]=Pe.useState(""),[mt,zt]=Pe.useState(""),[yt,St]=Pe.useState(""),[Qt,Bi]=Pe.useState("available"),[Si,Mi]=Pe.useState(""),[Ui,Ki]=Pe.useState("all"),[Vi,Ve]=Pe.useState(null),[xt,jt]=Pe.useState(null),[ui,Te]=Pe.useState(0),ct={"harwood-court":"/images/harwood-court-1.jpg","clark-i":"/images/clark-i.jpg","sontag-hall":"/images/sontag-hall.jpg","mudd-blaisdell-hall":"/images/mudd-blaisdell-hall.jpg"},Et=pt=>!pt||!pt.seconds?"N/A":new Date(pt.seconds*1e3).toLocaleString(),wt={"harwood-court":[{coords:"228,424,163,372",roomId:"HAR_109",info:"Room 109"},{coords:"246,519,308,574",roomId:"HAR_104",info:"Room 104"},{coords:"209,520,233,575",roomId:"HAR_101",info:"Room 101"},{coords:"246,477,298,513",roomId:"HAR_102",info:"Room 102"},{coords:"248,449,299,473",roomId:"HAR_106",info:"Room 106"},{coords:"296,419,249,387",roomId:"HAR_108",info:"Room 108"},{coords:"177,340,227,370",roomId:"HAR_111",info:"Room 111"},{coords:"247,359,295,386",roomId:"HAR_110",info:"Room 110"},{coords:"180,308,227,340",roomId:"HAR_113",info:"Room 113"},{coords:"248,289,295,320",roomId:"HAR_114",info:"Room 114"},{coords:"175,244,224,273",roomId:"HAR_117",info:"Room 117"},{coords:"247,261,281,288",roomId:"HAR_116",info:"Room 116"},{coords:"175,215,225,243",roomId:"HAR_119",info:"Room 119"},{coords:"298,261,265,215",roomId:"HAR_120",info:"Room 120"},{coords:"222,123,253,163",roomId:"HAR_123",info:"Room 123"},{coords:"285,161,256,125",roomId:"HAR_125",info:"Room 125"},{coords:"312,143,346,192",roomId:"HAR_127",info:"Room 127"},{coords:"594,123,625,171",roomId:"HAR_145",info:"Room 145"},{coords:"656,124,627,170",roomId:"HAR_147",info:"Room 147"},{coords:"595,225,625,267",roomId:"HAR_142",info:"Room 142"},{coords:"656,265,627,227",roomId:"HAR_144",info:"Room 144"},{coords:"660,263,707,290",roomId:"HAR_162",info:"Room 162"},{coords:"656,293,706,320",roomId:"HAR_164",info:"Room 164"},{coords:"728,278,782,303",roomId:"HAR_163",info:"Room 163"},{coords:"727,306,777,336",roomId:"HAR_165",info:"Room 165"},{coords:"729,340,779,368",roomId:"HAR_167",info:"Room 167"},{coords:"657,362,706,391",roomId:"HAR_168",info:"Room 168"},{coords:"657,393,708,419",roomId:"HAR_170",info:"Room 170"},{coords:"726,407,778,440",roomId:"HAR_171",info:"Room 171"},{coords:"658,452,705,480",roomId:"HAR_172",info:"Room 172"},{coords:"728,441,776,464",roomId:"HAR_173",info:"Room 173"},{coords:"728,467,777,494",roomId:"HAR_175",info:"Room 175"},{coords:"660,483,705,507",roomId:"HAR_174",info:"Room 174"},{coords:"728,497,776,524",roomId:"HAR_176",info:"Room 176"},{coords:"708,544,661,513",roomId:"HAR_177",info:"Room 177"},{coords:"727,528,777,566",roomId:"HAR_179",info:"Room 179"},{coords:"659,549,691,595",roomId:"HAR_178",info:"Room 178"},{coords:"726,567,777,593",roomId:"HAR_181",info:"Room 181"},{coords:"582,575,617,608",roomId:"HAR_180",info:"Room 180"},{coords:"583,612,628,640",roomId:"HAR_182",info:"Room 182"},{coords:"662,612,706,640",roomId:"HAR_184",info:"Room 184"},{coords:"727,597,778,626",roomId:"HAR_183",info:"Room 183"},{coords:"776,665,729,628",roomId:"HAR_187",info:"Room 187"},{coords:"705,680,745,708",roomId:"HAR_185",info:"Room 185"},{coords:"750,667,775,707",roomId:"HAR_189",info:"Room 189"}]},Ot=ct[E],$t=wt[E]||[],qt=pt=>!pt.is_taken&&pt.class_year<=xt&&pt.capacity===ui,kn=pt=>{if(pt.is_taken)return{eligible:!1,reason:"taken"};const Mt=pt.class_year<=xt,hi=pt.capacity===ui;return Mt&&hi?{eligible:!0,reason:"eligible"}:!Mt&&hi?{eligible:!1,reason:"class_year"}:Mt&&!hi?{eligible:!1,reason:"capacity"}:{eligible:!1,reason:"both"}},Ai=async pt=>{u(!0);try{const Mt=await fi.get(`https://backend-housing47.onrender.comrooms/get_room_by_id/${pt}`);H(Mt.data),u(!1)}catch(Mt){console.error("Error fetching room details:",Mt),u(!1)}};Pe.useEffect(()=>{(async()=>{Fe(!0),dt("");try{const Mt=localStorage.getItem("userId");if(console.log("Stored userId:",Mt),!Mt){x("/signin");return}Ve(Mt);const Ri=(await fi.get(`https://backend-housing47.onrender.comusers/get_user/${Mt}`)).data;if(jt(typeof Ri.class_year=="string"?parseInt(Ri.class_year,10):Ri.class_year),console.log("User class year:",Ri.class_year),Ri.group_id){const An=await fi.get(`https://backend-housing47.onrender.comusers/roommates/${Mt}`);console.log("Roommates response:",An.data),Te(An.data.roommates.length),console.log("Group size:",An.data.roommates.length)}else Te(1),console.log("No roommates, group size set to 1");const un=(await fi.get("https://backend-housing47.onrender.comrooms")).data;console.log("Total rooms fetched:",un.length);const hn=un.filter(An=>An.building_id==="HARWOOD");console.log("Rooms for this dorm:",hn.length);const zi=hn.map(An=>"is_taken"in An?An:{...An,is_taken:Math.random()>.7}),dn=zi.filter(An=>An.is_taken);console.log(`Found ${dn.length} taken rooms in data`),he(zi);try{const ea=(await fi.get(`https://backend-housing47.onrender.comrooms/filtered/${Mt}`)).data.filter(ta=>ta.building_id==="HARWOOD");console.log("Filtered rooms:",ea.length),Me(ea)}catch(An){console.warn("Could not get filtered rooms:",An);const ea=zi.filter(ta=>!ta.is_taken);console.log("Using available rooms as fallback:",ea.length),Me(ea)}}catch(Mt){console.error("Error fetching data:",Mt),dt("Failed to load room data. Please try again.")}finally{Fe(!1)}})()},[E,x]),Pe.useEffect(()=>{if(ie.length===0)return;let pt=[...ie];Qt==="available"?pt=pt.filter(Mt=>!Mt.is_taken):Qt==="taken"&&(pt=pt.filter(Mt=>Mt.is_taken)),mt&&(pt=pt.filter(Mt=>Mt.capacity===parseInt(mt))),yt&&(pt=pt.filter(Mt=>Mt.class_year===parseInt(yt))),Si==="yes"?pt=pt.filter(Mt=>Mt.has_ac===!0):Si==="no"&&(pt=pt.filter(Mt=>Mt.has_ac===!1)),Ui==="eligible"?pt=pt.filter(Mt=>qt(Mt)):Ui==="ineligible"&&(pt=pt.filter(Mt=>!qt(Mt)&&!Mt.is_taken)),Me(pt)},[Qt,mt,yt,Si,Ui,ie,ui,xt]);const Ln=()=>ie.length===0?(console.log("No room data available yet - skipping overlay rendering"),null):$t.map((pt,Mt)=>{const hi=ie.find(K=>K.room_number===pt.roomId);if(!hi)return console.log(`No room info found for area ${pt.roomId}`),null;const Ri=kn(hi),xn=pt.coords.split(",").map(Number),un=parseInt(xn[0]),hn=parseInt(xn[1]),zi=parseInt(xn[2]),dn=parseInt(xn[3]),An=Math.min(un,zi),ea=Math.min(hn,dn),ta=Math.abs(zi-un),Nr=Math.abs(dn-hn);let Ce,$;return hi.is_taken?(Ce="rgba(248, 113, 113, 0.6)",$="rgba(220, 38, 38, 0.8)"):Ri.eligible?(Ce="rgba(74, 222, 128, 0.6)",$="rgba(22, 163, 74, 0.8)"):(Ce="rgba(251, 191, 36, 0.6)",$="rgba(217, 119, 6, 0.8)"),F.jsx("div",{style:{position:"absolute",left:`${An}px`,top:`${ea}px`,width:`${ta}px`,height:`${Nr}px`,backgroundColor:Ce,border:`2px solid ${$}`,boxSizing:"border-box",pointerEvents:"none",zIndex:5}},pt.roomId)}),vo=async(pt,Mt,hi)=>{R(Mt),ze(!0),Fr(pt),hi?await Ai(hi):H(null)},Vn=()=>{ze(!1),H(null)},Cn=pt=>{Fr(pt)},Fr=pt=>{if(_e.current){const Mt=_e.current.getBoundingClientRect();Q({x:pt.clientX-Mt.left+15,y:pt.clientY-Mt.top+15})}},Wi=async pt=>{try{console.log("Starting room selection for roomId:",pt),console.log("Current userId:",Vi);const Mt=ie.find(dn=>dn.id===pt);if(Mt){const dn=kn(Mt);if(!dn.eligible){if(dn.reason==="class_year"){alert(`This room is only available for ${Mt.class_year===1?"Freshman":Mt.class_year===2?"Sophomore":Mt.class_year===3?"Junior":"Senior"} and above.`);return}else if(dn.reason==="capacity"){alert(`This room is for ${Mt.capacity} people, but your group size is ${ui}.`);return}else if(dn.reason==="both"){alert(`This room is not eligible for your group. It requires ${Mt.class_year===1?"Freshman":Mt.class_year===2?"Sophomore":Mt.class_year===3?"Junior":"Senior"} or above and a group size of ${Mt.capacity}.`);return}}}const Ri=(await fi.get(`https://backend-housing47.onrender.comusers/get_user/${Vi}`)).data;if(console.log("User data received:",Ri),Ri.room_id){if(console.log("User already has room assigned:",Ri.room_id),!window.confirm("You already have a room assigned. Do you want to change your selection?")){console.log("User cancelled room change");return}console.log("Unselecting current room...");const dn=await fi.post("https://backend-housing47.onrender.comrooms/unselectRoom",{room_id:Ri.room_id,user_id:Vi});console.log("Room unselection response:",dn.data)}console.log("Selecting new room...");const xn=await fi.post("https://backend-housing47.onrender.comrooms/selectRoom",{room_id:pt,user_id:Vi});console.log("Room selection response:",xn.data),console.log("Refreshing room data...");const hn=(await fi.get("https://backend-housing47.onrender.comrooms")).data;console.log("Room data received:",hn.length,"rooms");const zi=hn.filter(dn=>dn.building_id==="HARWOOD");console.log("Filtered room data for current dorm:",zi.length,"rooms"),he(zi),alert("Room selected successfully!")}catch(Mt){console.error("Error selecting room:",Mt),Mt.response?(console.error("Error response from server:",Mt.response.data),console.error("Error status:",Mt.response.status),alert(`Failed to select room: ${Mt.response.data.error||Mt.response.statusText}`)):Mt.request?(console.error("No response received from server"),alert("Failed to select room: No response from server. Check if the server is running.")):(console.error("Error during request setup:",Mt.message),alert(`Failed to select room: ${Mt.message}`))}},xo=()=>{x("/map")},bo=()=>{zt(""),St(""),Bi("available"),Mi(""),Ki("all")},Mn=pt=>!ie||ie.length===0?[]:[...new Set(ie.map(hi=>hi[pt]))].sort((hi,Ri)=>hi-Ri),$a=Mn("capacity"),za=Mn("class_year"),lr=(()=>{if(ie.length===0)return{eligible:0,ineligible:0,taken:0};const pt=ie.filter(Ri=>qt(Ri)).length,Mt=ie.filter(Ri=>!Ri.is_taken&&!qt(Ri)).length,hi=ie.filter(Ri=>Ri.is_taken).length;return{eligible:pt,ineligible:Mt,taken:hi}})();return F.jsxs("div",{style:Lt.page,children:[F.jsxs("header",{style:Lt.header,children:[F.jsxs("div",{style:Lt.logoContainer,children:[F.jsx("span",{style:Lt.logoIcon,children:"🏠"}),F.jsx("span",{style:Lt.logoText,children:"Housing47"})]}),F.jsxs("div",{style:Lt.navLinks,children:[F.jsx("button",{onClick:()=>x("/dashboard"),style:Lt.navLink,children:"Home"}),F.jsx("button",{onClick:()=>x("/map"),style:Lt.navLink,children:"Browse Housing"}),F.jsx("button",{onClick:()=>x("/users"),style:Lt.navLink,children:"Find Roommates"}),F.jsx("button",{onClick:()=>{localStorage.removeItem("userId"),x("/")},style:Lt.signOutButton,children:"Sign Out"})]})]}),F.jsxs("main",{style:Lt.mainContent,children:[F.jsxs("div",{style:Lt.leftSidebar,children:[F.jsxs("div",{style:Lt.sidebarHeader,children:[F.jsx("button",{onClick:xo,style:Lt.backButton,children:"← Back to Map"}),F.jsx("h1",{style:Lt.dormTitle,children:E.replace(/-/g," ").toUpperCase()}),F.jsx("p",{style:Lt.dormSubtitle,children:"Interactive Floor Plan"})]}),F.jsxs("div",{style:Lt.filterSection,children:[F.jsx("h2",{style:Lt.filterTitle,children:"Filter Rooms"}),F.jsx("div",{style:Lt.userInfoPanel,children:F.jsx("div",{style:Lt.eligibilityNote,children:F.jsx("p",{children:"Eligible rooms must match your group size and be available for your class year or lower."})})}),F.jsxs("div",{style:Lt.roomCountsContainer,children:[F.jsxs("div",{style:Lt.roomCountItem,children:[F.jsx("div",{style:Lt.eligibleIndicator}),F.jsxs("span",{children:[lr.eligible," eligible"]})]}),F.jsxs("div",{style:Lt.roomCountItem,children:[F.jsx("div",{style:Lt.ineligibleIndicator}),F.jsxs("span",{children:[lr.ineligible," ineligible"]})]}),F.jsxs("div",{style:Lt.roomCountItem,children:[F.jsx("div",{style:Lt.takenIndicator}),F.jsxs("span",{children:[lr.taken," taken"]})]})]}),F.jsxs("div",{style:Lt.filterGroup,children:[F.jsx("label",{style:Lt.filterLabel,children:"Room Eligibility"}),F.jsxs("select",{style:Lt.filterSelect,value:Ui,onChange:pt=>Ki(pt.target.value),children:[F.jsx("option",{value:"all",children:"All Rooms"}),F.jsx("option",{value:"eligible",children:"Eligible Rooms Only"}),F.jsx("option",{value:"ineligible",children:"Ineligible Rooms Only"})]})]}),F.jsxs("div",{style:Lt.filterGroup,children:[F.jsx("label",{style:Lt.filterLabel,children:"Availability"}),F.jsxs("select",{style:Lt.filterSelect,value:Qt,onChange:pt=>Bi(pt.target.value),children:[F.jsx("option",{value:"all",children:"All Rooms"}),F.jsx("option",{value:"available",children:"Available Only"}),F.jsx("option",{value:"taken",children:"Taken Only"})]})]}),F.jsxs("div",{style:Lt.filterGroup,children:[F.jsx("label",{style:Lt.filterLabel,children:"Air Conditioning"}),F.jsxs("select",{style:Lt.filterSelect,value:Si,onChange:pt=>Mi(pt.target.value),children:[F.jsx("option",{value:"",children:"All Rooms"}),F.jsx("option",{value:"yes",children:"With AC Only"}),F.jsx("option",{value:"no",children:"Without AC"})]})]}),F.jsxs("div",{style:Lt.filterGroup,children:[F.jsx("label",{style:Lt.filterLabel,children:"Room Capacity"}),F.jsxs("select",{style:Lt.filterSelect,value:mt,onChange:pt=>zt(pt.target.value),children:[F.jsx("option",{value:"",children:"All Capacities"}),$a.map(pt=>F.jsxs("option",{value:pt,children:[pt," ",pt===1?"Person":"People"]},pt))]})]}),F.jsxs("div",{style:Lt.filterGroup,children:[F.jsx("label",{style:Lt.filterLabel,children:"Class Year Eligibility"}),F.jsxs("select",{style:Lt.filterSelect,value:yt,onChange:pt=>St(pt.target.value),children:[F.jsx("option",{value:"",children:"All Class Years"}),za.map(pt=>F.jsx("option",{value:pt,children:pt===1?"Freshman":pt===2?"Sophomore":pt===3?"Junior":"Senior"},pt))]})]}),F.jsxs("div",{style:Lt.filterInfo,children:[F.jsxs("p",{children:["Your group size: ",F.jsx("strong",{children:ui})]}),F.jsxs("p",{children:["Your class year: ",F.jsx("strong",{children:xt===1?"Freshman":xt===2?"Sophomore":xt===3?"Junior":xt===4?"Senior":"Unknown"})]})]}),F.jsx("button",{style:Lt.resetButton,onClick:bo,children:"Reset Filters"})]}),F.jsxs("div",{style:Lt.roomListSection,children:[F.jsxs("h2",{style:Lt.roomListTitle,children:["Available Rooms ",je.length>0?`(${je.length})`:""]}),Oe?F.jsxs("div",{style:Lt.loadingContainer,children:[F.jsx("div",{style:Lt.loadingSpinner}),F.jsx("p",{children:"Loading rooms..."})]}):qe?F.jsx("div",{style:Lt.errorContainer,children:F.jsx("p",{children:qe})}):je.length>0?F.jsx("div",{style:Lt.roomListWrapper,children:F.jsx("div",{style:Lt.roomList,children:je.map(pt=>F.jsxs("div",{style:{...Lt.roomListItem,...pt.is_taken?Lt.roomTaken:{}},onClick:()=>!pt.is_taken&&Wi(pt.id),children:[F.jsxs("div",{style:Lt.roomNumber,children:["Room ",pt.room_number]}),F.jsxs("div",{style:Lt.roomDetails,children:[F.jsxs("span",{children:[pt.capacity," ",pt.capacity===1?"person":"people"]}),F.jsx("span",{children:" • "}),F.jsx("span",{children:pt.class_year===1?"Freshman":pt.class_year===2?"Sophomore":pt.class_year===3?"Junior":"Senior"}),pt.has_ac&&F.jsxs("span",{children:[" • ",F.jsx("span",{style:Lt.acBadge,children:"AC"})]})]}),F.jsx("div",{style:Lt.roomStatus,children:pt.is_taken?F.jsx("span",{style:Lt.takenBadge,children:"Taken"}):F.jsx("span",{style:Lt.availableBadge,children:"Available"})})]},pt.id))})}):F.jsx("p",{style:Lt.noRoomsText,children:"No rooms match your filters."})]})]}),F.jsx("div",{style:Lt.rightContent,children:Ot?F.jsxs("div",{style:Lt.imageContainer,children:[F.jsx("img",{ref:_e,src:Ot,alt:`${E} layout`,useMap:`#${E}-map`,style:Lt.mapImage}),F.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:5},children:Ln()}),ce&&F.jsx("div",{style:{...Lt.tooltip,left:`${re.x}px`,top:`${re.y}px`},children:A?F.jsx("div",{style:Lt.tooltipLoading,children:"Loading..."}):L?F.jsxs("div",{style:Lt.tooltipDetailed,children:[F.jsxs("div",{style:Lt.tooltipTitle,children:["Room ",L.room_number]}),F.jsxs("div",{style:Lt.tooltipDetails,children:[F.jsxs("p",{children:["Capacity: ",L.capacity," ",L.capacity===1?"person":"people"]}),F.jsxs("p",{children:["Status: ",L.is_taken?F.jsx("span",{style:{color:"#ef4444",fontWeight:"bold"},children:"Taken"}):F.jsx("span",{style:{color:"#22c55e",fontWeight:"bold"},children:"Available"})]}),F.jsxs("p",{children:["Class Year: ",L.class_year===1?"Freshman":L.class_year===2?"Sophomore":L.class_year===3?"Junior":"Senior"]}),L.time_taken&&F.jsxs("p",{children:["Previously taken: ",Et(L.time_taken)]}),L.dimensions&&F.jsxs("p",{children:["Size: ",L.dimensions]}),L.has_ac&&F.jsx("p",{children:"Air Conditioning: Yes"}),L.dimensions&&F.jsxs("p",{children:["Size: ",L.dimensions]}),L.features&&L.features.length>0&&F.jsxs("p",{children:["Features: ",L.features.join(", ")]})]})]}):F.jsx("div",{children:I})}),F.jsx("map",{name:`${E}-map`,children:$t.map((pt,Mt)=>{const hi=ie.find(xn=>xn.room_number===pt.roomId),Ri=hi?`Room ${hi.room_number} - ${hi.capacity} person${hi.capacity!==1?"s":""} - ${hi.is_taken?"Taken":"Available"}${hi.has_ac?" - Has AC":""}`:pt.info;return F.jsx("area",{shape:"rect",coords:pt.coords,alt:`Room ${pt.roomId}`,onClick:()=>hi&&!hi.is_taken&&Wi(hi.id),onMouseOver:xn=>vo(xn,Ri,hi==null?void 0:hi.id),onMouseOut:Vn,onMouseMove:Cn,style:{cursor:hi&&!hi.is_taken?"pointer":"default"}},Mt)})})]}):F.jsx("div",{style:Lt.noImageContainer,children:F.jsx("p",{style:Lt.noImageText,children:"No layout image found for this dorm."})})})]}),F.jsx("footer",{style:Lt.footer,children:F.jsx("p",{children:"© 2025 Housing47. All rights reserved."})})]})},Lt={page:{minHeight:"100vh",display:"flex",flexDirection:"column",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",backgroundColor:"#F9FAFB"},header:{backgroundColor:"white",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",padding:"1rem 2rem",display:"flex",justifyContent:"space-between",alignItems:"center",zIndex:10},logoContainer:{display:"flex",alignItems:"center",gap:"0.5rem"},logoIcon:{fontSize:"1.5rem"},logoText:{fontWeight:"bold",fontSize:"1.25rem",color:"#4F46E5"},navLinks:{display:"flex",alignItems:"center",gap:"1rem"},navLink:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#4B5563",fontWeight:"500",background:"none",border:"none",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},signOutButton:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#EF4444",fontWeight:"500",background:"none",border:"1px solid #EF4444",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},mainContent:{flex:1,display:"flex",flexDirection:"row",height:"calc(100vh - 137px)",overflow:"hidden"},leftSidebar:{width:"350px",backgroundColor:"white",borderRight:"1px solid #E5E7EB",padding:"1.5rem",overflowY:"auto",display:"flex",flexDirection:"column",gap:"1.5rem"},sidebarHeader:{marginBottom:"1rem"},backButton:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",color:"#4F46E5",fontWeight:"500",background:"none",border:"none",cursor:"pointer",transition:"color 0.2s",marginBottom:"1rem"},dormTitle:{fontSize:"1.5rem",fontWeight:"bold",color:"#1F2937",margin:"0",marginBottom:"0.25rem"},dormSubtitle:{fontSize:"0.875rem",color:"#6B7280",margin:"0"},filterSection:{display:"flex",flexDirection:"column",gap:"1rem",padding:"1.5rem",backgroundColor:"#F9FAFB",borderRadius:"0.5rem"},filterTitle:{fontSize:"1rem",fontWeight:"600",color:"#374151",margin:"0 0 0.5rem 0"},filterGroup:{display:"flex",flexDirection:"column",gap:"0.5rem"},filterLabel:{fontSize:"0.875rem",fontWeight:"500",color:"#4B5563"},filterSelect:{padding:"0.5rem",borderRadius:"0.375rem",border:"1px solid #D1D5DB",fontSize:"0.875rem",color:"#1F2937",backgroundColor:"white"},filterInfo:{marginTop:"0.5rem",padding:"0.75rem",backgroundColor:"#EEF2FF",borderRadius:"0.375rem",fontSize:"0.875rem",color:"#4338CA"},resetButton:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#F3F4F6",color:"#4B5563",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s"},roomListSection:{flex:"1",display:"flex",flexDirection:"column"},roomListTitle:{fontSize:"1rem",fontWeight:"600",color:"#374151",margin:"0 0 1rem 0"},roomListWrapper:{width:"100%",marginBottom:"1rem"},roomList:{display:"flex",flexDirection:"column",gap:"0.5rem",overflowY:"auto",maxHeight:"300px",borderRadius:"0.5rem",padding:"0.5rem",boxShadow:"inset 0 1px 2px rgba(0, 0, 0, 0.05)",backgroundColor:"#F9FAFB"},roomListItem:{padding:"0.75rem",borderRadius:"0.375rem",backgroundColor:"white",border:"1px solid #E5E7EB",cursor:"pointer",transition:"border-color 0.2s, transform 0.1s"},roomTaken:{backgroundColor:"#F3F4F6",cursor:"default",opacity:.8},roomNumber:{fontWeight:"600",color:"#1F2937",fontSize:"0.875rem"},roomDetails:{color:"#6B7280",fontSize:"0.75rem",marginTop:"0.25rem"},acBadge:{backgroundColor:"#DBEAFE",color:"#1E40AF",padding:"0.125rem 0.375rem",borderRadius:"9999px",fontSize:"0.625rem",fontWeight:"500"},roomStatus:{display:"flex",justifyContent:"flex-end",marginTop:"0.5rem"},availableBadge:{backgroundColor:"#D1FAE5",color:"#047857",fontSize:"0.75rem",fontWeight:"500",padding:"0.25rem 0.5rem",borderRadius:"9999px"},takenBadge:{backgroundColor:"#FEE2E2",color:"#B91C1C",fontSize:"0.75rem",fontWeight:"500",padding:"0.25rem 0.5rem",borderRadius:"9999px"},noRoomsText:{color:"#6B7280",fontSize:"0.875rem",fontStyle:"italic"},rightContent:{flex:"1",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#F3F4F6",padding:"1rem",overflow:"auto"},imageContainer:{position:"relative",maxHeight:"100%",display:"flex",justifyContent:"center",alignItems:"center",overflow:"visible"},mapImage:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",borderRadius:"0.75rem",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},tooltip:{position:"absolute",backgroundColor:"rgba(31, 41, 55, 0.95)",color:"white",padding:"0.75rem",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",zIndex:100,pointerEvents:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",maxWidth:"300px"},tooltipLoading:{padding:"0.25rem 0",fontSize:"0.75rem"},tooltipDetailed:{display:"flex",flexDirection:"column",gap:"0.5rem"},tooltipTitle:{fontWeight:"700",fontSize:"1rem",borderBottom:"1px solid rgba(255, 255, 255, 0.2)",paddingBottom:"0.25rem"},tooltipDetails:{display:"flex",flexDirection:"column",gap:"0.25rem",fontSize:"0.75rem"},noImageContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},noImageText:{color:"#6B7280",fontSize:"1.125rem"},footer:{borderTop:"1px solid #E5E7EB",padding:"1rem",textAlign:"center",color:"#6B7280",backgroundColor:"white",fontSize:"0.875rem"},loadingContainer:{display:"flex",flexDirection:"column",alignItems:"center",padding:"2rem 0",color:"#6B7280"},loadingSpinner:{width:"2rem",height:"2rem",border:"3px solid #E5E7EB",borderTopColor:"#4F46E5",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"0.5rem"},errorContainer:{padding:"1rem",backgroundColor:"#FEE2E2",color:"#B91C1C",borderRadius:"0.375rem",fontSize:"0.875rem"}};function Qv(){const x=$c(),[E,I]=Pe.useState({email:"",password:""}),[R,L]=Pe.useState({}),[H,A]=Pe.useState(!1),[u,re]=Pe.useState(""),Q=he=>{const{name:je,value:Me}=he.target;I({...E,[je]:Me}),R[je]&&L({...R,[je]:""})},ce=()=>{const he={};return E.email.trim()?/\S+@\S+\.\S+/.test(E.email)||(he.email="Email is invalid"):he.email="Email is required",E.password||(he.password="Password is required"),he},ze=async he=>{he.preventDefault();const je=ce();if(Object.keys(je).length>0){L(je);return}A(!0),re("");try{const Me=await fi.post("https://backend-housing47.onrender.comlogin",E);console.log("Login successful:",Me.data),localStorage.setItem("userId",Me.data.user.id),x("/dashboard")}catch(Me){if(console.error("Login error:",Me),Me.response){const Oe=Me.response.data.message||Me.response.data||"Login failed. Please check your credentials.";re(typeof Oe=="string"?Oe:JSON.stringify(Oe))}else Me.request?re("No response from server. Please check your connection."):re("An error occurred. Please try again.")}finally{A(!1)}},_e=()=>{x("/")},ie=()=>{x("/signup")};return F.jsx("div",{style:Dn.page,children:F.jsxs("div",{style:Dn.loginContainer,children:[F.jsxs("div",{style:Dn.header,children:[F.jsx("button",{onClick:_e,style:Dn.backButton,children:"← Back"}),F.jsxs("div",{style:Dn.logoContainer,children:[F.jsx("span",{style:Dn.logoIcon,children:"🏠"}),F.jsx("span",{style:Dn.logoText,children:"Housing47"})]})]}),F.jsx("h1",{style:Dn.title,children:"Sign In"}),F.jsx("p",{style:Dn.subtitle,children:"Welcome back to Housing47"}),u&&F.jsx("div",{style:Dn.submitErrorContainer,children:F.jsx("p",{style:Dn.submitErrorText,children:u})}),F.jsxs("form",{onSubmit:ze,style:Dn.form,children:[F.jsxs("div",{style:Dn.formGroup,children:[F.jsx("label",{htmlFor:"email",style:Dn.label,children:"Email"}),F.jsx("input",{type:"email",id:"email",name:"email",value:E.email,onChange:Q,style:{...Dn.input,...R.email?Dn.inputError:{}},placeholder:"your.email@university.edu"}),R.email&&F.jsx("p",{style:Dn.errorText,children:R.email})]}),F.jsxs("div",{style:Dn.formGroup,children:[F.jsx("label",{htmlFor:"password",style:Dn.label,children:"Password"}),F.jsx("input",{type:"password",id:"password",name:"password",value:E.password,onChange:Q,style:{...Dn.input,...R.password?Dn.inputError:{}},placeholder:"••••••••"}),R.password&&F.jsx("p",{style:Dn.errorText,children:R.password}),F.jsx("div",{style:Dn.forgotPassword,children:F.jsx("a",{href:"#",style:Dn.link,children:"Forgot password?"})})]}),F.jsx("button",{type:"submit",style:Dn.submitButton,disabled:H,children:H?"Signing In...":"Sign In"})]}),F.jsxs("div",{style:Dn.signupLink,children:["Don't have an account? ",F.jsx("a",{href:"#",onClick:ie,style:Dn.link,children:"Sign up"})]})]})})}const Dn={page:{minHeight:"100vh",background:"linear-gradient(to bottom right, #EBF4FF, #E0E7FF)",display:"flex",justifyContent:"center",alignItems:"center",padding:"2rem",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif"},loginContainer:{backgroundColor:"white",borderRadius:"1rem",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",padding:"2rem",width:"100%",maxWidth:"500px"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"2rem"},backButton:{background:"none",border:"none",color:"#4F46E5",fontSize:"1rem",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",padding:"0.5rem"},logoContainer:{display:"flex",alignItems:"center",gap:"0.5rem"},logoIcon:{fontSize:"1.5rem"},logoText:{fontWeight:"bold",fontSize:"1.25rem",color:"#4F46E5"},title:{fontSize:"1.875rem",fontWeight:"bold",color:"#1F2937",marginBottom:"0.5rem",textAlign:"center"},subtitle:{fontSize:"1rem",color:"#6B7280",marginBottom:"2rem",textAlign:"center"},submitErrorContainer:{backgroundColor:"#FEF2F2",borderRadius:"0.5rem",padding:"1rem",marginBottom:"1.5rem",borderLeft:"4px solid #EF4444"},submitErrorText:{color:"#B91C1C",margin:0,fontSize:"0.875rem"},form:{display:"flex",flexDirection:"column",gap:"1.25rem"},formGroup:{display:"flex",flexDirection:"column",gap:"0.5rem"},label:{fontSize:"0.875rem",fontWeight:"500",color:"#374151"},input:{padding:"0.75rem",borderRadius:"0.5rem",border:"1px solid #D1D5DB",fontSize:"1rem",transition:"border-color 0.2s, box-shadow 0.2s",outline:"none"},inputError:{borderColor:"#EF4444",backgroundColor:"#FEF2F2"},errorText:{color:"#EF4444",fontSize:"0.75rem",margin:"0.25rem 0 0 0"},forgotPassword:{textAlign:"right",fontSize:"0.75rem",marginTop:"0.5rem"},submitButton:{backgroundColor:"#4F46E5",color:"white",fontWeight:"500",fontSize:"1rem",padding:"0.75rem",borderRadius:"0.5rem",border:"none",cursor:"pointer",transition:"background-color 0.2s",marginTop:"0.5rem"},signupLink:{textAlign:"center",marginTop:"1.5rem",fontSize:"0.875rem",color:"#6B7280"},link:{color:"#4F46E5",fontWeight:"500",textDecoration:"none"}};function Jv(){const x=$c(),[E,I]=Pe.useState(null),[R,L]=Pe.useState(null),[H,A]=Pe.useState(!0),[u,re]=Pe.useState(""),[Q,ce]=Pe.useState([]),[ze,_e]=Pe.useState(null);let ie=null;Pe.useEffect(()=>{if(ie=localStorage.getItem("userId"),!ie){x("/signin");return}(async()=>{try{A(!0);const Oe=await fi.get(`https://backend-housing47.onrender.comusers/get_user/${ie}`);if(I(Oe.data),L(Oe.data.group_id),Oe.data.room_id)try{const Fe=await fi.get(`https://backend-housing47.onrender.comrooms/get_room_by_id/${Oe.data.room_id}`);_e(Fe.data)}catch(Fe){console.error("Error fetching room data:",Fe)}if(Oe.data.group_id)try{const Fe=await fi.get(`https://backend-housing47.onrender.comusers/roommates/${ie}`);Fe.data&&Fe.data.roommates&&ce(Fe.data.roommates)}catch(Fe){console.error("Error fetching roommates:",Fe)}}catch(Oe){console.error("Error fetching user data:",Oe),re("Failed to load your profile. Please try again.")}finally{A(!1)}})()},[x]);const he=()=>{localStorage.removeItem("userId"),x("/")},je=async()=>{ie=localStorage.getItem("userId");try{console.log("user id",ie);const Me=await fi.post(`https://backend-housing47.onrender.comusers/leaveGroup/${ie}`);console.log("Successfully left group:",Me.data);const Oe=await fi.get(`https://backend-housing47.onrender.comusers/get_user/${ie}`);I(Oe.data),L(Oe.data.group_id)}catch(Me){console.error("Error leaving group:",Me.message)}};return H?F.jsxs("div",{style:Li.loadingContainer,children:[F.jsx("div",{style:Li.loadingSpinner}),F.jsx("p",{children:"Loading your dashboard..."})]}):F.jsxs("div",{style:Li.page,children:[F.jsxs("header",{style:Li.header,children:[F.jsxs("div",{style:Li.logoContainer,children:[F.jsx("span",{style:Li.logoIcon,children:"🏠"}),F.jsx("span",{style:Li.logoText,children:"Housing47"})]}),F.jsxs("div",{style:Li.navLinks,children:[F.jsx("button",{style:{...Li.navLink,...Li.activeNavLink},children:"Dashboard"}),F.jsx("button",{onClick:()=>x("/map"),style:Li.navLink,children:"Browse Housing"}),F.jsx("button",{onClick:()=>x("/users"),style:Li.navLink,children:"Find Roommates"}),F.jsx("button",{onClick:he,style:Li.signOutButton,children:"Sign Out"})]})]}),F.jsxs("main",{style:Li.mainContent,children:[u&&F.jsx("div",{style:Li.errorMessage,children:u}),E&&F.jsxs("div",{style:Li.dashboardContainer,children:[F.jsxs("div",{style:Li.welcomeSection,children:[F.jsxs("h1",{style:Li.welcomeHeading,children:["Welcome, ",E.username,"!"]}),F.jsx("p",{style:Li.welcomeSubheading,children:"Here's your housing dashboard"})]}),F.jsxs("div",{style:Li.infoCards,children:[F.jsxs("div",{style:Li.card,children:[F.jsx("h2",{style:Li.cardTitle,children:"Your Profile"}),F.jsxs("div",{style:Li.cardContent,children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Email:"})," ",E.email]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Class Year:"})," ",Bg(E.class_year)]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Housing Status:"})," ",E.room_id?"Assigned":"Not Assigned"]})]})]}),F.jsxs("div",{style:Li.card,children:[F.jsx("h2",{style:Li.cardTitle,children:"Roommate Group"}),F.jsx("div",{style:Li.cardContent,children:R?F.jsxs(F.Fragment,{children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Group ID:"})," ",R]}),F.jsx("p",{children:F.jsx("strong",{children:"Roommates:"})}),Q.length>0?F.jsxs(F.Fragment,{children:[F.jsx("ul",{style:Li.roommateList,children:Q.map(Me=>F.jsxs("li",{style:Li.roommateItem,children:[Me.username," (",Bg(Me.class_year),")"]},Me.id))}),F.jsx("button",{onClick:je,style:Li.actionButton,children:"Leave Group"})]}):F.jsx(F.Fragment,{children:F.jsx("p",{children:"No roommates found"})})]}):F.jsxs(F.Fragment,{children:[F.jsx("p",{children:"You are not part of a roommate group yet. Create or join a group to find housing together."}),F.jsx("button",{onClick:()=>x("/users"),style:Li.actionButton,children:"Find Roommate"})]})})]}),F.jsxs("div",{style:Li.card,children:[F.jsx("h2",{style:Li.cardTitle,children:"Housing Assignment"}),F.jsxs("div",{style:Li.cardContent,children:[E.room_id?F.jsx(F.Fragment,{children:ze?F.jsxs("div",{children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Room:"})," ",ze.room_number]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Building:"})," ",ze.building_id]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Capacity:"})," ",ze.capacity," ",ze.capacity===1?"person":"people"]}),ze.has_ac&&F.jsxs("p",{children:[F.jsx("strong",{children:"Amenities:"})," Air Conditioning"]})]}):F.jsx("p",{children:"Loading room information..."})}):F.jsx("p",{children:"You don't have a housing assignment yet."}),F.jsx("button",{onClick:()=>x("/map"),style:Li.actionButton,children:"Browse Housing Map"})]})]})]})]})]}),F.jsx("footer",{style:Li.footer,children:F.jsx("p",{children:"© 2025 Housing47. All rights reserved."})})]})}function Bg(x){return{1:"Freshman",2:"Sophomore",3:"Junior",4:"Senior"}[x]||x}const Li={page:{minHeight:"100vh",display:"flex",flexDirection:"column",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",backgroundColor:"#F9FAFB"},header:{backgroundColor:"white",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",padding:"1rem 2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},logoContainer:{display:"flex",alignItems:"center",gap:"0.5rem"},logoIcon:{fontSize:"1.5rem"},logoText:{fontWeight:"bold",fontSize:"1.25rem",color:"#4F46E5"},navLinks:{display:"flex",alignItems:"center",gap:"1rem"},navLink:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#4B5563",fontWeight:"500",background:"none",border:"none",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},signOutButton:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#EF4444",fontWeight:"500",background:"none",border:"1px solid #EF4444",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},mainContent:{flex:1,padding:"2rem",maxWidth:"1200px",margin:"0 auto",width:"100%"},activeNavLink:{backgroundColor:"#EEF2FF",color:"#4F46E5"},dashboardContainer:{display:"flex",flexDirection:"column",gap:"2rem"},welcomeSection:{marginBottom:"1rem"},welcomeHeading:{fontSize:"1.875rem",fontWeight:"bold",color:"#111827",marginBottom:"0.5rem"},welcomeSubheading:{fontSize:"1.125rem",color:"#6B7280"},infoCards:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.5rem"},card:{backgroundColor:"white",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden"},cardTitle:{backgroundColor:"#F3F4F6",padding:"1rem",borderBottom:"1px solid #E5E7EB",fontSize:"1.25rem",fontWeight:"600",color:"#374151",margin:0},cardContent:{padding:"1.5rem",color:"#4B5563"},roommateList:{listStyleType:"none",padding:0,margin:"0.5rem 0 0 0"},roommateItem:{padding:"0.5rem 0",borderBottom:"1px solid #F3F4F6"},actionButton:{backgroundColor:"#4F46E5",color:"white",fontWeight:"500",fontSize:"0.875rem",padding:"0.625rem 1rem",borderRadius:"0.5rem",border:"none",cursor:"pointer",transition:"background-color 0.2s",marginTop:"1rem"},footer:{borderTop:"1px solid #E5E7EB",padding:"1.5rem",textAlign:"center",color:"#6B7280",backgroundColor:"white"},errorMessage:{backgroundColor:"#FEF2F2",color:"#B91C1C",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1.5rem",borderLeft:"4px solid #EF4444"},loadingContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",color:"#6B7280"},loadingSpinner:{width:"2.5rem",height:"2.5rem",border:"4px solid #E5E7EB",borderTopColor:"#4F46E5",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"1rem"}};function A_(x){var E,I,R="";if(typeof x=="string"||typeof x=="number")R+=x;else if(typeof x=="object")if(Array.isArray(x)){var L=x.length;for(E=0;E<L;E++)x[E]&&(I=A_(x[E]))&&(R&&(R+=" "),R+=I)}else for(I in x)x[I]&&(R&&(R+=" "),R+=I);return R}function Hh(){for(var x,E,I=0,R="",L=arguments.length;I<L;I++)(x=arguments[I])&&(E=A_(x))&&(R&&(R+=" "),R+=E);return R}function ex(x){if(typeof document>"u")return;let E=document.head||document.getElementsByTagName("head")[0],I=document.createElement("style");I.type="text/css",E.firstChild?E.insertBefore(I,E.firstChild):E.appendChild(I),I.styleSheet?I.styleSheet.cssText=x:I.appendChild(document.createTextNode(x))}ex(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var dp=x=>typeof x=="number"&&!isNaN(x),Xh=x=>typeof x=="string",Hc=x=>typeof x=="function",tx=x=>Xh(x)||dp(x),$m=x=>Xh(x)||Hc(x)?x:null,ix=(x,E)=>x===!1||dp(x)&&x>0?x:E,Xm=x=>Pe.isValidElement(x)||Xh(x)||Hc(x)||dp(x);function nx(x,E,I=300){let{scrollHeight:R,style:L}=x;requestAnimationFrame(()=>{L.minHeight="initial",L.height=R+"px",L.transition=`all ${I}ms`,requestAnimationFrame(()=>{L.height="0",L.padding="0",L.margin="0",setTimeout(E,I)})})}function rx({enter:x,exit:E,appendPosition:I=!1,collapse:R=!0,collapseDuration:L=300}){return function({children:H,position:A,preventExitTransition:u,done:re,nodeRef:Q,isIn:ce,playToast:ze}){let _e=I?`${x}--${A}`:x,ie=I?`${E}--${A}`:E,he=Pe.useRef(0);return Pe.useLayoutEffect(()=>{let je=Q.current,Me=_e.split(" "),Oe=Fe=>{Fe.target===Q.current&&(ze(),je.removeEventListener("animationend",Oe),je.removeEventListener("animationcancel",Oe),he.current===0&&Fe.type!=="animationcancel"&&je.classList.remove(...Me))};je.classList.add(...Me),je.addEventListener("animationend",Oe),je.addEventListener("animationcancel",Oe)},[]),Pe.useEffect(()=>{let je=Q.current,Me=()=>{je.removeEventListener("animationend",Me),R?nx(je,re,L):re()};ce||(u?Me():(he.current=1,je.className+=` ${ie}`,je.addEventListener("animationend",Me)))},[ce]),$n.createElement($n.Fragment,null,H)}}function Og(x,E){return{content:z_(x.content,x.props),containerId:x.props.containerId,id:x.props.toastId,theme:x.props.theme,type:x.props.type,data:x.props.data||{},isLoading:x.props.isLoading,icon:x.props.icon,reason:x.removalReason,status:E}}function z_(x,E,I=!1){return Pe.isValidElement(x)&&!Xh(x.type)?Pe.cloneElement(x,{closeToast:E.closeToast,toastProps:E,data:E.data,isPaused:I}):Hc(x)?x({closeToast:E.closeToast,toastProps:E,data:E.data,isPaused:I}):x}function ax({closeToast:x,theme:E,ariaLabel:I="close"}){return $n.createElement("button",{className:`Toastify__close-button Toastify__close-button--${E}`,type:"button",onClick:R=>{R.stopPropagation(),x(!0)},"aria-label":I},$n.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},$n.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function ox({delay:x,isRunning:E,closeToast:I,type:R="default",hide:L,className:H,controlledProgress:A,progress:u,rtl:re,isIn:Q,theme:ce}){let ze=L||A&&u===0,_e={animationDuration:`${x}ms`,animationPlayState:E?"running":"paused"};A&&(_e.transform=`scaleX(${u})`);let ie=Hh("Toastify__progress-bar",A?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${ce}`,`Toastify__progress-bar--${R}`,{"Toastify__progress-bar--rtl":re}),he=Hc(H)?H({rtl:re,type:R,defaultClassName:ie}):Hh(ie,H),je={[A&&u>=1?"onTransitionEnd":"onAnimationEnd"]:A&&u<1?null:()=>{Q&&I()}};return $n.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":ze},$n.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${ce} Toastify__progress-bar--${R}`}),$n.createElement("div",{role:"progressbar","aria-hidden":ze?"true":"false","aria-label":"notification timer",className:he,style:_e,...je}))}var sx=1,R_=()=>`${sx++}`;function lx(x,E,I){let R=1,L=0,H=[],A=[],u=E,re=new Map,Q=new Set,ce=Fe=>(Q.add(Fe),()=>Q.delete(Fe)),ze=()=>{A=Array.from(re.values()),Q.forEach(Fe=>Fe())},_e=({containerId:Fe,toastId:qe,updateId:dt})=>{let mt=Fe?Fe!==x:x!==1,zt=re.has(qe)&&dt==null;return mt||zt},ie=(Fe,qe)=>{re.forEach(dt=>{var mt;(qe==null||qe===dt.props.toastId)&&((mt=dt.toggle)==null||mt.call(dt,Fe))})},he=Fe=>{var qe,dt;(dt=(qe=Fe.props)==null?void 0:qe.onClose)==null||dt.call(qe,Fe.removalReason),Fe.isActive=!1},je=Fe=>{if(Fe==null)re.forEach(he);else{let qe=re.get(Fe);qe&&he(qe)}ze()},Me=()=>{L-=H.length,H=[]},Oe=Fe=>{var qe,dt;let{toastId:mt,updateId:zt}=Fe.props,yt=zt==null;Fe.staleId&&re.delete(Fe.staleId),Fe.isActive=!0,re.set(mt,Fe),ze(),I(Og(Fe,yt?"added":"updated")),yt&&((dt=(qe=Fe.props).onOpen)==null||dt.call(qe))};return{id:x,props:u,observe:ce,toggle:ie,removeToast:je,toasts:re,clearQueue:Me,buildToast:(Fe,qe)=>{if(_e(qe))return;let{toastId:dt,updateId:mt,data:zt,staleId:yt,delay:St}=qe,Qt=mt==null;Qt&&L++;let Bi={...u,style:u.toastStyle,key:R++,...Object.fromEntries(Object.entries(qe).filter(([Mi,Ui])=>Ui!=null)),toastId:dt,updateId:mt,data:zt,isIn:!1,className:$m(qe.className||u.toastClassName),progressClassName:$m(qe.progressClassName||u.progressClassName),autoClose:qe.isLoading?!1:ix(qe.autoClose,u.autoClose),closeToast(Mi){re.get(dt).removalReason=Mi,je(dt)},deleteToast(){let Mi=re.get(dt);if(Mi!=null){if(I(Og(Mi,"removed")),re.delete(dt),L--,L<0&&(L=0),H.length>0){Oe(H.shift());return}ze()}}};Bi.closeButton=u.closeButton,qe.closeButton===!1||Xm(qe.closeButton)?Bi.closeButton=qe.closeButton:qe.closeButton===!0&&(Bi.closeButton=Xm(u.closeButton)?u.closeButton:!0);let Si={content:Fe,props:Bi,staleId:yt};u.limit&&u.limit>0&&L>u.limit&&Qt?H.push(Si):dp(St)?setTimeout(()=>{Oe(Si)},St):Oe(Si)},setProps(Fe){u=Fe},setToggle:(Fe,qe)=>{let dt=re.get(Fe);dt&&(dt.toggle=qe)},isToastActive:Fe=>{var qe;return(qe=re.get(Fe))==null?void 0:qe.isActive},getSnapshot:()=>A}}var Ha=new Map,op=[],Ym=new Set,cx=x=>Ym.forEach(E=>E(x)),P_=()=>Ha.size>0;function ux(){op.forEach(x=>D_(x.content,x.options)),op=[]}var hx=(x,{containerId:E})=>{var I;return(I=Ha.get(E||1))==null?void 0:I.toasts.get(x)};function I_(x,E){var I;if(E)return!!((I=Ha.get(E))!=null&&I.isToastActive(x));let R=!1;return Ha.forEach(L=>{L.isToastActive(x)&&(R=!0)}),R}function dx(x){if(!P_()){op=op.filter(E=>x!=null&&E.options.toastId!==x);return}if(x==null||tx(x))Ha.forEach(E=>{E.removeToast(x)});else if(x&&("containerId"in x||"id"in x)){let E=Ha.get(x.containerId);E?E.removeToast(x.id):Ha.forEach(I=>{I.removeToast(x.id)})}}var fx=(x={})=>{Ha.forEach(E=>{E.props.limit&&(!x.containerId||E.id===x.containerId)&&E.clearQueue()})};function D_(x,E){Xm(x)&&(P_()||op.push({content:x,options:E}),Ha.forEach(I=>{I.buildToast(x,E)}))}function px(x){var E;(E=Ha.get(x.containerId||1))==null||E.setToggle(x.id,x.fn)}function k_(x,E){Ha.forEach(I=>{(E==null||!(E!=null&&E.containerId)||(E==null?void 0:E.containerId)===I.id)&&I.toggle(x,E==null?void 0:E.id)})}function mx(x){let E=x.containerId||1;return{subscribe(I){let R=lx(E,x,cx);Ha.set(E,R);let L=R.observe(I);return ux(),()=>{L(),Ha.delete(E)}},setProps(I){var R;(R=Ha.get(E))==null||R.setProps(I)},getSnapshot(){var I;return(I=Ha.get(E))==null?void 0:I.getSnapshot()}}}function gx(x){return Ym.add(x),()=>{Ym.delete(x)}}function _x(x){return x&&(Xh(x.toastId)||dp(x.toastId))?x.toastId:R_()}function fp(x,E){return D_(x,E),E.toastId}function _m(x,E){return{...E,type:E&&E.type||x,toastId:_x(E)}}function ym(x){return(E,I)=>fp(E,_m(x,I))}function vn(x,E){return fp(x,_m("default",E))}vn.loading=(x,E)=>fp(x,_m("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...E}));function yx(x,{pending:E,error:I,success:R},L){let H;E&&(H=Xh(E)?vn.loading(E,L):vn.loading(E.render,{...L,...E}));let A={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(Q,ce,ze)=>{if(ce==null){vn.dismiss(H);return}let _e={type:Q,...A,...L,data:ze},ie=Xh(ce)?{render:ce}:ce;return H?vn.update(H,{..._e,...ie}):vn(ie.render,{..._e,...ie}),ze},re=Hc(x)?x():x;return re.then(Q=>u("success",R,Q)).catch(Q=>u("error",I,Q)),re}vn.promise=yx;vn.success=ym("success");vn.info=ym("info");vn.error=ym("error");vn.warning=ym("warning");vn.warn=vn.warning;vn.dark=(x,E)=>fp(x,_m("default",{theme:"dark",...E}));function vx(x){dx(x)}vn.dismiss=vx;vn.clearWaitingQueue=fx;vn.isActive=I_;vn.update=(x,E={})=>{let I=hx(x,E);if(I){let{props:R,content:L}=I,H={delay:100,...R,...E,toastId:E.toastId||x,updateId:R_()};H.toastId!==x&&(H.staleId=x);let A=H.render||L;delete H.render,fp(A,H)}};vn.done=x=>{vn.update(x,{progress:1})};vn.onChange=gx;vn.play=x=>k_(!0,x);vn.pause=x=>k_(!1,x);function xx(x){var E;let{subscribe:I,getSnapshot:R,setProps:L}=Pe.useRef(mx(x)).current;L(x);let H=(E=Pe.useSyncExternalStore(I,R,R))==null?void 0:E.slice();function A(u){if(!H)return[];let re=new Map;return x.newestOnTop&&H.reverse(),H.forEach(Q=>{let{position:ce}=Q.props;re.has(ce)||re.set(ce,[]),re.get(ce).push(Q)}),Array.from(re,Q=>u(Q[0],Q[1]))}return{getToastToRender:A,isToastActive:I_,count:H==null?void 0:H.length}}function bx(x){let[E,I]=Pe.useState(!1),[R,L]=Pe.useState(!1),H=Pe.useRef(null),A=Pe.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:u,pauseOnHover:re,closeToast:Q,onClick:ce,closeOnClick:ze}=x;px({id:x.toastId,containerId:x.containerId,fn:I}),Pe.useEffect(()=>{if(x.pauseOnFocusLoss)return _e(),()=>{ie()}},[x.pauseOnFocusLoss]);function _e(){document.hasFocus()||Oe(),window.addEventListener("focus",Me),window.addEventListener("blur",Oe)}function ie(){window.removeEventListener("focus",Me),window.removeEventListener("blur",Oe)}function he(yt){if(x.draggable===!0||x.draggable===yt.pointerType){Fe();let St=H.current;A.canCloseOnClick=!0,A.canDrag=!0,St.style.transition="none",x.draggableDirection==="x"?(A.start=yt.clientX,A.removalDistance=St.offsetWidth*(x.draggablePercent/100)):(A.start=yt.clientY,A.removalDistance=St.offsetHeight*(x.draggablePercent===80?x.draggablePercent*1.5:x.draggablePercent)/100)}}function je(yt){let{top:St,bottom:Qt,left:Bi,right:Si}=H.current.getBoundingClientRect();yt.nativeEvent.type!=="touchend"&&x.pauseOnHover&&yt.clientX>=Bi&&yt.clientX<=Si&&yt.clientY>=St&&yt.clientY<=Qt?Oe():Me()}function Me(){I(!0)}function Oe(){I(!1)}function Fe(){A.didMove=!1,document.addEventListener("pointermove",dt),document.addEventListener("pointerup",mt)}function qe(){document.removeEventListener("pointermove",dt),document.removeEventListener("pointerup",mt)}function dt(yt){let St=H.current;if(A.canDrag&&St){A.didMove=!0,E&&Oe(),x.draggableDirection==="x"?A.delta=yt.clientX-A.start:A.delta=yt.clientY-A.start,A.start!==yt.clientX&&(A.canCloseOnClick=!1);let Qt=x.draggableDirection==="x"?`${A.delta}px, var(--y)`:`0, calc(${A.delta}px + var(--y))`;St.style.transform=`translate3d(${Qt},0)`,St.style.opacity=`${1-Math.abs(A.delta/A.removalDistance)}`}}function mt(){qe();let yt=H.current;if(A.canDrag&&A.didMove&&yt){if(A.canDrag=!1,Math.abs(A.delta)>A.removalDistance){L(!0),x.closeToast(!0),x.collapseAll();return}yt.style.transition="transform 0.2s, opacity 0.2s",yt.style.removeProperty("transform"),yt.style.removeProperty("opacity")}}let zt={onPointerDown:he,onPointerUp:je};return u&&re&&(zt.onMouseEnter=Oe,x.stacked||(zt.onMouseLeave=Me)),ze&&(zt.onClick=yt=>{ce&&ce(yt),A.canCloseOnClick&&Q(!0)}),{playToast:Me,pauseToast:Oe,isRunning:E,preventExitTransition:R,toastRef:H,eventHandlers:zt}}var wx=typeof window<"u"?Pe.useLayoutEffect:Pe.useEffect,vm=({theme:x,type:E,isLoading:I,...R})=>$n.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:x==="colored"?"currentColor":`var(--toastify-icon-color-${E})`,...R});function Tx(x){return $n.createElement(vm,{...x},$n.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Sx(x){return $n.createElement(vm,{...x},$n.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Ex(x){return $n.createElement(vm,{...x},$n.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Cx(x){return $n.createElement(vm,{...x},$n.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Mx(){return $n.createElement("div",{className:"Toastify__spinner"})}var Km={info:Sx,warning:Tx,success:Ex,error:Cx,spinner:Mx},Ax=x=>x in Km;function zx({theme:x,type:E,isLoading:I,icon:R}){let L=null,H={theme:x,type:E};return R===!1||(Hc(R)?L=R({...H,isLoading:I}):Pe.isValidElement(R)?L=Pe.cloneElement(R,H):I?L=Km.spinner():Ax(E)&&(L=Km[E](H))),L}var Rx=x=>{let{isRunning:E,preventExitTransition:I,toastRef:R,eventHandlers:L,playToast:H}=bx(x),{closeButton:A,children:u,autoClose:re,onClick:Q,type:ce,hideProgressBar:ze,closeToast:_e,transition:ie,position:he,className:je,style:Me,progressClassName:Oe,updateId:Fe,role:qe,progress:dt,rtl:mt,toastId:zt,deleteToast:yt,isIn:St,isLoading:Qt,closeOnClick:Bi,theme:Si,ariaLabel:Mi}=x,Ui=Hh("Toastify__toast",`Toastify__toast-theme--${Si}`,`Toastify__toast--${ce}`,{"Toastify__toast--rtl":mt},{"Toastify__toast--close-on-click":Bi}),Ki=Hc(je)?je({rtl:mt,position:he,type:ce,defaultClassName:Ui}):Hh(Ui,je),Vi=zx(x),Ve=!!dt||!re,xt={closeToast:_e,type:ce,theme:Si},jt=null;return A===!1||(Hc(A)?jt=A(xt):Pe.isValidElement(A)?jt=Pe.cloneElement(A,xt):jt=ax(xt)),$n.createElement(ie,{isIn:St,done:yt,position:he,preventExitTransition:I,nodeRef:R,playToast:H},$n.createElement("div",{id:zt,tabIndex:0,onClick:Q,"data-in":St,className:Ki,...L,style:Me,ref:R,...St&&{role:qe,"aria-label":Mi}},Vi!=null&&$n.createElement("div",{className:Hh("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!Qt})},Vi),z_(u,x,!E),jt,!x.customProgressBar&&$n.createElement(ox,{...Fe&&!Ve?{key:`p-${Fe}`}:{},rtl:mt,theme:Si,delay:re,isRunning:E,isIn:St,closeToast:_e,hide:ze,type:ce,className:Oe,controlledProgress:Ve,progress:dt||0})))},Px=(x,E=!1)=>({enter:`Toastify--animate Toastify__${x}-enter`,exit:`Toastify--animate Toastify__${x}-exit`,appendPosition:E}),Ix=rx(Px("bounce",!0)),Dx={position:"top-right",transition:Ix,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:x=>x.altKey&&x.code==="KeyT"};function kx(x){let E={...Dx,...x},I=x.stacked,[R,L]=Pe.useState(!0),H=Pe.useRef(null),{getToastToRender:A,isToastActive:u,count:re}=xx(E),{className:Q,style:ce,rtl:ze,containerId:_e,hotKeys:ie}=E;function he(Me){let Oe=Hh("Toastify__toast-container",`Toastify__toast-container--${Me}`,{"Toastify__toast-container--rtl":ze});return Hc(Q)?Q({position:Me,rtl:ze,defaultClassName:Oe}):Hh(Oe,$m(Q))}function je(){I&&(L(!0),vn.play())}return wx(()=>{var Me;if(I){let Oe=H.current.querySelectorAll('[data-in="true"]'),Fe=12,qe=(Me=E.position)==null?void 0:Me.includes("top"),dt=0,mt=0;Array.from(Oe).reverse().forEach((zt,yt)=>{let St=zt;St.classList.add("Toastify__toast--stacked"),yt>0&&(St.dataset.collapsed=`${R}`),St.dataset.pos||(St.dataset.pos=qe?"top":"bot");let Qt=dt*(R?.2:1)+(R?0:Fe*yt);St.style.setProperty("--y",`${qe?Qt:Qt*-1}px`),St.style.setProperty("--g",`${Fe}`),St.style.setProperty("--s",`${1-(R?mt:0)}`),dt+=St.offsetHeight,mt+=.025})}},[R,re,I]),Pe.useEffect(()=>{function Me(Oe){var Fe;let qe=H.current;ie(Oe)&&((Fe=qe.querySelector('[tabIndex="0"]'))==null||Fe.focus(),L(!1),vn.pause()),Oe.key==="Escape"&&(document.activeElement===qe||qe!=null&&qe.contains(document.activeElement))&&(L(!0),vn.play())}return document.addEventListener("keydown",Me),()=>{document.removeEventListener("keydown",Me)}},[ie]),$n.createElement("section",{ref:H,className:"Toastify",id:_e,onMouseEnter:()=>{I&&(L(!1),vn.pause())},onMouseLeave:je,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":E["aria-label"]},A((Me,Oe)=>{let Fe=Oe.length?{...ce}:{...ce,pointerEvents:"none"};return $n.createElement("div",{tabIndex:-1,className:he(Me),"data-stacked":I,style:Fe,key:`c-${Me}`},Oe.map(({content:qe,props:dt})=>$n.createElement(Rx,{...dt,stacked:I,collapseAll:je,isIn:u(dt.toastId,dt.containerId),key:`t-${dt.key}`},qe)))}))}function Lx(){const x=$c(),[E,I]=Pe.useState(!0),[R,L]=Pe.useState(null),[H,A]=Pe.useState(null),[u,re]=Pe.useState(""),[Q,ce]=Pe.useState([]),[ze,_e]=Pe.useState([]);let ie;Pe.useEffect(()=>{if(ie=localStorage.getItem("userId"),!ie){x("/signin");return}(async()=>{try{I(!0);const qe=await fi.get(`https://backend-housing47.onrender.comusers/get_user/${ie}`),dt=await fi.get(`https://backend-housing47.onrender.comusers/available/${ie}`);_e(dt.data)}catch(qe){console.error("Error fetching data:",qe),re("Failed to load your profile or available users. Please try again.")}finally{I(!1)}})()},[x]);const he=async Fe=>{try{const qe=localStorage.getItem("userId");if(!qe){x("/signin");return}const dt=await fi.post("https://backend-housing47.onrender.comusers/addToGroup",{currId:qe,roommateId:Fe});if(dt.status===200){L(dt.data.group_id);const mt=await fi.get(`https://backend-housing47.onrender.comusers/get_user/${qe}`);A(mt.data);const zt=await fi.get("https://backend-housing47.onrender.comusers");ce(zt.data);const yt=zt.data.filter(St=>!St.group_id&&St.id!==qe);_e(yt),vn.success("Successfully added to group!")}}catch(qe){console.error("Error adding user to group:",qe),re("Failed to add user to your group. Please try again.")}},je=()=>{localStorage.removeItem("userId"),x("/")},Me=async()=>{try{const Fe=localStorage.getItem("userId");if(!Fe){x("/signin");return}if((await fi.post(`https://backend-housing47.onrender.comusers/leaveGroup/${Fe}`)).status===200){L(null);const dt=await fi.get(`https://backend-housing47.onrender.comusers/get_user/${Fe}`);A(dt.data),vn("Successfully left the group!")}}catch(Fe){console.error("Error leaving group:",Fe),re("Failed to leave the group. Please try again.")}};if(E)return F.jsxs("div",{style:Yi.loadingContainer,children:[F.jsx("div",{style:Yi.loadingSpinner}),F.jsx("p",{children:"Loading profiles..."})]});const Oe=Q.filter(Fe=>Fe.group_id===R&&Fe.id!==localStorage.getItem("userId"));return F.jsxs("div",{style:Yi.page,children:[F.jsxs("header",{style:Yi.header,children:[F.jsxs("div",{style:Yi.logoContainer,children:[F.jsx("span",{style:Yi.logoIcon,children:"🏠"}),F.jsx("span",{style:Yi.logoText,children:"Housing47"})]}),F.jsxs("div",{style:Yi.navLinks,children:[F.jsx("button",{onClick:()=>x("/dashboard"),style:Yi.navLink,children:"Dashboard"}),F.jsx("button",{onClick:()=>x("/map"),style:Yi.navLink,children:"Browse Housing"}),F.jsx("button",{style:{...Yi.navLink,...Yi.activeNavLink},children:"Find Roommates"}),F.jsx("button",{onClick:je,style:Yi.signOutButton,children:"Sign Out"})]})]}),F.jsxs("main",{style:Yi.mainContent,children:[u&&F.jsx("div",{style:Yi.errorMessage,children:u}),F.jsxs("div",{style:Yi.dashboardContainer,children:[F.jsxs("div",{style:Yi.card,children:[F.jsx("h2",{style:Yi.cardTitle,children:"My Roommate Group"}),F.jsx("div",{style:Yi.cardContent,children:R?F.jsxs(F.Fragment,{children:[F.jsxs("p",{children:["Group ID: ",R]}),F.jsx("p",{children:"My Roommates:"}),Oe.length>0?F.jsx("ul",{style:Yi.roommateList,children:Oe.map(Fe=>F.jsxs("li",{style:Yi.roommateItem,children:[Fe.username," - ",jg(Fe.class_year)]},Fe.id))}):F.jsx("p",{children:"No roommates yet. Add some below!"}),F.jsx("button",{style:{...Yi.actionButton,backgroundColor:"#EF4444"},onClick:Me,children:"Leave Group"})]}):F.jsx("p",{children:"You're not part of any roommate group yet. Start by adding potential roommates below!"})})]}),F.jsxs("div",{style:Yi.welcomeSection,children:[F.jsx("h1",{style:Yi.welcomeHeading,children:"Find your next roommate!"}),F.jsx("p",{style:Yi.welcomeSubheading,children:"Browse through available users and add them to your roommate group"})]}),F.jsx("div",{style:Yi.infoCards,children:ze.length>0?ze.map(Fe=>F.jsx("div",{style:Yi.card,children:F.jsxs("div",{style:Yi.cardContent,children:[F.jsx("h3",{style:Yi.userName,children:Fe.username}),F.jsxs("p",{children:["Email: ",Fe.email]}),F.jsxs("p",{children:["Class Year: ",jg(Fe.class_year)]}),F.jsx("button",{style:Yi.actionButton,onClick:()=>he(Fe.id),children:"Add to My Group"})]})},Fe.id)):F.jsx("p",{style:Yi.noUsersMessage,children:"No available users found. Check back later!"})})]})]}),F.jsx("footer",{style:Yi.footer,children:F.jsx("p",{children:"© 2025 Housing47. All rights reserved."})})]})}function jg(x){return{1:"Freshman",2:"Sophomore",3:"Junior",4:"Senior"}[x]||x}const Yi={page:{minHeight:"100vh",display:"flex",flexDirection:"column",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",backgroundColor:"#F9FAFB"},header:{backgroundColor:"white",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",padding:"1rem 2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},logoContainer:{display:"flex",alignItems:"center",gap:"0.5rem"},logoIcon:{fontSize:"1.5rem"},logoText:{fontWeight:"bold",fontSize:"1.25rem",color:"#4F46E5"},navLinks:{display:"flex",alignItems:"center",gap:"1rem"},navLink:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#4B5563",fontWeight:"500",background:"none",border:"none",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},signOutButton:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#EF4444",fontWeight:"500",background:"none",border:"1px solid #EF4444",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},mainContent:{flex:1,padding:"2rem",maxWidth:"1200px",margin:"0 auto",width:"100%"},dashboardContainer:{display:"flex",flexDirection:"column",gap:"2rem"},welcomeSection:{marginBottom:"1rem",marginTop:"2rem"},welcomeHeading:{fontSize:"1.875rem",fontWeight:"bold",color:"#111827",marginBottom:"0.5rem"},welcomeSubheading:{fontSize:"1.125rem",color:"#6B7280"},infoCards:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.5rem"},card:{backgroundColor:"white",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden"},cardTitle:{backgroundColor:"#F3F4F6",padding:"1rem",borderBottom:"1px solid #E5E7EB",fontSize:"1.25rem",fontWeight:"600",color:"#374151",margin:0},cardContent:{padding:"1.5rem",color:"#4B5563"},roommateList:{listStyleType:"none",padding:0,margin:"0.5rem 0 1rem 0"},roommateItem:{padding:"0.5rem 0",borderBottom:"1px solid #F3F4F6",display:"flex",justifyContent:"space-between",alignItems:"center"},actionButton:{backgroundColor:"#4F46E5",color:"white",fontWeight:"500",fontSize:"0.875rem",padding:"0.625rem 1rem",borderRadius:"0.5rem",border:"none",cursor:"pointer",transition:"background-color 0.2s",marginTop:"1rem"},activeNavLink:{backgroundColor:"#EEF2FF",color:"#4F46E5"},footer:{borderTop:"1px solid #E5E7EB",padding:"1.5rem",textAlign:"center",color:"#6B7280",backgroundColor:"white"},errorMessage:{backgroundColor:"#FEF2F2",color:"#B91C1C",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1.5rem",borderLeft:"4px solid #EF4444"},loadingContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",color:"#6B7280"},loadingSpinner:{width:"2.5rem",height:"2.5rem",border:"4px solid #E5E7EB",borderTopColor:"#4F46E5",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"1rem"},userName:{fontSize:"1.25rem",fontWeight:"600",color:"#111827",marginTop:0,marginBottom:"0.75rem"},noUsersMessage:{gridColumn:"1 / -1",textAlign:"center",padding:"2rem",backgroundColor:"white",borderRadius:"0.75rem",color:"#6B7280"}},Bx=()=>{const x=$c();return F.jsxs("div",{style:Yt.page,children:[F.jsxs("header",{style:Yt.header,children:[F.jsxs("div",{style:Yt.logoContainer,children:[F.jsx("span",{style:Yt.logoIcon,children:"🏠"}),F.jsx("span",{style:Yt.logoText,children:"Housing47"})]}),F.jsxs("div",{style:Yt.navLinks,children:[F.jsx("button",{style:Yt.navLink,onClick:()=>x("/dashboard"),children:"Dashboard"}),F.jsx("button",{style:Yt.navLink,onClick:()=>x("/dorms"),children:"Browse Housing"}),F.jsx("button",{style:Yt.navLink,onClick:()=>x("/group"),children:"My Group"}),F.jsx("button",{onClick:()=>{localStorage.removeItem("userId"),x("/")},style:Yt.signOutButton,children:"Sign Out"})]})]}),F.jsx("main",{style:Yt.mainContent,children:F.jsxs("div",{style:Yt.aboutContainer,children:[F.jsx("h1",{style:Yt.pageTitle,children:"About Housing47"}),F.jsxs("section",{style:Yt.section,children:[F.jsx("h2",{style:Yt.sectionTitle,children:"Our Mission"}),F.jsx("div",{style:Yt.missionBox,children:F.jsx("p",{style:Yt.missionText,children:"Housing47 aims to transform the housing selection experience at Pomona College by reducing stress and anxiety, preventing the destruction of friendships, and creating a more intuitive and well-designed user experience that promotes collaboration among community members."})})]}),F.jsxs("section",{style:Yt.section,children:[F.jsx("h2",{style:Yt.sectionTitle,children:"The Problem We're Solving"}),F.jsx("p",{children:"The current Residence website is difficult to navigate and functionally limited. Finding dorm maps involves unnecessary friction, and planning your housing selection with friends using the current system creates stress and anxiety."}),F.jsx("p",{children:'Housing selection often requires students to be "in the know" and rely on anecdotal information from upperclassmen, creating inequity in the process. We believe all students deserve fair and informed access to housing information.'})]}),F.jsx("section",{style:Yt.section,children:F.jsxs("div",{style:Yt.twoColumnLayout,children:[F.jsxs("div",{style:Yt.column,children:[F.jsx("h2",{style:Yt.sectionTitle,children:"How It Works"}),F.jsxs("ul",{style:Yt.featureList,children:[F.jsxs("li",{children:[F.jsx("span",{style:Yt.featureIcon,children:"🗺️"}),F.jsxs("span",{style:Yt.featureText,children:[F.jsx("strong",{children:"Interactive Maps:"})," Explore dorms with intuitive floor plans"]})]}),F.jsxs("li",{children:[F.jsx("span",{style:Yt.featureIcon,children:"🔍"}),F.jsxs("span",{style:Yt.featureText,children:[F.jsx("strong",{children:"Smart Filtering:"})," Find rooms by floor, type, AC status, capacity, and class year eligibility"]})]}),F.jsxs("li",{children:[F.jsx("span",{style:Yt.featureIcon,children:"👥"}),F.jsxs("span",{style:Yt.featureText,children:[F.jsx("strong",{children:"Group Management:"})," Create and manage roommate groups easily"]})]}),F.jsxs("li",{children:[F.jsx("span",{style:Yt.featureIcon,children:"🔒"}),F.jsxs("span",{style:Yt.featureText,children:[F.jsx("strong",{children:"Privacy Protection:"})," Room draw times are kept private within groups to prevent coercion"]})]})]})]}),F.jsxs("div",{style:Yt.column,children:[F.jsx("h2",{style:Yt.sectionTitle,children:"Our Technology"}),F.jsxs("div",{style:Yt.techStack,children:[F.jsxs("div",{style:Yt.techCategory,children:[F.jsx("h3",{style:Yt.techTitle,children:"Frontend"}),F.jsxs("ul",{style:Yt.techList,children:[F.jsx("li",{children:"React JS"}),F.jsx("li",{children:"HTML/CSS"}),F.jsx("li",{children:"Maptiler API"}),F.jsx("li",{children:"Figma (Design)"})]})]}),F.jsxs("div",{style:Yt.techCategory,children:[F.jsx("h3",{style:Yt.techTitle,children:"Backend"}),F.jsxs("ul",{style:Yt.techList,children:[F.jsx("li",{children:"JavaScript"}),F.jsx("li",{children:"Firebase"})]})]})]})]})]})}),F.jsxs("section",{style:Yt.section,children:[F.jsx("h2",{style:Yt.sectionTitle,children:"Ethical Considerations"}),F.jsxs("div",{style:Yt.ethicsBox,children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Privacy:"})," Room draw times are kept private (only seen amongst groupmates) to prevent coercion of students with good draw times."]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Equity:"})," By making information more accessible and easy to understand, we ensure that all students have fair and informed access to housing, not just those with connections to upperclassmen."]})]})]}),F.jsxs("section",{style:Yt.section,children:[F.jsx("h2",{style:Yt.sectionTitle,children:"The Future of Housing47"}),F.jsx("div",{style:Yt.futureBox,children:F.jsxs("ul",{style:Yt.futureList,children:[F.jsx("li",{children:"Integration with the current Residence system to allow room selection directly through Housing47"}),F.jsx("li",{children:"Support for joining multiple groups with different numbers of people for contingency planning"}),F.jsx("li",{children:"Implementation of all dorms with high-quality floor plans"}),F.jsx("li",{children:"Additional features based on student feedback and needs"})]})})]}),F.jsxs("section",{style:Yt.section,children:[F.jsx("h2",{style:Yt.sectionTitle,children:"Our Team"}),F.jsx("p",{style:Yt.teamDescription,children:"Housing47 was created by a team of Pomona College students who experienced firsthand the challenges of the housing selection process. Our team includes both freshmen experiencing the process for the first time and seniors who have navigated it multiple times."}),F.jsxs("div",{style:Yt.makerInfo,children:[F.jsx("span",{style:Yt.makerBadge,children:"Maker Track Project"}),F.jsx("span",{style:Yt.overlayBadge,children:"5C Community Overlay"})]})]})]})}),F.jsx("footer",{style:Yt.footer,children:F.jsx("p",{children:"© 2025 Housing47. All rights reserved."})})]})},Yt={page:{minHeight:"100vh",display:"flex",flexDirection:"column",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",backgroundColor:"#F9FAFB"},header:{backgroundColor:"white",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",padding:"1rem 2rem",display:"flex",justifyContent:"space-between",alignItems:"center",zIndex:10},logoContainer:{display:"flex",alignItems:"center",gap:"0.5rem"},logoIcon:{fontSize:"1.5rem"},logoText:{fontWeight:"bold",fontSize:"1.25rem",color:"#4F46E5"},navLinks:{display:"flex",alignItems:"center",gap:"1rem"},navLink:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#4B5563",fontWeight:"500",background:"none",border:"none",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},signOutButton:{padding:"0.5rem 1rem",borderRadius:"0.5rem",color:"#EF4444",fontWeight:"500",background:"none",border:"1px solid #EF4444",cursor:"pointer",transition:"background-color 0.2s, color 0.2s"},mainContent:{flex:1,padding:"2rem",display:"flex",justifyContent:"center"},aboutContainer:{maxWidth:"1000px",width:"100%"},pageTitle:{fontSize:"2.5rem",fontWeight:"bold",color:"#1F2937",marginBottom:"2rem",textAlign:"center"},section:{marginBottom:"3rem"},sectionTitle:{fontSize:"1.5rem",fontWeight:"600",color:"#111827",marginBottom:"1rem",borderBottom:"2px solid #E5E7EB",paddingBottom:"0.5rem"},missionBox:{backgroundColor:"#EEF2FF",borderRadius:"0.75rem",padding:"1.5rem",borderLeft:"5px solid #4F46E5"},missionText:{fontSize:"1.1rem",lineHeight:"1.6",margin:0,color:"#1E40AF"},twoColumnLayout:{display:"flex",gap:"2rem",flexWrap:"wrap"},column:{flex:"1 1 400px"},featureList:{listStyle:"none",padding:0,margin:0,display:"flex",flexDirection:"column",gap:"1rem"},featureIcon:{fontSize:"1.5rem",marginRight:"0.75rem",display:"inline-block",verticalAlign:"middle"},featureText:{display:"inline-block",verticalAlign:"middle"},techStack:{display:"flex",gap:"2rem",flexWrap:"wrap"},techCategory:{flex:1,minWidth:"180px"},techTitle:{fontSize:"1.1rem",color:"#4B5563",marginBottom:"0.5rem"},techList:{margin:0,paddingLeft:"1.5rem"},ethicsBox:{backgroundColor:"#F0FDF4",borderRadius:"0.75rem",padding:"1.5rem",borderLeft:"5px solid #10B981"},futureBox:{backgroundColor:"#FEF3C7",borderRadius:"0.75rem",padding:"1.5rem"},futureList:{margin:0,paddingLeft:"1.5rem"},teamDescription:{marginBottom:"1.5rem"},makerInfo:{display:"flex",gap:"1rem",flexWrap:"wrap"},makerBadge:{backgroundColor:"#DBEAFE",color:"#1E40AF",padding:"0.5rem 0.75rem",borderRadius:"9999px",fontSize:"0.875rem",fontWeight:"500"},overlayBadge:{backgroundColor:"#E0E7FF",color:"#4338CA",padding:"0.5rem 0.75rem",borderRadius:"9999px",fontSize:"0.875rem",fontWeight:"500"},footer:{borderTop:"1px solid #E5E7EB",padding:"1rem",textAlign:"center",color:"#6B7280",backgroundColor:"white",fontSize:"0.875rem"}};function Ox(){return F.jsxs(a0,{children:[F.jsxs(By,{children:[F.jsx(Zc,{path:"/",element:F.jsx(m0,{})}),F.jsx(Zc,{path:"/signup",element:F.jsx(qv,{})}),F.jsx(Zc,{path:"/signin",element:F.jsx(Qv,{})}),F.jsx(Zc,{path:"/map",element:F.jsx(Kv,{})}),F.jsx(Zc,{path:"/dorms/:dormId",element:F.jsx(Wv,{})})," ",F.jsx(Zc,{path:"/dashboard",element:F.jsx(Jv,{})}),F.jsx(Zc,{path:"/users",element:F.jsx(Lx,{})}),F.jsx(Zc,{path:"/about",element:F.jsx(Bx,{})})]}),F.jsx(kx,{position:"top-right",autoClose:3e3})]})}q_.createRoot(document.getElementById("root")).render(F.jsx(Pe.StrictMode,{children:F.jsx(Ox,{})}));
